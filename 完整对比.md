# 数据

## 不分词性

[('T1578', 13), ('T1078', 12), ('T1044', 12), ('T1187', 11), ('T1556', 11), ('T1550.002', 11), ('T1098.002', 11), ('T0811', 11), ('T1556.001', 11), ('T1553', 11), ('T1110.001', 10), ('T0836', 10), ('T0859', 10), ('T1087', 10), ('T1574.005', 10), ('T1534', 10), ('T1562', 10), ('T1558', 10), ('T1578.004', 10), ('T1499', 10), ('T1550', 10), ('T1053.005', 10), ('T1608.004', 10), ('T1114', 10), ('T1133', 10), ('T1098', 10), ('T0823', 10), ('T1053.002', 9), ('T1557.001', 9), ('T1562.002', 9), ('T1078.003', 9), ('T0883', 9), ('T1553.003', 9), ('T1497.001', 9), ('T1578.002', 9), ('T1562.001', 9), ('T1553.001', 9), ('T1078.002', 9), ('T1037.002', 9), ('T1112', 9), ('T1134.004', 9), ('T1111', 9), ('T1003', 9), ('T0852', 9), ('T1110.003', 9), ('T1203', 9), ('T1070', 9), ('T1007', 9), ('T1110.004', 9), ('T1021', 9), ('T1485', 9), ('T1033', 9), ('T0886', 9)

## 自带

[('T1044', 9), ('T1574.005', 9), ('T1534', 8), ('T0811', 8), ('T0886', 8), ('T0823', 8), ('T1562.002', 8), ('T1556', 8), ('T1556.001', 8), ('T1578', 8), ('T1021', 7), ('T1078', 7), ('T1558', 7), ('T1098', 7), ('T1007', 7), ('T1078.002', 7), ('T1070', 7), ('T1546.004', 7), ('T1087', 7), ('T1485', 7), ('T1088', 7), ('T1053.002', 7), ('T1497', 7), ('T1553', 7), ('T1622', 7), ('T0859', 7), ('T1497.001', 7), ('T1053.005', 7), ('T1098.002', 7), ('T0825', 7), ('T1547.008', 6), ('T1134', 6), ('T1548.002', 6), ('T1528', 6), ('T1556.003', 6), ('T1078.004', 6), ('T1187', 6), ('T1072', 6), ('T1078.003', 6), ('T1578.002', 6), ('T1578.004', 6), ('T1539', 6), ('T1021.005', 6), ('T1553.003', 6), ('T1518.001', 6), ('T1547.009', 6), ('T0853', 6), ('T1497.002', 6), ('T1156', 6), ('T0814', 6), ('T1621', 6), ('T1197', 6), ('T1550.002', 6), ('T1497.003', 6), ('T1555.003', 6), ('T1087.004', 6), ('T1553.001', 6), ('T1548', 6), ('T1021.006', 6), ('T1550.004', 6), ('T1499', 6), ('T1021.002', 6), ('T1550.001', 6), ('T1564', 6), ('T1213.001', 6), ('T1068', 6), ('T1213', 6), ('T1584.001', 6), ('T1114', 6), ('T1087.001', 6), ('T1566.003', 6), ('T1557.001', 6), ('T1203', 6), ('T1110.001', 6), ('T1527', 6)

## stanford

[('T1562.002', 9), ('T1110.001', 8), ('T0823', 8), ('T1114', 8), ('T1534', 8), ('T0811', 8), ('T1556', 8), ('T1485', 8), ('T1558', 8), ('T0859', 7), ('T1550', 7), ('T1078.002', 7), ('T0886', 7), ('T1070', 7), ('T1578', 7), ('T1098.002', 7), ('T1564', 7), ('T1007', 7), ('T1044', 7), ('T1110.004', 7), ('T1550.002', 7), ('T1078.003', 7), ('T1110.003', 7), ('T1555.003', 7), ('T1078', 7), ('T1556.001', 7), ('T1546.004', 7), ('T1033', 7), ('T1547.008', 7), ('T1088', 7)

## stanford 结果 + 自带分词

```
[('T1562.002', 8), ('T1534', 8), ('T1078.003', 7), ('T1114', 7), ('T0811', 7), ('T1110.001', 7), ('T1578', 7), ('T1558', 7), ('T1556', 7), ('T0886', 7), ('T1078.002', 7), ('T0859', 7), ('T1546.004', 7), ('T1485', 7), ('T1556.001', 7), ('T1078', 7), ('T1098.002', 7), ('T0823', 7)
```

# 分析

## security rule

```
name: Login Logout At Unusual Time

remarks: A login/logout operation happened at unusual time

description: This rule identifies situations in which Windows login and logout operations are performed or attempted outside the normal working hours (e.g., whenever operators work in shifts, this rule can ensure that such login and logout operations happen in the supposed timeframe). As attackers can try to take advantage of the absence of personnel to exploit the target systems, rules like these one work on restricting the categories of security-related events happening at unexpected time.
```

### 自带: 26

```
{'hour', 'absence', 'shift', 'timeframe', 'rule', 'category', 'login', 'operator', 'perform', 'target', 'try', 'advantage', 'event', 'operation', 'attacker', 'personnel', 'system', 'account', 'work', 'logout', 'relate', 'security', 'time', 'restrict', 'situation', 'attempt'}
```

perform，relate，restrict

### stanford: 24

```
{'category', 'account', 'hour', 'personnel', 'target', 'attempt', 'login', 'system', 'event', 'attacker', 'window', 'logout', 'timeframe', 'operator', 'time', 'rule', 'operation', 'situation', 'security', 'absence', 'advantage', 'work', 'shift', 'try'}
```

## mitre attack（stanford）

### T1562.002: 9

category，**account**，target，**attempt**，**login**，**system**，event，window，**security**

```
log window event

activity tool success category prompt log advance analyst eventlogcoretechnologies login record exe compromise le set secpol line follow policy example code advancedsecauditpolicysettings user leverage default change adversary detection attempt data 002redcanaryco msc audit use command system security target turn remove parameter allusers creation failure logon limit service component t1562 auditpolicymicrosoft evidence window event process eventlog application power run powershell name configuration sub account auditpol stop

tool party log artifact s0002 viewer sc wevtutil http phant0m function hkeylocalmachine intent capture s0645 example argument action leverage script currentcontrolset detection software mitre attempt data minint mimikatz audit use command defevwineventlogging system registry file evtlogtampering cycle patch message control limit service org monitor window event administrator attack eventlog process run addition application auditpol stop
```

### T1078.003: 7

**account**，hour，**attempt**，**login**，**system**，time，**security**

```
account

purpose escalation dump harvest support http administration access technique persistence credential organization defense abuse t1003 user adversary machine mitre mean use system privilege gain password network service org configure movement attack account evasion

activity session log domain hour information resource login access build daemon admin correlate example behavior user machine attempt share use authentication system security vpn gain linux network service business process time sssd ownership account
```

# 思路1

## 不增加数据源

几乎无关联

## 增加数据源

噪声数据

## 区分词性

两种优劣

## 同一级别下的细分（词的重要性）

### IF-IDF

# 思路2

## 规范输入