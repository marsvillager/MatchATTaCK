category: vulnerability
ciaLevel: integrity
component: SI
description: Remote Desktop Protocol (RDP) is a proprietary protocol developed by
  Microsoft, which provides a user with a graphical interface to connect to another
  computer over a network connection. The user employs RDP client software for this
  purpose, while the other computer must run RDP server software. Secure Shell (SSH)
  is a cryptographic network protocol for operating network services securely over
  an unsecured network. Typical applications include remote command-line, login, and
  remote command execution, but any network service can be secured with SSH. This
  indicator help user to detect vulnerability scan behavior via RDP/SSH protocol on
  target network.
eventId: '5021'
eventType: alert
impact: ''
keys: '{"src":{"en":"Source Address", "zh":"源地址"}}'
name: 'Vulnerability Scan: Nessus RDP/SSH Access'
nameCN: 漏洞扫描：Nessus RDP/SSH访问
parseEsResultKeys: ''
redisEventKey: event-ts-nessus-rdp-ssh-access
remarkCN: 源主机 {src} 通过RDP/SSH协议进行漏洞扫描
remarks: Src host {src} performs vulnerability scan over RDP/SSH protocol via Nessus
  client
requirements: Nessus scans the target network via RDP/SSH protocol.
ruleType: '4'
script: '{"query": {"bool": {"must": [{"range": {"@timestamp": {"gt": "<bt>","lt":
  "<et>"}}}],"should": [{"bool": {"must": [{"match": {"cat": "rdp"}},{"match_phrase":
  {"cookie": "nessus"}}]}},{"bool": {"must": [{"match": {"cat": "ssh"}},{"exists":
  {"field": "client"}}]}}],"minimum_should_match": 1}},"size": 1000}'
source: ''
status: 0
tags: [attack.enterprise.T1595.002]
threshold: 1
timeWindow: 60000
