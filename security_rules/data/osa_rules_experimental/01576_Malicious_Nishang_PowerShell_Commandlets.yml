category: attack
ciaLevel: integrity
component: SI
eventId: '1576'
eventType: alert
impact: ''
keys: '{"src":{"en":"Source Address", "zh":"源地址"}}'
name: Malicious Nishang PowerShell Commandlets
nameCN: 可疑的Nishang PowerShell Commandlets
parseEsResultKeys: ''
redisEventKey: event-ts-malicious-nishang-powerShell-commandlets
remarkCN: 主机 {src} 从Nishang开发框架中检测到Commandlet名称和参数
remarks: Host {src} detects Commandlet names and arguments from the Nishang exploitation
  framework
ruleType: '1'
script: '{"query":{"constant_score":{"filter":{"bool":{"must":[{"range":{"@timestamp":{"gt":"<bt>","lt":"<et>"}}}],"should":[{"multi_match":{"query":"Add-ConstrainedDelegationBackdoor","fields":[],"type":"phrase"}},{"multi_match":{"query":"Set-DCShadowPermissions","fields":[],"type":"phrase"}},{"multi_match":{"query":"DNS_TXT_Pwnage","fields":[],"type":"phrase"}},{"multi_match":{"query":"Execute-OnTime","fields":[],"type":"phrase"}},{"multi_match":{"query":"HTTP-Backdoor","fields":[],"type":"phrase"}},{"multi_match":{"query":"Set-RemotePSRemoting","fields":[],"type":"phrase"}},{"multi_match":{"query":"Set-RemoteWMI","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-AmsiBypass","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-CHM","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-HTA","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-SCF","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-SCT","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-Shortcut","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-WebQuery","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-Word","fields":[],"type":"phrase"}},{"multi_match":{"query":"Enable-Duplication","fields":[],"type":"phrase"}},{"multi_match":{"query":"Remove-Update","fields":[],"type":"phrase"}},{"multi_match":{"query":"Download-Execute-PS","fields":[],"type":"phrase"}},{"multi_match":{"query":"Download_Execute","fields":[],"type":"phrase"}},{"multi_match":{"query":"Execute-Command-MSSQL","fields":[],"type":"phrase"}},{"multi_match":{"query":"Execute-DNSTXT-Code","fields":[],"type":"phrase"}},{"multi_match":{"query":"Out-RundllCommand","fields":[],"type":"phrase"}},{"multi_match":{"query":"Copy-VSS","fields":[],"type":"phrase"}},{"multi_match":{"query":"FireBuster","fields":[],"type":"phrase"}},{"multi_match":{"query":"FireListener","fields":[],"type":"phrase"}},{"multi_match":{"query":"Get-Information","fields":[],"type":"phrase"}},{"multi_match":{"query":"Get-PassHints","fields":[],"type":"phrase"}},{"multi_match":{"query":"Get-WLAN-Keys","fields":[],"type":"phrase"}},{"multi_match":{"query":"Get-Web-Credentials","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-CredentialsPhish","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-MimikatzWDigestDowngrade","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-SSIDExfil","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-SessionGopher","fields":[],"type":"phrase"}},{"multi_match":{"query":"Keylogger","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-Interceptor","fields":[],"type":"phrase"}},{"multi_match":{"query":"Create-MultipleSessions","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-NetworkRelay","fields":[],"type":"phrase"}},{"multi_match":{"query":"Run-EXEonRemote","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-Prasadhak","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-BruteForce","fields":[],"type":"phrase"}},{"multi_match":{"query":"Password-List","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-JSRatRegsvr","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-JSRatRundll","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-PoshRatHttps","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-PowerShellIcmp","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-PowerShellUdp","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-PSGcat","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-PsGcatAgent","fields":[],"type":"phrase"}},{"multi_match":{"query":"Remove-PoshRat","fields":[],"type":"phrase"}},{"multi_match":{"query":"Add-Persistance","fields":[],"type":"phrase"}},{"multi_match":{"query":"ExetoText","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-Decode","fields":[],"type":"phrase"}},{"multi_match":{"query":"Invoke-Encode","fields":[],"type":"phrase"}},{"multi_match":{"query":"Parse_Keys","fields":[],"type":"phrase"}},{"multi_match":{"query":"Remove-Persistence","fields":[],"type":"phrase"}},{"multi_match":{"query":"StringtoBase64","fields":[],"type":"phrase"}},{"multi_match":{"query":"TexttoExe","fields":[],"type":"phrase"}},{"multi_match":{"query":"Powerpreter","fields":[],"type":"phrase"}},{"multi_match":{"query":"Nishang","fields":[],"type":"phrase"}},{"multi_match":{"query":"DataToEncode","fields":[],"type":"phrase"}},{"multi_match":{"query":"LoggedKeys","fields":[],"type":"phrase"}},{"multi_match":{"query":"OUT-DNSTXT","fields":[],"type":"phrase"}},{"multi_match":{"query":"Jitter","fields":[],"type":"phrase"}},{"multi_match":{"query":"ExfilOption","fields":[],"type":"phrase"}},{"multi_match":{"query":"Tamper","fields":[],"type":"phrase"}},{"multi_match":{"query":"DumpCerts","fields":[],"type":"phrase"}},{"multi_match":{"query":"DumpCreds","fields":[],"type":"phrase"}},{"multi_match":{"query":"Shellcode32","fields":[],"type":"phrase"}},{"multi_match":{"query":"Shellcode64","fields":[],"type":"phrase"}},{"multi_match":{"query":"NotAllNameSpaces","fields":[],"type":"phrase"}},{"multi_match":{"query":"exfill","fields":[],"type":"phrase"}},{"multi_match":{"query":"FakeDC","fields":[],"type":"phrase"}},{"multi_match":{"query":"Exploit","fields":[],"type":"phrase"}}]}}}}}'
source: ''
status: 0
tags: ''
threshold: 1
timeWindow: 60000
