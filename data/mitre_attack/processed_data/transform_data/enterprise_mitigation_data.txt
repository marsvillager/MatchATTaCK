password filt dll mitig
ens valid password filt reg filt dlls must pres window instal direct cod c \windows\system32\ /code default domain control and/or loc comput correspond entry cod hkey_local_machine\system\currentcontrolset\control\lsa\notification pack /code microsoft instal password filt n.d
spac filenam mitig
prev fil trail spac extend
histcontrol mitig
prev us chang cod histcontrol /code environ vary sec bash hist also mak sur cod histcontrol /code environ vary set ignoredup instead ignorebo ignorespac
cred fil mitig
est org policy prohibit password stor fil ens develop system admin aw risk assocy plaintext password softw config fil leav endpoint system serv preempt search fil contain password remov find restrict fil shar spec direct access necess us remov vuln group policy pref microsoft ms14-025
exploit cred access mitig
upd softw regul employ patch man intern enterpr endpoint serv develop robust cyb threat intellig cap determin typ level threat us softw exploit 0-days particul org mak difficult advers adv op exploit undiscov unpatch vuln us sandbox avail typ virt apply microseg also mitig impact typ exploit risk addit exploit weak impl stil ex ar technic pwn2own 2017 vm escap sec apply look behavy us exploit window defend exploit guard wdeg enh mitig expery toolkit emet us mitig exploit behavy technet mov beyond emet control flow integr check anoth way pot ident stop softw exploit occ wikiped control flow integr many protect depend architect target apply bin compat work softw target defens evas
query reg mitig
ident unnecess system util pot malicy softw us acquir inform within reg audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
login item mitig
restrict us abl cre login item addit hold shift key login prev ap op autom re-open window mac
setuid setgid mitig
apply know vuln know shel escap setuid setgid bit set reduc pot dam apply comprom addit numb program setuid setgid bit set minim across system
compil html fil mitig
consid block download/transfer execut pot uncommon fil typ know us advers campaign chm fil paloalto prev opportun attack apr 2016 also consid us apply whitel prev execut hh.exe requir giv system network prev pot misus advers
dat destruct mitig
consid impl disast recovery plan contain proc tak regul dat backup us rest org dat ready.gov drp ens backup stor system protect common method advers us gain access destroy backup prev recovery ident pot malicy softw audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
window man instru ev subscrib mitig
dis wmi serv caus system inst evalu ass impact network default admin allow connect remot us wmi restrict us allow connect disallow us connect remot wmi prev cred overlap across system admin privileg account fireey wmi 2015
fil system permit weak mitig
us audit tool cap detect fil system permit abus opportun system within enterpr correct limit privileg us account group auth admin interact serv chang serv bin target path loc toolkit lik powersploit framework contain powerup mod us expl system serv fil system permit weak powersploit ident block pot malicy softw execut abus fil direct serv permit us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown program deny execut us direct fil download direct temp direct abl sec kanthak 7zip instal turn uac privileg elev standard us cod hkey_local_machine\software\microsoft\windows\currentversion\policies\system /code autom deny elev request ad cod consentpromptbehaviorus =dword:00000000 /code sec kanthak 7zip instal consid en instal detect us ad cod enableinstallerdetect =dword:00000001 /code prompt password instal also log attempt dis instal detect instead ad cod enableinstallerdetect =dword:00000000 /code prev pot elev privileg exploit process uac detect instal allow instal process continu without log
appinit dlls mitig
upgrad window 8 lat en sec boot ident block pot malicy softw execut appinit dlls us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown dlls
launch ag mitig
restrict us abl cre launch ag group policy
network intrud prev
us intrud detect sign block traff network bound
regsvr32 mitig
microsoft enh mitig expery toolkit emet attack surfac reduc asr feat us block regsvr32.exe us bypass whitel sec host baselin emet
hid us mitig
comput domain join group policy help restrict abl cre hid us simil prev mod cod /library/preferences/com.apple.loginwindow /code cod hide500users /code valu forc us vis
dat inform reposit mitig
mitig advers access inform reposit collect develop publ policy defin acceiv inform stor appropry impl access control mech includ auth appropry auth enforc principl least-privilege period privileg review account mitig access valid account http us access reposit
exploit remot serv mitig
seg network system appropry reduc access crit system serv control method minim avail serv necess regul scan intern network avail serv ident new pot vuln serv minim permit access serv account limit impact exploit upd softw regul employ patch man intern enterpr endpoint serv develop robust cyb threat intellig cap determin typ level threat us softw exploit 0-days particul org mak difficult advers adv op exploit undiscov unpatch vuln us sandbox avail typ virt apply microseg also mitig impact typ exploit risk addit exploit weak impl stil ex ar technic pwn2own 2017 vm escap sec apply look behavy us exploit window defend exploit guard wdeg enh mitig expery toolkit emet us mitig exploit behavy technet mov beyond emet control flow integr check anoth way pot ident stop softw exploit occ wikiped control flow integr many protect depend architect target apply bin compat work softw serv target
vuln scan
vuln scan us find pot exploit softw vuln remedy
domain trust discovery mitig
map trust within ex domains/forest keep trust rel minim employ network seg sensit domain harmj0y domain trust
third-party softw mitig
evalu sec third-party softw could us enterpr environ ens access man system third-party system limit monit sec strict approv policy us third-party system grant access third-party system limit numb auth admin ens prop system access isol crit network system us firewal account privileg sep group policy multi-factor auth ver account cred us access third-party system un us throughout enterpr network ens account us third-party provid access system trac third-party us throughout network us third-party provid environ ens third-party system regul patch us provid prev pot remot access exploit privileg esc http ens regul review account provid system ver continu busy nee ens govern trac de-provisioning access long requir third-party system us deploy serv ens config deploy sign bin ens trust sign cert co-located third-party system instead loc system access remot remot access tight control
bin pad mitig
ident pot malicy softw execut pad otherw obfusc bin audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
audio capt mitig
mitig techn spec difficult requir fine-grained ap control effort foc prev unw unknown cod execut system ident block pot malicy softw us record audio us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
system owner/us discovery mitig
ident unnecess system util pot malicy softw us acquir inform system us audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
periph dev discovery mitig
ident unnecess system util pot malicy softw us acquir inform periph dev audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
clipboard dat mitig
instead block softw bas clipboard capt behavy ident pot malicy softw contain funct audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
gatekeep bypass mitig
tool us suppl gatekeep funct addit system set prev apply run n't download appl stor help mitig issu
schedule transf mitig
network intrud detect prev system us network sign ident traff spec advers command control infrastruct malw us mitig act network level sign oft un ind within protocol bas spec obfusc techn us particul advers tool lik diff across vary malw famy vert advers lik chang tool command control sign tim construct protocol way avoid detect common defend tool univers birmingham c2
brows bookmark discovery mitig
fil system act common part op system unlik mitig would appropry techn exampl mitig access brows bookmark fil lik unintend sid effect prev legitim softw op prop effort foc prev advers tool run ear chain act id subsequ malicy behavy stil benef ident block unnecess system util pot malicy softw us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
port monit mitig
ident block pot malicy softw persist man us whitel beechey 2010 tool cap monit dll load process run system permit
limit access resourc network
prev access fil shar remot access system unnecess serv mech limit access includ us network cont rdp gateway etc
applescrib mitig
requir applescrib sign trust develop id execut prev random applescrib cod execut applescrib sign subject applescrib cod scrutiny .app fil pass gatekeep
indirect command execut mitig
ident block pot malicy softw contain abud funct us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp mech also us dis and/or limit us access window util fil types/location us invok malicy execut spectorop settingcontent-ms jun 2018
network shar discovery mitig
ident unnecess system util pot malicy softw us acquir network shar inform audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
remot dat stor
us remot sec log sensit fil stor access control bet prev expos intrud detect log dat sensit inform
filt network traff
us network apply filt ingr egress traff perform protocol-based filt config softw endpoint filt network traff
restrict web-based cont
restrict us certain websit block downloads/attachment block javascrib restrict brows extend etc
instal root cert mitig
http publ key pin hpkp on method mitig pot man-in-the-middle situ advers us mis-issued fraud cert interceiv encrypt commun enforc us expect cert wikiped hpkp window group policy us man root cert cod flag /code valu cod hklm\software\policies\microsoft\systemcertificates\root\protectedroots /code set 1 prev non-administrator us mak root instal hkcu cert stor spectorop cod sign dec 2017
limit softw instal
block us group inst unapprov softw
sudo mitig
sudo fil strictly edit password alway requir us spawn risky process us high privileg requir password ev advers get termin access must know password run anyth sudo fil
multilay encrypt mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level us encrypt protocol mak typ network-based c2 detect difficult due reduc abl sign traff pri knowledg advers c2 infrastruct us domain ip address block lik effect long-term solv advers chang infrastruct oft univers birmingham c2
transmit dat manip mitig
ident crit busy system process target advers work sec commun rel process tamp encrypt import dat flow reduc impact tail mod dat transit
autom exfilt mitig
ident unnecess system util script pot malicy softw us transf dat outsid network audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
apply window discovery mitig
ident unnecess system util pot malicy softw us acquir inform audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
apply develop guid
mitig describ guid train giv develop apply avoid introduc sec weak advers abl tak adv
system firmw mitig
prev advers access privileg account access necess perform techn check integr ex bio ef determin vuln mod patch bio ef necess us trust platform mod technolog tcg trust platform mod
dat compress mitig
ident unnecess system util third-party tool pot malicy softw us compress fil audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp network intrud prev dat loss prev tool set block spec fil typ leav network unencrypt channel advers mov encrypt channel
limit hardw instal
block us group inst us unapprov hardw system includ usb dev
us train
train us aw access manip attempt advers reduc risk success spearph soc engin techn involv us interact
dat encrypt mitig
ident unnecess system util third-party tool pot malicy softw us encrypt fil audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
fil direct discovery mitig
fil system act common part op system unlik mitig would appropry techn stil benef ident block unnecess system util pot malicy softw us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
us account control
config window us account control mitig risk advers obtain elev process access
hyperv mitig
prev advers access privileg account necess instal hyperv
plist mod mitig
prev plist fil mod us mak read-only
op system config
mak config chang rel op system common feat op system result system hard techn
window admin shar mitig
reus loc admin account password across system ens password complex un password crack guess deny remot us loc admin cred log system allow domain us account loc admin group multipl system ident unnecess system util pot malicy softw us lev smb window admin shar audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
winlogon help dll mitig
limit privileg us account auth admin perform winlogon help chang ident block pot malicy softw execut winlogon help process us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown dlls
runtim dat manip mitig
ident crit busy system process target advers work sec system tamp prev crit busy system process replac overwrit reconfig load pot malicy cod ident pot malicy softw audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
im fil execut opt inject mitig
typ attack techn easy mitig prev control sint bas abus op system design feat exampl mitig ifeo lik unintend sid effect prev legitim softw i.e. sec produc op prop microsoft ifeoormalw july 2015 effort foc prev advers tool run ear chain act ident subsequ malicy behavy ident block pot malicy softw execut ifeo us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown execut
process doppelgäng mitig
typ attack techn easy mitig prev control patch sint bas abus op system design feat exampl mitig spec ap cal lik unintend sid effect prev legitim process-loading mech op prop effort foc prev advers tool run ear chain act ident subsequ malicy behavy although process doppelgäng us evad certain typ defens stil good pract ident pot malicy softw us perform advers act audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
fil delet mitig
ident unnecess system util third-party tool pot malicy softw us delet fil audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
exploit defens evas mitig
upd softw regul employ patch man intern enterpr endpoint serv develop robust cyb threat intellig cap determin typ level threat us softw exploit 0-days particul org mak difficult advers adv op exploit undiscov unpatch vuln us sandbox avail typ virt apply microseg also mitig impact typ exploit risk addit exploit weak impl stil ex ar technic pwn2own 2017 vm escap sec apply look behavy us exploit window defend exploit guard wdeg enh mitig expery toolkit emet us mitig exploit behavy technet mov beyond emet control flow integr check anoth way pot ident stop softw exploit occ wikiped control flow integr many protect depend architect target apply bin compat work softw target defens evas
email collect mitig
us encrypt provid ad lay sec sensit inform send email encrypt us publ key cryptograph requir advers obtain priv cert along encrypt key decrypt mess us two-factor auth public-facing webmail serv also recommend best pract minim us us nam password advers ident unnecess system util pot malicy softw us collect email dat fil access corp email serv audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
dis sec tool mitig
ens prop process reg fil permit plac prev advers dis interf sec serv
dat remov med mitig
ident unnecess system util pot malicy softw us collect dat remov med audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
standard non-applicat lay protocol mitig
prop config firewal proxy limit outgo traff necess port prop network gateway system also ens host provid commun auth interfac network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec obfusc techn us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
control panel item mitig
typ attack techn easy mitig prev control sint bas abus op system design feat exampl mitig spec window ap cal and/or execut particul fil extend lik unintend sid effect prev legitim softw i.e. driv config tool op prop effort foc prev advers tool run ear chain act id subsequ malicy behavy restrict stor execut control panel item protect direct cod c \windows /code rath us direct index know saf control panel item block pot malicy softw us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown execut fil consid ful en us account control uac imp system-wide chang illegitim admin microsoft uac
pas ticket mitig
monit domain unus cred logon limit cred overlap across system prev dam cred comprom ens loc admin account complex un password allow us loc admin multipl system limit domain admin account permit domain control limit serv deleg admin funct sep account adsec ad kerbero attack contain impact prevy gen gold ticket reset built-in krbtgt account password twic invalid ex gold ticket cre krbtgt hash kerbero ticket der cert-eu gold ticket protect attempt ident block unknown malicy softw could us obtain kerbero ticket us auth us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
domain gen algorithm mitig
techn difficult mitig sint domain reg us dispos short malw research reverse-engineer malw vary us dga determin fut domain malw attempt contact tim resourc intend effort cybereason dissect dga cisco umbrell dga brut forc malw also increas incorp see valu un inst would nee determin extract fut gen domain cas see particul sampl us extract dns traff akama dga mitig ev thousand poss domain gen per day mak impract defend preempt reg poss c2 domain due cost cas loc dns sinkhol us help prev dga-based command control reduc cost network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec protocol us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
clear command hist mitig
prev us delet writ certain fil stop advers malicy alt cod ~/.bash_history /code fil addit mak environ vary readon mak sur hist preserv sec bash hist
window remot man mitig
dis winrm serv serv necess lock crit enclav sep winrm infrastruct account permit follow winrm best pract config auth method us host firewal restrict winrm access allow commun to/from spec dev nsa spot
dat backup
tak stor dat backup end us system crit serv ens backup stor system hard keep sep corp network prev comprom
launch daemon mitig
limit privileg us account remedy privileg esc vect auth admin cre new launch daemon
serv stop mitig
ens prop process reg fil permit plac inhibit advers dis interf crit serv limit privileg us account group auth admin interact serv chang serv config hard system us serv crit network busy commun funct op intrud detect analys respons system sep network produc environ less chant advers see interf crit respons funct
ssh hijack mitig
ens ssh key pair strong password refrain us key-store technolog ssh-agent unless prop protect ens priv key stor sec loc legitim own access strong password rot frequ ens prop fil permit set hard system prev root privileg esc opportun allow remot access via ssh root privileg account ens ag forward dis system explicit requir feat prev misus symantec ssh ssh-agent
dat encrypt impact mitig
consid impl disast recovery plan contain proc regul tak test dat backup us rest org dat ready.gov drp cas mean decrypt fil affect ransomw campaign releas publ research trust sourc publ releas decrypt tools/key revers effect ransomw ident pot malicy softw audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
dat stag mitig
ident system util remot access third-party tool us pot malicy softw us stor compress encrypt dat publ writ direct cent loc common us stag direct e.g recyc bin ind non-standard behavy audit and/or block us fil integr monit tool appropry consid apply dat siz limit block fil writ common compress encrypt util 7zip rar zip zlib frequ us stag direct cent loc monit attempt viol restrict
shar webroot mitig
network allow op develop test web cont allow us set web serv enterpr network particul vuln system web serv prop sec limit privileg account us unauth network shar access network/system isol ens prop permit direct access web serv disallow remot access webroot direct us serv web cont dis execut direct within webroot ens permit web serv process requir us built-in account instead cre spec account limit unnecess access permit overlap across multipl system acunetix serv secuirty nist serv sec july 2008
kernel mod extend mitig
common tool detect linux rootkit includ rkhunter sourceforg rkhunter chrootkit chkrootkit main although rootkit design evad certain detect tool lkms kernel extend requir root level permit inst limit access root account prev us load kernel mod extend prop privileg sep limit privileg esc opportun apply whitel softw restrict tool selinux also aid restrict kernel mod load kernel.org restrict kernel mod
cred reg mitig
stor cred within reg proact search cred within reg key attempt remedy risk necess softw must stor cred ens account limit permit abus obtain advers
masquerad mitig
cre sec rul avoid exclud bas fil nam fil path requir sign bin us fil system access control protect fold c \windows\system32 us tool restrict program execut via whitel attribut fil nam ident pot malicy softw look lik legitim program bas nam loc audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
web serv mitig
firewal web proxy us enforc extern network commun policy difficult org block particul serv many common us cours busy network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec protocol encod command us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
resourc hijack mitig
ident pot malicy softw audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
network sniff mitig
ens wireless traff encrypt appropry us kerbero ssl multifact auth wherev poss monit switch network span port us arp/dns poison rout reconfig ident block pot malicy softw us sniff analys network traff us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
execut prev
block execut cod system apply control and/or script block
password policy discovery mitig
mitig discovery password policy adv sint inform requir know system us network ens password policy mitig brut forc attack yet giv advers inform adv policy light act direct common way set enforc password policy throughout enterpr network microsoft password complex
cred access protect
us cap prev success cred access advers includ block form cred dump
brut forc mitig
set account lockout policy certain numb fail login attempt prev password guess strict policy cre den serv condit rend environ un-usable account locked-out perm us multifact auth follow best pract mitig access valid account http ref nist guidelin cre password nist 800-63-3 poss also en mult fact auth extern fac serv
ind remov tool mitig
mitig difficult inst lik advers access system anoth channel learn techn tool block resid defens exerc best pract config sec wel ens prop process follow investig pot comprom ess detect larg intrud discret alert ident block pot malicy softw us advers us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
.bash_profile .bashrc mitig
mak fil immut chang certain admin limit abl advers easy cre us level persist
sign script proxy execut mitig
certain sign script us execut program necess within giv environ us apply whitel config block execut script requir giv system network prev pot misus advers
multi-stage channel mitig
command control infrastruct us multi-stage channel block know ahead tim un sign pres c2 traff could also us bas ident block channel univers birmingham c2
fallback channel mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec protocol us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
screen capt mitig
block softw bas screen capt funct difficult legitim softw perform act instead ident pot malicy softw funct acquir screen capt audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
sourc mitig
due pot legitim us sourc command difficult mitig us techn
remot desktop protocol mitig
dis rdp serv unnecess remov unnecess account group remot desktop us group en firewal rul block rdp traff network sec zon audit remot desktop us group memb regul remov loc admin group list group allow log rdp limit remot us permit remot access necess us remot desktop gateway multifact auth remot login berkley sec leav rdp access internet chang gpo defin short timeout sess maxim amount tim singl sess act chang gpo spec maxim amount tim disconnect sess stay act rd sess host serv window rdp sess
llmnr/nbt-ns poison mitig
dis llmnr netbio loc comput sec set group policy nee within environ adsec window sec baselin us host-based sec softw block llmnr/netbios traff en smb sign stop ntlmv2 relay attack byt3bl33d3r ntlm relay sec ide smb relay microsoft smb packet sign
us execut mitig
us us train way bring aw common phish spearph techn rais susp pot malicy ev apply whitel abl prev run execut masquerad fil link visit us block unknown unus fil transit default download policy suspicy sit best pract prev vect .scr .exe .lnk .pif .cpl etc download scan dev op analys compress encrypt form zip rar us cont malicy fil obfusc fil inform http link visit us network intrud prev system system design scan remov malicy download us block act solv sign behavy bas advers construct fil way avoid system
hardw addit mitig
est network access control policy us dev cert 802.1x standard wikiped 802.1x restrict us dhcp reg dev prev unreg dev commun trust system block unknown dev access endpoint sec config monit ag
keychain mitig
password us login keychain chang us login password increas complex advers nee know addit password
script mitig
turn unus feat restrict access script engin vbscript scriptable admin framework powershel config off sec set en protect view execut within sandbox environ block macro group policy microsoft block off macro typ virt apply microseg also mitig impact comprom risk addit exploit weak impl stil ex ar technic pwn2own 2017 vm escap
cod sign
enforc bin apply integr digit sign ver prev untrust cod execut
timestomp mitig
mitig timestomp spec lik difficult effort foc prev pot malicy softw run ident block pot malicy softw contain funct perform timestomp us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
account discovery mitig
prev admin account enum apply elev uac sint lead disclos account nam reg key loc cod hklm\ software\microsoft\windows\currentversion\policies\credui\enumerateadministrators /code dis gpo comput config policy admin templ window compon cred us interfac e num admin account elev ucf stig elev account enum ident unnecess system util pot malicy softw us acquir inform system domain account audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
defac mitig
impl best pract websit defend exploit public-facing apply http owasp top 10 2017 consid impl disast recovery plan contain proc tak regul dat backup us rest org dat ready.gov drp ens backup stor system protect common method advers us gain access destroy backup prev recovery
environ vary permit
prev mod environ vary unauth us group
re-opened apply mitig
hold shift key log prev ap op autom re-open window mac feat dis entir follow termin command cod default writ -g applepersist -bool /code
netsh help dll mitig
ident block pot malicy softw persist man us whitel beechey 2010 tool cap monit dll load window util lik applock window command jpcert nsa m applock
domain front mitig
poss inspect http traff capt analys connect appear domain front ord us domain front attack lik nee deploy addit tool comprom system fireey apt29 domain front tor march 2017 mandy easy breach poss detect prev instal tool host-based solv
dat loss prev
us dat loss prev dlp strategy categ sensit dat ident dat form ind person ident inform pii restrict exfilt sensit dat purplesec dat loss prev
network den serv mitig
flood volum excess capac network connect target typ necess interceiv incom traff upstream filt attack traff legitim traff defens provid host internet serv provid isp 3rd party cont delivery network cdn provid spec do mitig cert-eu ddo march 2017 depend flood volum on-premises filt poss block sourc address sourc attack block port target block protocol us transport cert-eu ddo march 2017 immedy respons requir rapid eng 3rd party analys risk assocy crit resourc affect network do attack cre disast recovery plan/business continu plan respond incid cert-eu ddo march 2017
exploit public-facing apply mitig
apply isol least privileg help lesson impact exploit apply isol limit process system feat exploit target access least privileg serv account limit permit exploit process get rest system web apply firewal us limit expos apply seg extern fac serv serv rest network dmz sep host infrastruct us sec cod best pract design custom softw mean deploy extern fac system avoid issu docu owasp cwe softw weak id effort regul scan extern fac system vuln est proc rapid patch system crit vuln discov scan publ disclos
compon firmw mitig
prev advers access privileg account access necess perform techn consid remov replac system compon suspect comprom
system network config discovery mitig
ident unnecess system util pot malicy softw us acquir inform system network config audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
ind remov host mitig
autom forward ev log serv dat reposit prev condit advers loc manip dat loc system poss minim tim delay ev report avoid prolong stor loc system protect gen ev fil stor loc prop permit auth limit opportun advers increas privileg prev privileg esc opportun obfuscate/encrypt ev fil loc transit avoid giv feedback advers
lc_main hijack mitig
enforc valid digit sign sign cod apply trust apply sign trust party
forc auth mitig
block smb traff exit enterpr network egress filt block tcp port 139 445 udp port 137. filt block webdav protocol traff exit network access extern resourc smb webdav necess traff tight limit whitel us-cert smb sec us-cert apt energy oct 2017 intern traff monit workstation-to-workstat unus vs. baselin smb traff many network depend system network config resourc loc us strong password increas difficul cred hash crack obtain
firmw corrupt mitig
prev advers access privileg account access necess perform techn check integr ex bio dev firmw determin vuln mod patch bio firmw necess prev success us know vuln
privileg process integr
protect process high privileg us interact crit system compon us protect process light anti-process inject defens process integr enforc meas
multi-hop proxy mitig
traff know anonym network c2 infrastruct block us network black whit list not kind block circumv techn lik domain front http
xsl script process mitig
window man instru http and/or msxsl.exe us within giv environ dis wmi caus system inst evalu ass impact network msxsl.exe unnecess block execut prev abus advers
lc_load_dylib addit mitig
enforc bin sign correct appl develop id whitel apply via know hash bin also baselin dynam libr requir ap requir new dynam libr includ part upd investig
mitig
categ assocy techn mitig might increas risk comprom theref mitig recommend
pre-compromis
categ us appl mitig act apply techn occ advers gain init access reconnaiss resourc develop techn
trust rel mitig
network seg us isol infrastruct compon requir broad network access prop man account permit us party trust rel minim pot abus party party comprom advers vet sec policy proc org contract work requir privileg access network resourc
dll side-loading mitig
upd softw regul instal softw write-protected loc us program sxstrace.exe includ window along man inspect check manifest fil side-loading vuln softw
drive-by comprom mitig
drive-by comprom rely vuln piec softw cli end system us modern brows sec feat turn ens brows plugin keep upd help prev exploit phas techn malicy cod serv ad adblock help prev cod execut first plac script block extend help prev execut javascrib common us exploit process brows sandbox us mitig impact exploit sandbox escap stil ex window blog microsoft edg sandbox ar technic pwn2own 2017 vm escap typ virt apply microseg also mitig impact client-side exploit risk addit exploit weak impl stil ex ar technic pwn2own 2017 vm escap sec apply look behavy us exploit window defend exploit guard wdeg enh mitig expery toolkit emet us mitig exploit behavy technet mov beyond emet control flow integr check anoth way pot ident stop softw exploit occ wikiped control flow integr many protect depend architect target apply bin compat
lsass driv mitig
window 8.1 serv 2012 r2 en lsa protect set reg key cod hkey_local_machine\system\currentcontrolset\control\lsa\runasppl /code cod dword:00000001 /code microsoft lsa protect mar 2014 lsa protect ens lsa plug-in driv load digit sign microsoft sign adh microsoft sec develop lifecyc sdl process guid window 10 serv 2016 en window defend cred guard microsoft en cred guard april 2017 run lsass.exe isol virt environ without dev driv microsoft cred guard april 2017 ens saf dll search mod en cod hkey_local_machine\system\currentcontrolset\control\session manager\safedllsearchmode /code mitig risk lsass.exe load malicy cod libr microsoft dll sec
hook mitig
typ attack techn easy mitig prev control sint bas abus op system design feat exampl mitig hook lik unintend sid effect prev legitim softw i.e. sec produc op prop effort foc prev advers tool run ear chain act ident subsequ malicy behavy
ssl/tls inspect
break inspect ssl/tls sess look encrypt web traff advers act
common us port mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec protocol us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
process hollow mitig
typ attack techn easy mitig prev control sint bas abus op system design feat exampl mitig spec ap cal lik unintend sid effect prev legitim softw i.e. sec produc op prop effort foc prev advers tool run ear chain act ident subsequ malicy behavy although process hollow us evad certain typ defens stil good pract ident pot malicy softw us perform advers act audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
boot integr
us sec method boot system ver integr op system load mech
dat loc system mitig
ident unnecess system util pot malicy softw us collect dat loc system audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
trap mitig
due pot legitim us trap command difficult mitig us techn
dynam dat exchang mitig
reg key spec microsoft off feat control sec set dis autom dde/ol execut microsoft dde adv nov 2017 bleepingcomput dde dis word dec 2017 github dis ddeauto oct 2017 microsoft also cre en default reg key complet dis dde execut word excel microsoft adv170021 dec 2017 ens protect view en microsoft protect view consid dis emb fil off program onenot enrol protect view enigm rev dde jan 2018 github dis ddeauto oct 2017 window 10 en attack surfac reduc asr rul prev dde attack spawn child process off program microsoft asr nov 2017 enigm rev dde jan 2018
endpoint den serv mitig
lev serv provid cont delivery network cdn provid spec do mitig filt traff upstream serv cert-eu ddo march 2017 filt bound traff block sourc address sourc attack block port target block protocol us transport defend syn flood en syn cooky
system tim discovery mitig
benign softw us legitim process gath system tim effort foc prev unw unknown cod execut system common tool net.exe block policy prev common way acquir remot system tim ident unnecess system util pot malicy softw us acquir system tim inform audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
cod sign mitig
process whitel trust publ ver auth softw help prev sign malicy untrust cod execut system nsa m applock technet trust publ securel digit cert
systemd serv mitig
cre mod systemd serv unit fil gen reserv admin linux root us us superus privileg limit us access system util systemctl us legitim nee restrict read/write access systemd unit fil select privileg us legitim nee man system serv addit instal softw common ad chang systemd serv unit fil restrict softw instal trust reposit cauty orph softw pack util malicy cod protect apply whitel mitig abl malw cre mod systemd serv
hid fil direct mitig
mitig techn difficult unadv due legitim us hid fil direct
network seg
architect sect network isol crit system funct resourc us phys log seg prev access pot sensit system inform us dmz contain internet-facing serv expos intern network config sep virt priv cloud vpc inst isol crit cloud system
threat intellig program
threat intellig program help org gen threat intellig inform track trend inform defend pri mitig risk
input prompt mitig
techn exploit us tend alway supply cred prompt mak difficult mitig us us train way bring aw rais susp pot malicy ev ex off docu prompt cred
reg run key startup fold mitig
ident block pot malicy softw execut run key startup fold persist us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
autom collect mitig
encrypt off-system stor sensit inform on way mitig collect fil stop advers acquir inform intrud persist long period tim advers abl discov access dat mean keylog inst system abl interceiv password input capt http us decrypt protect docu advers collect strong password us prev offlin crack encrypt docu brut forc http techn ident unnecess system util third-party tool pot malicy softw us collect fil audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
rundll32 mitig
microsoft enh mitig expery toolkit emet attack surfac reduc asr feat us block method us rundll32.exe bypass whitel sec host baselin emet
spearph attach mitig
network intrud prev system system design scan remov malicy email attach us block act solv sign behavy bas advers construct attach way avoid system block unknown unus attach default transmit email best pract prev vect .scr .exe .pif .cpl etc email scan dev op analys compress encrypt form zip rar us cont malicy attach obfusc fil inform http techn involv us interact endpoint difficult ful mitig howev pot mitig us train ident soc engin techn spearph email prev attach execut apply whitel us anti-virus also autom quarantin suspicy fil
fil system log offset mitig
ident pot malicy softw us access log driv man audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
password policy
set enforc sec password policy account
behavy prev endpoint
us cap prev suspicy behavy pattern occ endpoint system could includ suspicy process fil ap cal etc behavy
distribut compon object model mitig
mod reg set direct us dcomcnfg.exe cod hkey_local_machine\software\classes\appid\ appid_guid /code assocy process-wide sec individ com apply microsoft process wid com key mod reg set direct us dcomcnfg.exe cod hkey_local_machine\software\microsoft\ole /code assocy system-wide sec default com apply set process-wide sec microsoft system wid com key microsoft com ac consid dis dcom dcomcnfg.exe microsoft dis dcom en window firewal prev dcom instanty default ens com alert protect view en microsoft protect view
cmstp mitig
cmstp.exe necess within giv environ unless us vpn connect instal consid us apply whitel config block execut cmstp.exe requir giv system network prev pot misus advers msitpro cmstp aug 2017
exfilt command control channel mitig
mitig command control apply network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec obfusc techn us particul advers tool lik diff across vary malw famy vert advers lik chang tool command control sign tim construct protocol way avoid detect common defend tool univers birmingham c2
exploit privileg esc mitig
upd softw regul employ patch man intern enterpr endpoint serv develop robust cyb threat intellig cap determin typ level threat us softw exploit 0-days particul org mak difficult advers adv op exploit undiscov unpatch vuln us sandbox avail typ virt apply microseg also mitig impact typ client-side exploit risk addit exploit weak impl stil ex ar technic pwn2own 2017 vm escap sec apply look behavy us exploit window defend exploit guard wdeg enh mitig expery toolkit emet us mitig exploit behavy technet mov beyond emet control flow integr check anoth way pot ident stop softw exploit occ wikiped control flow integr many protect depend architect target apply bin compat work softw compon target privileg esc
serv reg permit weak mitig
ens prop permit set reg hiv prev us mod key system compon lead privileg esc ident block pot malicy softw execut serv abus us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown program
us account man
man cre mod us permit assocy us account
auth pack mitig
window 8.1 window serv 2012 r2 lat vert mak lsa run protect process light ppl set reg key cod hklm\system\currentcontrolset\control\lsa\runasppl /code requir dlls load lsa sign microsoft graeb 2014 microsoft config lsa
startup item mitig
sint startupitem deprec prev us writ cod /library/startupitems /code direct would prev startup item get reg simil appropry permit apply spec us edit startup item lev privileg esc
network shar connect remov mitig
follow best pract mitig act rel est window admin shar http ident unnecess system util pot malicy softw us lev network shar audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
man brows mitig
sint brows pivot requir high integr process launch restrict us permit address privileg esc bypass us account control http opportun limit expos techn clos brows sess regul long nee
appcert dlls mitig
ident block pot malicy softw execut appcert dlls us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown dlls
rootkit mitig
ident pot malicy softw contain rootkit funct audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
bootkit mitig
ens prop permit plac help prev advers access privileg account necess perform act us trust platform mod technolog sec trust boot process prev system integr comprom tcg trust platform mod technet sec boot process
dll search ord hijack mitig
disallow load remot dlls microsoft dll preload includ default window serv 2012+ avail patch xp+ serv 2003+ microsoft dll search path algorithm en saf dll search mod forc search system dlls direct gre restrict e.g cod systemroot /code us loc direct dlls e.g us hom direct saf dll search mod en via group policy comput config policy admin templ ms leg ms safedllsearchmod en saf dll search mod assocy window reg key loc cod hklm\system\currentcontrolset\control\session manager\safedllsearchmode /code microsoft dll search us audit tool cap detect dll search ord hijack opportun system within enterpr correct toolkit lik powersploit framework contain powerup mod us expl system dll hijack weak powersploit ident block pot malicy softw execut search ord hijack us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown dlls
supply chain comprom mitig
apply supply chain risk man scrm pract proc mit se guid 2014 supply chain analys appropry risk man throughout life-cycl system lev est softw develop lifecyc sdlc pract nist supply chain 2012 un ident supply chain el process act limit access expos within supply chain est maintain prov el process tool dat shar inform within strict limit perform scrm aw train us defend design system el process perform continu integr review strengthen delivery mech ass sustain act process man dispos fin disposit act throughout system el lif cyc patch man process impl check unus depend unmaintain and/or prevy vuln depend unnecess feat compon fil docu continu monit vuln sourc us autom man cod review tool also impl wel owasp top 10 2017
restrict fil direct permit
restrict access set direct fil permit spec us privileg account
cre account mitig
us enforc multifact auth follow guidelin prev limit advers access valid account http us cre privileg account within environ advers cre loc account system limit access within network access level prop lock account nee persist individ system us depend util system resid protect domain control ens prop sec config crit serv config access control firewal limit access system allow domain admin account us day-to-day op expos pot advers unprivileg system
remot system discovery mitig
ident unnecess system util pot malicy softw us acquir inform remot avail system audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
logon script mitig
restrict writ access logon script spec admin prev access admin account mitig cred access techn limit account access permit valid account http ident block pot malicy softw execut logon script mod us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown program
privileg account man
man cre mod us permit assocy privileg account includ system root
screensaver mitig
block .scr fil execut non-standard loc set group policy forc us ded screensaver loc chang overrid set prev chang us group policy dis screensavers unnecess technet screensaver gp
sec support provid mitig
window 8.1 window serv 2012 r2 lat vert mak lsa run protect process light ppl set reg key cod hklm\system\currentcontrolset\control\lsa\runasppl /code requir ssp dlls sign microsoft graeb 2014 microsoft config lsa
uncommon us port mitig
prop config firewal proxy limit outgo traff necess port network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec protocol us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
shortcut mod mitig
limit permit cre symbol link window appropry group admin necess group virt do gpo comput config policy window set sec set loc policy us right assign cre symbol link ucf stig symbol link ident block unknown pot malicy softw execut shortcut mod us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
tim provid mitig
ident block pot malicy softw execut tim provid us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown dlls consid us group policy config block subsequ mod w32time paramet microsoft w32time 2017
restrict reg permit
restrict abl mod certain hiv key window reg
kerberoast mitig
ens strong password leng id 25+ charact complex serv account password period expir adsec crack kerbero dec 2015 also consid us group man serv account anoth third party produc password vault adsec crack kerbero dec 2015 limit serv account minim requir privileg includ memb privileg group domain admin adsec crack kerbero dec 2015 en ae kerbero encrypt anoth stronger encrypt algorithm rath rc4 poss adsec crack kerbero dec 2015
custom cryptograph protocol mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sint custom protocol us adh typ protocol standard opportun sign traff network level detect sign oft un ind within protocol bas spec protocol us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
antivirus/antimalware
us sign heur detect malicy softw
standard cryptograph protocol mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level us encrypt protocol mak typ network-based c2 detect difficult due reduc abl sign traff pri knowledg advers c2 infrastruct us domain ip address block lik effect long-term solv advers chang infrastruct oft univers birmingham c2
regsvcs/regasm mitig
regsvc regasm necess within giv environ block execut regsvcs.exe regasm.exe requir giv system network prev pot misus advers
exfilt network med mitig
ens host-based sens maintain vis us network adapt prev cre new on poss microsoft gpo bluetoo feb 2009 techrepubl wireless gpo feb 2009
graph us interfac mitig
prev advers gain access cred cred access us log remot desktop sess system ident unnecess system util third-party tool pot malicy softw us log remot interact sess audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
ntfs fil attribut mitig
difficult inadv block access ea ad microsoft ad mar 2014 symantec ad 2009 effort foc prev pot malicy softw run ident block pot malicy softw contain funct hid inform ea ad us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp consid adjust read writ permit ntfs ea though test ens routin o op imp insiderthr ntfs ea oct 2017
bash hist mitig
multipl method prev us command hist flush .bash_history fil includ us follow command cod set +o hist /code cod set -o hist /code start log cod unset histfil /code ad us .bash_rc fil cod ln -s /dev/null ~/.bash_history /code writ command cod /dev/null /code instead
spearph link mitig
techn involv us interact endpoint difficult ful mitig howev pot mitig us train ident soc engin techn spearph email malicy link determin certain websit us spearph necess busy op consid block access act monit wel pos sign risk mitig tak plac us execut http occ
compil delivery mitig
typ techn easy mitig prev control patch sint bas abus op system design feat exampl block fil compil unintend sid effect prev legitim o framework cod develop mech op prop consid remov compil nee otherw effort foc prev advers tool run ear chain act ident subsequ malicy behavy ident unnecess system util pot malicy softw us decrypt deobfusc decod compil fil inform audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
cred dump mitig
window monitor/harden access lsass sam tabl tool allow process whitel limit cred overlap across system prev lat mov opportun us valid account http password hash obtain ens loc admin account complex un password across system network put us admin domain account loc admin group across system unless tight control oft equ loc admin account password system follow best pract design admin enterpr network limit privileg account us across admin tier microsoft sec privileg access window 8.1 window serv 2012 r2 en protect process light lsa microsoft lsa ident block pot malicy softw us dump cred us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp window 10 microsoft impl new protect cal cred guard protect lsa secret us obtain cred form cred dump config default hardw firmw system requir technet cred guard also protect form cred dump github shb cred guard man access control list reply direct chang permit assocy domain control reply adsec dcsync sept 2015 microsoft reply ac consid dis restrict ntlm traff microsoft dis ntlm nov 2012 linux scrap password mem requir root privileg follow best pract restrict access esc privileg avoid hostil program access sensit reg mem
remot access tool mitig
prop config firewal apply firewal proxy limit outgo traff sit serv us remot access tool network intrud detect prev system us network sign abl prev traff serv wel us apply whitel mitig us instal unapprov softw
multi-factor auth
us two piec evid auth system usernam password addit tok phys smart card tok gen
brows extend mitig
instal brows extend trust sourc ver ens extend inst intend on many malicy extend masquerad legitim on brows extend brows control group policy set brows extend whit black list appropry sec policy technospot chrome extend gp chang set prev brows inst extend without sufficy permit clos brows sess fin us
softw config
impl config chang softw op system mitig sec risk assocy softw op
dcshadow mitig
typ attack techn easy mitig prev control sint bas abus ad design feat exampl mitig spec ad ap cal lik unintend sid effect prev dc reply op prop effort foc prev advers tool run ear chain act id subsequ malicy behavy
new serv mitig
limit privileg us account remedy privileg esc vect auth admin cre new serv ident block unnecess system util pot malicy softw us cre serv us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
commun remov med mitig
dis autorun unnecess microsoft dis autorun disallow restrict remov med org policy level requir busy op technet remov med control
sid-history inject mitig
cle sid-history attribut legitim account migr complet consid apply sid filt interforest trust forest trust extern trust exclud sid-history request access domain resourc sid filt ens auth request trust contain sid sec princip trust domain i.e prev trust domain claim us memb group outsid domain sid filt forest trust en default dis cas allow child domain transit access forest trust sid filt extern trust autom en cre extern trust us serv 2003 lat domain control microsoft trust consid nov 2014 microsoft sid filt quarantin jan 2009 howev not sid filt autom apply leg trust delib dis allow inter-domain access resourc sid filt apply microsoft netdom trust sept 2012 dis sidh forest trust us netdom tool cod netdom trust trustingdomainnam /domain trusteddomainnam /enablesidhistory /code domain control apply sid filt quarantin extern trust us netdom tool cod netdom trust trustingdomainnam /domain trusteddomainnam /quarantine ye /code domain control apply sid filt domain trust within singl forest recommend unsupport config caus break chang microsoft netdom trust sept 2012 adsec kerbero gt aug 2015 domain within forest untrustworthy memb forest situ necess first split trust untrust domain sep forest sid filt apply interforest trust
apply isol sandbox
restrict execut cod virt environ transit endpoint system
dat transf siz limit mitig
network intrud detect prev system us network sign ident traff spec advers command control infrastruct malw us mitig act network level sign oft un ind within protocol bas spec obfusc techn us particul advers tool lik diff across vary malw famy vert advers lik chang tool command control sign tim construct protocol way avoid detect common defend tool univers birmingham c2
inhibit system recovery mitig
consid techn control prev dis serv delet fil involv system recovery consid impl disast recovery plan contain proc tak regul dat backup us rest org dat ready.gov drp ens backup stor system protect common method advers us gain access destroy backup prev recovery ident pot malicy softw audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
web shel mitig
ens extern fac web serv patch regul prev advers access exploit privileg esc http gain remot cod access fil includ weak allow advers upload fil script autom serv web pag audit account group permit ens account us man serv overlap account permit us intern network could acquir cred access us log web serv plant web shel pivot web serv intern network us-cert alert ta15-314 web shel
pas hash mitig
monit system domain log unus cred logon act prev access valid account http apply patch kb2871997 window 7 high system limit default access account loc admin group en pas hash mitig apply uac restrict loc account network logon assocy reg key loc cod hklm\software\microsoft\windows\currentversion\policies\system\localaccounttokenfilterpolicy /code gpo comput config policy admin templ scm pas hash mitig apply uac restrict loc account network logon github iad sec host baselin uac filt limit cred overlap across system prev dam cred comprom reduc advers abl perform lat mov system ens built-in cre loc admin account complex un password allow domain us loc admin group multipl system
sec softw discovery mitig
ident unnecess system util pot malicy softw us acquir inform loc sec softw audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
bypass us account control mitig
remov us loc admin group system although uac bypass techn ex stil prud us highest enforc level uac poss mitig bypass opportun ex techn dll search ord hijack http check common uac bypass weak window system aw risk post address issu appropry github uacm
access feat mitig
us techn remot advers must us conjunct rdp ens network level auth en forc remot desktop sess auth sess cre login screen display en default window vist lat technet rdp nla poss us remot desktop gateway man connect sec config rdp within network technet rdp gateway ident block pot malicy softw execut advers techn us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
system network connect discovery mitig
ident unnecess system util pot malicy softw us acquir inform network connect audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
rc.common mitig
limit privileg us account auth us edit rc.common fil
loc job schedule mitig
limit privileg us account remedy privileg esc vect auth us cre schedule job ident block unnecess system util pot malicy softw us schedule job us whitel tool
environ key mitig
techn lik mitig prev control protect unintend target comprom target effort foc prev advers tool run ear chain act ident subsequ malicy behavy comprom
access tok manip mitig
access tok integr part sec system within window turn howev attack must already admin level access loc system mak ful us techn sur restrict us account least privileg requir job us also spoof access tok legitim cred follow mitig guidelin prev advers us valid account http limit permit us us group cre tok set defin loc system account gpo comput config policy window set sec set loc policy us right assign cre tok object microsoft cre tok also defin cre process level tok loc network serv gpo comput config policy window set sec set loc policy us right assign replac process level tok microsoft replac process tok also limit opportun advers increas privileg limit privileg esc opportun
system inform discovery mitig
ident unnecess system util pot malicy softw us acquir inform op system und hardw audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
templ inject mitig
consid dis microsoft off macros/active cont prev execut malicy payload docu microsoft dis macro though set mitig forc auth http us techn techn involv us interact endpoint difficult ful mitig howev pot mitig includ train us ident soc engin techn spearph email network/host intrud prev system antivir deton chamb employ prev docu fetch and/or execut malicy payload anomal templ inject mar 2018
spearph via serv mitig
determin certain soc med sit person webmail serv serv us spearph necess busy op consid block access act monit wel pos sign risk techn involv us legitim serv us interact endpoint difficult ful mitig howev pot mitig us train ident soc engin techn spearph email malicy link prev download execut apply whitel us anti-virus also autom quarantin suspicy fil
apply deploy softw mitig
grant access apply deploy system limit numb auth admin ens prop system access isol crit network system us firewal account privileg sep group policy multifact auth ver account cred us access deploy system un us throughout enterpr network patch deploy system regul prev pot remot access exploit privileg esc http apply deploy system config deploy sign bin ens trust sign cert co-located apply deploy system instead loc system access remot remot access tight control
softw pack mitig
ens upd vir definit cre custom sign observ malw employ heuristic-based malw detect ident prev execut pot malicy softw pack us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
bit job mitig
typ attack techn easy mitig prev control sint bas abus op system design feat exampl dis bit funct lik unintend sid effect prev legitim softw patch upd effort foc prev advers tool run ear chain act id subsequ malicy behavy mondok window piggyback bit 2007 mod network and/or host firewal rul wel network control allow legitim bit traff consid limit access bit interfac spec us group symantec bit 2007 consid reduc default bit job lifetim group policy edit cod jobinactivitytimeout /code cod maxdownloadtim /code reg valu cod hkey_local_machine\software\policies\microsoft\windows\bits /code microsoft bit
extr window mem inject mitig
typ attack techn easy mitig prev control sint bas abus op system design feat exampl mitig spec ap cal lik unintend sid effect prev legitim softw i.e. sec produc op prop effort foc prev advers tool run ear chain act ident subsequ malicy behavy although ewm inject us evad certain typ defens stil good pract ident pot malicy softw us perform advers act audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
audit
perform audit scan system permit insec softw insec config etc ident pot weak
remot fil cop mitig
network intrud detect prev system us network sign ident traff spec advers malw unus dat transf know tool protocol lik ftp us mitig act network level sign oft un ind within protocol bas spec obfusc techn us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
apply shim mitig
cur n't lot way mitig apply shim dis shim engin n't recommend window depend shim interop softw becom unst work microsoft releas opt patch upd kb3045645 remov auto-elevate flag within sdbinst.exe prev us apply shim bypass uac chang uac set alway not giv us vis uac elev request howev opt popul among us due const uac interrupt
execut mod load mitig
direct mitig mod load ap cal rel mod load lik unintend sid effect prev legitim softw op prop effort foc prev advers tool run ear chain act ident correl subsequ behavy determin result malicy act
deobfuscate/decod fil inform mitig
ident unnecess system util pot malicy softw us deobfusc decod fil inform audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
powershel mitig
poss remov powershel system nee review perform ass impact environ sint could us many legitim purpos admin funct powershel necess restrict powershel execut policy admin execut sign script aw method bypass powershel execut policy depend environ config netsp powershel execut policy bypass disable/restrict winrm serv help prev us powershel remot execut
dat obfusc mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec obfusc techn us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
network serv scan mitig
us network intrud detection/prevent system detect prev remot serv scan ens unnecess port serv clos prop network seg follow protect crit serv dev ident unnecess system util pot malicy softw us acquir inform serv run remot system audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
exploit protect
us cap detect block condit lead ind softw exploit occ
mshta mitig
mshta.exe necess within giv environ sint funct tie old vert internet expl reach end lif us apply whitel config block execut mshta.exe requir giv system network prev pot misus advers
valid account mitig
tak meas detect prev techn o cred dump http instal keylog acquir cred input capt http limit cred overlap across system prev access account cred obtain ens loc admin account complex un password across system network put us admin domain account loc admin group across system unless tight control us account seg oft equ loc admin account password system follow best pract design admin enterpr network limit privileg account us across admin tier microsoft sec privileg access audit domain loc account wel permit level routin look situ could allow advers gain wid access obtain cred privileg account technet cred theft technet least privileg audit also includ default account en new loc account cre auth apply apply util default usernam password chang immedy instal deploy produc environ us-cert alert ta13-175 risk default password internet poss apply us ssh key upd period prop sec
extern remot serv mitig
limit access remot serv cent man cont vpns man remot access system deny direct remot access intern system us network proxy gateway firewal dis block remot avail serv window remot man http us strong two-factor multi-factor auth remot serv account mitig advers abl lev ste cred aw multi-factor auth interceiv http techn two-factor auth impl
serv execut mitig
ens permit disallow serv run high permit level cre interact us low permit level also ens high permit level serv bin replac mod us low permit level ident unnecess system util pot malicy softw us interact window serv audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
chang default fil assocy mitig
direct mitig techn recommend sint legitim funct perform us softw pref follow microsoft best pract fil assocy msdn fil assocy ident block pot malicy softw execut techn us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
system serv discovery mitig
ident unnecess system util pot malicy softw us acquir inform serv audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
dat network shar driv mitig
ident unnecess system util pot malicy softw us collect dat network shar audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
video capt mitig
mitig techn spec difficult requir fine-grained ap control effort foc prev unw unknown cod execut system ident block pot malicy softw us capt video im us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
multiband commun mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec protocol us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
sudo cach mitig
set cod timestamp_timeout /code 0 requir us input password every tim cod sudo /code execut simil ens cod tty_tickets /code set en prev leak across tty sess
dylib hijack mitig
prev us abl writ fil search path apply fold apply run standard dylib fold us ca n't writ direct ca n't interceiv search path
permit group discovery mitig
ident unnecess system util pot malicy softw us acquir inform group permit audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
path interceiv mitig
elimin path interceiv weak program config fil script path environ vary serv shortcut surround path vary quot mark funct allow microsoft createprocess aw search ord window us execut load bin us ful qual path wherev appropry msdn dll sec cle old window reg key softw uninstal avoid key assocy legitim bin period search correct report path interceiv weak system introduc us custom avail tool report softw us insec path config kanthak sentinel requir execut plac write-protected direct ens prop permit direct access control set deny us abl writ fil top-level direct cod c /code system direct cod c \windows\ /code reduc plac malicy fil could plac execut ident block pot malicy softw execut path interceiv us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 cap audit and/or block unknown execut
launchctl mitig
prev us inst launch ag launch daemon instead requir push group policy
act direct config
config act direct prev us certain techn us sid filt etc
exfilt phys med mitig
dis autorun unnecess microsoft dis autorun disallow restrict remov med org policy level requir busy op technet remov med control
upd softw
perform regul softw upd mitig exploit risk
restrict libr load
prev abus libr load mech op system softw load untrust cod config appropry libr load mech investig pot vuln softw
two-factor auth interceiv mitig
remov smart card us protect dev serv us transmit receiv out-of-band cod ident block pot malicy softw us interceiv 2fa cred system us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
stor dat manip mitig
ident crit busy system process target advers work sec dat rel process tamp ens least privileg principl apply import inform resourc reduc expos dat manip risk consid encrypt import inform reduc advers abl perform tail dat mod appl examin us fil monit softw check integr import fil direct wel tak correct act unauth chang detect consid impl disast recovery plan contain proc tak regul dat backup us rest org dat ready.gov drp ens backup stor system protect common method advers us gain access manip backup
dis remov feat program
remov deny access unnecess pot vuln softw prev abus advers
installutil mitig
installutil necess within giv environ us apply whitel config block execut installutil.exe requir giv system network prev pot misus advers
ind block mitig
ens ev tracers/forwarder microsoft etw 2018 firewal policy assocy mech sec appropry permit access control consid autom relaunch forward mech rec interv ex temp on-logon etc wel apply appropry chang man firewal rul rel system config
mod reg mitig
misconfig permit reg lead opportun advers execut cod lik serv reg permit weak http ens prop permit set reg hiv prev us mod key system compon lead privileg esc ident block unnecess system util pot malicy softw us mod reg us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
sip trust provid hijack mitig
ens prop permit set reg hiv prev us mod key rel sip trust provid compon also ens valu contain ful path prev dll search ord hijack http spectorop subvert trust sept 2017 consid remov unnecess and/or stal sip spectorop subvert trust sept 2017 restrict stor execut sip dlls protect direct c \windows rath us direct en whitel solv applock and/or dev guard block load malicy sip dlls compon stil abl hijack suit funct already pres disk malicy mod reg key prev
reply remov med mitig
dis autorun unnecess microsoft dis autorun disallow restrict remov med org policy level requir busy op technet remov med control ident pot malicy softw us infect remov med result taint remov med audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
taint shar cont mitig
protect shar fold minim us writ access us util detect mitig common feat us exploit microsoft enh mitig expery toolkit emet reduc pot lat mov risk us web-based docu man collab serv us network fil direct shar ident pot malicy softw us taint cont result audit and/or block unknown program us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
priv key mitig
us strong passphras priv key mak crack difficult poss stor key sep cryptograph hardw instead loc system ens auth key allow access crit resourc audit access list regul ens permit prop set fold contain sensit priv key prev unintend access us sep infrastruct man crit system prev overlap cred permit system could us vect lat mov follow best pract mitig access us valid account http
schedule task mitig
limit privileg us account remedy privileg esc vect auth admin cre schedule task remot system toolkit lik powersploit framework contain powerup mod us expl system permit weak schedule task could us esc privileg powersploit config set schedule task forc task run context auth account instead allow run system assocy reg key loc cod hklm\system\currentcontrolset\control\lsa\submitcontrol /code set config gpo comput config policy window set sec set loc policy sec opt domain control allow serv op schedule task set dis technet serv op schedule task config increas schedule pri opt allow admin group right schedule pri process config gpo comput config policy window set sec set loc policy us right assign increas schedule pri technet schedule pri ident block unnecess system util pot malicy softw us schedule task us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
exploit cli execut mitig
brows sandbox us mitig impact exploit sandbox escap stil ex window blog microsoft edg sandbox ar technic pwn2own 2017 vm escap typ virt apply microseg also mitig impact client-side exploit risk addit exploit weak impl stil ex ar technic pwn2own 2017 vm escap sec apply look behavy us exploit window defend exploit guard wdeg enh mitig expery toolkit emet us mitig exploit behavy technet mov beyond emet control flow integr check anoth way pot ident stop softw exploit occ wikiped control flow integr many protect depend architect target apply bin compat
custom command control protocol mitig
prop config firewal proxy limit outgo traff necess port prop network gateway system also ens host provid commun auth interfac network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec protocol us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
process discovery mitig
ident unnecess system util pot malicy softw us acquir inform process audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
port knock mitig
mitig vary techn could achiev us stat firewal depend upon impl
redund access mitig
ident block pot malicy softw us remot access tool audit and/or block us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol diff across vary malw famy vert advers lik chang tool sign tim construct protocol way avoid detect common defend tool univers birmingham c2
account us policy
config feat rel account us lik login attempt lockout spec login tim etc
hid window mitig
whitel program allow plist tag program consid suspicy
dat encod mitig
network intrud detect prev system us network sign ident traff spec advers malw us mitig act network level sign oft un ind within protocol bas spec obfusc techn us particul advers tool lik diff across vary malw famy vert advers lik chang tool c2 sign tim construct protocol way avoid detect common defend tool univers birmingham c2
mod ex serv mitig
us audit tool cap detect privileg serv abus opportun system within enterpr correct limit privileg us account group auth admin interact serv chang serv config toolkit lik powersploit framework contain powerup mod us expl system privileg esc weak powersploit ident block pot malicy softw execut serv abus us whitel beechey 2010 tool lik applock window command jpcert nsa m applock cap audit and/or block unknown program
encrypt sensit inform
protect sensit inform strong encrypt
compon object model hijack mitig
direct mitig techn recommend particul environ sint com object legitim part op system inst softw block com object chang unforeseen sid effect legitim funct instead ident block pot malicy softw execut execut techn us whitel beechey 2010 tool lik applock window command jpcert nsa m applock softw restrict policy corio 2008 appropry technet applock v srp
